define(["translations","pgadmin.browser.endpoints","pgadmin.browser.utils","pgadmin.user_management.current_user","pgadmin.browser.messages","pgadmin.server.supported_servers"],function(n,i,r,a,o,s){return function(l){function e(e){for(var t,n,i=e[0],r=e[1],a=e[2],o=0,s=[];o<i.length;o++)n=i[o],Object.prototype.hasOwnProperty.call(c,n)&&c[n]&&s.push(c[n][0]),c[n]=0;for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&(l[t]=r[t]);for(p&&p(e);s.length;)s.shift()();return u.push.apply(u,a||[]),d()}function d(){for(var e,t=0;t<u.length;t++){for(var n=u[t],i=!0,r=1;r<n.length;r++){var a=n[r];0!==c[a]&&(i=!1)}i&&(u.splice(t--,1),e=f(f.s=n[0]))}return e}var n={},c={11:0},u=[];function f(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return l[e].call(t.exports,t,t.exports,f),t.l=!0,t.exports}f.e=function(r){var e=[],n=c[r];if(0!==n)if(n)e.push(n[2]);else{var t=new Promise(function(e,t){n=c[r]=[e,t]});e.push(n[2]=t);var i,a=document.createElement("script");a.charset="utf-8",a.timeout=120,f.nc&&a.setAttribute("nonce",f.nc),a.src=function(e){return f.p+""+({13:"vendors~chart",14:"vendors~geometry",15:"vendors~snapsvg"}[e]||e)+".chunk.js"}(r);var o=new Error;i=function(e){a.onerror=a.onload=null,clearTimeout(s);var t=c[r];if(0!==t){if(t){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;o.message="Loading chunk "+r+" failed.\n("+n+": "+i+")",o.name="ChunkLoadError",o.type=n,o.request=i,t[1](o)}c[r]=void 0}};var s=setTimeout(function(){i({type:"timeout",target:a})},12e4);a.onerror=a.onload=i,document.head.appendChild(a)}return Promise.all(e)},f.m=l,f.c=n,f.d=function(e,t,n){f.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},f.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(t,e){if(1&e&&(t=f(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(f.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)f.d(n,i,function(e){return t[e]}.bind(null,i));return n},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="",f.oe=function(e){throw console.error(e),e},Object.defineProperty(f,"p",{get:function(){try{if("function"!=typeof getChunkURL)throw new Error("WebpackRequireFrom: 'getChunkURL' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return getChunkURL()}catch(e){return""}}});var t=window.webpackJsonp=window.webpackJsonp||[],i=t.push.bind(t);t.push=e,t=t.slice();for(var r=0;r<t.length;r++)e(t[r]);var p=i;return u.push([438,1,2,10,3,0,4]),d()}([,,function(e,t,n){"use strict";var i,r;n(23),n(40),n(4),n(29),i=[n(93)],void 0===(r=function(i){return function(e){var t=i[e]?i[e]:e;if(1==arguments.length)return t;try{var n=arguments;return t.split("%s").map(function(e,t){return 0<t?t<n.length?[n[t],e].join(""):["%s",e].join(""):e}).join("")}catch(e){return console.error(e),t}}}.apply(t,i))||(e.exports=r)},function(n,i,r){"use strict";(function(e){var t;function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(21),r(26),r(27),r(19),r(73),r(33),r(12),r(79),r(37),r(4),r(46),r(24),r(62),r(8),r(29),r(22),void 0===(t=function(){var e=window.pgAdmin=window.pgAdmin||{};function n(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}return function(e,t,d){function c(e,t,n,i){n=n||"width";var r,a,o,s=(t.match(g)||[])[2],l="px"===s?1:_[s+"toPx"];if(l||/r?em/i.test(s)&&!i)e=l?e:"rem"===s?p:"fontSize"===n&&e.parentNode||e,l=l||parseFloat(u(e,"fontSize")),o=parseFloat(t)*l;else{a=(r=e.style)[n];try{r[n]=t}catch(e){return 0}o=r[n]?parseFloat(u(e,n)):0,r[n]=a!==d?a:null}return o}function u(e,t){var n,i,r,a,o,s=["paddingTop","paddingBottom","borderTop","borderBottom"],l=4;if(i=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)],"%"===(r=((n=h?h(e)[t]:i?i+"px":"fontSize"===t?c(e,"1em","left",1)+"px":e.currentStyle[t]).match(g)||[])[2])&&f)if(/^top|bottom/.test(t)){for(a=(o=e.parentNode||e).offsetHeight;l--;)a-=parseFloat(u(o,s[l]));n=parseFloat(n)/100*a+"px"}else n=c(e,n);else("auto"===n||r&&"px"!==r)&&h?n=0:r&&"px"!==r&&!h&&(n=c(e,n)+"px");return n}var f,n=t.createElement("test"),p=t.documentElement,i=t.defaultView,h=i&&i.getComputedStyle,g=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,_={},r=[1/25.4,1/2.54,1/72,1/6],a=["mm","cm","pt","pc","in","mozmm"],o=6;for(p.appendChild(n),h&&(n.style.marginTop="1%",f="1%"===h(n).marginTop);o--;)_[a[o]+"toPx"]=r[o]?r[o]*_.inToPx:c(n,"1"+a[o]);p.removeChild(n),n=d,e.toPx=c}(e,window.document),e.natural_sort=function(e,t,n){n=n||{};function i(e){return n.insensitive&&(""+e).toLowerCase()||""+e}var r,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,l=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,d=/^0x[0-9a-f]+$/i,c=/^0/,u=i(e).replace(s,"")||"",f=i(t).replace(s,"")||"",p=u.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),h=f.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(u.match(d))||1!==p.length&&u.match(l)&&Date.parse(u),_=parseInt(f.match(d))||g&&f.match(l)&&Date.parse(f)||null,m=n.desc?-1:1;if(_){if(g<_)return-1*m;if(_<g)return 1*m}for(var v=0,b=Math.max(p.length,h.length);v<b;v++){if(r=!(p[v]||"").match(c)&&parseFloat(p[v])||p[v]||0,a=!(h[v]||"").match(c)&&parseFloat(h[v])||h[v]||0,isNaN(r)!==isNaN(a))return(isNaN(r)?1:-1)*m;if(y(r)!==y(a)&&(r+="",a+=""),r<a)return-1*m;if(a<r)return 1*m}return 0},Math.round10||(Math.round10=function(e,t){return n("round",e,t)}),Math.floor10||(Math.floor10=function(e,t){return n("floor",e,t)}),Math.ceil10||(Math.ceil10=function(e,t){return n("ceil",e,t)}),e}.apply(i,[]))||(n.exports=t)}).call(this,r(3))},,function(e,t,n){"use strict";var i,r;n(4),n(8),i=[n(94)],void 0===(r=function(i){return function(e,r){var t=i[e],n=t;return t?n=n.replace(/([<])([^:^>]*:)?([^>]+)([>])/g,function(e,t,n,i){return i in r?r[i]:e}):t}}.apply(t,i))||(e.exports=r)},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(10),n(16),n(23),n(40),n(33),n(7),n(37),n(4),n(143),n(8),n(65),n(29),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.parseShortcutValue=function(e){var t="";e.alt&&(t+="alt+");e.shift&&(t+="shift+");e.control&&(t+="ctrl+");return t+=e.key.char.toLowerCase()},t.findAndSetFocus=function(t){if(0==t.length)return;setTimeout(function(){var e=t.find("button.fa-plus:first");0==e.length&&(e=t.find("\n          .pgadmin-controls:first input:enabled,\n          .pgadmin-controls:first .btn:not(.toggle),\n          .CodeMirror-scroll").find('*[tabindex]:not([tabindex="-1"])')),0<e.length?e[0].focus():t[0].focus()},200)},t.getEpoch=function(e){var t=e||new Date;return parseInt(t.getTime()/1e3)},t.getGCD=function(e){function n(e,t){return 0==e?t:n(t%e,e)}var t=e.length;if(t<=2)return n(e[0],e[1]);for(var i=e[0],r=1;r<t;r++)i=n(e[r],i);return i},t.getMod=function(e,t){return(e%t+t)%t},t.parseFuncParams=function(e){var t=[],n="",i="";if(e.endsWith("()"))n=e.substring(0,e.length-2);else if(e.endsWith(")")){if(!e.endsWith("()")&&e.endsWith(")")){var r=0,a=e.length;for(r=e.length-2;0<=r;){if("("==e[r]){a=r;break}if('"'==e[r])for(r--;'"'!=e[r];)r--;r--}n=e.substring(0,a),i=e.substring(a+1,e.length-1);var o=0,s="",l=["IN","OUT","INOUT","VARIADIC"];for(o=r=0;r<i.length;){if('"'==i[r])for(r++;'"'!=i[r];)r++;else" "==i[r]?(""==s||-1<l.indexOf(s))&&(s=i.substring(o,r),o=r+1):","==i[r]&&(t.push([s,i.substring(o,r)]),s="",o=r+1);r++}t.push([s,i.substring(o)])}}else n=e;return{func_name:n,param_string:i,params:t}},t.quote_ident=o,t.fully_qualify=function(e,t,n){var i=a.getTreeNodeHierarchyFromIdentifier.call(e,n),r="";void 0!==i.schema?r=o(i.schema._label):void 0!==i.view?r=o(i.view._label):void 0!==i.catalog&&(r=o(i.catalog._label));void 0!==i.package&&"package"!=t._type&&(""==r?r=o(i.package._label):r+="."+o(i.package._label));return""!=r?r+"."+o(t._label):o(t._label)},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},t.titleize=function(e){return""===e||null===e?e:e.split(" ").map(function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}).join(" ")},t.sprintf=function(t){try{var n=arguments;return t.split("%s").map(function(e,t){return 0<t?t<n.length?[n[t],e].join(""):["%s",e].join(""):e}).join("")}catch(e){return console.error(e),t}},t.isString=t.isFunction=t.isValidData=void 0;var i,r=(i=n(1))&&i.__esModule?i:{default:i},a=n(57);t.isValidData=function(e){return!r.default.isUndefined(e)&&!r.default.isNull(e)};t.isFunction=function(e){return r.default.isFunction(e)};function o(e){var t=!1;return isNaN(parseInt(e))||(t=!0),-1<e.search(/[^a-z0-9_]/g)&&(e=e.replace(/"/g,'""'),t=!0),t?'"'.concat(e,'"'):e}t.isString=function(e){return r.default.isString(e)}},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){var t=null;try{t=window.opener&&window.opener.pgAdmin?window.opener:window.parent&&window.parent.pgAdmin?window.parent:window.top&&window.top.pgAdmin?window.top:window}catch(e){t=window}return t}();t.default=i},,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(l){function i(e){var t,n,i=0,r=0,a={};do{var o=e.getData();if(o._type in this.Nodes&&this.Nodes[o._type].hasId){var s=(t=o._type,n=r,"partition"===t&&0<n?"table":t);void 0===a[s]&&(a[s]=l.extend({},o,{priority:i}),i-=1)}r+=1,e=e.hasParent()?e.parent():null}while(e);return a}n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeNodeHierarchyFromElement=function(e,t){return i.call(e,t)},t.getTreeNodeHierarchyFromIdentifier=function(e){var t=this.treeMenu.translateTreeNodeIdFromACITree(e),n=this.treeMenu.findNode(t);return null===n?null:i.call(this,n)},t.getTreeNodeHierarchy=i}).call(this,n(1))},,,,,,,,,,,,function(e,t,n){"use strict";var i,r;n(23),n(73),n(141),n(4),n(8),i=[n(0),n(1),n(2),n(5)],void 0===(r=function(n,i,s,l){var d={epicRandomString:function(e){for(var t=[],n="0123456789abcdef",i=0;i<36;i++)t[i]=n.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=n.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(/-/g,"").substr(0,e)},getHash:function(e){for(var t=0,n=e.length,i=0;i<n;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t},calculateColumnWidth:function(e){n("body").append('<span id="pg_text" style="visibility: hidden;">'+e+"</span>");var t=n("#pg_text").width()+23;return n("#pg_text").remove(),t},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},previousStatus:null,fetchConnectionStatus:function(e,r,a){var t=l("sqleditor.connection_status",{trans_id:e.transId});if("visible"===document.visibilityState&&"visible"===r.data("panel-visible")&&!a.hasClass("obtaining-conn")){var o=e;n.ajax({url:t,method:"GET"}).done(function(e){if(e&&e.data){var t=e.data.status,n=e.data.message,i=!1;switch(o.update_notifications(e.data.notifies),t){case 1:t!=d.previousStatus||a.hasClass("fa-hourglass-half")||(a.removeClass().addClass("fa fa-hourglass-half"),i=!0);break;case 2:d.previousStatus==t||a.hasClass("fa-clock-o")||(a.removeClass().addClass("fa fa-clock-o"),i=!0);break;case 3:d.previousStatus==t||a.hasClass("fa-exclamation-circle")||(a.removeClass().addClass("fa fa-exclamation-circle"),i=!0);break;case 4:d.previousStatus==t||a.hasClass("fa-exclamation-triangle")||(a.removeClass().addClass("fa fa-exclamation-triangle"),i=!0);break;default:d.previousStatus==t||a.hasClass("fa-query_tool_connected")||(a.removeClass().addClass("pg-font-icon icon-query-tool-connected"),i=!0)}d.previousStatus=t,i&&(r.popover("hide"),r.attr("data-content",n))}else d.previousStatus=-99,n=s("An unexpected error occurred - ensure you are logged into the application."),r.attr("data-content",n),a.hasClass("icon-query-tool-disconnected")||(r.popover("hide"),a.removeClass().addClass("pg-icon-font icon-query-tool-disconnected"))}).fail(function(e){d.previousStatus=-1;var t=s("Transaction status check failed.");0==e.readyState?t=s("Not connected to the server or the connection to the server has been closed."):e.responseJSON&&e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),r.attr("data-content",t),a.hasClass("icon-query-tool-disconnected")||(r.popover("hide"),a.removeClass().addClass("pg-font-icon icon-query-tool-disconnected"))})}},updateConnectionStatusFlag:function(e){var t=n(".connection_status");t.data("panel-visible")!=e&&t.data("panel-visible",e)},calcFontSize:function(e){if(e){var t=Number(Math.round(e+"e+2")+"e-2");if(0<t)return t+"em"}return"1em"},addEditableIcon:function(e,t){var n={cssClass:"editable-column-header-icon",content:t?'<i class="fa fa-pencil"></i>':'<i class="fa fa-lock"></i>'};i.isUndefined(e.header)||i.isUndefined(e.header.buttons)?e.header={buttons:[n]}:e.header.buttons.push(n)}};return d}.apply(t,i))||(e.exports=r)},,,,,function(e,t,n){"use strict";n(36),n(10),n(7),n(4),n(65),Object.defineProperty(t,"__esModule",{value:!0}),t.processEventDebugger=function(e,t,n,i){var r,a,o="";this.validateShortcutKeys(n.edit_grid_values,t)?(this._stopEventPropagation(t),(r=e.find('div.wcPanelTabContent:not(".wcPanelTabContentHidden")')).length&&(a=(0,y.default)(r).find("td.editable:first")).length&&a.trigger("click")):this.validateShortcutKeys(n.move_next,t)?(this._stopEventPropagation(t),o=P(i,"right")):this.validateShortcutKeys(n.move_previous,t)?(this._stopEventPropagation(t),o=P(i,"left")):this.validateShortcutKeys(n.switch_panel,t)&&(this._stopEventPropagation(t),o=P(i,"switch"));return o},t.processEventQueryTool=function(e,t,n,i){if(e.isQueryRunning())return;var r=n.which||n.keyCode,a="",o=e.preferences.execute_query,s=e.preferences.explain_query,l=e.preferences.explain_analyze_query,d=e.preferences.download_csv,c=e.preferences.move_next,u=e.preferences.move_previous,f=e.preferences.switch_panel,p=e.preferences.toggle_case,h=e.preferences.commit_transaction,g=e.preferences.rollback_transaction,_=e.preferences.save_data;if(this.validateShortcutKeys(o,n))this._stopEventPropagation(n),t.executeQuery(e);else if(this.validateShortcutKeys(s,n))this._stopEventPropagation(n),t.explain(e);else if(this.validateShortcutKeys(l,n))this._stopEventPropagation(n),t.explainAnalyze(e);else if(this.validateShortcutKeys(d,n))this._stopEventPropagation(n),t.download(e);else if(this.validateShortcutKeys(p,n))this._stopEventPropagation(n),t.toggleCaseOfSelectedText(e);else if(this.validateShortcutKeys(h,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeCommit(e));else if(this.validateShortcutKeys(g,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeRollback(e));else if(this.validateShortcutKeys(_,n))this._stopEventPropagation(n),t.saveDataChanges(e);else if((this.isMac()&&n.metaKey||!this.isMac()&&n.ctrlKey)&&!n.altKey&&n.shiftKey&&r===x)this._stopEventPropagation(n),t.commentBlockCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&r===x)this._stopEventPropagation(n),t.commentLineCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&r===w)this._stopEventPropagation(n),t.uncommentLineCode(e);else if(r==S)t.focusOut(e),(0,y.default)(n.target).hasClass("dropdown-item")&&0<(0,y.default)(n.target).closest(".dropdown-submenu").length&&(0,y.default)(n.target).closest(".dropdown-submenu").find(".dropdown-menu").removeClass("show");else if(this.validateShortcutKeys(c,n))this._stopEventPropagation(n),a=P(i,"right");else if(this.validateShortcutKeys(u,n))this._stopEventPropagation(n),a=P(i,"left");else if(this.validateShortcutKeys(f,n))this._stopEventPropagation(n),a=P(i,"switch");else if(r===k||r===E){if(0<(0,y.default)(n.target).closest(".dropdown-menu").length){this._stopEventPropagation(n);var m=(0,y.default)(n.target).closest("li");for((0,y.default)(n.target).closest(".dropdown-menu").find(".show").removeClass("show"),r===k?m=m.prev():r===E&&(m=m.next());m.hasClass("dropdown-divider")||m.hasClass("d-none")||m.find(".dropdown-item").first().hasClass("disabled");)r===k?m=m.prev():r===E&&(m=m.next());m.find(".dropdown-item").trigger("focus")}}else if((r===C||r===T)&&0<(0,y.default)(n.target).closest(".dropdown-menu").length){this._stopEventPropagation(n);var v=(0,y.default)(n.target).closest("li");if(r===T)v.hasClass("dropdown-submenu")&&(v.find(".dropdown-menu").addClass("show"),v=v.find(".dropdown-menu .dropdown-item").first().trigger("focus"));else if(r===C){var b=v.closest(".dropdown-menu");0<b.closest(".dropdown-submenu").length&&(b.removeClass("show"),(v=b.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}}return a},t.focusDockerPanel=P,t.validateShortcutKeys=function(e,t){if(!e)return!1;var n=t.which||t.keyCode;return e.alt==t.altKey&&e.shift==t.shiftKey&&e.control==t.ctrlKey&&e.key.key_code==n},t._stopEventPropagation=function(e){e.cancelBubble=!0,e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},t.isMac=function(){return-1!=window.navigator.platform.search("Mac")},t.isKeyCtrlAlt=function(e){return e.ctrlKey||e.altKey},t.isKeyAltShift=function(e){return e.altKey||e.shiftKey},t.isKeyCtrlShift=function(e){return e.ctrlKey||e.shiftKey},t.isKeyCtrlAltShift=function(e){return e.ctrlKey||e.altKey||e.shiftKey},t.isAltShiftBoth=function(e){return e.altKey&&e.shiftKey&&!e.ctrlKey},t.isCtrlShiftBoth=function(e){return e.ctrlKey&&e.shiftKey&&!e.altKey},t.isCtrlAltBoth=function(e){return e.ctrlKey&&e.altKey&&!e.shiftKey},t.shortcut_key=a,t.shortcut_title=function(e,t){var n="";if(null==t)return n;t.alt&&(n=(0,i.default)("Alt")+"+");t.shift&&(n+=(0,i.default)("Shift")+"+");t.control&&(n+=(0,i.default)("Ctrl")+"+");return n+=a(t),"".concat(e," (").concat(n,")")},t.shortcut_accesskey_title=function(e,t){return"".concat(e," (").concat((0,i.default)("accesskey")," + ").concat(a(t),")")};var y=r(n(0)),i=r(n(2)),l=n(25);function r(e){return e&&e.__esModule?e:{default:e}}var w=190,x=191,S=27,C=37,k=38,T=39,E=40;function a(e){var t="";return e.key&&e.key.char&&(t=e.key.char.toUpperCase()),t}function P(e,t){if(e){if(!e._focusFrame){if(0==e._frameList.length&&0==e._frameList[0]._panelList.length)return;e._frameList[0]._panelList[e._frameList[0]._curTab].focus()}var n=e._focusFrame,i=0,r=!1;if("switch"==t){var a=0,o=e._frameList.length;for(a=0;a<o&&n!==e._frameList[a];a++);i=(n=e._frameList[(0,l.getMod)(a+1,o)])._curTab,r=!0}else"left"==t?(i=(0,l.getMod)(n._curTab-1,n._panelList.length),r=!1):"right"==t&&(i=(0,l.getMod)(n._curTab+1,n._panelList.length),r=!1);var s=n._panelList[i];return s.$container.find('*[tabindex]:not([tabindex="-1"])').trigger("focus"),s.focus(r),s._type}}},,,,,,,function(n,i,r){"use strict";(function(c){var e,t;r(36),r(214),r(53),r(122),r(58),r(18),r(63),e=[r(130)],void 0===(t=function(){function n(e,t){return e.fromCell==t.fromCell&&e.toCell==t.toCell&&e.fromRow==t.fromRow&&e.toRow==t.toRow}function i(e){return new r.Range(0,1,e.getDataLength()-1,e.getColumns().length-1)}var r=window.Slick,a=function(e){return!c.isUndefined(e[0].pos)},o=function(e,t){return t.fromCell==t.toCell&&0==t.fromRow&&t.toRow==e.getDataLength()-1},s=function(e,t){return 0===t.fromRow&&t.toRow===e.getDataLength()-1},l=function(e,t){return t.fromCell===function(e){return c.findIndex(e.getColumns(),function(e){var t=e.pos;return!c.isUndefined(t)&&d(e)})}(e)&&t.toCell===function(e){return c.findLastIndex(e.getColumns(),d)}(e)};function d(e){return c.isUndefined(e.selectable)||!0===e.selectable}return{addRange:function(e,t){return e.push(t),e},removeRange:function(e,t){return c.filter(e,function(e){return!n(e,t)})},isRangeSelected:function(e,t){return c.any(e,function(e){return n(e,t)})},areAllRangesSingleRows:function(e,t){return c.every(e,function(e){return e.fromRow==e.toRow&&l(t,e)})},areAllRangesSingleColumns:function(e,t){return c.every(e,o.bind(this,t))},areAllRangesCompleteRows:function(t,e){return c.every(e,function(e){return l(t,e)})},areAllRangesCompleteColumns:function(t,e){return c.every(e,function(e){return s(t,e)})},rangeForRow:function(e,t){var n=e.getColumns();return a(n)?new r.Range(t,0,t,e.getColumns().length-1):new r.Range(t,1,t,e.getColumns().length-1)},rangeForColumn:function(e,t){return new r.Range(0,t,e.getDataLength()-1,t)},isEntireGridSelected:function(e){var t=e.getSelectionModel().getSelectedRanges();return 1==t.length&&n(t[0],i(e))},getRangeOfWholeGrid:i,isFirstColumnData:a,getIndexesOfCompleteRows:function(t,e){var n=[];return e.forEach(function(e){l(t,e)&&(n=n.concat(c.range(e.fromRow,e.toRow+1)))}),n},selectAll:function(e){var t=i(e);e.getSelectionModel().setSelectedRanges([t])},isRangeAColumn:o,rangeHasCompleteColumns:s,rangeHasCompleteRows:l,isAnyCellOfColumnSelected:function(e,t){return c.any(e,function(e){return e.fromCell<=t&&e.toCell>=t})},isRangeEntirelyWithinSelectedRanges:function(e,t){return c.any(e,function(e){return e.fromCell<=t.fromCell&&e.toCell>=t.toCell&&e.fromRow<=t.fromRow&&e.toRow>=t.toRow})},isAnyCellOfRowSelected:function(e,t){return c.any(e,function(e){return e.fromRow<=t&&e.toRow>=t})}}}.apply(i,e))||(n.exports=t)}).call(this,r(1))},,,,,,,function(e,t,n){"use strict";(function(o){n(36),n(11),n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getPanelTitle=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;null==t&&(t=e.treeMenu.selected());var n=r.getTreeNodeHierarchyFromIdentifier.call(e,t);if(function(e){return void 0===e.server}(n))return;var i=function(e){return e.database?e.database.label:e.server.db}(n);return"".concat(i,"/").concat(n.server.user.name,"@").concat(n.server.label)},t.setQueryToolDockerTitle=function(e,t,n,i){var r="",a="";r=i||"true"==i?(a=(0,s.default)("File - ")+n,"fa fa-file-text-o"):"false"==t||0==t?(a=(0,s.default)("View/Edit Data - ")+n,"fa fa-table"):(a=(0,s.default)("Query Tool - ")+n,"pg-font-icon icon-query-tool");e.title('<span title="'+o.escape(a)+'">'+o.escape(n)+"</span>"),e.icon(r)};var e,r=n(57),s=(e=n(2))&&e.__esModule?e:{default:e}}).call(this,n(1))},,,,,function(e,t){e.exports=n},function(e,t){e.exports=i},,function(e,t,n){"use strict";n(10);var i=o(n(0)),r=o(n(1)),a=o(n(41));function o(e){return e&&e.__esModule?e:{default:e}}e.exports={modifyAcitreeAnimation:function(e,t){var n=e.get_preference("browser","enable_acitree_animation").value;r.default.isUndefined(t)&&(t=e.tree),n?t.options({animateRoot:!0,unanimated:!1,show:r.default.extend(t.options().show,{duration:75}),hide:r.default.extend(t.options().hide,{duration:75}),view:r.default.extend(t.options().view,{duration:75})}):t.options({animateRoot:!1,unanimated:!0,show:r.default.extend(t.options().show,{duration:0}),hide:r.default.extend(t.options().hide,{duration:0}),view:r.default.extend(t.options().view,{duration:0})})},modifyAlertifyAnimation:function(e){(r.default.isUndefined(e)||r.default.isNull(e))&&(e=a.default.pgAdmin.Browser),e.get_preference("browser","enable_alertify_animation").value?((0,i.default)(document).find("body").removeClass("alertify-no-animation"),r.default.each(document.getElementsByTagName("iframe"),function(e){(0,i.default)(e.contentDocument).find("body").removeClass("alertify-no-animation")})):((0,i.default)(document).find("body").addClass("alertify-no-animation"),r.default.each(document.getElementsByTagName("iframe"),function(e){(0,i.default)(e.contentDocument).find("body").addClass("alertify-no-animation")}))}}},,,,,,,function(e,t,n){"use strict";n(7),n(12),n(148),Object.defineProperty(t,"__esModule",{value:!0}),t.setPGCSRFToken=function(i,r){if(!r)throw"csrf-token meta tag has not been set";var a=l.default.sync;l.default.sync=function(e,t,n){return n.beforeSend=function(e){e.setRequestHeader(i,r)},a(e,t,n)};var o=l.default.get;l.default.get=function(e,t,n){return n.beforeSend=function(e){e.setRequestHeader(i,r)},o(e,t,n)},s.default.ajaxSetup({beforeSend:function(e){e.setRequestHeader(i,r)}}),d.default.interceptors.request.use(function(e){return e.headers[i]=r,e},function(e){return Promise.reject(e)})};var s=i(n(0)),l=i(n(15)),d=i(n(70));function i(e){return e&&e.__esModule?e:{default:e}}},,,,,,,,,,,,,,,,function(e,h,g){"use strict";(function(o){g(21),g(26),g(27),g(53),g(10),g(58),g(19),g(23),g(18),g(145),g(75),g(7),g(32),g(76),g(48),g(12),g(4),g(24),g(8),g(29),g(83),g(63),g(22),g(6),Object.defineProperty(h,"__esModule",{value:!0}),h.isValidTreeNodeData=h.Tree=h.TreeNode=void 0;var e=g(25),s=t(g(0)),l=t(g(14));function t(e){return e&&e.__esModule?e:{default:e}}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var u=function(){function r(e,t,n,i){a(this,r),this.id=e,this.data=t,this.setParent(i),this.children=[],this.domNode=n}return n(r,[{key:"hasParent",value:function(){return null!==this.parentNode&&void 0!==this.parentNode}},{key:"parent",value:function(){return this.parentNode}},{key:"setParent",value:function(e){this.parentNode=e,this.path=this.id,null!=e&&void 0!==e.path&&(this.path=e.path+"."+this.id)}},{key:"getData",value:function(){if(void 0!==this.data)return null===this.data?null:Object.assign({},this.data)}},{key:"getHtmlIdentifier",value:function(){return this.domNode}},{key:"reload",value:function(e){var t=this;this.unload(e),e.aciTreeApi.setInode(this.domNode),e.aciTreeApi.deselect(this.domNode),setTimeout(function(){e.selectNode(t.domNode)},0)}},{key:"unload",value:function(e){this.children=[],e.aciTreeApi.unload(this.domNode)}},{key:"ancestorNode",value:function(e){for(var t=this;t.hasParent();)if(e(t=t.parent()))return t;return null}},{key:"anyFamilyMember",value:function(e){return!!e(this)||null!==this.ancestorNode(e)}},{key:"anyParent",value:function(e){return null!==this.ancestorNode(e)}}]),r}();h.TreeNode=u;var f=function(){function e(){a(this,e),this.rootNode=new u(void 0,{}),this.aciTreeApi=void 0,this.draggableTypes={}}return n(e,[{key:"registerDraggableType",value:function(t,e){var n=this,i=1<arguments.length&&void 0!==e?e:null;"object"==r(t)?Object.keys(t).forEach(function(e){n.registerDraggableType(e,t[e])}):null!=i&&t.replace(/ +/," ").split(" ").forEach(function(e){n.draggableTypes[e]=i})}},{key:"getDraggable",value:function(e){return this.draggableTypes[e]?this.draggableTypes[e]:null}},{key:"prepareDraggable",value:function(i,r){var a=this.getDraggable(i._type);null!=a&&r.find(".aciTreeItem").attr("draggable",!0)[0].addEventListener("dragstart",function(e){var t=a(i,r);if("string"==typeof t?t={text:t,cur:{from:t.length,to:t.length}}:t.cur||(t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(n,!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t,{cur:{from:t.text.length,to:t.text.length}})),e.dataTransfer.setData("text",JSON.stringify(t)),e.dataTransfer.dropEffect&&(e.dataTransfer.dropEffect="move"),e.dataTransfer.setDragImage){var n=(0,s.default)('\n              <div class="drag-tree-node">\n                <span>'.concat(o.escape(t.text),"</span>\n              </div>"));(0,s.default)("body .drag-tree-node").remove(),(0,s.default)("body").append(n),e.dataTransfer.setDragImage(n[0],0,0)}})}},{key:"addNewNode",value:function(e,t,n,i){var r=this.findNode(i);return this.createOrUpdateNode(e,t,r,n)}},{key:"findNode",value:function(e){return null==e||0===e.length?this.rootNode:function(e,a){return null!==a?function e(t){if(void 0!==t.path&&void 0!==a&&!a.startsWith(t.path))return null;for(var n=0,i=t.children.length;n<i;n++){var r=e(t.children[n]);if(null!==r)return r}return t.path===a?t:null}(e):e}(this.rootNode,e.join("."))}},{key:"findNodeByDomElement",value:function(e){var t=this.translateTreeNodeIdFromACITree(e);if(t&&t[0])return this.findNode(t)}},{key:"selected",value:function(){return this.aciTreeApi.selected()}},{key:"selectNode",value:function(e){this.aciTreeApi.select(e)}},{key:"createOrUpdateNode",value:function(e,t,n,i){var r=[e];null!=n&&(r=[n.path,e]);var a=this.findNode(r);if(null!==a)return a.data=t,a;var o=new u(e,t,i,n);return n===this.rootNode&&(o.parentNode=null),n.children.push(o),o}},{key:"register",value:function(e){e.on("acitree",function(e,t,n,i){if(t.isItem(n)&&("added"===i||"idset"===i)){var r=t.getId(n),a=t.itemData(n);"added"===i&&this.prepareDraggable(a,n);var o=this.translateTreeNodeIdFromACITree(t.parent(n));this.addNewNode(r,a,n,o),a.errmsg&&l.default.error(a.errmsg)}}.bind(this)),this.aciTreeApi=e.aciTree("api")}},{key:"translateTreeNodeIdFromACITree",value:function(e){for(var t=e,n=[];null!=t&&0<t.length&&(n.unshift(this.aciTreeApi.getId(t)),this.aciTreeApi.hasParent(t));)t=this.aciTreeApi.parent(t);return n}}]),e}();h.Tree=f;var p=e.isValidData;h.isValidTreeNodeData=p}).call(this,g(1))},,function(e,t,n){"use strict";n(122),n(11),n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.initializeToolbar=function(e,t){l=e,r.default.each(d,function(e){u(e)}),r.default.each(c,function(e){u(e)}),e.on(t.EVENT.BUTTON,function(e){"name"in e&&e.name===(0,i.default)("Query Tool")?a.default.DataGrid.show_query_tool("",a.default.Browser.tree.selected()):"name"in e&&e.name===(0,i.default)("View Data")?a.default.DataGrid.show_data_grid({mnuid:3},a.default.Browser.tree.selected()):"name"in e&&e.name===(0,i.default)("Filtered Rows")&&a.default.DataGrid.show_filtered_row({mnuid:4},a.default.Browser.tree.selected())})},t.enable=function(e,t){e in s?l.buttonEnable(e,t):console.warn("Developer warning: No tool button found with label: "+e)};var i=o(n(2)),r=o(n(1)),a=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var s={},l=null,d=[{label:(0,i.default)("Filtered Rows"),btnClass:"pg-font-icon icon-filter-table-toolbar",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1},{label:(0,i.default)("View Data"),btnClass:"fa fa-table",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1},{label:(0,i.default)("Query Tool"),btnClass:"pg-font-icon icon-query-tool",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1}],c=[];function u(e){e.label in s&&!(r.default.findIndex(l._buttonList,{name:e.label})<0)||(l.addButton(e.label,e.btnClass,e.text,e.label,e.toggled,e.toggleClass,e.parentClass,e.enabled),s[e.label]=e)}},,,function(e,t){e.exports=r},function(e,t,n){"use strict";n(10),n(18),n(7),n(6);var s=i(n(0)),r=i(n(105)),l=n(25);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function i(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.dialogContainer=e,this.tabSwitching=!1,this.tabs=this.dialogContainer.find(".nav-tabs"),0<this.tabs.length&&(this.tabs=this.tabs[0]),this.dialogTabBackward=(0,l.parseShortcutValue)(t),this.dialogTabForward=(0,l.parseShortcutValue)(n),(0,r.default)(this.dialogContainer[0]).bind(this.dialogTabBackward,this.onKeyboardEvent.bind(this)),(0,r.default)(this.dialogContainer[0]).bind(this.dialogTabForward,this.onKeyboardEvent.bind(this))}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(i,[{key:"onKeyboardEvent",value:function(e,t){var n=this.dialogContainer.find(".tab-content:first > .tab-pane.active:first"),i=this.isActivePaneHasChildTabs(n);this.tabSwitching||(this.tabSwitching=!0,i&&this.navigate(t,i.childTab,i.childTabPane,e)||this.navigate(t,this.tabs,n,e))}},{key:"isActivePaneHasChildTabs",value:function(e){var t=e.find(".nav-tabs:first");return 0<t.length?{childTab:t,childTabPane:e.find(".tab-content:first > .tab-pane.active:first")}:null}},{key:"navigate",value:function(e,t,n,i){return e==this.dialogTabBackward?this.navigateBackward(t,n,i):e==this.dialogTabForward&&this.navigateForward(t,n,i)}},{key:"navigateBackward",value:function(e,t,n){var i,r,a=this,o=(0,s.default)(e).find("li").has("a.active").prev("li");return 0<o.length?(o.find("a").tab("show"),0<(r=(i=t.prev()).find(".tab-content:first > .tab-pane.active:first")).length?(0,l.findAndSetFocus)(r):(0,l.findAndSetFocus)(i),setTimeout(function(){a.tabSwitching=!1},200),n.stopPropagation(),!0):this.tabSwitching=!1}},{key:"navigateForward",value:function(e,t,n){var i,r,a=this,o=(0,s.default)(e).find("li").has("a.active").next("li");return 0<o.length?(o.find("a").tab("show"),0<(r=(i=t.next()).find(".tab-content:first > .tab-pane.active:first")).length?(0,l.findAndSetFocus)(r):(0,l.findAndSetFocus)(i),setTimeout(function(){a.tabSwitching=!1},200),n.stopPropagation(),!0):this.tabSwitching=!1}},{key:"detach",value:function(){(0,r.default)(this.dialogContainer[0]).unbind(this.dialogTabBackward),(0,r.default)(this.dialogContainer[0]).unbind(this.dialogTabForward)}}]),i}();e.exports={dialogTabNavigator:o}},,function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.getTransId=function(e){return r.default.ajax({data:e,type:"POST",async:!1,url:(0,i.default)("file_manager.get_trans_id"),dataType:"json",contentType:"application/json; charset=utf-8"})},t.removeTransId=function(e){return r.default.ajax({type:"GET",async:!1,url:(0,i.default)("file_manager.delete_trans_id",{trans_id:e}),dataType:"json",contentType:"application/json; charset=utf-8"})},t.set_last_traversed_dir=function(e,t){return r.default.ajax({url:(0,i.default)("file_manager.save_last_dir",{trans_id:t}),type:"POST",data:JSON.stringify(e),contentType:"application/json"})};var i=a(n(5)),r=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(7),n(4),n(8),Object.defineProperty(t,"__esModule",{value:!0}),t.getHelpUrl=function(e,t,n){var i=Math.floor(n/1e4),r=Math.floor(n/100)-100*i,a="";a=10<=i?e.replace("$VERSION$",i):e.replace("$VERSION$",i+"."+r);"/"!=a.substr(-1)&&(a+="/");return a+t}},,,,,function(e,t,n){"use strict";n(36);var i,s=(i=n(1))&&i.__esModule?i:{default:i};e.exports={generate_url:function(e,t,n,i,r,a){var o="";return s.default.each(s.default.sortBy(s.default.pick(t,r),function(e){return e.priority}),function(e){o="".concat(o,"/").concat(encodeURI(e._id))}),o=a?"".concat(o,"/").concat(a):"".concat(o,"/"),"".concat(e).concat(i,"/").concat(n).concat(o)}}},,function(e,t,n){"use strict";n(21),n(26),n(27),n(10),n(195),n(16),n(126),n(19),n(23),n(50),n(33),n(7),n(12),n(4),n(46),n(24),n(65),n(29),n(22),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.browserTreeState=t.pgBrowser=void 0;var f=s(n(1)),i=s(n(0)),r=s(n(5)),a=s(n(2)),o=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var p=o.default.Browser=o.default.Browser||{},l=(t.pgBrowser=p).browserTreeState=p.browserTreeState||{};t.browserTreeState=l,f.default.extend(p.browserTreeState,{parent:"server",orig_parent:"server_group",stored_state:{},last_state:{},current_state:{},init:function(){var e=p.get_preference("browser","browser_tree_state_save_interval");f.default.isUndefined(e)||-1===e.value?f.default.isUndefined(e)||i.default.ajax({url:(0,r.default)("settings.reset_tree_state"),type:"DELETE"}).fail(function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,a.default)('Error resetting the tree saved state."'),t)}):(setInterval(this.save_state,1e3*e.value),this.fetch_state.apply(this),p.Events.on("pgadmin:browser:tree:expand-from-previous-tree-state",this.expand_from_previous_state,this),p.Events.on("pgadmin:browser:tree:remove-from-tree-state",this.remove_from_cache,this),p.Events.on("pgadmin:browser:tree:update-tree-state",this.update_cache,this))},save_state:function(){var e=p.browserTreeState;e.last_state!=JSON.stringify(e.current_state)&&i.default.ajax({url:(0,r.default)("settings.save_tree_state"),type:"POST",contentType:"application/json",data:JSON.stringify(e.current_state)}).done(function(){e.last_state=JSON.stringify(e.current_state)}).fail(function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,a.default)('Error saving the tree state."'),t)})},fetch_state:function(){var t=this;i.default.ajax({url:(0,r.default)("settings.get_tree_state"),type:"GET",dataType:"json",contentType:"application/json"}).done(function(e){t.stored_state=e}).fail(function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,a.default)("Error fetching the tree state."),t)})},update_cache:function(e){var t,n=e&&p.tree.itemData(e),i=(n&&p.Nodes[n._type]).getTreeNodeHierarchy(e),r=p.tree.pathId(e),a=r.join(),o=[],s=-1;if(p.tree.hasParent(e)&&this.parent in i){if(t=i[this.parent]._id,p.tree.isOpen(e)){r.push(n.id),o=r.join(),t in this.current_state||(this.current_state[t]={paths:[],selected:{},conn_status:{},is_opened:{}});var l=f.default.find(this.current_state[t].paths,function(e){return-1!==e.search(o)});f.default.isUndefined(l)&&(f.default.isUndefined(this.current_state[t].paths)?this.current_state[t].paths=[]:s=this.current_state[t].paths.indexOf(a),-1!==s?this.current_state[t].paths[s]=o:this.current_state[t].paths.push(o))}this.update_database_status(e),this.update_current_selected_item(i)}},remove_from_cache:function(e){var i=this,t=i.stored_state||{},r=e&&p.tree.itemData(e),n=r&&p.Nodes[r._type],a=n&&n.getTreeNodeHierarchy(e);if(null!==a&&p.tree.hasParent(e)&&i.parent in a){var o=a&&a[i.parent]._id,s=a&&a[i.orig_parent].id;if(this.update_database_status(e),r._type!=i.parent&&"database"!=r._type){if(p.tree.isClosed(e)){var l=i.current_state[o].paths,d=void 0;if("database"in a&&(d=a.database.id),!f.default.isUndefined(l)&&!f.default.isUndefined(l.length)){var c=0,u=void 0;f.default.each(l,function(e){if(!f.default.isUndefined(e)){var t=e.split(",");if(-1!==t.indexOf(r.id)&&(void 0===d||void 0!==d&&-1!==t.indexOf(d))){var n=t.indexOf(r.id);t.splice(n),(u=t.join())==s?i.current_state[o].paths.splice(e,1):i.current_state[o].paths[c]=u}c++}})}}}else o in t&&"paths"in t[o]&&(t[o].paths=i.current_state[o].paths,i.save_state())}},expand_from_previous_state:function(r){var a=this,o=a.stored_state||{},s=r&&p.tree.itemData(r),e=s&&p.Nodes[s._type],l=e&&e.getTreeNodeHierarchy(r);if(null!==l&&p.tree.hasParent(r)&&a.parent in l&&(s._type!=a.parent||!1!==p.tree.isOpen(r))){var t=o[l[a.parent]._id];if(!("database"==s._type&&t&&"conn_status"in t&&"is_opened"in t)||0!==t.conn_status[s.id]&&0!==t.is_opened[s.id]&&s.id in t.is_opened){if(!f.default.isUndefined(t)&&"paths"in t&&!f.default.isUndefined(t.paths.length)){var n=c(t.paths),d=void 0;"database"in l&&(d=l.database.id),f.default.each(n,function(e){if(!f.default.isUndefined(e)){var t=e.split(",");if(-1!==t.indexOf(s.id)&&(void 0===d||void 0!==d&&-1!==t.indexOf(d))){var n=t.indexOf(s.id);if(p.tree.toggle(r),n==t.length-1){var i=o[l[a.parent]._id].paths.indexOf(e);o[l[a.parent]._id].paths.splice(i,1)}}}})}this.select_tree_item(r)}}},update_database_status:function(e){var t=e&&p.tree.itemData(e),n=(t&&p.Nodes[t._type]).getTreeNodeHierarchy(e);if("database"in n){var i=n.database.id,r=n&&n[this.parent]._id;r in this.current_state&&"selected"in this.current_state[r]&&(n.database.connected?this.current_state[r].conn_status[i]=1:this.current_state[r].conn_status[i]=0,"database"==t._type&&(p.tree.isOpen(e)?this.current_state[r].is_opened[i]=1:this.current_state[r].is_opened[i]=0))}},update_current_selected_item:function(e){if(this.parent in e){var t=e&&e[this.parent]._id,n=p.tree.itemData(p.tree.selected()),i=void 0;n=n?n.id:void 0,"database"in e&&(i=e.database.id),t in this.current_state&&"selected"in this.current_state[t]&&!f.default.isUndefined(n)&&(this.current_state[t].selected[e[this.parent].id]=n,f.default.isUndefined(i)||(this.current_state[t].selected[i]=n))}},select_tree_item:function(e){var t=this.stored_state||{},n=e&&p.tree.itemData(e),i=n&&p.Nodes[n._type],r=i&&i.getTreeNodeHierarchy(e),a=t[r[this.parent]._id];if("database"in r){var o=r.database.id;a&&"selected"in a&&o in a.selected&&a.selected[o]==n.id&&p.tree.select(e)}}})},,,,,,,function(e,t){e.exports=a},function(e,t,n){"use strict";var i,r;n(10),n(16),n(23),n(30),n(33),n(11),n(12),n(4),n(46),n(8),n(6),n(31),i=[n(2),n(5),n(0),n(1),n(14),n(9),n(15),n(56),n(68),n(80),n(161),n(153),n(144)],void 0===(r=function(f,n,p,h,g,i,_,m,r,e,a){if(i.UserManagement)return i.UserManagement;var v=n("user_management.users"),b=n("user_management.roles");return i.UserManagement={init:function(){if(!this.initialized)return this.initialized=!0,this},change_password:function(e){var t=f("Change Password");g.ChangePassword||g.dialog("ChangePassword",function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){g.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:f("Change Password"),url:n("help.static",{filename:"change_user_password.html"})}},{text:f("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout(function(){return g.ChangePassword().destroy()},500)}},prepare:function(){var e=document.createElement("iframe");e.frameBorder="no",e.width="100%",e.height="100%",e.src=this.setting("url"),this.elements.content.appendChild(e)},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void i.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null)}}}),g.ChangePassword(t,e).resizeTo(i.stdW.lg,i.stdH.md)},isPgaLoginRequired:function(e){return void 0===e.responseJSON&&void 0!==e.data?401===e.status&&e.data&&e.data.info&&"PGADMIN_LOGIN_REQUIRED"===e.data.info:401===e.status&&e.responseJSON&&e.responseJSON.info&&"PGADMIN_LOGIN_REQUIRED"===e.responseJSON.info},pgaLogin:function(e){var t=f("pgAdmin 4 login");e=e||n("security.login"),g.PgaLogin||g.dialog("PgaLogin",function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){g.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:f("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout(function(){return g.PgaLogin().destroy()})}},prepare:function(){var e=this,t=document.createElement("iframe"),n=this.setting("url");t.onload=function(){-1==(this.contentDocument||this.contentWindow.document).location.href.indexOf(n)&&(this.contentWindow.stop(),this.onload=null,e.close(),i.Events.trigger("pgadmin:user:logged-in"))},t.frameBorder="no",t.width="100%",t.height="100%",t.src=n,e.elements.content.appendChild(t)}}}),g.PgaLogin(t,e).resizeTo(i.stdW.md,i.stdH.md)},show_users:function(){if(a.is_admin){var d=[],c=i.Node.Model.extend({idAttribute:"id",urlRoot:v,defaults:{id:void 0,email:void 0,active:!0,role:void 0,newPassword:void 0,confirmPassword:void 0},schema:[{id:"email",label:f("Email"),type:"text",cell:m.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["id"],editable:function(e){return!(e instanceof _.Collection)&&!!e.isNew()}},{id:"role",label:f("Role"),type:"text",control:"Select2",cellHeaderClasses:"width_percent_20",cell:"select2",select2:{allowClear:!1,openOnEnter:!1},options:function(e){var t=[];return e instanceof r.Control?h.each(d,function(e){t.push({label:e.name,value:e.id.toString()})}):h.each(d,function(e){t.push([e.name,e.id.toString()])}),t},editable:function(e){return e instanceof _.Collection||e.get("id")!=a.id}},{id:"active",label:f("Active"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_10",editable:function(e){return e instanceof _.Collection||e.get("id")!=a.id}},{id:"newPassword",label:f("New password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"},{id:"confirmPassword",label:f("Confirm password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"}],validate:function(){var e=null,t=this.changed||{};if(("email"in t||!this.isNew())&&(h.isUndefined(this.get("email"))||h.isNull(this.get("email"))||""==String(this.get("email")).replace(/^\s+|\s+$/g,"")))return e=f("Email address cannot be empty."),this.errorModel.set("email",e),e;if(this.get("email")&&!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(this.get("email")))return e=f("Invalid email address: %s.",this.get("email")),this.errorModel.set("email",e),e;if(this.get("email")&&1<this.collection.where({email:this.get("email")}).length)return e=f("The email address %s already exists.",this.get("email")),this.errorModel.set("email",e),e;if(this.errorModel.unset("email"),"role"in t&&(h.isUndefined(this.get("role"))||h.isNull(this.get("role"))||""==String(this.get("role")).replace(/^\s+|\s+$/g,"")))return e=f("Role cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("role",e),e;if(this.errorModel.unset("role"),this.isNew()){if("newPassword"in t&&(h.isUndefined(this.get("newPassword"))||h.isNull(this.get("newPassword"))||""==this.get("newPassword")))return e=f("Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("newPassword",e),e;if(!h.isUndefined(this.get("newPassword"))&&!h.isNull(this.get("newPassword"))&&this.get("newPassword").length<6)return e=f("Password must be at least 6 characters for user %s.",this.get("email")||""),this.errorModel.set("newPassword",e),e;if(this.errorModel.unset("newPassword"),"confirmPassword"in t&&(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))return e=f("Confirm Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",e),e;if(this.errorModel.unset("confirmPassword"),this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return e=f("Passwords do not match for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",e),e;this.errorModel.unset("confirmPassword")}else if((h.isUndefined(this.get("newPassword"))||h.isNull(this.get("newPassword"))||""==this.get("newPassword"))&&(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))this.errorModel.unset("newPassword"),""==this.get("newPassword")&&this.set({newPassword:void 0}),this.errorModel.unset("confirmPassword"),""==this.get("confirmPassword")&&this.set({confirmPassword:void 0});else{if(!h.isUndefined(this.get("newPassword"))&&!h.isNull(this.get("newPassword"))&&""==!this.get("newPassword")&&this.get("newPassword").length<6)return e=f("Password must be at least 6 characters for user %s.",this.get("email")||""),this.errorModel.set("newPassword",e),e;if(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword"))return e=f("Confirm Password cannot be empty for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",e),e;if(this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return e=f("Passwords do not match for user %s.",this.get("email")||""),this.errorModel.set("confirmPassword",e),e;this.errorModel.unset("newPassword"),this.errorModel.unset("confirmPassword")}return null}}),u=r.generateGridColumnsFromModel(null,c,"edit"),e=m.Extension.DeleteCell.extend({deleteRow:function(e){var t=this;if(e.preventDefault(),t.model.get("id")==a.id)return g.alert(f("Cannot delete user."),f("Cannot delete currently logged in user."),function(){return!0}),!0;!(!h.isUndefined(this.column.get("canDeleteRow"))&&h.isFunction(this.column.get("canDeleteRow")))||m.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)?t.model.isNew()?t.model.destroy():g.confirm(f("Delete user?"),f("Are you sure you wish to delete this user?"),function(){t.model.destroy({wait:!0,success:function(){g.success(f("User deleted."))},error:function(){g.error(f("Error during deleting user."))}})},function(){return!0}):g.alert(f("Error"),f("This user cannot be deleted."),function(){return!0})}});u.columns.unshift({name:"pg-backform-delete",label:"",cell:e,editable:!1,cell_priority:-1,canDeleteRow:!0}),g.UserManagement||g.dialog("UserManagement",function(){return{main:function(e){this.set("title",e)},build:function(){g.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:f("Users"),url:n("help.static",{filename:"user_management.html"})}},{text:f("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button user_management_pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{title:f("User Management"),padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){this.view&&(this.view.remove({data:!0,internal:!0,silent:!0}),this.$content.remove())}},prepare:function(){var e=h.template(['<div class="pg-prop-footer" style="visibility:hidden;">',' <div class="pg-prop-status-bar">','    <div class="error-in-footer"> ','      <div class="d-flex px-2 py-1"> ','        <div class="pr-2"> ','          <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i> ',"        </div> ",'        <div class="alert-text" role="status></div> ','        <div class="ml-auto close-error-bar"> ','          <a class="close-error fa fa-times text-danger"></a> ',"        </div> ","      </div> ","    </div> "," </div>","</div>"].join("\n")),i=p(e()),t=m.Row.extend({userInvalidClass:"bg-user-invalid",initialize:function(){m.Row.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"pgadmin:user:invalid",this.userInvalid),this.listenTo(this.model,"pgadmin:user:valid",this.userValid)},userInvalid:function(){p(this.el).removeClass("new"),p(this.el).addClass(this.userInvalidClass)},userValid:function(){p(this.el).removeClass(this.userInvalidClass)}}),n=_.Collection.extend({model:c,url:v,initialize:function(){_.Collection.prototype.initialize.apply(this,arguments);var n=this;n.changedUser=null,n.invalidUsers={},n.on("add",n.onModelAdd),n.on("remove",n.onModelRemove),n.on("pgadmin-session:model:invalid",function(e,t){n.invalidUsers[t.cid]=e,t.trigger("pgadmin:user:invalid",t),i.find(".alert-text").html(e),i.css("visibility","visible")}),n.on("pgadmin-session:model:valid",function(e){delete n.invalidUsers[e.cid],e.trigger("pgadmin:user:valid",e),this.updateErrorMsg(),this.saveUser(e)})},onModelAdd:function(e){e.startNewSession()},onModelRemove:function(e){delete this.invalidUsers[e.cid],this.updateErrorMsg()},updateErrorMsg:function(){var e=null;for(var t in this.invalidUsers)if(e=this.invalidUsers[t])break;e?(i.find(".alert-text").html(e),i.css("visibility","visible")):(i.find(".alert-text").empty(),i.css("visibility","hidden"))},saveUser:function(n){var e=n.toJSON(!0);return!(n.isNew()&&!(n.get("email")&&n.get("role")&&n.get("newPassword")&&n.get("confirmPassword")&&n.get("newPassword")==n.get("confirmPassword")))&&(!(!n.isNew()&&n.get("newPassword")!=n.get("confirmPassword"))&&void(n.sessChanged()&&e&&!h.isEmpty(e)&&(n.stopSession(),n.save({},{attrs:e,wait:!0,success:function(){n.set({newPassword:void 0,confirmPassword:void 0}),n.startNewSession(),g.success(f("User '%s' saved.",n.get("email")))},error:function(e,t){n.startNewSession(),g.error(f("Error saving user: '%s'",t.responseJSON.errormsg))}}))))}}),s=this.userCollection=new n,r=h.template('<div class="navtab-inline-controls">\n                    <div class="input-group">\n                      <div class="input-group-prepend">\n                        <span class="input-group-text fa fa-search" id="labelSearch"></span>\n                        </div>\n                          <input type="search" class="form-control" id="txtGridSearch" placeholder="Search" aria-label="Search" aria-describedby="labelSearch" />\n                        </div>\n                        <button id="btn_refresh" type="button" class="btn btn-secondary btn-navtab-inline add" title="Add">\n                          <span class="fa fa-plus "></span>\n                        </button>\n                      </div>\n                    </div>\n                  </div>'),a={canAdd:!0,add_title:f("Add new user")},o=p("<div></div>",{class:"user_container flex-grow-1"});p.ajax({url:b,method:"GET",async:!1}).done(function(e){d=e}).fail(function(){setTimeout(function(){g.alert(f("Error"),f("Cannot load user roles."))},100)});var l=this.view=new m.Grid({row:t,columns:u.columns,collection:s,className:"backgrid table table-bordered table-noouter-border table-bottom-border table-hover"});o.append(l.render().$el[0]),this.$content=p("<div class='user_management object subnode subnode-noouter-border d-flex flex-column'></div>").append(r(a)).append(o).append(i),this.elements.content.appendChild(this.$content[0]),function(e){return new m.Extension.ClientSideFilter({collection:e,placeholder:h("Filter by email"),wait:150})}(s).setCustomSearchBox(p("#txtGridSearch")),s.fetch(),this.$content.find("a.close-error").on("click",function(){i.find(".alert-text").empty(),i.css("visibility","hidden")}),this.$content.find("button.add").first().on("click",function(e){e.preventDefault();var t,n=!1,i=null;if(s.each(function(e){n||(n=e.isNew(),i=e)}),n){t=s.indexOf(i);var r=l.body.rows[t].$el;return r.addClass("new"),p(r).pgMakeVisible("backform-tab"),!1}p(l.body.$el.find(p("tr.new"))).removeClass("new");var a=new c(null,{handler:s,top:s,collection:s});s.add(a),t=s.indexOf(a);var o=l.body.rows[t].$el;return o.addClass("new"),p(o).pgMakeVisible("backform-tab"),!1})},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void i.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null);if("close"==e.button.element.name){var t=this;h.all(this.userCollection.pluck("id"))&&h.isEmpty(this.userCollection.invalidUsers)||(e.cancel=!0,g.confirm(f("Discard unsaved changes?"),f("Are you sure you want to close the dialog? Any unsaved changes will be lost."),function(){return t.close(),!0},function(){return!0}))}}}}),g.UserManagement(!0).resizeTo(i.stdW.md,i.stdH.md)}}},i.UserManagement}.apply(t,i))||(e.exports=r)},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r;n(16),n(4),n(8),n(83),i=[n(0),n(1)],void 0===(r=function(e,i){return function(e,t){if(i.isUndefined(t)||i.isNull(t))return!0;t.startsWith("coll-")&&(t=t.replace("coll-",""));if(0<=i.indexOf(["server_group","server","catalog_object_column"],t))return!0;var n=e.get_preference("browser","show_node_"+t);return!n||n.value}}.apply(t,i))||(e.exports=r)},,,function(e,p,h){"use strict";(function(r){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}h(21),h(26),h(27),h(19),h(33),h(11),h(7),h(32),h(48),h(12),h(24),h(49),h(22),h(6),Object.defineProperty(p,"__esModule",{value:!0}),p.pgBrowser=void 0;var i=t(h(3)),a=t(h(5)),s=t(h(0)),l=e(h(14)),d=e(h(69)),n=t(h(41));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function e(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function t(e){return e&&e.__esModule?e:{default:e}}var u=h(96),f=i.default.Browser=i.default.Browser||{};p.pgBrowser=f,r.extend(f,{preferences_cache:[],prefcache_version:0,generate_preference_version:function(){return(new Date).getTime()},preference_version:function(e){if(!e)return this.prefcache_version;this.prefcache_version=e},get_preference:function(e,t){var n=this;if(0!=r.size(n.preferences_cache))return r.findWhere(n.preferences_cache,{module:e,name:t});var i=setInterval(function(){if(0<n.preferences_cache.length)return clearInterval(i),r.findWhere(n.preferences_cache,{module:e,name:t})},1e3)},get_preferences_for_module:function(e){var t={};if(r.each(r.where(this.preferences_cache,{module:e}),function(e){t[e.name]=e.value}),0<Object.keys(t).length)return t},get_preference_for_id:function(e){return r.findWhere(this.preferences_cache,{id:e})},cache_preferences:function(t){var n=this,e={};e[i.default.csrf_token_header]=i.default.csrf_token,setTimeout(function(){s.default.ajax({url:(0,a.default)("preferences.get_all"),headers:e}).done(function(e){n.preferences_cache=e,n.preference_version(n.generate_preference_version()),f.keyboardNavigation.init(),f.tree&&(u.modifyAcitreeAnimation(n),u.modifyAlertifyAnimation(n)),f.browserTreeState.init(),t&&("string"==typeof t?s.default.event.trigger("prefchange:"+t):r.each(t,function(e,t){s.default.event.trigger("prefchange:"+t)}))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n)})},500)},reflectPreferences:function(e){var t=this;if("sqleditor"===e||null==e){var n=t.get_preferences_for_module("sqleditor");(0,s.default)(t.editor.getWrapperElement()).css("font-size",d.calcFontSize(n.sql_font_size)),t.editor.setOption("tabSize",n.tab_size),t.editor.setOption("lineWrapping",n.wrap_code),t.editor.setOption("autoCloseBrackets",n.insert_pair_brackets),t.editor.setOption("matchBrackets",n.brace_matching),t.editor.refresh()}},onPreferencesChange:function(e,t){(0,s.default)(n.default).on("prefchange:"+e,function(e){t(e)})}})}).call(this,h(1))},function(e,t){e.exports=o},function(e,f,p){"use strict";(function(i){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}p(21),p(26),p(27),p(19),p(11),p(7),p(32),p(12),p(24),p(49),p(22),p(6),Object.defineProperty(f,"__esModule",{value:!0}),f.pgBrowser=void 0;var e=t(p(3)),r=t(p(5)),a=t(p(0)),n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(p(14)),s=t(p(2));p(59);var l=t(p(41));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function t(e){return e&&e.__esModule?e:{default:e}}var c=e.default.Browser=e.default.Browser||{};f.pgBrowser=c;var u=window.wcDocker;i.extend(c,{lock_layout_levels:{PREVENT_DOCKING:"docking",FULL:"full",NONE:"none"},buildDefaultLayout:function(e){var t=e.addPanel("browser",u.DOCK.LEFT),n=e.addPanel("dashboard",u.DOCK.RIGHT,t);e.addPanel("properties",u.DOCK.STACKED,n,{tabOrientation:u.TAB.TOP}),e.addPanel("sql",u.DOCK.STACKED,n),e.addPanel("statistics",u.DOCK.STACKED,n),e.addPanel("dependencies",u.DOCK.STACKED,n),e.addPanel("dependents",u.DOCK.STACKED,n)},save_current_layout:function(e,t){if(t){var n={setting:e,value:t.save()};a.default.ajax({type:"POST",url:(0,r.default)("settings.store_bulk"),data:n})}},restore_layout:function(t,e,n){if(""!=e)try{t.restore(e)}catch(e){t.clear(),n&&n(t)}else n&&n(t);var i=l.default.pgAdmin.Browser,r=setInterval(function(){i.get_preferences_for_module("browser")&&(clearInterval(r),i.reflectLocklayoutChange(t),i.onPreferencesChange("browser",function(){i.reflectLocklayoutChange(t)}))},500)},reflectLocklayoutChange:function(e){var t=l.default.pgAdmin.Browser,n=t.get_preferences_for_module("browser");t.lock_layout(e,n.lock_layout)},lock_layout:function(e,t){var n=this.menus.file.mnu_locklayout.menu_items;switch(t){case this.lock_layout_levels.PREVENT_DOCKING:e.lockLayout(u.LOCK_LAYOUT_LEVEL.PREVENT_DOCKING);break;case this.lock_layout_levels.FULL:e.lockLayout(u.LOCK_LAYOUT_LEVEL.FULL);break;case this.lock_layout_levels.NONE:e.lockLayout(u.LOCK_LAYOUT_LEVEL.NONE)}i.each(n,function(e){e.name!="mnu_lock_"+t?e.change_checked(!1):e.change_checked(!0)})},save_lock_layout:function(e){var t=l.default.pgAdmin.Browser;a.default.ajax({url:(0,r.default)("browser.lock_layout"),method:"PUT",contentType:"application/json",data:JSON.stringify({value:e})}).done(function(){t.cache_preferences("browser")}).fail(function(e,t){n.pgNotifier(t,e,(0,s.default)("Failed to save the lock layout setting."))})},mnu_lock_docking:function(){this.lock_layout(this.docker,this.lock_layout_levels.PREVENT_DOCKING),this.save_lock_layout(this.lock_layout_levels.PREVENT_DOCKING)},mnu_lock_full:function(){this.lock_layout(this.docker,this.lock_layout_levels.FULL),this.save_lock_layout(this.lock_layout_levels.FULL)},mnu_lock_none:function(){this.lock_layout(this.docker,this.lock_layout_levels.NONE),this.save_lock_layout(this.lock_layout_levels.NONE)}})}).call(this,p(1))},,function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(21),n(26),n(27),n(10),n(19),n(18),n(7),n(32),n(12),n(24),n(49),n(22),n(6);var s=h(n(1)),l=h(n(3)),a=h(n(0)),d=h(n(105)),i=p(n(25)),r=h(n(125)),c=p(n(74)),u=h(n(41));function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function p(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function h(e){return e&&e.__esModule?e:{default:e}}var g=l.default.Browser=l.default.Browser||{};g.keyboardNavigation=g.keyboardNavigation||{},s.default.extend(g.keyboardNavigation,{init:function(){d.default.reset(),0<g.preferences_cache.length&&(this.keyboardShortcut={file_shortcut:i.parseShortcutValue(g.get_preference("browser","main_menu_file").value),object_shortcut:i.parseShortcutValue(g.get_preference("browser","main_menu_object").value),tools_shortcut:i.parseShortcutValue(g.get_preference("browser","main_menu_tools").value),help_shortcut:i.parseShortcutValue(g.get_preference("browser","main_menu_help").value),left_tree_shortcut:i.parseShortcutValue(g.get_preference("browser","browser_tree").value),tabbed_panel_backward:i.parseShortcutValue(g.get_preference("browser","tabbed_panel_backward").value),tabbed_panel_forward:i.parseShortcutValue(g.get_preference("browser","tabbed_panel_forward").value),sub_menu_query_tool:i.parseShortcutValue(g.get_preference("browser","sub_menu_query_tool").value),sub_menu_view_data:i.parseShortcutValue(g.get_preference("browser","sub_menu_view_data").value),sub_menu_properties:i.parseShortcutValue(g.get_preference("browser","sub_menu_properties").value),sub_menu_create:i.parseShortcutValue(g.get_preference("browser","sub_menu_create").value),sub_menu_delete:i.parseShortcutValue(g.get_preference("browser","sub_menu_delete").value),sub_menu_refresh:i.parseShortcutValue(g.get_preference("browser","sub_menu_refresh").value),context_menu:i.parseShortcutValue(g.get_preference("browser","context_menu").value),direct_debugging:i.parseShortcutValue(g.get_preference("browser","direct_debugging").value),drop_multiple_objects:i.parseShortcutValue(g.get_preference("browser","grid_menu_drop_multiple").value),drop_cascade_multiple_objects:i.parseShortcutValue(g.get_preference("browser","grid_menu_drop_cascade_multiple").value),add_grid_row:i.parseShortcutValue(g.get_preference("browser","add_grid_row").value)},this.shortcutMethods={bindMainMenu:{shortcuts:[this.keyboardShortcut.file_shortcut,this.keyboardShortcut.object_shortcut,this.keyboardShortcut.tools_shortcut,this.keyboardShortcut.help_shortcut]},bindRightPanel:{shortcuts:[this.keyboardShortcut.tabbed_panel_backward,this.keyboardShortcut.tabbed_panel_forward]},bindLeftTree:{shortcuts:this.keyboardShortcut.left_tree_shortcut},bindSubMenuQueryTool:{shortcuts:this.keyboardShortcut.sub_menu_query_tool},bindSubMenuViewData:{shortcuts:this.keyboardShortcut.sub_menu_view_data},bindSubMenuProperties:{shortcuts:this.keyboardShortcut.sub_menu_properties},bindSubMenuCreate:{shortcuts:this.keyboardShortcut.sub_menu_create},bindSubMenuDelete:{shortcuts:this.keyboardShortcut.sub_menu_delete},bindSubMenuRefresh:{shortcuts:this.keyboardShortcut.sub_menu_refresh,bindElem:"#tree"},bindContextMenu:{shortcuts:this.keyboardShortcut.context_menu},bindDirectDebugging:{shortcuts:this.keyboardShortcut.direct_debugging},bindDropMultipleObjects:{shortcuts:this.keyboardShortcut.drop_multiple_objects},bindDropCascadeMultipleObjects:{shortcuts:this.keyboardShortcut.drop_cascade_multiple_objects},bindAddGridRow:{shortcuts:this.keyboardShortcut.add_grid_row}},this.bindShortcuts())},bindShortcuts:function(){var n=this;s.default.each(n.shortcutMethods,function(e,t){n._bindWithMousetrap(e.shortcuts,n[t],e.bindElem)});(0,a.default)(".pg-navbar").on("keydown",function(e){switch(e.keyCode){case 37:n.bindMainMenuLeft(e);break;case 38:n.bindMainMenuUpDown(e,"up");break;case 39:n.bindMainMenuRight(e);break;case 40:n.bindMainMenuUpDown(e,"down")}})},_bindWithMousetrap:function(e,t,n){var i=this;if(d.default.unbind(e),n){var r=document.querySelector(n);(0,d.default)(r).bind(e,function(){t.apply(this,arguments)}.bind(r))}else d.default.bind(e,function(){t.apply(i,arguments)})},unbindShortcuts:function(){s.default.each(this.mousetrapInstances,function(e){e.instance.reset()}),this.mousetrapInstances=[]},bindMainMenu:function(e,t){var n=this.keyboardShortcut;t===n.file_shortcut&&(0,a.default)("#mnu_file a.dropdown-toggle").dropdown("toggle"),t===n.object_shortcut&&(0,a.default)("#mnu_obj a.dropdown-toggle").first().dropdown("toggle"),t===n.tools_shortcut&&(0,a.default)("#mnu_tools a.dropdown-toggle").dropdown("toggle"),t===n.help_shortcut&&(0,a.default)("#mnu_help a.dropdown-toggle").dropdown("toggle")},bindRightPanel:function(e,t){var n=0,i=l.default.Browser.docker.findPanels().length-1,r=0,a=!1,o=this.keyboardShortcut;s.default.each(l.default.Browser.docker.findPanels(),function(e,t){e.isVisible()&&!a&&"browser"!==e._type&&(r=t,a=!0)}),t===o.tabbed_panel_backward?n=0<r?r-1:1:t===o.tabbed_panel_forward&&(n=r<i?r+1:i),l.default.Browser.docker.findPanels()[n].focus(),setTimeout(function(){document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},1e3)},bindMainMenuLeft:function(e){if((0,a.default)(e.target).hasClass("nav-link")){var t=(0,a.default)(e.target).closest(".nav-item");for(c._stopEventPropagation(e),t=t.prev(".nav-item");t.hasClass("d-none");)t=t.prev(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if(0<(0,a.default)(e.target).closest(".dropdown-menu").length){var n=(0,a.default)(e.target).closest("li");c._stopEventPropagation(e);var i=n.closest(".dropdown-menu");0<i.closest(".dropdown-submenu").length&&(i.removeClass("show"),i.closest(".dropdown-submenu").removeClass("dropdown-submenu-visible"),(n=i.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}},bindMainMenuRight:function(e){if((0,a.default)(e.target).hasClass("nav-link")){var t=(0,a.default)(e.target).closest(".nav-item");for(c._stopEventPropagation(e),t=t.next(".nav-item");t.hasClass("d-none");)t=t.next(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if(0<(0,a.default)(e.target).closest(".dropdown-menu").length){var n=(0,a.default)(e.target).closest("li");c._stopEventPropagation(e),n.hasClass("dropdown-submenu")&&(n.addClass("dropdown-submenu-visible"),n.find(".dropdown-menu").addClass("show"),n=n.find(".dropdown-menu .dropdown-item").first().trigger("focus"))}},bindMainMenuUpDown:function(e,t){if(0<(0,a.default)(e.target).closest(".dropdown-menu").length){c._stopEventPropagation(e);var n=(0,a.default)(e.target).closest("li"),i=(0,a.default)(e.target).closest(".dropdown-menu");for(i.find(".show").removeClass("show"),i.find(".dropdown-submenu").removeClass("dropdown-submenu-visible"),"up"===t?n=n.prev():"down"===t&&(n=n.next());n.hasClass("dropdown-divider")||n.find(".dropdown-item").first().hasClass("disabled");)"up"===t?n=n.prev():"down"===t&&(n=n.next());n.find(".dropdown-item").trigger("focus")}},bindLeftTree:function(){var e=this.getTreeDetails();(0,a.default)("#tree").trigger("focus"),e.t.focus(e.i),e.t.select(e.i)},bindSubMenuQueryTool:function(){var e=this.getTreeDetails();e.d&&l.default.DataGrid.show_query_tool("",e.i)},bindSubMenuViewData:function(){var e=this.getTreeDetails();e.d&&l.default.DataGrid.show_data_grid({mnuid:1},e.i)},bindSubMenuProperties:function(){var e=this.getTreeDetails();e.d&&!0!==l.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&l.default.Browser.Node.callbacks.show_obj_properties.call(l.default.Browser.Nodes[e.t.itemData(e.i)._type],{action:"edit"})},bindSubMenuCreate:function(){var e=this.getTreeDetails(),t=l.default.Browser.Nodes[e.t.itemData(e.i)._type];if(e.d){if(!0===t.collection_node){if(!t.node)return;t=l.default.Browser.Nodes[t.node]}l.default.Browser.Node.callbacks.show_obj_properties.call(t,{action:"create",item:e.i})}},bindSubMenuDelete:function(){var e=this.getTreeDetails();e.d&&!0!==l.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&l.default.Browser.Node.callbacks.delete_obj.call(l.default.Browser.Nodes[e.t.itemData(e.i)._type])},bindSubMenuRefresh:function(e){e.preventDefault();var t=g.keyboardNavigation.getTreeDetails();l.default.Browser.Node.callbacks.refresh.call(l.default.Browser.Nodes[t.t.itemData(t.i)._type])},bindContextMenu:function(e){var t=this.getTreeDetails(),n=e.srcElement||e.target,i=(0,a.default)(n).find(".aciTreeEntry").position().left+70,r=(0,a.default)(n).find(".aciTreeEntry").position().top+70;t.t.blur(t.i),(0,a.default)("#tree").trigger("blur"),t.i.children().contextMenu({x:i,y:r})},bindDirectDebugging:function(){var e=this.getTreeDetails(),t=e.t.itemData(e.i)._type;!e.d||"function"!==t&&"procedure"!==t||l.default.Tools.Debugger.can_debug(e.d,e.i,{debug_type:"direct"})&&l.default.Tools.Debugger.get_function_information(l.default.Browser.Nodes[t])},bindDropMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&0<(0,a.default)("button.delete_multiple").length&&(0,a.default)("button.delete_multiple").click()},bindDropCascadeMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&0<(0,a.default)("button.delete_multiple_cascade").length&&(0,a.default)("button.delete_multiple_cascade").click()},bindAddGridRow:function(){var e=(0,a.default)(document.activeElement).closest(".object.subnode");(0,a.default)(e).length&&(0,a.default)(e).find(".add").click()},isPropertyPanelVisible:function(){var t=!1;return s.default.each(l.default.Browser.docker.findPanels(),function(e){"properties"===e._type&&(t=e.isVisible())}),t},getTreeDetails:function(){var e=l.default.Browser.tree,t=0<e.selected().length?e.selected():e.first(),n=t&&1===t.length?e.itemData(t):void 0;return{t:e,i:t,d:n}},getDialogTabNavigator:function(e){var t=u.default.pgAdmin.Browser.get_preference("browser","dialog_tab_backward").value,n=u.default.pgAdmin.Browser.get_preference("browser","dialog_tab_forward").value;return new r.default.dialogTabNavigator(e,t,n)}}),e.exports=l.default.Browser.keyboardNavigation},,,function(e,t,n){"use strict";n(7),n(87),Object.defineProperty(t,"__esModule",{value:!0}),t.ModelValidation=void 0;var r=i(n(2)),a=i(n(1)),o=n(263);function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.err={},this.errmsg="",this.model=e}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(i,[{key:"validate",value:function(){var e=this.model.get("service");return!this.model.isNew()&&"id"in this.model.sessAttrs?(this.err.id=(0,r.default)("The ID cannot be changed."),this.errmsg=this.err.id):this.model.errorModel.unset("id"),this.checkForEmpty("name",(0,r.default)("Name must be specified.")),i.isEmptyString(e)?(this.setNullValueForEmptyString("service"),this.checkHostAndHostAddress(),this.checkForEmpty("db",(0,r.default)("Maintenance database must be specified.")),this.checkForEmpty("username",(0,r.default)("Username must be specified.")),this.checkForEmpty("port",(0,r.default)("Port must be specified."))):(this.checkForEmpty("db",(0,r.default)("Maintenance database must be specified.")),this.clearHostAddressAndDbErrors()),this.model.get("use_ssh_tunnel")&&(this.checkForEmpty("tunnel_host",(0,r.default)("SSH Tunnel host must be specified.")),this.checkForEmpty("tunnel_port",(0,r.default)("SSH Tunnel port must be specified.")),this.checkForEmpty("tunnel_username",(0,r.default)("SSH Tunnel username must be specified.")),this.model.get("tunnel_authentication")&&this.checkForEmpty("tunnel_identity_file",(0,r.default)("SSH Tunnel identity file must be specified."))),this.model.errorModel.set(this.err),a.default.size(this.err)?this.errmsg:null}},{key:"setNullValueForEmptyString",value:function(e){var t=this.model.get(e);a.default.isUndefined(t)||a.default.isNull(t)||""===String(t).trim()&&this.model.set(e,null)}},{key:"clearHostAddressAndDbErrors",value:function(){var t=this;a.default.each(["host","hostaddr","db","username","port"],function(e){t.setNullValueForEmptyString(e),t.model.errorModel.unset(e)})}},{key:"checkHostAndHostAddress",value:function(){var e=(0,r.default)("Either Host name, Address or Service must be specified.");this.checkForEmpty("host",e)&&this.checkForEmpty("hostaddr",e)?this.errmsg=this.errmsg||e:(this.errmsg=void 0,delete this.err.host,delete this.err.hostaddr),this.checkForValidIp(this.model.get("hostaddr"),(0,r.default)("Host address must be valid IPv4 or IPv6 address."))}},{key:"checkForValidIp",value:function(e,t){if(e){var n=new o.Address6(e).isValid();new o.Address4(e).isValid()||n||(this.err.hostaddr=t,this.errmsg=t)}else this.model.errorModel.unset("hostaddr")}},{key:"checkForEmpty",value:function(e,t){var n=this.model.get(e);return i.isEmptyString(n)?(this.err[e]=t,this.errmsg=this.errmsg||t,!0):(this.model.errorModel.unset(e),!1)}}],[{key:"isEmptyString",value:function(e){return a.default.isUndefined(e)||a.default.isNull(e)||""===String(e).trim()}}]),i}();t.ModelValidation=l},,,function(e,t,n){"use strict";var i,r,a;n(16),n(6),(a=a||{}).dashboard=n(201),(a=a||{}).tools=a.tools||{},a.tools.user_management=n(162),(a=a||{}).browser=a.browser||{},a.browser.object_statistics=n(204),(a=a||{}).browser=a.browser||{},a.browser.dependencies=n(207),(a=a||{}).browser=a.browser||{},a.browser.dependents=n(208),(a=a||{}).browser=a.browser||{},a.browser.object_sql=n(209),(a=a||{}).browser=a.browser||{},a.browser.bgprocess=n(210),(a=a||{}).node=a.node||{},a.node.server_group=n(271),(a=a||{}).node=a.node||{},a.node.server=n(160),(a=a||{}).node=a.node||{},a.node.database=n(272),(a=a||{}).node=a.node||{},a.node.role=n(274),(a=a||{}).node=a.node||{},a.node.cast=n(275),(a=a||{}).node=a.node||{},a.node.tablespace=n(276),(a=a||{}).node=a.node||{},a.node.resource_group=n(277),(a=a||{}).node=a.node||{},a.node.event_trigger=n(278),(a=a||{}).node=a.node||{},a.node.extension=n(279),(a=a||{}).node=a.node||{},a.node.language=n(280),(a=a||{}).node=a.node||{},a.node.foreign_data_wrapper=n(281),(a=a||{}).node=a.node||{},a.node.foreign_server=n(282),(a=a||{}).node=a.node||{},a.node.user_mapping=n(283),(a=a||{}).node=a.node||{},a.node.schema=n(284),(a=a||{}).node=a.node||{},a.node.catalog=n(285),(a=a||{}).node=a.node||{},a.node.catalog_object=n(286),(a=a||{}).node=a.node||{},a.node.collation=n(287),(a=a||{}).node=a.node||{},a.node.domain=n(288),(a=a||{}).node=a.node||{},a.node.domain_constraints=n(289),(a=a||{}).node=a.node||{},a.node.foreign_table=n(290),(a=a||{}).node=a.node||{},a.node.fts_configuration=n(291),(a=a||{}).node=a.node||{},a.node.fts_dictionary=n(292),(a=a||{}).node=a.node||{},a.node.fts_parser=n(293),(a=a||{}).node=a.node||{},a.node.fts_template=n(294),(a=a||{}).node=a.node||{},a.node.function=n(211),(a=a||{}).node=a.node||{},a.node.procedure=n(295),(a=a||{}).node=a.node||{},a.node.edbfunc=n(212),(a=a||{}).node=a.node||{},a.node.edbproc=n(296),(a=a||{}).node=a.node||{},a.node.edbvar=n(297),(a=a||{}).node=a.node||{},a.node.trigger_function=n(298),(a=a||{}).node=a.node||{},a.node.package=n(299),(a=a||{}).node=a.node||{},a.node.sequence=n(300),(a=a||{}).node=a.node||{},a.node.synonym=n(301),(a=a||{}).node=a.node||{},a.node.type=n(302),(a=a||{}).node=a.node||{},a.node.rule=n(213),(a=a||{}).node=a.node||{},a.node.index=n(303),(a=a||{}).node=a.node||{},a.node.trigger=n(304),(a=a||{}).node=a.node||{},a.node.catalog_object_column=n(305),(a=a||{}).node=a.node||{},a.node.view=n(306),(a=a||{}).node=a.node||{},a.node.mview=n(307),(a=a||{}).node=a.node||{},a.node.table=n(308),(a=a||{}).node=a.node||{},a.node.partition=n(311),(a=a||{}).node=a.node||{},a.node.compound_trigger=n(312),i=[n(2),n(5),n(0),n(1),n(14),n(3),n(84),n(69),n(15),n(216),n(217),n(121),n(88),n(25),n(59)],void 0===(r=function(o,g,_,m,i,s,e,t,n,r,a,l,v,d){var b=window.wcDocker,y=s.Browser;return s.DataGrid||(s.DataGrid=m.extend({init:function(){if(!this.initialized){this.initialized=!0,this.title_index=1;var e=this,t=setInterval(function(){0<y.preference_version()&&(e.preferences=y.get_preferences_for_module("sqleditor"),clearInterval(t))},0);y.onPreferencesChange("sqleditor",function(){e.preferences=y.get_preferences_for_module("sqleditor")});for(var n=["table","view","mview","foreign_table","catalog_object","partition"],i=function(e){var t=!m.isUndefined(e)&&!m.isNull(e)&&-1!==m.indexOf(n,e._type);return l.enable(o("View Data"),t),l.enable(o("Filtered Rows"),t),t},r=[{name:"query_tool",module:this,applies:["tools"],callback:"show_query_tool",enable:function(e){var t=!(m.isUndefined(e)||m.isNull(e)||-1!=m.indexOf(s.unsupported_nodes,e._type)||("database"!=e._type||!e.allowConn)&&"database"==e._type);return l.enable(o("Query Tool"),t),t},priority:1,label:o("Query Tool"),icon:"pg-font-icon icon-query-tool"}],a=0;a<n.length;a++)r.push({name:"view_all_rows_context_"+n[a],node:n[a],module:this,data:{mnuid:3},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:101,label:o("All Rows")},{name:"view_first_100_rows_context_"+n[a],node:n[a],module:this,data:{mnuid:1},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:102,label:o("First 100 Rows")},{name:"view_last_100_rows_context_"+n[a],node:n[a],module:this,data:{mnuid:2},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:103,label:o("Last 100 Rows")},{name:"view_filtered_rows_context_"+n[a],node:n[a],module:this,data:{mnuid:4},applies:["context","object"],callback:"show_filtered_row",enable:i,category:"view_data",priority:104,label:o("Filtered Rows...")});s.Browser.add_menu_category("view_data",o("View/Edit Data"),100,""),s.Browser.add_menus(r),new s.Browser.Frame({name:"frm_datagrid",showTitle:!0,isCloseable:!0,isPrivate:!0,url:"about:blank"}).load(y.docker),this.on("pgadmin-datagrid:transaction:created",function(e){this.launch_grid(e)})}},show_data_grid:function(e,t){var n=d.getRandomInt(1,9999999);r.showDataGrid(this,y,i,e,t,n)},show_filtered_row:function(e,t){var n=d.getRandomInt(1,9999999);r.showDataGrid(this,y,i,e,t,n,!0,this.preferences)},show_query_tool:function(e,t){var n=d.getRandomInt(1,9999999);a.showQueryTool(this,y,i,e,t,n)},launch_grid:function(e,t,n,i,r,a){var o,s,l,d=4<arguments.length&&void 0!==r?r:null,c=5<arguments.length&&void 0!==a?a:null,u='\n          <form id="queryToolForm" action="'.concat(t,'" method="post">\n            <input id="title" name="title" hidden />');if(d&&(u+='<input name="query_url" value="'.concat(d,'" hidden />')),c&&(u+='<textarea name="sql_filter" hidden>'.concat(c,"</textarea>")),u+='\n          </form>\n            <script>\n              document.getElementById("title").value = "'.concat(m.escape(i),'";\n              document.getElementById("queryToolForm").submit();\n            <\/script>\n          '),this.preferences.new_browser_tab){var f=window.open("","_blank");f.document.write(u),f.document.title=i}else{var p=y.docker.findPanels("properties"),h=y.docker.addPanel("frm_datagrid",b.DOCK.STACKED,p[0]);v.setQueryToolDockerTitle(h,n,m.unescape(i)),h.focus(),h.on(b.EVENT.CLOSED,function(){_.ajax({url:g("datagrid.close",{trans_id:e}),method:"DELETE"})});o=h,s=_('<div class="pg-sp-container">\n                    <div class="pg-sp-content">\n                        <div class="row">\n                            <div class="col-12 pg-sp-icon"></div>\n                        </div>\n                    </div>\n                </div>').appendTo(_(o).data("embeddedFrame").$container),l=setInterval(function(){if(_(o).data("frameInitialized")){clearInterval(l);var e=_(o).data("embeddedFrame");e&&(e.onLoaded(function(){s.remove()}),e.openHTML(u))}},100)}}},n.Events)),s.DataGrid}.apply(t,i))||(e.exports=r)},function(e,t,i){"use strict";var n,r;function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(n,!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i(21),i(36),i(53),i(10),i(58),i(23),i(40),i(18),i(11),i(75),i(7),i(32),i(76),i(48),i(269),i(37),i(4),i(65),i(63),i(6),n=[i(5),i(2),i,i(0),i(1),i(3),i(15),i(56),i(202),i(14),i(13),i(203),i(25),i(41),i(9),i(146),i(59)],void 0===(r=function(p,h,e,g,_,m,l,d,o,c,v,u,f,s){m.Browser=m.Browser||{};var b=m.Browser;if(!m.Dashboard){var y,w,x=!0,S="",C="",k=!1,T=!1,E=!1,P=d.Extension.DeleteCell.extend({render:function(){this.$el.empty();var t=this;return"cancel"===t.column.get("cell_action")?this.$el.html("<i class='fa fa-stop' data-toggle='tooltip' title='"+h("Cancel the active query")+"' aria-label='"+h("Cancel the active query")+"'></i>"):this.$el.html("<i class='fa fa-times-circle text-danger' data-toggle='tooltip' title='"+h("Terminate the session")+"' aria-label='"+h("Terminate the session")+"'></i>"),this.$el.attr("tabindex",0),this.$el.on("keydown",function(e){32==e.keyCode&&t.$el.click()}),this.delegateEvents(),this},deleteRow:function(e){var t,n,i,r,a,o=this,s=o.column.get("cell_action");if(e.preventDefault(),d.callByNeed(o.column.get("canDeleteRow"),o.column,o.model)){a="cancel"===s?(t=h("Cancel Active Query?"),n=h("Are you sure you wish to cancel the active query?"),i=h("Active query cancelled successfully."),r=h("An error occurred whilst cancelling the active query."),S+o.model.get("pid")):(t=h("Terminate Session?"),n=h("Are you sure you wish to terminate the session?"),i=h("Session terminated successfully."),r=h("An error occurred whilst terminating the active query."),C+o.model.get("pid")),c.confirm(t,n,function(){g.ajax({url:a,type:"DELETE"}).done(function(e){e==h("Success")?(c.success(i),g("#btn_refresh").trigger("click")):c.error(r)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n)})},function(){return!0})}}}),O=d.Extension.ObjectCell.extend({enterEditMode:function(){this.model.trigger("enteringEditMode",[this]),d.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents(),d.callByNeed(this.column.editable(),this.column,this.model)&&(this.$el.html("<i class='fa fa-caret-down subnode-edit-in-process'></i>"),this.model.trigger("pg-sub-node:opened",this.model,this))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-caret-right' data-toggle='tooltip' title='"+h("View the active session details")+"' aria-label='"+h("View the active session details")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.trigger("focus"),this}}),N=l.Model.extend({defaults:{version:null},schema:[{id:"backend_type",label:h("Backend type"),type:"text",editable:!0,disabled:!0,group:h("Details"),visible:function(){return 1e5<=this.version}},{id:"query_start",label:h("Query started at"),type:"text",editable:!1,disabled:!0,group:h("Details")},{id:"state_change",label:h("Last state changed at"),type:"text",editable:!0,disabled:!0,group:h("Details")},{id:"query",label:h("SQL"),type:"text",editable:!0,disabled:!0,control:v.SqlFieldControl,group:h("Details")}]});return m.Dashboard={init:function(){if(!this.initialized){this.initialized=!0,this.sid=this.did=-1,this.version=-1;var e=this.object_selected.bind(this),t=this.object_disconnected.bind(this);b.Events.on("pgadmin-browser:tree:selected",e),b.Events.on("pgadmin:server:disconnect",t);var i=p("dashboard.index");this.chart_store={},this.charts_poller_int_id=-1;var n=b.panels.dashboard.panel;if(n){var r=n.layout().scene().find(".pg-panel-content");if(r){g(r).html('<div class="alert alert-info pg-panel-message" role="alert">'+h("Loading dashboard...")+"</div>"),function n(){g.ajax({url:i,type:"GET",dataType:"html"}).done(function(e){g(r).html(e)}).fail(function(e,t){c.pgNotifier(t,e,h("An error occurred whilst loading the dashboard."),function(e){"CRYPTKEY_SET"===e?n():g(r).html('<div class="alert alert-danger pg-panel-message" role="alert">'+h("An error occurred whilst loading the dashboard.")+"</div>")})})}(),g(n).data("sid",-1),g(n).data("did",-1)}}}},object_disconnected:function(){var e=b.tree.selected(),t=e&&b.tree.itemData(e);0!=e.length&&this.object_selected(e,t,b.Nodes[t._type])},object_selected:function(e,t,n){var i=this;if(!1===x)_.isUndefined(t.connected)||!0===t.connected||i.clearChartFromStore();else if(t&&t._type){var r=n.getTreeNodeHierarchy(e),a=u.url(t,e,r);if(null===a){a=p("dashboard.index"),i.version=r.server&&r.server.version||0,S=a+"cancel_query/",C=a+"terminate_session/";var o=r.server;w=o&&o.db||null,o&&o.user&&o.user.is_superuser?k=!0:(k=!1,y=o&&o.user?o.user.name:null),"database"in r?(i.sid=r.server._id,i.did=r.database._id,E=!(T=!1),a+=i.sid+"/"+i.did,S+=i.sid+"/"+i.did+"/",C+=i.sid+"/"+i.did+"/"):"server"in r?(i.sid=r.server._id,i.did=-1,E=!(T=!0),a+=i.sid,S+=i.sid+"/",C+=i.sid+"/"):T=E=!1}else T=E=!1;var s=b.panels.dashboard.panel;if(s){var l=s.layout().scene().find(".pg-panel-content");if(l){if(t.connected||_.isUndefined(t.connected)){if(a!==g(s).data("dashboard_url")||a===g(s).data("dashboard_url")&&0==g(s).data("server_status")){g(l).empty(),i.clearChartFromStore();g(l).html('<div class="alert alert-info pg-panel-message" role="alert">'+h("Loading dashboard...")+"</div>"),function n(){g.ajax({url:a,type:"GET",dataType:"html"}).done(function(e){g(l).html(e),i.init_dashboard()}).fail(function(e,t){c.pgNotifier(t,e,h("An error occurred whilst loading the dashboard."),function(e){"CRYPTKEY_SET"===e?n():g(l).html('<div class="alert alert-danger pg-panel-message" role="alert">'+h("An error occurred whilst loading the dashboard.")+"</div>")})})}(),g(s).data("server_status",!0)}}else g(l).empty(),_.isUndefined(t.connected)||!0===t.connected||i.clearChartFromStore(),g(l).html('<div class="alert alert-info pg-panel-message" role="alert">'+h("Please connect to the selected server to view the dashboard.")+"</div>"),g(s).data("server_status",!1);g(s).data("dashboard_url",a)}}}},renderCharts:function(e){function i(e,t){return"Seconds ago: ".concat(parseInt(t.x*e),"</br>\n                  Value: ").concat(t.y)}var r=this,a=f.getEpoch();r.stopChartsPoller(),e.map(function(e){if(r.chart_store[e.chart_name]&&r.old_preferences[e.refresh_pref_name]!=r.preferences[e.refresh_pref_name]&&r.clearChartFromStore(e.chart_name),r.chart_store[e.chart_name]){var t=r.chart_store[e.chart_name].chart_obj;t.setOptions(e.options,!1),t.setTooltipFormatter(i.bind(null,r.preferences[e.refresh_pref_name]))}if(!r.chart_store[e.chart_name]){var n=new o.Chart(e.container,e.options);n.setTooltipFormatter(i.bind(null,r.preferences[e.refresh_pref_name])),n.setOtherData("counter",e.counter),r.chart_store[e.chart_name]={chart_obj:n,refresh_on:a,refresh_rate:r.preferences[e.refresh_pref_name]}}}),r.startChartsPoller(r.chart_store,r.sid,r.did)},getStatsUrl:function(e,t,n){var i=0<arguments.length&&void 0!==e?e:-1,r=1<arguments.length&&void 0!==t?t:-1,a=2<arguments.length&&void 0!==n?n:[],o=p("dashboard.dashboard_stats");return o+="/"+i,o+=0<r?"/"+r:"",o+="?chart_names="+a.join(",")},updateChart:function(e,i){var r=e.getOtherData("dataset")||[],a=e.getOtherData("counter_prev_data")||i,o=e.getOtherData("counter")||!1;if(0==r.length)for(var t in i)r.push({data:[[0,o?i[t]-a[t]:i[t]]],label:t});else Object.keys(i).map(function(e,t){if(o){if(_.isUndefined(a))return;r[t].data.unshift([0,i[e]-a[e]])}else r[t].data.unshift([0,i[e]]);for(var n=0;n<r[t].data.length;n++)r[t].data[n][0]=n}),a=i;for(var n=0;n<r.length;n++)101<r[n].data.length&&r[n].data.pop();e.setOtherData("dataset",r),e.setOtherData("counter_prev_data",a),e.isInPage()&&e.isVisible()&&e.draw(r)},stopChartsPoller:function(){clearInterval(this.charts_poller_int_id)},startChartsPoller:function(a,r,o){var s=this,e=f.getGCD(Object.values(a).map(function(e){return e.refresh_rate})),l=0,d=0;s.stopChartsPoller();function t(){var e=f.getEpoch(),t=[];for(var n in a)a[n].refresh_on<=e&&(a[n].refresh_on=e+a[n].refresh_rate,t.push(n));if(0==t.length||0<l||3<=d)l--;else{var i=s.getStatsUrl(r,o,t);d++,g.ajax({url:i,type:"GET"}).done(function(e){for(var t in e){var n=a[t].chart_obj;g(n.getContainer()).removeClass("graph-error"),s.updateChart(n,e[t])}}).fail(function(e){var t="",n="info";for(var i in 0===e.readyState?t=h("Not connected to the server or the connection to the server has been closed."):(t=JSON.parse(e.responseText).errormsg,428===e.status?(_.isUndefined(t)||_.isNull(t))&&(t=h("Please connect to the selected server to view the graph.")):(t=h("An error occurred whilst rendering the graph."),n="danger")),a){var r=a[i].chart_obj;g(r.getContainer()).addClass("graph-error"),g(r.getContainer()).html('<div class="alert alert-'+n+' pg-panel-message" role="alert">'+t+"</div>")}}).always(function(){l=0,d--}),l=3}}t(),s.charts_poller_int_id=setInterval(t,1e3*e)},add_new_server:function(){if(b&&b.tree){for(var e=0!=b.tree.selected().length?b.tree.selected():b.tree.first(null,!1),t=i(160),n=b.tree.itemData(e);n&&"server_group"!=n._type;)e=b.tree.next(e),n=b.tree.itemData(e);if(!n)return;t&&t.callbacks.show_obj_properties.apply(t,[{action:"create"},e])}},render_grid:function(e,t,n){var i=l.Model.extend({}),r=t+this.sid;-1!=this.did&&(r+="/"+this.did);var a=new(l.Collection.extend({model:i,url:r,mode:"client"})),o=new d.Grid({emptyText:"No data found",columns:n,collection:a,className:"backgrid presentation table table-bordered table-noouter-border table-hover"});g(e).empty(),g(e).append(o.render().el);var s=new d.Extension.ClientSideFilter({collection:a});s.setCustomSearchBox(g("#txtGridSearch")),g(e).data("data",a),g(e).data("grid",o),g(e).data("filter",s)},render_grid_data:function(r){var a=g(r).data("data"),e=g(r).data("grid"),o=g(r).data("filter");if(_.isUndefined(a))return null;a.fetch({reset:!0,success:function(){g(r).hasClass("grid-error")&&(g(r).removeClass("grid-error"),g(r).html(e.render().el),g(o.el).show()),o.search()},error:function(e,t){var n="",i="info";0===t.readyState?n=h("Not connected to the server or the connection to the server has been closed."):(n=JSON.parse(t.responseText).errormsg,428===t.status?(_.isUndefined(n)||_.isNull(n))&&(n=h("Please connect to the selected server to view the table.")):(n=h("An error occurred whilst rendering the table."),i="danger")),g(r).hasClass("grid-error")||(g(o.el).hide(),g(r).addClass("grid-error")),g(r).html('<div class="alert alert-'+i+' pg-panel-message" role="alert">'+n+"</div>"),setTimeout(function(){m.Dashboard.render_grid_data(r,a)},5e3)}})},clearChartFromStore:function(e){var n=this;e?delete n.chart_store[e]:(n.stopChartsPoller(),_.each(n.chart_store,function(e,t){delete n.chart_store[t]}))},init_dashboard:function(){var e=this,t=setInterval(function(){try{0<s.default.pgAdmin.Browser.preference_version()&&(clearInterval(t),e.reflectPreferences())}catch(e){throw clearInterval(t),e}},0);b.onPreferencesChange("dashboards",function(){e.reflectPreferences()})},reflectPreferences:function(){var e=this;if(e.preferences?(e.old_preferences=e.preferences,e.preferences=s.default.pgAdmin.Browser.get_preferences_for_module("dashboards")):(e.preferences=s.default.pgAdmin.Browser.get_preferences_for_module("dashboards"),e.old_preferences=e.preferences),T||E){var t=g(".dashboard-container").find("#graph-sessions")[0],n=g(".dashboard-container").find("#graph-tps")[0],i=g(".dashboard-container").find("#graph-ti")[0],r=g(".dashboard-container").find("#graph-to")[0],a=g(".dashboard-container").find("#graph-bio")[0],o={parseFloat:!1,xaxis:{min:100,max:0,autoscale:0},yaxis:{autoscale:1}};e.preferences.graph_data_points&&(o=D({},o,{},{points:{show:!0,radius:1,hitRadius:3}})),e.preferences.graph_mouse_track&&(o=D({},o,{},{mouse:{track:!0,position:"sw"}})),e.preferences.show_graphs&&g("#dashboard-graphs").hasClass("dashboard-hidden")?g("#dashboard-graphs").removeClass("dashboard-hidden"):e.preferences.show_graphs||(g("#dashboard-graphs").addClass("dashboard-hidden"),e.clearChartFromStore()),e.preferences.show_activity&&g("#dashboard-activity").hasClass("dashboard-hidden")?g("#dashboard-activity").removeClass("dashboard-hidden"):e.preferences.show_activity||g("#dashboard-activity").addClass("dashboard-hidden"),e.preferences.show_graphs&&m.Dashboard.renderCharts([{chart_name:"session_stats",container:t,options:o,counter:!1,refresh_pref_name:"session_stats_refresh"},{chart_name:"tps_stats",container:n,options:o,counter:!0,refresh_pref_name:"tps_stats_refresh"},{chart_name:"ti_stats",container:i,options:o,counter:!0,refresh_pref_name:"ti_stats_refresh"},{chart_name:"to_stats",container:r,options:o,counter:!0,refresh_pref_name:"to_stats_refresh"},{chart_name:"bio_stats",container:a,options:o,counter:!0,refresh_pref_name:"bio_stats_refresh"}]),e.preferences.show_graphs||e.preferences.show_activity?g("#dashboard-none-show").addClass("dashboard-hidden"):g("#dashboard-none-show").removeClass("dashboard-hidden"),T?e.reflectPreferencesServer():E&&e.reflectPreferencesDatabase()}},reflectPreferencesServer:function(){var t=this,e=g(".dashboard-container"),n=e.find("#server_activity").get(0),i=e.find("#server_locks").get(0),r=e.find("#server_prepared").get(0),a=e.find("#server_config").get(0),o={tab_server_activity:n,tab_server_locks:i,tab_server_prepared:r,tab_server_config:a};if(t.preferences.show_activity){var s=[{name:"pid",label:h("PID"),editable:!1,cell:"string"},{name:"datname",label:h("Database"),editable:!1,cell:"string"},{name:"usename",label:h("User"),editable:!1,cell:"string"},{name:"application_name",label:h("Application"),editable:!1,cell:"string"},{name:"client_addr",label:h("Client"),editable:!1,cell:"string"},{name:"backend_start",label:h("Backend start"),editable:!1,cell:"string"},{name:"state",label:h("State"),editable:!1,cell:"string"}];s=t.version<90600?s.concat([{name:"waiting",label:h("Waiting?"),editable:!1,cell:"string"}]):s.concat([{name:"wait_event",label:h("Wait event"),editable:!1,cell:"string"},{name:"blocking_pids",label:h("Blocking PIDs"),editable:!1,cell:"string"}]);var l=new N,d=v.generateViewSchema(null,l,"create",null,null,!0);_.each(d[0].fields,function(e){e.version=t.version}),s.unshift({name:"pg-backform-expand",label:"",cell:O,cell_priority:-1,postgres_version:t.version,schema:d}),s.unshift({name:"pg-backform-delete",label:"",cell:P,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:m.Dashboard.can_take_action,postgres_version:t.version}),s.unshift({name:"pg-backform-delete",label:"",cell:P,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:m.Dashboard.can_take_action,postgres_version:t.version});var c=[{name:"pid",label:h("PID"),editable:!1,cell:"string"},{name:"datname",label:h("Database"),editable:!1,cell:"string"},{name:"locktype",label:h("Lock type"),editable:!1,cell:"string"},{name:"relation",label:h("Target relation"),editable:!1,cell:"string"},{name:"page",label:h("Page"),editable:!1,cell:"string"},{name:"tuple",label:h("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:h("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:h("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:h("Class"),editable:!1,cell:"string"},{name:"objid",label:h("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:h("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:h("Mode"),editable:!1,cell:"string"},{name:"granted",label:h("Granted?"),editable:!1,cell:"string"}],u=[{name:"git",label:h("Name"),editable:!1,cell:"string"},{name:"database",label:h("Database"),editable:!1,cell:"string"},{name:"Owner",label:h("Owner"),editable:!1,cell:"string"},{name:"transaction",label:h("XID"),editable:!1,cell:"string"},{name:"prepared",label:h("Prepared at"),editable:!1,cell:"string"}],f=[{name:"name",label:h("Name"),editable:!1,cell:"string"},{name:"category",label:h("Category"),editable:!1,cell:"string"},{name:"setting",label:h("Setting"),editable:!1,cell:"string"},{name:"unit",label:h("Unit"),editable:!1,cell:"string"},{name:"short_desc",label:h("Description"),editable:!1,cell:"string"}];g(n).addClass("pg-el-container"),g(n).attr("el","sm"),m.Dashboard.render_grid(n,p("dashboard.activity"),s),m.Dashboard.render_grid(i,p("dashboard.locks"),c),m.Dashboard.render_grid(r,p("dashboard.prepared"),u),m.Dashboard.render_grid(a,p("dashboard.config"),f),m.Dashboard.render_grid_data(n),g('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=o[g(e.relatedTarget).attr("aria-controls")];g(t).data("filtertext",g("#txtGridSearch").val());var n=o[g(e.target).attr("aria-controls")];g("#txtGridSearch").val(g(n).data("filtertext")),m.Dashboard.render_grid_data(n)}),g("#btn_refresh").off("click").on("click",function(){var e=o[g("#dashboard-activity .nav-tabs .active").attr("aria-controls")];m.Dashboard.render_grid_data(e)})}},reflectPreferencesDatabase:function(){var t=this,e=document.getElementById("database_activity"),n=document.getElementById("database_locks"),i=document.getElementById("database_prepared"),r={tab_database_activity:e,tab_database_locks:n,tab_database_prepared:i};if(t.preferences.show_activity){var a=[{name:"pid",label:h("PID"),editable:!1,cell:"string"},{name:"usename",label:h("User"),editable:!1,cell:"string"},{name:"application_name",label:h("Application"),editable:!1,cell:"string"},{name:"client_addr",label:h("Client"),editable:!1,cell:"string"},{name:"backend_start",label:h("Backend start"),editable:!1,cell:"string"},{name:"state",label:h("State"),editable:!1,cell:"string"}];a=t.version<90600?a.concat([{name:"waiting",label:h("Waiting?"),editable:!1,cell:"string"}]):a.concat([{name:"wait_event",label:h("Wait event"),editable:!1,cell:"string"},{name:"blocking_pids",label:h("Blocking PIDs"),editable:!1,cell:"string"}]);var o=new N,s=v.generateViewSchema(null,o,"create",null,null,!0);_.each(s[0].fields,function(e){e.version=t.version}),a.unshift({name:"pg-backform-expand",label:"",cell:O,cell_priority:-1,postgres_version:t.version,schema:s}),a.unshift({name:"pg-backform-delete",label:"",cell:P,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:m.Dashboard.can_take_action,postgres_version:t.version}),a.unshift({name:"pg-backform-delete",label:"",cell:P,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:m.Dashboard.can_take_action,postgres_version:t.version});var l=[{name:"pid",label:h("PID"),editable:!1,cell:"string"},{name:"locktype",label:h("Lock type"),editable:!1,cell:"string"},{name:"relation",label:h("Target relation"),editable:!1,cell:"string"},{name:"page",label:h("Page"),editable:!1,cell:"string"},{name:"tuple",label:h("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:h("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:h("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:h("Class"),editable:!1,cell:"string"},{name:"objid",label:h("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:h("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:h("Mode"),editable:!1,cell:"string"},{name:"granted",label:h("Granted?"),editable:!1,cell:"string"}],d=[{name:"git",label:h("Name"),editable:!1,cell:"string"},{name:"Owner",label:h("Owner"),editable:!1,cell:"string"},{name:"transaction",label:h("XID"),editable:!1,cell:"string"},{name:"prepared",label:h("Prepared at"),editable:!1,cell:"string"}];g(e).addClass("pg-el-container"),g(e).attr("el","sm"),m.Dashboard.render_grid(e,p("dashboard.activity"),a),m.Dashboard.render_grid(n,p("dashboard.locks"),l),m.Dashboard.render_grid(i,p("dashboard.prepared"),d),m.Dashboard.render_grid_data(e),g('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=r[g(e.relatedTarget).attr("aria-controls")];g(t).data("filtertext",g("#txtGridSearch").val());var n=r[g(e.target).attr("aria-controls")];g("#txtGridSearch").val(g(n).data("filtertext")),m.Dashboard.render_grid_data(n)}),g("#btn_refresh").off("click").on("click",function(){var e=r[g("#dashboard-activity .nav-tabs .active").attr("aria-controls")];m.Dashboard.render_grid_data(e)})}},toggleVisibility:function(e,t){x=e,1<arguments.length&&void 0!==t&&t&&this.clearChartFromStore()},can_take_action:function(e){var t=e.collection.where({state:"active"}),n=this.get("postgres_version")||null,i="cancel"===(this.get("cell_action")||null),r=h(i?"cancel":"terminate");return n&&1e5<=n&&!e.get("datname")?(c.info(h("You cannot ")+r+h(" background worker processes.")),!1):w==e.get("datname")&&"active"==e.get("state")&&1==t.length?(c.error(h("You are not allowed to ")+r+h(" the main active session.")),!1):i&&"idle"==e.get("state")?(c.info(h("The session is already in idle state.")),!1):!!k||(!(!y||y!=e.get("usename"))||(c.error(h("Superuser privileges are required to ")+r+h(" another users query.")),!1))}},m.Dashboard}}.apply(t,n))||(e.exports=r)},function(e,t,r){"use strict";function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}r(21),r(53),r(58),r(75),r(7),r(32),r(76),r(48),r(63),Object.defineProperty(t,"__esModule",{value:!0}),t.Chart=void 0;var n=function(){function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=this;r.e(13).then(function(e){n.chartApi=r(163)}.bind(null,r)).catch(function(e){throw e}),this._container=e,this._options={},this._defaultOptions={legend:{position:"nw",backgroundColor:"#D2E8FF"},lines:{show:!0,lineWidth:2},shadowSize:0,resolution:3,grid:{color:"transparent",tickColor:"#8f8f8f"}},this._dataset=null,this._tooltipFormatter=null,this._otherData={},this.setOptions(t)}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(i,[{key:"getContainer",value:function(){return this._container}},{key:"getContainerDimensions",value:function(){return{height:this._container.clientHeight,width:this._container.clientWidth}}},{key:"getOptions",value:function(){return this._options}},{key:"setOptions",value:function(e,t){var n=!(1<arguments.length&&void 0!==t)||t;this._options=n?a({},this._defaultOptions,{},this._options,{},e):a({},this._defaultOptions,{},e)}},{key:"removeOptions",value:function(e){this._options[e]&&delete this._options[e]}},{key:"getOtherData",value:function(e){if(this._otherData[e])return this._otherData[e]}},{key:"setOtherData",value:function(e,t){this._otherData[e]=t}},{key:"isVisible",value:function(){var e=this.getContainerDimensions();return 0<e.height&&0<e.width}},{key:"isInPage",value:function(){return this._container!==document.body&&document.body.contains(this._container)}},{key:"setTooltipFormatter",value:function(e){var t=this.getOptions();this._tooltipFormatter=e,this._tooltipFormatter&&this.setOptions({mouse:a({},t.mouse,{trackFormatter:this._tooltipFormatter})})}},{key:"draw",value:function(e){this._dataset=e,this._container&&this.chartApi&&this.chartApi.draw(this._container,this._dataset,this._options)}}]),i}();t.Chart=n},function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.url=function(e,t,r){var n=s.default.treeMenu.findNodeByDomElement(t),a=null;n&&n.anyFamilyMember(function(e){var t=e.getData(),n=s.default.Nodes[t._type],i=n&&n.dashboard;return(0,o.isFunction)(i)&&(i=i.apply(n,[e,t,r])),null!==(a=(0,o.isString)(i)?i:null)});return a};var i,o=n(25),s=(i=n(9))&&i.__esModule?i:{default:i}},function(e,t,n){"use strict";var i,r;n(10),n(16),n(50),n(18),n(11),n(6),i=[n(2),n(1),n(0),n(15),n(3),n(9),n(28),n(47),n(205),n(206)],void 0===(r=function(h,g,_,t,m,v,b,y,s,w){if(v.NodeStatistics)return v.NodeStatistics;if(v.NodeStatistics=v.NodeStatistics||{},v.NodeStatistics.initialized)return v.NodeStatistics;var l=b.SizeFormatter=function(){};g.extend(l.prototype,{fromRaw:function(e){return s(e)},toRaw:function(e){return e}});var e=b.Extension.SwitchCell.extend({defaults:g.extend({},b.Extension.SwitchCell.prototype.defaults)}),d={16:e,20:b.IntegerCell,21:b.IntegerCell,23:b.IntegerCell,700:b.NumberCell,701:b.NumberCell,1700:b.NumberCell,702:b.DatetimeCell,703:b.DatetimeCell,1082:b.DatetimeCell.extend({includeDate:!0,includeTime:!1,includeMilli:!1}),1083:b.DatetimeCell.extend({includeDate:!1,includeTime:!0,includeMilli:!0}),1114:b.DatetimeCell.extend({includeDate:!0,includeTime:!0,includeMilli:!0}),1184:"string",1266:"string"},x=window.wcDocker;return g.extend(e.prototype.defaults.options,{onText:h("True"),offText:h("False"),onColor:"success",offColor:"primary",size:"mini"}),g.extend(v.NodeStatistics,{init:function(){if(!this.initialized){this.initialized=!0,g.bindAll(this,"showStatistics","panelVisibilityChanged","__createMultiLineStatistics","__createSingleLineStatistics","__loadMoreRows"),g.extend(this,{initialized:!0,collection:new t.Collection(null),statistic_columns:[{editable:!1,name:"statistics",label:h("Statistics"),cell:"string",headerCell:b.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_25"},{editable:!1,name:"value",label:h("Value"),cell:"string"}],panel:v.docker.findPanels("statistics"),columns:null,grid:null});var e=this;v.Events.on("pgadmin-browser:panel-statistics:"+x.EVENT.VISIBILITY_CHANGED,this.panelVisibilityChanged),v.Events.on("pgadmin:browser:node:updated",function(){this.panel&&this.panel.length&&(_(this.panel[0]).data("node-prop",""),this.panelVisibilityChanged(this.panel[0]))},this),0==this.panel.length?v.Events.on("pgadmin-browser:panel-statistics:"+x.EVENT.INIT,function(){e.panel=v.docker.findPanels("statistics"),!e.panel[0].isVisible()&&1==e.panel.length||(v.Events.on("pgadmin-browser:tree:selected",this.showStatistics),v.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this))}.bind(this)):!e.panel[0].isVisible()&&1==e.panel.length||(v.Events.on("pgadmin-browser:tree:selected",this.showStatistics),v.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this)),0<e.panel.length&&e.panel[0].isVisible()&&(v.Events.on("pgadmin-browser:tree:selected",this.showStatistics),v.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this))}},__updateCollection:function(e,n,a,t){var i=this.panel[0].layout().scene().find(".pg-panel-content"),o=i.find(".pg-panel-statistics-message"),s=i.find(".pg-panel-statistics-container"),r=this.panel,l=this,d="",c=t;if(n){d=h("No statistics are available for the selected object.");var u=n.getTreeNodeHierarchy(a),f={node_type:t,url:e};if(g.isEqual(_(r[0]).data("node-prop"),f))return;if(_(r[0]).data("node-prop",f),w.nodeHasStatistics(n,a)){var p;d="";!function r(){_.ajax({url:e,type:"GET",beforeSend:function(e){e.setRequestHeader(m.csrf_token_header,m.csrf_token),p=setTimeout(function(){o.text(h("Retrieving data from the server...")),o.removeClass("d-none"),l.grid&&l.grid.remove()},1e3)}}).done(function(e){if(clearTimeout(p),o.text(""),e.data){var t=l.data=e.data;n.hasCollectiveStatistics||1<t.rows.length?(v.Events.on("pgadmin-browser:panel-statistics:"+x.EVENT.SCROLLED,l.__loadMoreRows),l.__createMultiLineStatistics.call(l,t,n.statsPrettifyFields)):(v.Events.off("pgadmin-browser:panel-statistics:"+x.EVENT.SCROLLED,l.__loadMoreRows),l.__createSingleLineStatistics.call(l,t,n.statsPrettifyFields)),l.grid&&(delete l.grid,l.grid=null),l.grid=new b.Grid({emptyText:"No data found",columns:l.columns,collection:l.collection,className:"backgrid presentation table table-bordered table-noouter-border table-hover"}),l.grid.render(),s.empty(),s.append(l.grid.$el),o.hasClass("d-none")||o.addClass("d-none"),s.removeClass("d-none")}else e.info&&(s.hasClass("d-none")||s.addClass("d-none"),o.text(e.info),o.removeClass("d-none"))}).fail(function(e,t,n){var i=u[c].label;v.Events.trigger("pgadmin:node:retrieval:error","statistics",e,t,n,a),y.pgHandleItemError(e,t,n,{item:a,info:u})||y.pgNotifier(t,e,h("Error retrieving the information - %s",n||i),function(e){"CRYPTKEY_SET"===e?r():console.warn(arguments)}),o.text(h("Failed to retrieve data from the server."))})}()}}""!=d&&(s.hasClass("d-none")||s.addClass("d-none"),o.removeClass("d-none"),o.text(d))},refreshStatistics:function(e,t,n){var i={node_type:t._type,url:n.generate_url(e,"stats",t,!0)};g.isEqual(_(this.panel[0]).data("node-prop"),i)&&(_(this.panel[0]).data("node-prop",""),this.showStatistics(e,t,n))},showStatistics:function(e,t,n){var i=this;n&&n&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(function(){i.__updateCollection.call(i,n.generate_url(e,"stats",t,!0),n,e,t._type)},400))},__createMultiLineStatistics:function(e,t){var n=e.rows,i=e.columns;for(var r in this.columns=[],i){var a=i[r],o=d[a.type_code]||"string";"PID"==a.name&&(o=o.extend({orderSeparator:""}));var s={editable:!1,name:a.name,cell:o};-1!=g.indexOf(t,a.name)&&(s.formatter=l),this.columns.push(s)}this.collection.reset(n.splice(0,50))},__loadMoreRows:function(){var e=_(".pg-panel-statistics-container").closest(".wcFrameCenter")[0];if(e.scrollHeight-10<e.scrollTop+e.offsetHeight){var t=this.data.rows;0<t.length&&this.collection.add(t.splice(0,50))}},__createSingleLineStatistics:function(e,t){var n,i=e.rows[0],r=e.columns,a=[];for(var o in this.columns=this.statistic_columns,r)n=r[o].name,a.push({statistics:n,value:i&&i[n]?-1!=g.indexOf(t,n)?s(i[n]):i[n]:null});this.collection.reset(a)},panelVisibilityChanged:function(e){if(e.isVisible()){var t=v.tree,n=t.selected(),i=n&&t.itemData(n),r=n&&i&&v.Nodes[i._type];v.NodeStatistics.showStatistics.apply(v.NodeStatistics,[n,i,r]),v.Events.on("pgadmin-browser:tree:selected",v.NodeStatistics.showStatistics),v.Events.on("pgadmin-browser:tree:refreshing",v.NodeStatistics.refreshStatistics,this)}else v.Events.off("pgadmin-browser:tree:selected",v.NodeStatistics.showStatistics),v.Events.off("pgadmin-browser:tree:refreshing",v.NodeStatistics.refreshStatistics,this)}}),v.NodeStatistics}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i;void 0===(i=function(){return function(e){var t=Math.abs(e),n=0,i=["bytes","kB","MB","GB","TB","PB"];if(t<10240)return t+" "+i[n];for(;n+=1,10239<(t/=1024););return Math.round(t)+" "+i[n]}}.apply(t,[]))||(e.exports=i)},function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.nodeHasStatistics=function(e,t){if("function"!=typeof e.hasStatistics)return e.hasStatistics;var n=e.getTreeNodeHierarchy(t);return e.hasStatistics(n)}},function(e,t,n){"use strict";var i,r;n(10),n(50),n(4),n(8),n(6),i=[n(2),n(1),n(0),n(15),n(3),n(9),n(14),n(28),n(25)],void 0===(r=function(f,n,p,t,h,g,_,i,r){if(g.NodeDependencies)return g.NodeDependencies;var m=window.wcDocker;return g.NodeDependencies=g.NodeDependencies||{},n.extend(g.NodeDependencies,{init:function(){if(!this.initialized){this.initialized=!0,this.dependenciesPanel=g.docker.findPanels("dependencies")[0],n.bindAll(this,"showDependencies","__loadMoreRows","__appendGridToPanel");var e=t.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var t=g.Nodes[e.type];return null!=e.icon&&""!=e.icon||(e.icon=t?n.isFunction(t.node_image)?t.node_image.apply(t,[null,null]):t.node_image||"icon-"+e.type:"icon-"+e.type),e.type=r.titleize(e.type.replace(/_/g," "),!0),e}});this.dependenciesCollection=new(t.Collection.extend({model:e}))(null),g.Events.on("pgadmin-browser:tree:selected",this.showDependencies),this.__appendGridToPanel()}},__appendGridToPanel:function(){var e=this.dependenciesPanel.layout().scene().find(".pg-panel-content").find(".pg-panel-dependencies-container"),t=new i.Grid({emptyText:"No data found",columns:[{name:"type",label:f("Type"),cell:i.Cell.extend({render:function(){return i.Cell.prototype.render.apply(this,arguments),this.$el.prepend(p("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:f("Name"),cell:"string",editable:!1},{name:"field",label:"",cell:"string",editable:!1}],collection:this.dependenciesCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependenciesGrid=t,e.append(t.render().el),!0},showDependencies:function(r,a,o){var s=this,t=f("Please select an object in the tree view."),e=this.dependenciesPanel.layout().scene().find(".pg-panel-content"),l=e.find(".pg-panel-depends-message"),n=e.find(".pg-panel-dependencies-container"),d=o.getTreeNodeHierarchy(r),c=a._type,i=o.generate_url(r,"dependency",a,!0);if(o&&(t=f("No dependency information is available for the selected object."),o.hasDepends)){this.dependenciesGrid.columns.models[2].set({label:f("Restriction")}),l.addClass("d-none"),n.removeClass("d-none");var u="";p.ajax({url:i,type:"GET",beforeSend:function(e){e.setRequestHeader(h.csrf_token_header,h.csrf_token),u=setTimeout(function(){l.text(f("Fetching dependency information from the server...")),l.removeClass("d-none"),t=""},1e3)}}).done(function(e){clearTimeout(u),0<e.length?(l.hasClass("d-none")||l.addClass("d-none"),n.removeClass("d-none"),s.dependenciesData=e,s.dependenciesCollection.reset(s.dependenciesData.splice(0,100),{parse:!0}),g.Events.on("pgadmin-browser:panel-dependencies:"+m.EVENT.SCROLLED,s.__loadMoreRows)):(g.Events.off("pgadmin-browser:panel-dependencies:"+m.EVENT.SCROLLED),s.dependenciesCollection.reset({silent:!0}),l.text(t),l.removeClass("d-none"),n.hasClass("d-none")||n.addClass("d-none"))}).fail(function(e,t,n){var i=d[c].label;g.Events.trigger("pgadmin:node:retrieval:error","depends",e,t,n),_.pgHandleItemError(e,t,n,{item:r,info:d})||_.pgNotifier(t,e,f("Error retrieving data from the server: %s",n||i),function(e){"CRYPTKEY_SET"===e?s.showDependencies(r,a,o):console.warn(arguments)}),l.text(f("Failed to retrieve data from the server."))})}""!=t&&(l.text(t),l.removeClass("d-none"),n.hasClass("d-none")||n.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependenciesPanel.length<1)){var e=this.dependenciesPanel.$container.find(".pg-panel-dependencies-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&0<this.dependenciesData.length&&this.dependenciesCollection.add(this.dependenciesData.splice(0,100),{parse:!0})}}}),g.NodeDependencies}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;n(10),n(50),n(4),n(8),n(6),i=[n(2),n(1),n(0),n(15),n(3),n(9),n(14),n(28),n(25)],void 0===(r=function(f,n,p,t,h,g,_,i,r){if(g.NodeDependents)return g.NodeDependents;var m=window.wcDocker;return g.NodeDependents=g.NodeDependents||{},n.extend(g.NodeDependents,{init:function(){if(!this.initialized){this.initialized=!0,this.dependentsPanel=g.docker.findPanels("dependents")[0],n.bindAll(this,"showDependents","__loadMoreRows","__appendGridToPanel");var e=t.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var t=g.Nodes[e.type];return null!=e.icon&&""!=e.icon||(e.icon=t?n.isFunction(t.node_image)?t.node_image.apply(t,[null,null]):t.node_image||"icon-"+e.type:"icon-"+e.type),e.type=r.titleize(e.type.replace(/_/g," "),!0),e}});this.dependentCollection=new(t.Collection.extend({model:e}))(null),g.Events.on("pgadmin-browser:tree:selected",this.showDependents),g.Events.on("pgadmin-browser:tree:refreshing",this.refreshDependents,this),this.__appendGridToPanel()}},__appendGridToPanel:function(){var e=this.dependentsPanel.layout().scene().find(".pg-panel-content").find(".pg-panel-dependents-container"),t=new i.Grid({emptyText:"No data found",columns:[{name:"type",label:f("Type"),cell:i.Cell.extend({render:function(){return i.Cell.prototype.render.apply(this,arguments),this.$el.prepend(p("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:f("Name"),cell:"string",editable:!1},{name:"field",label:"",cell:"string",editable:!1}],collection:this.dependentCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependentGrid=t,e.append(t.render().el),!0},showDependents:function(r,a,o){var s=this,t=f("Please select an object in the tree view."),e=this.dependentsPanel.layout().scene().find(".pg-panel-content"),l=e.find(".pg-panel-depends-message"),n=e.find(".pg-panel-dependents-container"),d=o.getTreeNodeHierarchy(r),c=a._type,i=o.generate_url(r,"dependent",a,!0);if(o&&(t=f("No dependent information is available for the selected object."),o.hasDepends)){"tablespace"==o.type||"role"==o.type?this.dependentGrid.columns.models[2].set({label:f("Database")}):this.dependentGrid.columns.models[2].set({label:f("Restriction")}),l.addClass("d-none"),n.removeClass("d-none");var u="";p.ajax({url:i,type:"GET",beforeSend:function(e){e.setRequestHeader(h.csrf_token_header,h.csrf_token),u=setTimeout(function(){l.text(f("Fetching dependent information from the server...")),l.removeClass("d-none"),t=""},1e3)}}).done(function(e){clearTimeout(u),0<e.length?(l.hasClass("d-none")||l.addClass("d-none"),n.removeClass("d-none"),s.dependentData=e,s.dependentCollection.reset(s.dependentData.splice(0,100),{parse:!0}),g.Events.on("pgadmin-browser:panel-dependents:"+m.EVENT.SCROLLED,s.__loadMoreRows)):(g.Events.off("pgadmin-browser:panel-dependents:"+m.EVENT.SCROLLED),s.dependentCollection.reset({silent:!0}),l.text(t),l.removeClass("d-none"),n.hasClass("d-none")||n.addClass("d-none"))}).fail(function(e,t,n){var i=d[c].label;g.Events.trigger("pgadmin:node:retrieval:error","depends",e,t,n),_.pgHandleItemError(e,t,n,{item:r,info:d})||_.pgNotifier(t,e,f("Error retrieving data from the server: %s",n||i),function(e){"CRYPTKEY_SET"===e?s.showDependents(r,a,o):console.warn(arguments)}),l.text(f("Failed to retrieve data from the server."))})}""!=t&&(l.text(t),l.removeClass("d-none"),n.hasClass("d-none")||n.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependentsPanel.length<1)){var e=this.dependentsPanel.$container.find(".pg-panel-dependents-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&0<this.dependentData.length&&this.dependentCollection.add(this.dependentData.splice(0,100),{parse:!0})}}}),g.NodeDependents}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;n(18),n(6),i=[n(2),n(1),n(0),n(3),n(9),n(14)],void 0===(r=function(c,u,f,p,h,g){if(h.ShowNodeSQL=h.ShowNodeSQL||{},h.ShowNodeSQL.initialized)return h.ShowNodeSQL;var t=window.wcDocker;return u.extend(h.ShowNodeSQL,{init:function(){var e;this.initialized||(this.initialized=!0,u.bindAll(this,"showSQL","sqlPanelVisibilityChanged"),this.sqlPanels=e=h.docker.findPanels("sql"),h.Events.on("pgadmin-browser:panel-sql:"+t.EVENT.VISIBILITY_CHANGED,this.sqlPanelVisibilityChanged),h.Events.on("pgadmin:browser:node:updated",function(){this.sqlPanels&&this.sqlPanels.length&&(f(this.sqlPanels[0]).data("node-prop",""),this.sqlPanelVisibilityChanged(this.sqlPanels[0]))},this),0==e.length?h.Events.on("pgadmin-browser:panel-sql:"+t.EVENT.INIT,function(){!e[0].isVisible()&&1==e.length||(h.Events.on("pgadmin-browser:tree:selected",this.showSQL),h.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this))}.bind(this)):!e[0].isVisible()&&1==e.length||(h.Events.on("pgadmin-browser:tree:selected",this.showSQL),h.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this)))},refreshSQL:function(e,t,n){var i={node_type:t._type,url:n.generate_url(e,"sql",t,!0)};u.isEqual(f(this.sqlPanels[0]).data("node-prop"),i)&&(f(this.sqlPanels[0]).data("node-prop",""),this.showSQL(e,t,n))},showSQL:function(s,r,l){this.timeout&&clearTimeout(this.timeout);var d=this;this.timeout=setTimeout(function(){var e="-- "+c("Please select an object in the tree view.");if(l){e="-- "+c("No SQL could be generated for the selected object.");var a=r._type,t=l.generate_url(s,"sql",r,!0),o=l.getTreeNodeHierarchy(s),n={node_type:a,url:t};if(u.isEqual(f(d.sqlPanels[0]).data("node-prop"),n))return;if(f(d.sqlPanels[0]).data("node-prop",n),l.hasSQL){var i;e="";!function r(){f.ajax({url:t,type:"GET",beforeSend:function(e){e.setRequestHeader(p.csrf_token_header,p.csrf_token),i=setTimeout(function(){p.Browser.editor.setValue(c("Retrieving data from the server..."))},1e3)}}).done(function(e){p.Browser.editor.getValue()!=e&&p.Browser.editor.setValue(e),clearTimeout(i)}).fail(function(e,t,n){var i=o[a].label;h.Events.trigger("pgadmin:node:retrieval:error","sql",e,t,n,s),g.pgHandleItemError(e,t,n,{item:s,info:o})||g.pgNotifier(t,e,c("Error retrieving the information - %s",n||i),function(e){"CRYPTKEY_SET"===e?r():console.warn(arguments)})})}()}}""!=e&&p.Browser.editor.setValue(e)},400)},sqlPanelVisibilityChanged:function(e){if(e.isVisible()){var t=h.tree,n=t.selected(),i=n&&t.itemData(n),r=n&&i&&h.Nodes[i._type];h.ShowNodeSQL.showSQL.apply(h.ShowNodeSQL,[n,i,r]),h.Events.on("pgadmin-browser:tree:selected",h.ShowNodeSQL.showSQL),h.Events.on("pgadmin-browser:tree:refreshing",h.ShowNodeSQL.refreshSQL,this)}else h.Events.off("pgadmin-browser:tree:selected",h.ShowNodeSQL.showSQL),h.Events.off("pgadmin-browser:tree:refreshing",h.ShowNodeSQL.refreshSQL,this)}}),h.ShowNodeSQL}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;n(36),n(10),n(23),n(33),n(18),n(12),n(79),n(37),n(46),n(6),i=[n(3),n(2),n(5),n(1),n(0),n(9),n(47)],void 0===(r=function(d,c,t,u,f,p,a){if(p.BackgroundProcessObsorver=p.BackgroundProcessObsorver||{},p.BackgroundProcessObsorver.initialized)return p.BackgroundProcessObsorver;function o(e,t){var n=this;setTimeout(function(){n.initialize.apply(n,[e,t])},1)}var h=window.wcDocker;return u.extend(o.prototype,{success_status_tpl:u.template('\n      <div class="d-flex px-2 py-1 bg-success-light border border-success rounded">\n        <div class="pr-2">\n          <i class="fa fa-check fa-lg text-success pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),failed_status_tpl:u.template('\n      <div class="d-flex px-2 py-1 bg-danger-lighter border border-danger rounded">\n        <div class="pr-2">\n          <i class="fa fa-close fa-lg text-danger pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),other_status_tpl:u.template('\n      <div class="d-flex px-2 py-1 bg-primary-light border border-primary rounded">\n        <div class="pr-2">\n          <i class="fa fa-info fa-lg text-primary pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),initialize:function(e,t){u.extend(this,{details:!1,notify:u.isUndefined(t)||t,curr_status:null,state:0,completed:!1,id:e.id,type_desc:null,desc:null,detailed_desc:null,stime:null,exit_code:null,acknowledge:e.acknowledge,execution_time:null,out:-1,err:-1,lot_more:!1,notifier:null,container:null,panel:null,logs:f("<ol></ol>",{class:"pg-bg-process-logs"})}),this.notify&&(p.Events&&p.Events.on("pgadmin-bgprocess:started:"+this.id,function(e){e.notifier||e.show.apply(e)}),p.Events&&p.Events.on("pgadmin-bgprocess:finished:"+this.id,function(e){e.notifier||e.show.apply(e)}));var n=this;setTimeout(function(){n.update.apply(n,[e])},1)},bgprocess_url:function(e){switch(e){case"status":return this.details&&-1!=this.out&&-1!=this.err?t("bgprocess.detailed_status",{pid:this.id,out:this.out,err:this.err}):t("bgprocess.status",{pid:this.id});case"acknowledge":return t("bgprocess.acknowledge",{pid:this.id});case"stop_process":return t("bgprocess.stop_process",{pid:this.id});default:return t("bgprocess.list")}},update:function(e){var t=this,n=[],i=[];"stime"in e&&(t.stime=new Date(e.stime)),"execution_time"in e&&(t.execution_time=parseFloat(e.execution_time)),"type_desc"in e&&(t.type_desc=e.type_desc),"desc"in e&&(t.desc=e.desc),"details"in e&&(t.detailed_desc=e.details),"exit_code"in e&&(t.exit_code=e.exit_code),"process_state"in e&&(t.state=e.process_state),"out"in e&&(t.out=e.out&&e.out.pos,e.out&&e.out.lines&&(n=e.out.lines)),"err"in e&&(t.err=e.err&&e.err.pos,e.err&&e.err.lines&&(i=e.err.lines)),t.completed=t.completed||"err"in e&&"out"in e&&e.err.done&&e.out.done||!t.details&&!u.isNull(t.exit_code);for(var r=0,a=0,o=[],s=document.createElement("textarea"),l=function(e){return s.textContent=e,s.innerHTML};r<n.length&&a<i.length;)d.natural_sort(n[r][0],i[a][0])<=0?o.push('<li class="pg-bg-res-out">'+l(n[r++][1])+"</li>"):o.push('<li class="pg-bg-res-err">'+l(i[a++][1])+"</li>");for(;r<n.length;)o.push('<li class="pg-bg-res-out">'+l(n[r++][1])+"</li>");for(;a<i.length;)o.push('<li class="pg-bg-res-err">'+l(i[a++][1])+"</li>");o.length&&(t.logs.append(o.join("")),setTimeout(function(){t.logs[0].scrollTop=t.logs[0].scrollHeight})),t.logs_loading&&(t.logs_loading.remove(),t.logs_loading=null),t.stime&&(t.curr_status=t.other_status_tpl({status_text:c("Started")}),2<=t.execution_time&&(t.curr_status=t.other_status_tpl({status_text:c("Running...")})),u.isNull(t.exit_code)||(3===t.state?t.curr_status=t.failed_status_tpl({status_text:c("Terminated by user.")}):0==t.exit_code?t.curr_status=t.success_status_tpl({status_text:c("Successfully completed.")}):t.curr_status=t.failed_status_tpl({status_text:c("Failed (exit code: %s).",String(t.exit_code))})),0==t.state&&t.stime&&(t.state=1,p.Events&&p.Events.trigger("pgadmin-bgprocess:started:"+t.id,t,t)),1!=t.state||u.isNull(t.exit_code)||(t.state=2,p.Events&&p.Events.trigger("pgadmin-bgprocess:finished:"+t.id,t,t)),setTimeout(function(){t.show.apply(t)},10)),t.completed||setTimeout(function(){t.status.apply(t)},1e3)},status:function(){var t=this;f.ajax({typs:"GET",timeout:3e4,url:t.bgprocess_url("status"),cache:!1,async:!0,contentType:"application/json"}).done(function(e){setTimeout(function(){t.update(e)},10)}).fail(function(e){410!=e.status&&setTimeout(function(){t.update(e)},1e4)})},show:function(){var e=this;if(e.notify&&!e.details){if(!e.notifier){var t=f('\n            <div class="card">\n              <div class="card-header bg-primary d-flex">\n                <div>'.concat(e.type_desc,'</div>\n                <div class="ml-auto">\n                  <button class="btn btn-sm-sq btn-primary pg-bg-close"><i class="fa fa-lg fa-close"></i></button>\n                </div>\n              </div>\n              <div class="card-body px-2">\n                <div class="py-1">').concat(e.desc,'</div>\n                <div class="py-1">').concat(e.stime.toString(),'</div>\n                <div class="d-flex py-1">\n                  <div class="my-auto mr-2">\n                    <span class="fa fa-clock-o fa-2x"></span>\n                  </div>\n                  <div class="pg-bg-etime my-auto mr-2"></div>\n                  <div class="ml-auto">\n                    <button class="btn btn-secondary pg-bg-more-details"><span class="fa fa-info-circle"></span>&nbsp;').concat(c("More details..."),'</button>\n                    <button class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;').concat(c("Stop Process"),'</button>\n                  </div>\n                </div>\n                <div class="pg-bg-status py-1">\n                </div>\n              </div>\n            </div>\n            ')),n=t.find(".pg-bg-more-details"),i=t.find(".pg-bg-close");e.container=t,e.notifier=a.notify(t.get(0),"bg-bgprocess",0,null),n.on("click",function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation(),this.notifier.dismiss(),this.notifier=null,this.completed=!1,this.show_detailed_view.apply(this)}.bind(e)),i.on("click",function(){this.notifier.dismiss(),this.notifier=null,this.acknowledge_server.apply(this)}.bind(this)),e.container.on("click",function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation()}),t.find(".bg-process-stop").off("click").on("click",e.stop_process.bind(this))}e.container.find(".pg-bg-etime").empty().append(f("<span></span>").text(String(e.execution_time))).append(f("<span></span>").text(" "+c("seconds"))),f(e.container.find(".pg-bg-status")).html(e.curr_status);var r=f(e.container.find(".bg-process-stop"));isNaN(parseInt(e.exit_code))?r.attr("disabled",!1):r.attr("disabled",!0)}else e.show_detailed_view.apply(e)},show_detailed_view:function(){var e=this,t=this.panel,n=!1;e.panel||(n=!0,(t=this.panel=p.BackgroundProcessObsorver.create_panel()).title("Process Watcher - "+e.type_desc),t.focus());var i=t.$container,r=i.find(".bg-process-watcher"),a=i.find(".bg-process-details"),o=i.find(".bg-process-footer"),s=i.find(".bg-process-stop");if(isNaN(parseInt(e.exit_code))?s.attr("disabled",!1):s.attr("disabled",!0),s.off("click").on("click",e.stop_process.bind(this)),n&&(r.html(e.logs),setTimeout(function(){e.logs[0].scrollTop=e.logs[0].scrollHeight}),e.logs_loading=f('<li class="pg-bg-res-out loading-logs">'.concat(c("Loading process logs..."),"</li>")),e.logs.append(e.logs_loading),a.find(".bg-detailed-desc").html(e.detailed_desc)),a.find(".bg-process-stats .bgprocess-start-time").html(e.stime),o.find(".bg-process-status").html(e.curr_status),o.find(".bg-process-exec-time p").empty().append(f("<span></span>").text(String(e.execution_time))).append(f("<span></span>").text(" "+c("seconds"))),n){e.details=!0,e.err=0,e.out=0,setTimeout(function(){e.status.apply(e)},1e3);var l=function(e,t,n){var i=t.outerHeight()+n.outerHeight();e.css("padding-bottom",i)}.bind(t,r,a,o);t.on(h.EVENT.RESIZED,l),t.on(h.EVENT.ATTACHED,l),t.on(h.EVENT.DETACHED,l),l(),t.on(h.EVENT.CLOSED,function(e){e.panel=null,e.details=!1,null!=e.exit_code&&e.acknowledge_server.apply(e)}.bind(t,this))}},acknowledge_server:function(){f.ajax({type:"PUT",timeout:3e4,url:this.bgprocess_url("acknowledge"),cache:!1,async:!0,contentType:"application/json"}).done(function(){}).fail(function(){console.warn(arguments)})},stop_process:function(){this.state=3,f.ajax({type:"PUT",timeout:3e4,url:this.bgprocess_url("stop_process"),cache:!1,async:!0,contentType:"application/json"}).done(function(){}).fail(function(){console.warn(arguments)})}}),u.extend(p.BackgroundProcessObsorver,{bgprocesses:{},init:function(){var e=this;e.initialized||(e.initialized=!0,setTimeout(function(){e.update_process_list.apply(e)},1e3),p.Events.on("pgadmin-bgprocess:created",function(){setTimeout(function(){p.BackgroundProcessObsorver.update_process_list(!0)},1e3)}))},update_process_list:function(i){var r=this;f.ajax({typs:"GET",timeout:3e4,url:t("bgprocess.list"),cache:!1,async:!0,contentType:"application/json"}).done(function(e){if(e&&u.isArray(e)){for(var t in e){var n=e[t];"id"in n&&(n.id in r.bgprocesses||(r.bgprocesses[n.id]=new o(n)))}i&&0==e.length&&setTimeout(function(){r.update_process_list(!1)},3e3)}}).fail(function(){console.warn(arguments)})},create_panel:function(){return this.register_panel(),p.docker.addPanel("bg_process_watcher",h.DOCK.FLOAT,null,{w:screen.width<700?.95*screen.width:.5*screen.width,h:screen.height<500?.95*screen.height:.5*screen.height,x:screen.width<700?"2%":"25%",y:screen.height<500?"2%":"25%"})},register_panel:function(){var e=p.docker.findPanels("bg_process_watcher");e&&1<=e.length||new p.Panel({name:"bg_process_watcher",showTitle:!0,isCloseable:!0,isPrivate:!0,isLayoutMember:!1,content:'<div class="bg-process-details"><div class="bg-detailed-desc"></div><div class="bg-process-stats d-flex py-1"><div class="my-auto mr-2"><span class="fa fa-clock-o fa-2x"></span></div><div class="pg-bg-etime my-auto mr-2"><span>'+c("Start time")+': <span class="bgprocess-start-time"></span></span></div><div class="ml-auto"><button type="button" class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;'+c("Stop Process")+'</button></div></div></div><div class="bg-process-watcher"></div><div class="bg-process-footer p-2 d-flex"><div class="bg-process-status flex-grow-1"></div><div class="bg-process-exec-time ml-4 my-auto"><div class="exec-div"><span>'+c("Execution time")+":</span><p></p></div></div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow p-2")}}).load(p.docker)}}),p.BackgroundProcessObsorver}.apply(t,i))||(e.exports=r)},,,,,function(e,t,n){"use strict";var i,r;n(16),n(40),n(11),n(4),n(8),n(29),n(6),i=[n(2),n(0),n(1),n(15),n(9),n(13),n(28),n(20)],void 0===(r=function(l,e,d,t,n,i,r){r.PartitionRow=r.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function(){r.Row.prototype.initialize.apply(this,arguments);var i=this;i.model.on("change:is_attach",function(){setTimeout(function(){i.columns.each(function(e){if("partition_name"==e.get("name")){var t=i.columns.indexOf(e),n=new(e.get("cellFunction").apply(e,[i.model]))({column:e,model:i.model});i.cells[t].remove(),i.cells[t]=n,i.render()}})},10)}),i.listenTo(i.model,"pgadmin-session:model:duplicate",i.modelDuplicate),i.listenTo(i.model,"pgadmin-session:model:unique",i.modelUnique)},modelDuplicate:function(){e(this.el).removeClass("new"),e(this.el).addClass(this.modelDuplicateClass)},modelUnique:function(){e(this.el).removeClass(this.modelDuplicateClass)}});i.PartitionKeyModel=n.Node.Model.extend({defaults:{key_type:"column",pt_column:void 0,expression:void 0},keys:["pt_column"],schema:[{id:"key_type",label:l("Key type"),type:"select2",editable:!0,cell:"select2",cellHeaderClasses:"width_percent_25",select2:{allowClear:!1},options:[{label:l("Column"),value:"column"},{label:l("Expression"),value:"expression"}]},{id:"pt_column",label:l("Column"),type:"text",cell:r.Extension.Select2DepCell.extend({keyPathAccessor:function(e,t){var n=e;if(d.isArray(n))return d.map(n,function(e){return e.pt_column});t=t.split(".");for(var i=0;i<t.length;i++){if(d.isNull(n))return null;d.isEmpty(t[i])||d.isUndefined(n[t[i]])||(n=n[t[i]])}return d.isObject(n)&&!d.isArray(n)?null:n},initialize:function(){var e=this;if(this.model.handler){if(r.Extension.Select2DepCell.prototype.initialize.apply(this,arguments),d.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=this.model.top.get("typname"),n=this.model.top.of_types_tables,i=[];0<e.length?d.each(e.models,function(e){var t=e.get("name");d.isUndefined(t)||d.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}):!d.isUndefined(t)&&!d.isNull(t)&&!d.isUndefined(n)&&0<n.length&&d.each(n,function(e){e.label==t&&d.each(e.oftype_columns,function(e){i.push({label:e.name,value:e.name,image:"icon-column"})})}),this.column.set("options",i)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),r.Extension.Select2DepCell.prototype.remove.apply(this,arguments)}}}),deps:["key_type"],cellHeaderClasses:"width_percent_30",transform:function(e){var t=[];return e&&d.isArray(e)&&d.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},editable:function(e){return"expression"!=e.get("key_type")||(setTimeout(function(){e.set("pt_column",void 0)},10),!1)}},{id:"expression",label:l("Expression"),type:"text",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_45",deps:["key_type"],editable:function(e){return"column"!=e.get("key_type")||(setTimeout(function(){e.set("expression",void 0)},10),!1)}}],validate:function(){var e,t=this.get("key_type"),n=this.get("pt_column"),i=this.get("expression");return this.errorModel.clear(),d.isUndefined(t)||d.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=l("Partition key type cannot be empty."),this.errorModel.set("key_type",e),e):"column"==t&&d.isUndefined(n)||d.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=l("Partition key column cannot be empty."),this.errorModel.set("pt_column",e),e):"expression"==t&&d.isUndefined(i)||d.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=l("Partition key expression cannot be empty."),this.errorModel.set("expression",e),e):null}}),i.PartitionsModel=n.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,is_attach:!1,partition_name:void 0,is_default:void 0,values_from:void 0,values_to:void 0,values_in:void 0,values_modulus:void 0,values_remainder:void 0},keys:["partition_name"],schema:[{id:"oid",label:l("OID"),type:"text"},{id:"is_attach",label:l("Operation"),cell:"switch",type:"switch",options:{onText:l("Attach"),offText:l("Create"),width:65},cellHeaderClasses:"width_percent_5",editable:function(e){return!(!(e instanceof t.Model&&e.isNew())||e.top.isNew())}},{id:"partition_name",label:l("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e instanceof t.Model&&e.isNew())},cellFunction:function(e){if(e.get("is_attach")){var t=[];return e.set({partition_name:void 0},{silent:!0}),d.each(e.top.table_options,function(e){t.push([e.label,e.value])}),r.Extension.Select2Cell.extend({optionValues:t})}return r.StringCell}},{id:"is_default",label:l("Default"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_5",min_version:11e4,options:{onText:l("Yes"),offText:l("No")},editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&("range"===e.handler.top.attributes.partition_type||"list"===e.handler.top.attributes.partition_type)&&e instanceof t.Model&&e.isNew()&&11e4<=e.handler.top.node_info.server.version)}},{id:"values_from",label:l("From"),type:"text",cell:r.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof t.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_to",label:l("To"),type:"text",cell:r.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof t.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_in",label:l("In"),type:"text",cell:r.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"list"===e.handler.top.attributes.partition_type&&e instanceof t.Model&&e.isNew()&&!0!==e.get("is_default"))}},{id:"values_modulus",label:l("Modulus"),type:"int",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof t.Model&&e.isNew())}},{id:"values_remainder",label:l("Remainder"),type:"int",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15 width_percent_20",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof t.Model&&e.isNew())}}],validate:function(){var e,t=this.get("partition_name"),n=this.get("is_default"),i=this.get("values_from"),r=this.get("values_to"),a=this.get("values_in"),o=this.get("values_modulus"),s=this.get("values_remainder");if(this.errorModel.clear(),d.isUndefined(t)||d.isNull(t)||""===String(t).replace(/^\s+|\s+$/g,""))return e=l("Partition name cannot be empty."),this.errorModel.set("partition_name",e),e;if("range"===this.top.get("partition_type")){if(!0!==n&&(d.isUndefined(i)||d.isNull(i)||""===String(i).replace(/^\s+|\s+$/g,"")))return e=l("For range partition From field cannot be empty."),this.errorModel.set("values_from",e),e;if(!0!==n&&(d.isUndefined(r)||d.isNull(r)||""===String(r).replace(/^\s+|\s+$/g,"")))return e=l("For range partition To field cannot be empty."),this.errorModel.set("values_to",e),e}else if("list"===this.top.get("partition_type")){if(!0!==n&&(d.isUndefined(a)||d.isNull(a)||""===String(a).replace(/^\s+|\s+$/g,"")))return e=l("For list partition In field cannot be empty."),this.errorModel.set("values_in",e),e}else if("hash"===this.top.get("partition_type")){if(d.isUndefined(o)||d.isNull(o)||""===String(o).replace(/^\s+|\s+$/g,""))return e=l("For hash partition Modulus field cannot be empty."),this.errorModel.set("values_modulus",e),e;if(d.isUndefined(s)||d.isNull(s)||""===String(s).replace(/^\s+|\s+$/g,""))return e=l("For hash partition Remainder field cannot be empty."),this.errorModel.set("values_remainder",e),e}return null}})}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(21),n(26),n(27),n(36),n(10),n(19),n(11),n(7),n(32),n(12),n(24),n(49),n(22),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.showDataGrid=function(t,n,i,e,r,a){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6],s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:null,l=n.treeMenu.findNodeByDomElement(r);if(void 0===l||!l.getData())return void i.alert((0,h.default)("Data Grid Error"),(0,h.default)("No object selected."));var d=_.getTreeNodeHierarchyFromIdentifier.call(n,r);if(function(e){return void 0===e.server||void 0===e.database}(d)||!function(e){return void 0!==e.schema||void 0!==e.view||void 0!==e.catalog}(d))return;var c=function(e,t,n,i){var r=(0,g.default)("datagrid.panel",{trans_id:e});return r+="?is_query_tool=".concat(!1)+"&cmd_type=".concat(t.mnuid)+"&obj_type=".concat(n._type)+"&obj_id=".concat(n._id)+"&sgid=".concat(i.server_group._id)+"&sid=".concat(i.server._id)+"&did=".concat(i.database._id)+"&server_type=".concat(i.server.server_type)}(a,e,l.getData(),d),u=y(n,r);if(o){!function(i,r){i.filterDialog||i.dialog("filterDialog",function(){return{main:function(e,t,n,i,r){this.set("title",e),this.message=t,this.validateUrl=n,this.okCallback=r,this.preferences=i},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,h.default)("Data Filter"),url:(0,g.default)("help.static",{filename:"viewdata_filter.html"})}},{text:(0,h.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,h.default)("OK"),key:null,className:"btn btn-primary fa fa-check pg-alertify-button"}],options:{modal:0,resizable:!0,maximizable:!1,pinnable:!1,autoReset:!1}}},build:function(){var t=this;i.pgDialogBuild.apply(t),(0,b.default)(t.__internal.buttons[2].element).attr("title",(0,h.default)("Use SHIFT + ENTER to apply filter...")),(0,b.default)(t.elements.body).on("keypress",function(e){e.shiftKey&&13==e.keyCode&&t.__internal.buttons[2].element.click()})},prepare:function(){var e=this,t=(0,b.default)(this.message),n=t.find("#sql_filter");(0,b.default)(this.elements.header).attr("data-title",this.get("title")),(0,b.default)(this.elements.body.childNodes[0]).addClass("dataview_filter_dialog"),this.setContent(t.get(0)),e.__internal.buttons[2].element.disabled=!0,this.filter_obj=m.default.fromTextArea(n.get(0),{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:r.editor_shortcut_keys,indentWithTabs:!e.preferences.use_spaces,indentUnit:e.preferences.tab_size,tabSize:e.preferences.tab_size,lineWrapping:e.preferences.wrap_code,autoCloseBrackets:e.preferences.insert_pair_brackets,matchBrackets:e.preferences.brace_matching});var i=v.calcFontSize(e.preferences.sql_font_size);(0,b.default)(this.filter_obj.getWrapperElement()).css("font-size",i),setTimeout(function(){e.filter_obj.refresh(),e.filter_obj.focus()},500),e.filter_obj.on("change",function(){""!==e.filter_obj.getValue()?e.__internal.buttons[2].element.disabled=!1:e.__internal.buttons[2].element.disabled=!0})},callback:function(e){if(e.button.text==(0,h.default)("OK")){var t=this.filter_obj.getValue(),n=this;e.cancel=!0,b.default.ajax({url:n.validateUrl,method:"POST",async:!1,contentType:"application/json",data:JSON.stringify(t)}).done(function(e){e.data.status?(n.okCallback(t),n.close()):i.alert((0,h.default)("Validation Error"),e.data.result)}).fail(function(e){i.alert((0,h.default)("Validation Error"),e)})}else if(0==e.index)return e.cancel=!0,void r.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null)}}})}(i,n);var f=function(e,t){var n={sid:t.server._id,did:t.database._id,obj_id:e._id};return(0,g.default)("datagrid.filter_validate",n)}(l.getData(),d),p=function(e){t.launch_grid(a,c,!1,u,null,e)};b.default.get((0,g.default)("datagrid.filter"),function(e){i.filterDialog("Data Filter - ".concat(u),e,f,s,p).resizeTo(n.stdW.sm,n.stdH.sm)})}else t.launch_grid(a,c,!1,u)},t.retrieveNameSpaceName=l,t.generateDatagridTitle=y;var h=i(n(2)),g=i(n(5)),_=n(57),a=n(88),m=i(n(84)),v=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(n(69)),b=i(n(0));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return void 0!==e.schema?e.schema.label:void 0!==e.view?e.view.label:void 0!==e.catalog?e.catalog.label:""}function y(e,t){var n=(0,a.getPanelTitle)(e,t),i=l(_.getTreeNodeHierarchyFromIdentifier.call(e,t)),r=e.treeMenu.findNodeByDomElement(t);return"".concat(i,".").concat(r.getData().label,"/").concat(n)}},function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.showQueryTool=function(e,t,n,i,r,a){var o=i||"",s=function(e,t){return(0,p.getPanelTitle)(e,t)}(t,r);if(void 0===t.treeMenu.findNodeByDomElement(r))return void n.alert((0,c.default)("Query Tool Error"),(0,c.default)("No object selected."));var l=f.getTreeNodeHierarchyFromIdentifier.call(t,r);if(function(e){return void 0===e.server}(l))return;var d=function(e,t,n){var i=(0,u.default)("datagrid.panel",{trans_id:e});i+="?is_query_tool=".concat(!0)+"&sgid=".concat(n.server_group._id)+"&sid=".concat(n.server._id)+"&server_type=".concat(n.server.server_type),function(e){return e.database}(n)&&(i+="&did=".concat(n.database._id));return i}(a,0,l);e.launch_grid(a,d,!0,s,o)};var c=i(n(2)),u=i(n(5)),f=n(57),p=n(88);function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";var i,r;i=[n(2),n(47)],void 0===(r=function(t,n){return{copyTextToClipboard:function(i){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",document.body.appendChild(e),e.select();document.addEventListener("copy",function e(t){document.removeEventListener("copy",e);var n=t.clipboardData||window.clipboardData;n&&(n.setData("text",i),t.preventDefault())});try{document.execCommand("copy")}catch(e){n.alert(t("Error"),t("Oops, unable to copy to clipboard"))}document.body.removeChild(e)}}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";n(7),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.httpResponseRequiresNewTransaction=o,t.handleLoginRequiredAndTransactionRequired=l,t.handleQueryToolAjaxError=function(e,t,n,i,r,a){if(0===n.readyState)return(0,s.default)("Not connected to the server or the connection to the server has been closed.");l(e,t,n,i,r,a);var o=n.responseText;void 0!==n.responseJSON&&(void 0!==n.responseJSON.errormsg&&(o=n.responseJSON.errormsg),503===n.status&&void 0!==n.responseJSON.info&&"CONNECTION_LOST"==n.responseJSON.info&&setTimeout(function(){i&&t.saveState(i,r),t.handle_connection_lost(!1,n)}));return o};var i,s=(i=n(2))&&i.__esModule?i:{default:i};function o(e){return void 0===e.responseJSON&&void 0!==e.data?404===e.status&&e.data&&e.data.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.data.info:404===e.status&&e.responseJSON&&e.responseJSON.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.responseJSON.info}function l(e,t,n,i,r,a){return r=r&&0<r.length?r:[],e.Browser.UserManagement.isPgaLoginRequired(n)?(i&&t.saveState(i,r),e.Browser.UserManagement.pgaLogin()):a&&o(n)?(i&&t.saveState(i,r),t.initTransaction()):void 0}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(i,e,d){"use strict";(function(t){d(10),d(6);var r=n(d(2)),a=n(d(5)),o=n(d(0)),e=n(d(14)),s=n(d(3)),l=d(127);function n(e){return e&&e.__esModule?e:{default:e}}i.exports=e.default.dialog("fileSelectionDlg",function(){return{main:function(e){t.isUndefined(e.dialog_title)&&(e.dialog_title="Select file"),this.dialog_type=e.dialog_type,this.set("title",e.dialog_title),this.params=JSON.stringify(e),this.elements.dialog.style.minWidth="630px",this.show()},settings:{label:void 0},settingUpdated:function(e,t,n){switch(e){case"message":this.setMessage(n);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=n)}},prepare:function(){var e=this;e.$container.find(".storage_content").remove(),e.$container.append("<div class='storage_content'></div>");var t=e.$container.find(".storage_content");t.empty(),(0,o.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties"),o.default.get((0,a.default)("file_manager.index"),function(e){t.append(e)});var n,i=(0,l.getTransId)(e.params);4==i.readyState&&(n=JSON.parse(i.responseText)),e.trans_id=n.data.fileTransId,setTimeout(function(){(0,o.default)(e.$container.find(".file_manager")).on("enter-key",function(){(0,o.default)((0,o.default)(e.elements.footer).find(".file_manager_ok")).trigger("click")})},200),e.__internal.buttons[1].element.disabled=!0},setup:function(){return{buttons:[{text:(0,r.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,r.default)("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},callback:function(e){var t;if(e.button.text==(0,r.default)("Select")){var n=(0,o.default)(".storage_dialog #uploader .input-path").val(),i={path:(0,o.default)(".currentpath").val()};s.default.Browser.Events.trigger("pgadmin-storage:finish_btn:"+this.dialog_type,n),t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,l.removeTransId)(this.trans_id),(0,l.set_last_traversed_dir)(i,this.trans_id)}else e.button.text==(0,r.default)("Cancel")&&(t=(0,o.default)(this.elements.body).find(".storage_content"),(0,o.default)(t).find("*").off(),t.remove(),(0,l.removeTransId)(this.trans_id),s.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:"+this.dialog_type))},build:function(){this.$container=(0,o.default)('<div class="storage_dialog file_selection_dlg"></div>'),this.elements.content.appendChild(this.$container.get(0)),e.default.pgDialogBuild.apply(this)},hooks:{onshow:function(){}}}})}).call(this,d(1))},function(t,e,n){"use strict";(function(o){n(10),n(259),n(120),n(4),n(260),n(29);var s=e(n(2)),a=e(n(5)),l=e(n(0)),i=e(n(14)),d=e(n(3)),c=n(127);function e(e){return e&&e.__esModule?e:{default:e}}t.exports=i.default.dialog("createModeDlg",function(){return{setup:function(){return{buttons:[{text:(0,s.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times file_manager_create_cancel pg-alertify-button"},{text:(0,s.default)("Create"),key:13,className:"btn btn-primary fa fa-file file_manager_create file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},replace_file:function(){var t=(0,l.default)(".replace_file .btn_yes"),n=(0,l.default)(".replace_file .btn_no");(0,l.default)(".storage_dialog #uploader .input-path").attr("disabled",!0),(0,l.default)(".file_manager_ok").addClass("disabled"),(0,l.default)(".replace_file, .fm_dimmer").show(),t.on("click",function(){(0,l.default)(".replace_file, .fm_dimmer").hide(),t.off(),n.off();var e=(0,l.default)(".storage_dialog #uploader .input-path").val();d.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",e),(0,l.default)(".file_manager_create_cancel").trigger("click"),(0,l.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,l.default)(".file_manager_ok").removeClass("disabled")}),n.on("click",function(){(0,l.default)(".replace_file, .fm_dimmer").hide(),t.off(),n.off(),(0,l.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,l.default)(".file_manager_ok").removeClass("disabled")})},is_file_exist:function(){var e=(0,l.default)(".storage_dialog #uploader .input-path").val(),t=e.substr(0,e.lastIndexOf("/")+1),n=e.substr(e.lastIndexOf("/")+1),i=!1,r={path:t,name:n,mode:"is_file_exist"};return l.default.ajax({type:"POST",data:JSON.stringify(r),url:(0,a.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/x-download; charset=utf-8",async:!1}).done(function(e){var t=e.data.result;i=1===t.Code}),i},check_permission:function(e){var n=!1,t={path:e,mode:"permission"};return l.default.ajax({type:"POST",data:JSON.stringify(t),url:(0,a.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/json; charset=utf-8",async:!1}).done(function(e){var t=e.data.result;1===t.Code?n=!0:((0,l.default)(".file_manager_ok").addClass("disabled"),i.default.error(t.Error))}).fail(function(){(0,l.default)(".file_manager_ok").addClass("disabled"),i.default.error((0,s.default)("Error occurred while checking access permission."))}),n},callback:function(e){if(e.button.text==(0,s.default)("Create")){var t,n=(0,l.default)(".storage_dialog #uploader .input-path").val(),i={path:(0,l.default)(".currentpath").val()},r="/",a=(0,l.default)(".allowed_file_types select").val();if("win32"===(0,l.default)(".file_manager").attr("data-platform")&&(r="\\"),n.includes(".")&&!n.split(".").pop().includes(r)||"*"==a||(n=n+"."+a,(0,l.default)(".storage_dialog #uploader .input-path").val(n)),!this.check_permission(n))return void(e.cancel=!0);!o.isUndefined(n)&&""!==n&&this.is_file_exist()?(this.replace_file(),e.cancel=!0):(d.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",n),t=(0,l.default)(this.elements.body).find(".storage_content"),(0,l.default)(t).find("*").off(),t.remove(),(0,c.removeTransId)(this.trans_id)),(0,c.set_last_traversed_dir)(i,this.trans_id)}else e.button.text==(0,s.default)("Cancel")&&(t=(0,l.default)(this.elements.body).find(".storage_content"),(0,l.default)(t).find("*").off(),t.remove(),(0,c.removeTransId)(this.trans_id),d.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:create_file"))}}},!0,"fileSelectionDlg")}).call(this,n(1))},,,,,,,,,,,,function(e,t){e.exports=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.disableTriggers=function(e,t,n,i){return r(e,t,n,i,{is_enable_trigger:"D"})},t.enableTriggers=function(e,t,n,i){return r(e,t,n,i,{is_enable_trigger:"O"})};var i,o=(i=n(70))&&i.__esModule?i:{default:i};function r(n,i,e,t,r){var a=function(e,t){var n=(e||{}).item||t.selected();return t.findNodeByDomElement(n)}(t,n);if(!a||null===a.getData()||void 0===a.getData())return!1;o.default.put(e(a.getHtmlIdentifier(),"set_trigger",a.getData(),!0),r).then(function(e){1===e.data.success&&(i.success(e.data.info),a.reload(n))}).catch(function(e){try{var t=e.response.data;0===t.success&&i.error(t.errormsg)}catch(e){console.warn(e.stack||e)}a.unload(n)})}},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(21),n(26),n(27),n(19),n(7),n(32),n(12),n(24),n(49),n(22),Object.defineProperty(t,"__esModule",{value:!0}),t.show_advanced_tab=function(e){if(function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&"gpdb"===e.node_info.server.server_type}(e))return!1;return!0};var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(n(1));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}},,,,function(e,t,n){"use strict";n(24);function y(e,t){var n,i,r;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return M;if(!(n=W(t.slice(1,-1))))return M;e.host=n}else if(ie(e)){if(t=_(t),K.test(t))return M;if(null===(n=Q(t)))return M;e.host=n}else{if(G.test(t))return M;for(n="",i=E(t),r=0;r<i.length;r++)n+=te(i[r],Y);e.host=n}}function c(e){var t,n,i,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=A(e/256);return t.join(".")}if("object"!=typeof e)return e;for(t="",i=function(e){for(var t=null,n=1,i=null,r=0,a=0;a<8;a++)0!==e[a]?(n<r&&(t=i,n=r),i=null,r=0):(null===i&&(i=a),++r);return n<r&&(t=i,n=r),t}(e),n=0;n<8;n++)r&&0===e[n]||(r=r&&!1,i===n?(t+=n?":":"::",r=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}function w(e){return""!=e.username||""!=e.password}function r(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme}function x(e,t){var n;return 2==e.length&&L.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)}function S(e){var t;return 1<e.length&&x(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)}function C(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&x(t[0],!0)||t.pop()}function u(e,t,n,i){var r,a,o,s,l,d,c=n||re,u=0,f="",p=!1,h=!1,g=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace($,"")),t=t.replace(J,""),r=E(t);u<=r.length;){switch(a=r[u],c){case re:if(!a||!L.test(a)){if(n)return j;c=oe;continue}f+=a.toLowerCase(),c=ae;break;case ae:if(a&&(B.test(a)||"+"==a||"-"==a||"."==a))f+=a.toLowerCase();else{if(":"!=a){if(n)return j;f="",c=oe,u=0;continue}if(n&&(ie(e)!=T(ne,f)||"file"==f&&(w(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,n)return void(ie(e)&&ne[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?c=me:ie(e)&&i&&i.scheme==e.scheme?c=se:ie(e)?c=ue:"/"==r[u+1]?(c=le,u++):(e.cannotBeABaseURL=!0,e.path.push(""),c=xe)}break;case oe:if(!i||i.cannotBeABaseURL&&"#"!=a)return j;if(i.cannotBeABaseURL&&"#"==a){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,c=Ce;break}c="file"==i.scheme?me:de;continue;case se:if("/"!=a||"/"!=r[u+1]){c=de;continue}c=fe,u++;break;case le:if("/"==a){c=pe;break}c=we;continue;case de:if(e.scheme=i.scheme,a==k)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==a||"\\"==a&&ie(e))c=ce;else if("?"==a)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",c=Se;else{if("#"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),c=we;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Ce}break;case ce:if(!ie(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,c=we;continue}c=pe}else c=fe;break;case ue:if(c=fe,"/"!=a||"/"!=f.charAt(u+1))continue;u++;break;case fe:if("/"==a||"\\"==a)break;c=pe;continue;case pe:if("@"==a){p&&(f="%40"+f),p=!0,o=E(f);for(var _=0;_<o.length;_++){var m=o[_];if(":"!=m||g){var v=te(m,ee);g?e.password+=v:e.username+=v}else g=!0}f=""}else if(a==k||"/"==a||"?"==a||"#"==a||"\\"==a&&ie(e)){if(p&&""==f)return"Invalid authority";u-=E(f).length+1,f="",c=he}else f+=a;break;case he:case ge:if(n&&"file"==e.scheme){c=be;continue}if(":"!=a||h){if(a==k||"/"==a||"?"==a||"#"==a||"\\"==a&&ie(e)){if(ie(e)&&""==f)return M;if(n&&""==f&&(w(e)||null!==e.port))return;if(s=y(e,f))return s;if(f="",c=ye,n)return;continue}"["==a?h=!0:"]"==a&&(h=!1),f+=a}else{if(""==f)return M;if(s=y(e,f))return s;if(f="",c=_e,n==ge)return}break;case _e:if(!U.test(a)){if(a==k||"/"==a||"?"==a||"#"==a||"\\"==a&&ie(e)||n){if(""!=f){var b=parseInt(f,10);if(65535<b)return I;e.port=ie(e)&&b===ne[e.scheme]?null:b,f=""}if(n)return;c=ye;continue}return I}f+=a;break;case me:if(e.scheme="file","/"==a||"\\"==a)c=ve;else{if(!i||"file"!=i.scheme){c=we;continue}if(a==k)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==a)e.host=i.host,e.path=i.path.slice(),e.query="",c=Se;else{if("#"!=a){S(r.slice(u).join(""))||(e.host=i.host,e.path=i.path.slice(),C(e)),c=we;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Ce}}break;case ve:if("/"==a||"\\"==a){c=be;break}i&&"file"==i.scheme&&!S(r.slice(u).join(""))&&(x(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),c=we;continue;case be:if(a==k||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&x(f))c=we;else if(""==f){if(e.host="",n)return;c=ye}else{if(s=y(e,f))return s;if("localhost"==e.host&&(e.host=""),n)return;f="",c=ye}continue}f+=a;break;case ye:if(ie(e)){if(c=we,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=k&&(c=we,"/"!=a))continue}else e.fragment="",c=Ce;else e.query="",c=Se;break;case we:if(a==k||"/"==a||"\\"==a&&ie(e)||!n&&("?"==a||"#"==a)){if(".."===(d=(d=f).toLowerCase())||"%2e."===d||".%2e"===d||"%2e%2e"===d?(C(e),"/"==a||"\\"==a&&ie(e)||e.path.push("")):"."===(l=f)||"%2e"===l.toLowerCase()?"/"==a||"\\"==a&&ie(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&x(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(a==k||"?"==a||"#"==a))for(;1<e.path.length&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",c=Se):"#"==a&&(e.fragment="",c=Ce)}else f+=te(a,X);break;case xe:"?"==a?(e.query="",c=Se):"#"==a?(e.fragment="",c=Ce):a!=k&&(e.path[0]+=te(a,Y));break;case Se:n||"#"!=a?a!=k&&("'"==a&&ie(e)?e.query+="%27":e.query+="#"==a?"%23":te(a,Y)):(e.fragment="",c=Ce);break;case Ce:a!=k&&(e.fragment+=te(a,Z))}u++}}function i(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}}var k,a=n(17),f=n(43),o=n(315),s=n(34),l=n(171),d=n(60),p=n(104),T=n(52),h=n(238),E=n(255),g=n(177).codeAt,_=n(439),m=n(91),v=n(440),b=n(78),P=s.URL,O=v.URLSearchParams,N=v.getState,D=b.set,q=b.getterFor("URL"),A=Math.floor,R=Math.pow,j="Invalid scheme",M="Invalid host",I="Invalid port",L=/[A-Za-z]/,B=/[\d+\-.A-Za-z]/,U=/\d/,V=/^(0x|0X)/,z=/^[0-7]+$/,F=/^\d+$/,H=/^[\dA-Fa-f]+$/,K=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,G=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,$=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,J=/[\u0009\u000A\u000D]/g,Q=function(e){var t,n,i,r,a,o,s,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),4<(t=l.length))return e;for(n=[],i=0;i<t;i++){if(""==(r=l[i]))return e;if(a=10,1<r.length&&"0"==r.charAt(0)&&(a=V.test(r)?16:8,r=r.slice(8==a?1:2)),""===r)o=0;else{if(!(10==a?F:8==a?z:H).test(r))return e;o=parseInt(r,a)}n.push(o)}for(i=0;i<t;i++)if(o=n[i],i==t-1){if(o>=R(256,5-t))return null}else if(255<o)return null;for(s=n.pop(),i=0;i<n.length;i++)s+=n[i]*R(256,3-i);return s},W=function(e){function t(){return e.charAt(f)}var n,i,r,a,o,s,l,d=[0,0,0,0,0,0,0,0],c=0,u=null,f=0;if(":"==t()){if(":"!=e.charAt(1))return;f+=2,u=++c}for(;t();){if(8==c)return;if(":"!=t()){for(n=i=0;i<4&&H.test(t());)n=16*n+parseInt(t(),16),f++,i++;if("."==t()){if(0==i)return;if(f-=i,6<c)return;for(r=0;t();){if(a=null,0<r){if(!("."==t()&&r<4))return;f++}if(!U.test(t()))return;for(;U.test(t());){if(o=parseInt(t(),10),null===a)a=o;else{if(0==a)return;a=10*a+o}if(255<a)return;f++}d[c]=256*d[c]+a,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==t()){if(f++,!t())return}else if(t())return;d[c++]=n}else{if(null!==u)return;f++,u=++c}}if(null!==u)for(s=c-u,c=7;0!=c&&0<s;)l=d[c],d[c--]=d[u+s-1],d[u+--s]=l;else if(8!=c)return;return d},Y={},Z=h({},Y,{" ":1,'"':1,"<":1,">":1,"`":1}),X=h({},Z,{"#":1,"?":1,"{":1,"}":1}),ee=h({},X,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),te=function(e,t){var n=g(e,0);return 32<n&&n<127&&!T(t,e)?e:encodeURIComponent(e)},ne={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ie=function(e){return T(ne,e.scheme)},re={},ae={},oe={},se={},le={},de={},ce={},ue={},fe={},pe={},he={},ge={},_e={},me={},ve={},be={},ye={},we={},xe={},Se={},Ce={},ke=function(e,t){var n,i,r=p(this,ke,"URL"),a=1<arguments.length?t:void 0,o=String(e),s=D(r,{type:"URL"});if(void 0!==a)if(a instanceof ke)n=q(a);else if(i=u(n={},String(a)))throw TypeError(i);if(i=u(s,o,null,n))throw TypeError(i);var l=s.searchParams=new O,d=N(l);d.updateSearchParams(s.query),d.updateURL=function(){s.query=String(l)||null},f||(r.href=Ee.call(r),r.origin=Pe.call(r),r.protocol=Oe.call(r),r.username=Ne.call(r),r.password=De.call(r),r.host=qe.call(r),r.hostname=Ae.call(r),r.port=Re.call(r),r.pathname=je.call(r),r.search=Me.call(r),r.searchParams=Ie.call(r),r.hash=Le.call(r))},Te=ke.prototype,Ee=function(){var e=q(this),t=e.scheme,n=e.username,i=e.password,r=e.host,a=e.port,o=e.path,s=e.query,l=e.fragment,d=t+":";return null!==r?(d+="//",w(e)&&(d+=n+(i?":"+i:"")+"@"),d+=c(r),null!==a&&(d+=":"+a)):"file"==t&&(d+="//"),d+=e.cannotBeABaseURL?o[0]:o.length?"/"+o.join("/"):"",null!==s&&(d+="?"+s),null!==l&&(d+="#"+l),d},Pe=function(){var e=q(this),t=e.scheme,n=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&ie(e)?t+"://"+c(e.host)+(null!==n?":"+n:""):"null"},Oe=function(){return q(this).scheme+":"},Ne=function(){return q(this).username},De=function(){return q(this).password},qe=function(){var e=q(this),t=e.host,n=e.port;return null===t?"":null===n?c(t):c(t)+":"+n},Ae=function(){var e=q(this).host;return null===e?"":c(e)},Re=function(){var e=q(this).port;return null===e?"":String(e)},je=function(){var e=q(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Me=function(){var e=q(this).query;return e?"?"+e:""},Ie=function(){return q(this).searchParams},Le=function(){var e=q(this).fragment;return e?"#"+e:""};if(f&&l(Te,{href:i(Ee,function(e){var t=q(this),n=String(e),i=u(t,n);if(i)throw TypeError(i);N(t.searchParams).updateSearchParams(t.query)}),origin:i(Pe),protocol:i(Oe,function(e){var t=q(this);u(t,String(e)+":",re)}),username:i(Ne,function(e){var t=q(this),n=E(String(e));if(!r(t)){t.username="";for(var i=0;i<n.length;i++)t.username+=te(n[i],ee)}}),password:i(De,function(e){var t=q(this),n=E(String(e));if(!r(t)){t.password="";for(var i=0;i<n.length;i++)t.password+=te(n[i],ee)}}),host:i(qe,function(e){var t=q(this);t.cannotBeABaseURL||u(t,String(e),he)}),hostname:i(Ae,function(e){var t=q(this);t.cannotBeABaseURL||u(t,String(e),ge)}),port:i(Re,function(e){var t=q(this);r(t)||(""==(e=String(e))?t.port=null:u(t,e,_e))}),pathname:i(je,function(e){var t=q(this);t.cannotBeABaseURL||(t.path=[],u(t,e+"",ye))}),search:i(Me,function(e){var t=q(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",u(t,e,Se)),N(t.searchParams).updateSearchParams(t.query)}),searchParams:i(Ie),hash:i(Le,function(e){var t=q(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",u(t,e,Ce)):t.fragment=null})}),d(Te,"toJSON",function(){return Ee.call(this)},{enumerable:!0}),d(Te,"toString",function(){return Ee.call(this)},{enumerable:!0}),P){var Be=P.createObjectURL,Ue=P.revokeObjectURL;Be&&d(ke,"createObjectURL",function(e){return Be.apply(P,arguments)}),Ue&&d(ke,"revokeObjectURL",function(e){return Ue.apply(P,arguments)})}m(ke,"URL"),a({global:!0,forced:!o,sham:!f},{URL:ke})},function(e,t,n){var i=n(35),r=n(39),a=n(98),o=r("iterator");e.exports=!i(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),n=e.searchParams,i="";return e.pathname="c%20d",n.forEach(function(e,t){n.delete("b"),i+=t+e}),a&&!e.toJSON||!n.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==n.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!n[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==i||"x"!==new URL("http://x",void 0).host})},function(n,i,r){"use strict";(function(h){var e,t;r(10),r(40),r(18),e=[r(0),r(81),r(130)],void 0===(t=function(f,p){return function(){var e=window.Slick,t=new e.EventHandler,a=new e.Event,n=new e.Event,i=function(e,t,n){var i=n.column;if(e.focus(),d(i)){var r=f(t.target);if(l(t)){if(f(t.target).hasClass("slick-resizable-handle"))return;r=f(t.target).parents(".slick-header-column")}r.toggleClass("selected"),r.hasClass("selected")&&a.notify(n,t),t.isPropagationStopped()||t.isImmediatePropagationStopped()||s(e,i.id)}else o(e)},o=function(n){if(f(".copy-with-header").hasClass("visibility-hidden"))f(".slick-header-column").each(function(e,t){f(t).removeClass("selected")});else{var i=n.getSelectedRows();f(".slick-header-column").each(function(e,t){0==i.length?(f(t).removeClass("selected"),n.getColumns()[e].selected=!1):0<e&&n.getColumns()[e].selectable&&(f(t).addClass("selected"),n.getColumns()[e].selected=!0)})}}.bind(p),r=function(r,e,a){f(".slick-header-column").each(function(e,t){var n=f(t).find('[data-cell-type="column-header-row"]'),i=r.getColumnIndex(n.data("column-id"));c(r,a,i)?(f(t).addClass("selected"),i&&(r.getColumns()[i].selected=!0)):p.areAllRangesCompleteRows(r,a)||(f(t).removeClass("selected"),i&&(r.getColumns()[i].selected=!1))})},s=function(e,t){var n,i=e.getSelectionModel(),r=i.getSelectedRanges(),a=e.getColumnIndex(t),o=p.rangeForColumn(e,a);n=p.isRangeSelected(r,o)?p.removeRange(r,o):p.areAllRangesSingleColumns(r,e)?p.addRange(r,o):[o],i.setSelectedRanges(n)},l=function(e){return!f(e.target).hasClass("slick-header-column")},d=function(e){return!1!==e.selectable},c=function(e,t,n){var i=p.areAllRangesCompleteRows(e,t);return u(e,t,n)&&!i},u=function(e,t,n){var i=p.isRangeEntirelyWithinSelectedRanges(t,p.rangeForColumn(e,n)),r=p.isAnyCellOfColumnSelected(t,n);return i||r};f.extend(this,{init:function(e){t.subscribe(e.onHeaderClick,i.bind(null,e)),e.getSelectionModel().onSelectedRangesChanged.subscribe(r.bind(null,e)),n.subscribe(function(e,t){s(t.grid,t.column.id)})},getColumnDefinitions:function(e){return h.map(e,function(e){if(d(e)){var t="<span data-cell-type='column-header-row'        data-test='output-column-header'       data-column-id='"+e.id+"'>  <span class='column-description'>    <span class='column-name'>"+e.display_name+"</span>    <span class='column-type'>"+e.column_type+"</span>  </span></span>";return h.extend(e,{name:t})}return e})},onBeforeColumnSelectAll:a,onColumnSelectAll:n,toggleColumnHeaderForCopyHeader:o})}}.apply(i,e))||(n.exports=t)}).call(this,r(1))},function(e,t,n){"use strict";var i,r;n(40),i=[n(0),n(1),n(218),n(81),n(450)],void 0===(r=function(n,e,l,d,c){var u=function(){return!n(".copy-with-header").hasClass("visibility-hidden")},f=function(e,t){e&&n("#btn-paste-row").prop("disabled",!t)};return function(){var e=this||window,t=e.slickgrid,n=t.getColumns(),i=t.getSelectionModel().getSelectedRanges(),r=t.getData(),a=t.getSelectedRows(),o=t.CSVOptions;d.areAllRangesCompleteRows(t,i)?(e.copied_rows=a.map(function(e){return t.getDataItem(e)}),f(e.can_edit,!0)):(e.copied_rows=[],f(e.can_edit,!1));var s=c.rangesToCsv(r.getItems(),n,i,o,u());s&&l.copyTextToClipboard(s)}}.apply(t,i))||(e.exports=r)},function(e,t,n){window,e.exports=function(n){return function(n){var i={};function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"stringify",function(){return c}),n.d(t,"parse",function(){return C});var u,f,i,p,r,a,o=n(0),h=n.n(o),s=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function l(e){return e<10?"0"+e:e}function d(){return this.valueOf()}function g(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function c(e,t,n){var i;if(u="",f="","number"==typeof n)for(i=0;i<n;i+=1)f+=" ";else"string"==typeof n&&(f=n);if(p=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return function e(t,n){var i,r,a,o,s,l=u,d=n[t],c=null!=d&&(d instanceof h.a||h.a.isBigNumber(d));switch(c&&!d.isFinite()&&(d=null),d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(t)),"function"==typeof p&&(d=p.call(n,t,d)),typeof d){case"string":return c?d:g(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(u+=f,s=[],"[object Array]"===Object.prototype.toString.apply(d)){for(o=d.length,i=0;i<o;i+=1)s[i]=e(i,d)||"null";return a=0===s.length?"[]":u?"[\n"+u+s.join(",\n"+u)+"\n"+l+"]":"["+s.join(",")+"]",u=l,a}if(p&&"object"==typeof p)for(o=p.length,i=0;i<o;i+=1)"string"==typeof p[i]&&(a=e(r=p[i],d))&&s.push(g(r)+(u?": ":":")+a);else for(r in d)Object.prototype.hasOwnProperty.call(d,r)&&(a=e(r,d))&&s.push(g(r)+(u?": ":":")+a);return a=0===s.length?"{}":u?"{\n"+u+s.join(",\n"+u)+"\n"+l+"}":"{"+s.join(",")+"}",u=l,a}}("",{"":e})}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=d,Number.prototype.toJSON=d,String.prototype.toJSON=d),i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var _,m,v={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},b=function(e){throw{name:"SyntaxError",message:e,at:r,text:_}},y=function(e){return e&&e!==a&&b("Expected '"+e+"' instead of '"+a+"'"),a=_.charAt(r),r+=1,a},w=function(){var e,t="";for("-"===a&&(t="-",y("-"));a>="0"&&a<="9";)t+=a,y();if("."===a)for(t+=".";y()&&a>="0"&&a<="9";)t+=a;if("e"===a||"E"===a)for(t+=a,y(),"-"!==a&&"+"!==a||(t+=a,y());a>="0"&&a<="9";)t+=a,y();if((e=new h.a(t)).isFinite())return e;b("Bad number")},x=function(){var e,t,n,i="";if('"'===a)for(;y();){if('"'===a)return y(),i;if("\\"===a)if(y(),"u"===a){for(n=0,t=0;t<4&&(e=parseInt(y(),16),isFinite(e));t+=1)n=16*n+e;i+=String.fromCharCode(n)}else{if("string"!=typeof v[a])break;i+=v[a]}else i+=a}b("Bad string")},S=function(){for(;a&&a<=" ";)y()};function C(e,o){var t;return _=e,r=0,a=" ",t=m(),S(),a&&b("Syntax error"),"function"==typeof o?function e(t,n){var i,r,a=t[n];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(void 0!==(r=e(a,i))?a[i]=r:delete a[i]);return o.call(t,n,a)}({"":t},""):t}m=function(){switch(S(),a){case"{":return function(){var e,t={};if("{"===a){if(y("{"),S(),"}"===a)return y("}"),t;for(;a;){if(e=x(),S(),y(":"),Object.hasOwnProperty.call(t,e)&&b("Duplicate key '"+e+"'"),t[e]=m(),S(),"}"===a)return y("}"),t;y(","),S()}}b("Bad object")}();case"[":return function(){var e=[];if("["===a){if(y("["),S(),"]"===a)return y("]"),e;for(;a;){if(e.push(m()),S(),"]"===a)return y("]"),e;y(","),S()}}b("Bad array")}();case'"':return x();case"-":return w();default:return a>="0"&&a<="9"?w():function(){switch(a){case"t":return y("t"),y("r"),y("u"),y("e"),!0;case"f":return y("f"),y("a"),y("l"),y("s"),y("e"),!1;case"n":return y("n"),y("u"),y("l"),y("l"),null}b("Unexpected '"+a+"'")}()}},t.default={parse:C,stringify:c}}])}(n(451))},function(e,t,n){"use strict";e.exports={TRANSACTION_STATUS_IDLE:0,TRANSACTION_STATUS_ACTIVE:1,TRANSACTION_STATUS_INTRANS:2,TRANSACTION_STATUS_INERROR:3,TRANSACTION_STATUS_UNKNOWN:5}},function(e,t,n){"use strict";n(33);var i=a(n(0)),r=a(n(41));function a(e){return e&&e.__esModule?e:{default:e}}var o={_verbose:function(){return!(0,i.default)(".explain-verbose").hasClass("visibility-hidden")},_costsEnabled:function(){return!(0,i.default)(".explain-costs").hasClass("visibility-hidden")},_buffers:function(){return!(0,i.default)(".explain-buffers").hasClass("visibility-hidden")},_timing:function(){return!(0,i.default)(".explain-timing").hasClass("visibility-hidden")},_summary:function(){return!(0,i.default)(".explain-summary").hasClass("visibility-hidden")},_settings:function(){return!(0,i.default)(".explain-settings").hasClass("visibility-hidden")},_clearMessageTab:function(){(0,i.default)(".sql-editor-message").html("")},executeQuery:function(e){this._clearMessageTab(),e.check_data_changes_to_execute_query()},explainAnalyze:function(e){var t={format:"json",analyze:!0,verbose:this._verbose(),costs:this._costsEnabled(),buffers:this._buffers(),timing:this._timing(),summary:this._summary(),settings:this._settings()};this._clearMessageTab(),e.check_data_changes_to_execute_query(t)},explain:function(e){var t={format:"json",analyze:!1,verbose:this._verbose(),costs:this._costsEnabled(),buffers:!1,timing:!1,summary:this._summary(),settings:this._settings()};this._clearMessageTab(),e.check_data_changes_to_execute_query(t)},download:function(e){var t=e.gridView.query_tool_obj.getSelection();if(t=t||e.gridView.query_tool_obj.getValue()){var n="data-"+(new Date).getTime()+".csv";e.is_query_tool||(n=e.table_name+".csv"),e.trigger_csv_download(t,n)}},commentBlockCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.toggleComment(t.getCursor(!0),t.getCursor(!1))},commentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.lineComment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},uncommentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.uncomment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},focusOut:function(){document.activeElement.blur(),r.default.document.activeElement.blur()},toggleCaseOfSelectedText:function(e){var t=e.gridView.query_tool_obj,n=t.getSelection();n&&(n===n.toUpperCase()?t.replaceSelection(n.toLowerCase()):t.replaceSelection(n.toUpperCase()))},executeCommit:function(e){e.special_sql="COMMIT;",this.executeQuery(e)},executeRollback:function(e){e.special_sql="ROLLBACK;",this.executeQuery(e)},saveDataChanges:function(e){e.close_on_save=!1,e.save_data()}};e.exports=o},function(e,t,n){"use strict";n(7),n(37),n(87),Object.defineProperty(t,"__esModule",{value:!0}),t.calculateQueryRunTime=function(e,t){var n,i,r,a=(0,o.default)(t).diff(e);return n=parseInt(a/1e3),a%=1e3,i=parseInt(n/60),n%=60,r=parseInt(i/60),((0<r?r+" hr ":"")+(0<(i%=60)?i+" min ":"")+(r<=0&&0<n?n+" secs ":"")+(r<=0&&i<=0?a+" msec ":"")).trim()};var i,o=(i=n(118))&&i.__esModule?i:{default:i}},function(e,B,U){"use strict";(function(e){var i=U(464),a=U(465),o=U(466);function n(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"!=typeof e)return r(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}function r(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=c(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=s(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):c(e,t);if("Buffer"===t.type&&o(t.data))return c(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(i)return M(e).length;t=(""+t).toLowerCase(),i=!0}}function h(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function g(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=u.from(t,i)),u.isBuffer(t))return 0===t.length?-1:_(e,t,n,i,r);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,i,r){var a,o=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s/=o=2,l/=2,n/=2}function d(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var c=-1;for(a=n;a<s;a++)if(d(e,a)===d(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(s<n+l&&(n=s-l),a=n;0<=a;a--){for(var u=!0,f=0;f<l;f++)if(d(e,a+f)!==d(t,f)){u=!1;break}if(u)return a}return-1}function m(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?r<(i=Number(i))&&(i=r):i=r;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");a/2<i&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function v(e,t,n,i){return L(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function b(e,t,n,i){return L(function(e,t){for(var n,i,r,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,r=n%256,a.push(r),a.push(i);return a}(t,e.length-n),e,n,i)}function y(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function w(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var a,o,s,l,d=e[r],c=null,u=239<d?4:223<d?3:191<d?2:1;if(r+u<=n)switch(u){case 1:d<128&&(c=d);break;case 2:128==(192&(a=e[r+1]))&&127<(l=(31&d)<<6|63&a)&&(c=l);break;case 3:a=e[r+1],o=e[r+2],128==(192&a)&&128==(192&o)&&2047<(l=(15&d)<<12|(63&a)<<6|63&o)&&(l<55296||57343<l)&&(c=l);break;case 4:a=e[r+1],o=e[r+2],s=e[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(l=(15&d)<<18|(63&a)<<12|(63&o)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,u=1):65535<c&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=u}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=x));return n}(i)}B.Buffer=u,B.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},B.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),B.kMaxLength=n(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return r(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,i){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,a=Math.min(n,i);r<a;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;var i=u.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?w(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return w(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return y(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",t=B.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,i,r){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(r<=i&&n<=t)return 0;if(r<=i)return-1;if(n<=t)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(i,r),d=e.slice(t,n),c=0;c<s;++c)if(l[c]!==d[c]){a=l[c],o=d[c];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||r<n)&&(n=r),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var a,o,s,l,d,c,u=!1;;)switch(i){case"hex":return m(this,e,t,n);case"utf8":case"utf-8":return d=t,c=n,L(M(e,(l=this).length-d),l,d,c);case"ascii":return v(this,e,t,n);case"latin1":case"binary":return v(this,e,t,n);case"base64":return a=this,o=t,s=n,L(I(e),a,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),u=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function S(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function C(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function k(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||i<n)&&(n=i);for(var r="",a=t;a<n;++a)r+=j(e[a]);return r}function T(e,t,n){for(var i=e.slice(t,n),r="",a=0;a<i.length;a+=2)r+=String.fromCharCode(i[a]+256*i[a+1]);return r}function E(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,i,r,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<t||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function O(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-n,2);r<a;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function N(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-n,4);r<a;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function D(e,t,n,i){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,n,i,r){return r||D(e,0,n,4),a.write(e,t,n,i,23,4),n+4}function A(e,t,n,i,r){return r||D(e,0,n,8),a.write(e,t,n,i,52,8),n+8}u.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var r=t-e;n=new u(r,void 0);for(var a=0;a<r;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var i=this[e+--t],r=1;0<t&&(r*=256);)i+=this[e+--t]*r;return i},u.prototype.readUInt8=function(e,t){return t||E(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||E(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||E(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return(r*=128)<=i&&(i-=Math.pow(2,8*t)),i},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var i=t,r=1,a=this[e+--i];0<i&&(r*=256);)a+=this[e+--i]*r;return(r*=128)<=a&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||E(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||E(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||E(e,4,this.length),a.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||E(e,4,this.length),a.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||E(e,8,this.length),a.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||E(e,8,this.length),a.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||P(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,a=0;for(this[t]=255&e;++a<n&&(r*=256);)this[t+a]=e/r&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||P(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,a=1;for(this[t+r]=255&e;0<=--r&&(a*=256);)this[t+r]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);P(this,e,t,n,r-1,-r)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);P(this,e,t,n,r-1,-r)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;0<=--a&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return A(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return A(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,i){if(n=n||0,i||0===i||(i=this.length),t>=e.length&&(t=e.length),t=t||0,0<i&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,a=i-n;if(this===e&&n<t&&t<i)for(r=a-1;0<=r;--r)e[r+t]=this[r+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:M(new u(e,i).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var t=/[^+\/0-9A-Za-z-_]/g;function R(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function M(e,t){var n;t=t||1/0;for(var i=e.length,r=null,a=[],o=0;o<i;++o){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!r){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===i){-1<(t-=3)&&a.push(239,191,189);continue}r=n;continue}if(n<56320){-1<(t-=3)&&a.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&-1<(t-=3)&&a.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function I(e){return i.toByteArray(R(e))}function L(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,U(89))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,r;function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(n,!0).forEach(function(e){W(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(21),n(36),n(53),n(10),n(58),n(16),n(19),n(120),n(40),n(73),n(95),n(50),n(193),n(33),n(18),n(11),n(145),n(75),n(7),n(32),n(76),n(48),n(12),n(37),n(4),n(46),n(24),n(62),n(8),n(29),n(87),n(63),n(22),n(6),n(314),i=[n(2),n(5),n(0),n(313),n(442),n(1),n(14),n(3),n(15),n(84),n(443),n(447),n(449),n(218),n(317),n(81),n(452),n(453),n(454),n(69),n(457),n(219),n(458),n(460),n(467),n(468),n(472),n(74),n(320),n(473),n(200),n(96),n(321),n(474),n(475),n(319),n(103),n(88),n(41),n(428),n(256),n(476),n(477),n(478),n(9),n(162)],void 0===(r=function(x,u,S,e,t,C,k,f,n,i,l,T,E,r,a,o,P,O,N,D,s,p,d,q,c,h,g,_,m,v,b,y,w,A,R,j,M,I,L){if(f.SqlEditor)return f.SqlEditor;var B=window.wcDocker,U=f.Browser,V=i.default,z=window.Slick,F=c.default,H=h.default,K=g.QuerySources;M.setPGCSRFToken(f.csrf_token_header,f.csrf_token);function G(){this.initialize.apply(this,arguments)}var $=!1,J=n.View.extend({initialize:function(e){this.$el=e.el,this.handler=e.handler,this.handler.col_size={};var t=L.default.pgAdmin.Browser;this.preferences=t.get_preferences_for_module("sqleditor"),this.handler.preferences=this.preferences,this.connIntervalId=null,this.layout=e.layout},events:{"click .btn-load-file":"on_file_load","click #btn-save-file":"on_save_file","click #btn-file-menu-save":"on_save_file","click #btn-file-menu-save-as":"on_save_as","click #btn-find":"on_find","click #btn-find-menu-find":"on_find","click #btn-find-menu-find-next":"on_find_next","click #btn-find-menu-find-previous":"on_find_previous","click #btn-find-menu-replace":"on_replace","click #btn-find-menu-replace-all":"on_replace_all","click #btn-find-menu-find-persistent":"on_find_persistent","click #btn-find-menu-jump":"on_jump","click #btn-delete-row":"on_delete","click #btn-save-data":"on_save_data","click #btn-filter":"on_show_filter","click #btn-filter-menu":"on_show_filter","click #btn-include-filter":"on_include_filter","click #btn-exclude-filter":"on_exclude_filter","click #btn-remove-filter":"on_remove_filter","click #btn-cancel":"on_cancel","click #btn-copy-row":"on_copy_row","click #btn-copy-with-header":"on_copy_row_with_header","click #btn-paste-row":"on_paste_row","click #btn-flash":"on_flash","click #btn-flash-menu":"on_flash","click #btn-cancel-query":"on_cancel_query","click #btn-download":"on_download","click #btn-clear":"on_clear","click #btn-auto-commit":"on_auto_commit","click #btn-auto-rollback":"on_auto_rollback","click #btn-clear-history":"on_clear_history","click .noclose":"do_not_close_menu","click #btn-explain":"on_explain","click #btn-explain-analyze":"on_explain_analyze","click #btn-explain-verbose":"on_explain_verbose","click #btn-explain-costs":"on_explain_costs","click #btn-explain-buffers":"on_explain_buffers","click #btn-explain-timing":"on_explain_timing","click #btn-explain-summary":"on_explain_summary","click #btn-explain-settings":"on_explain_settings","change .limit":"on_limit_change",keydown:"keyAction","click #btn-comment-code":"on_toggle_comment_block_code","click #btn-toggle-comment-block":"on_toggle_comment_block_code","click #btn-comment-line":"on_comment_line_code","click #btn-uncomment-line":"on_uncomment_line_code","click #btn-indent-code":"on_indent_code","click #btn-unindent-code":"on_unindent_code","click #btn-commit":"on_commit_transaction","click #btn-rollback":"on_rollback_transaction"},reflectPreferences:function(){var e=L.default.pgAdmin.Browser;U.preference_version()<e.preference_version()&&(U.preference_version(e.preference_version()),this.preferences=e.get_preferences_for_module("sqleditor"),this.handler.preferences=this.preferences,R.updateUIPreferences(this))},buildDefaultLayout:function(e){var t=e.addPanel("sql_panel",B.DOCK.TOP);e.addPanel("scratch",B.DOCK.RIGHT,t),e.addPanel("history",B.DOCK.STACKED,t);var n=e.addPanel("data_output",B.DOCK.BOTTOM);e.addPanel("explain",B.DOCK.STACKED,n),e.addPanel("messages",B.DOCK.STACKED,n),e.addPanel("notifications",B.DOCK.STACKED,n)},set_server_version:function(e){var t=this;t.server_ver=e,this.$el.find("*[data-min-ver]").map(function(){var e=S(this);parseInt(e.attr("data-min-ver"))>t.server_ver?e.addClass("d-none"):e.removeClass("d-none")})},set_editor_title:function(e){this.$el.find(".editor-title").text(e)},render:function(){var a=this;a.gain_focus=function(){setTimeout(function(){D.updateConnectionStatusFlag("visible")},100)},a.lost_focus=function(){setTimeout(function(){D.updateConnectionStatusFlag("hidden")},100)},a.docker=new B("#editor-panel",{allowContextMenu:!0,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:u("static",{filename:"css"}),theme:"webcabin.overrides.css"});var e=new f.Browser.Panel({name:"sql_panel",title:x("Query Editor"),width:"75%",height:"33%",isCloseable:!1,isPrivate:!0}),t=new f.Browser.Panel({name:"data_output",title:x("Data Output"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,extraClasses:"hide-vertical-scrollbar",content:'<div id ="datagrid" class="sql-editor-grid-container text-12" tabindex="0"></div>'}),n=new f.Browser.Panel({name:"explain",title:x("Explain"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div class="sql-editor-explain" tabindex="0"></div>'}),i=new f.Browser.Panel({name:"messages",title:x("Messages"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div class="sql-editor-message" tabindex="0"></div>'}),r=new f.Browser.Panel({name:"history",title:x("Query History"),width:"100%",height:"33%",isCloseable:!1,isPrivate:!0,content:'<div id ="history_grid" class="sql-editor-history-container" tabindex="0"></div>'}),o=new f.Browser.Panel({name:"scratch",title:x("Scratch Pad"),width:"25%",height:"33%",isCloseable:!0,isPrivate:!1,content:'<div class="sql-scratch"><textarea wrap="off" tabindex="0"></textarea></div>'}),s=new f.Browser.Panel({name:"notifications",title:x("Notifications"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="notification_grid" class="sql-editor-notifications" tabindex="0"></div>'}),l=new f.Browser.Panel({name:"geometry_viewer",title:x("Geometry Viewer"),width:"100%",height:"100%",isCloseable:!0,isPrivate:!0,isLayoutMember:!1,content:'<div id ="geometry_viewer_panel" class="sql-editor-geometry-viewer" tabindex="0"></div>'});e.load(a.docker),t.load(a.docker),n.load(a.docker),i.load(a.docker),r.load(a.docker),o.load(a.docker),s.load(a.docker),l.load(a.docker),U.restore_layout(a.docker,this.layout,this.buildDefaultLayout.bind(this)),a.docker.on(B.EVENT.LAYOUT_CHANGED,function(){U.save_current_layout("SQLEditor/Layout",a.docker)}),a.sql_panel_obj=a.docker.findPanels("sql_panel")[0],a.history_panel=a.docker.findPanels("history")[0],a.data_output_panel=a.docker.findPanels("data_output")[0],a.explain_panel=a.docker.findPanels("explain")[0],a.messages_panel=a.docker.findPanels("messages")[0],a.notifications_panel=a.docker.findPanels("notifications")[0],a.sql_panel_obj.on(B.EVENT.RESIZE_ENDED,function(){setTimeout(function(){a&&a.query_tool_obj&&a.query_tool_obj.refresh()},200)}),a.render_history_grid(),U.Events.on("pgadmin:query_tool:connected:"+a.handler.transId,function(){a.fetch_query_history()}),v.renderNotificationsGrid(a.notifications_panel);var d=S('<textarea id="sql_query_tool" tabindex="-1"></textarea>'),c=S('<div id="output-panel" tabindex="0"></div>').append(d);a.sql_panel_obj.$container.find(".pg-panel-content").append(c),a.query_tool_obj=V.fromTextArea(d.get(0),{tabindex:"0",lineNumbers:!0,styleSelectedText:!0,mode:"gpdb"===a.handler.server_type?"text/x-gpsql":"text/x-pgsql",foldOptions:{widget:""},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:U.editor_shortcut_keys,scrollbarStyle:"simple",dragDrop:!1}),a.handler.is_query_tool&&(a.query_tool_obj.setOption("dragDrop",!0),a.query_tool_obj.on("drop",function(e,t){var n=null;try{n=JSON.parse(t.dataTransfer.getData("text")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}catch(e){return}var i=e.coordsChar({left:t.x,top:t.y});e.replaceRange(n.text,i),e.focus(),e.setSelection(Q({},i,{ch:i.ch+n.cur.from}),Q({},i,{ch:i.ch+n.cur.to}))})),U.Events.on("pgadmin:query_tool:sql_panel:focus",function(){a.query_tool_obj.focus()}),a.preferences.new_browser_tab||(C.each(L.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(e){e.isVisible()&&(e.on(B.EVENT.CLOSING,function(){return a.handler.check_needed_confirmations_before_closing_panel(!0)}),e.on(B.EVENT.GAIN_FOCUS,function(){var e=S(this.$container),t=a.handler.transId;e.hasClass("wcPanelTabContentHidden")||(setTimeout(function(){a.handler.gridView.query_tool_obj.focus()},200),U.Events.trigger("pgadmin:query_tool:panel:gain_focus:"+t))}),e.on(B.EVENT.LOST_FOCUS,function(){var e=S(this.$container),t=a.handler.transId;e.hasClass("wcPanelTabContentHidden")&&U.Events.trigger("pgadmin:query_tool:panel:lost_focus:"+t)}))}),U.Events.on("pgadmin:query_tool:panel:gain_focus:"+a.handler.transId,a.gain_focus,a),U.Events.on("pgadmin:query_tool:panel:lost_focus:"+a.handler.transId,a.lost_focus,a)),setTimeout(function(){a.query_tool_obj.focus()},500),V.registerHelper("hint","sql",function(e){var t=[],n=e.getDoc(),l=n.getCursor(),i=l.ch,r={editor:e,url:u("sqleditor.autocomplete",{trans_id:a.transId}),data:t,current_line:l.line,hint_render:function(e,t,n){var i=document.createElement("span");switch(n.type){case"database":i.className="sqleditor-hint pg-icon-"+n.type;break;case"datatype":i.className="sqleditor-hint icon-type";break;case"keyword":i.className="fa fa-key";break;case"table alias":i.className="fa fa-at";break;default:i.className="sqleditor-hint icon-"+n.type}i.appendChild(document.createTextNode(n.text)),e.appendChild(i)}};return t.push(n.getValue()),t.push(n.getRange({line:0,ch:0},{line:r.current_line,ch:i})),{then:function(o){var s=this;S.ajax({url:s.url,method:"POST",contentType:"application/json",data:JSON.stringify(s.data)}).done(function(e){var n=[];C.each(e.data.result,function(e,t){n.push({text:t,type:e.object_type,render:s.hint_render})}),n.sort(function(e,t){var n=e.text.toLowerCase(),i=t.text.toLowerCase();return n<i?-1:i<n?1:0});var t,i,r,a=s.editor.getTokenAt(l);a.end>l.ch&&(a.end=l.ch,a.string=a.string.slice(0,l.ch-a.start)),a.string.match(/^[.`\w@]\w*$/)?(r=a.string,t=a.start,i=a.end):(t=i=l.ch,r=""),"."!=r.charAt(0)&&"``"!=r.charAt(0)||(t+=1),o({list:n,from:{line:s.current_line,ch:t},to:{line:s.current_line,ch:i}})}).fail(function(e){return p.handleLoginRequiredAndTransactionRequired(f,s,e,null,[],!1)})}.bind(r)}}),S(".dropdown-submenu").on("mouseenter",function(){var e=S(this).find("ul.dropdown-menu");if(S(e).offset().left+e.width()>S(window).width()){var t=-S(e).width();e.css("left",t)}}).on("mouseleave",function(){S(this).find("ul.dropdown-menu").css("left","")}),a.reflectPreferences(),a.preferences.auto_commit?S(".auto-commit").removeClass("visibility-hidden"):S(".auto-commit").addClass("visibility-hidden"),a.preferences.auto_rollback?S(".auto-rollback").removeClass("visibility-hidden"):S(".auto-rollback").addClass("visibility-hidden"),L.default.pgAdmin.Browser.onPreferencesChange("sqleditor",function(){a.reflectPreferences()}),a.preferences.new_browser_tab&&(U.bind_beforeunload(),setInterval(function(){L.default.pgAdmin&&a.reflectPreferences()},1e3))},render_grid:function(e,t,n,i,r){var l=this;l.handler.numberOfModifiedCells=0,l.handler.reset_data_store(),l.handler.rows_to_disable=new Array,l.handler.temp_new_rows=new Array,l.handler.primary_keys_data={},l.client_primary_key=i,l.client_primary_key_counter=0,l.handler.slickgrid&&l.handler.slickgrid.destroy(),C.isArray(e)&&C.size(e)||(e=[]);var a,o=[],s=l.handler.col_size,d=l.handler.query,c=d.match(/select.*from\s+\w+\.*(\w+)/i);a=c?c[1]:D.getHash(d),l.handler.table_name=a,s[a]=s[a]||{},C.each(t,function(e){e.display_name=C.escape(e.display_name),e.column_type=C.escape(e.column_type);var t={id:e.name,pos:e.pos,field:e.name,name:e.label,display_name:e.display_name,column_type:e.column_type,column_type_internal:e.column_type_internal,cell:e.cell,not_null:e.not_null,has_default_val:e.has_default_val,is_array:e.is_array,can_edit:e.can_edit},n=e.column_type.trim(),i=e.name.length>n.length?C.escape(e.display_name):n;if(C.isUndefined(s[a][e.name])?(t.width=D.calculateColumnWidth(i),s[a][e.name]=t.width):t.width=s[a][e.name],"oid"==e.cell&&"oid"==e.name?t.editor=null:"Json"==e.cell?(t.editor=e.can_edit?z.Editors.JsonText:z.Editors.ReadOnlyJsonText,t.formatter=z.Formatters.JsonString):"number"==e.cell||"oid"==e.cell||-1!==S.inArray(e.type,["xid","real"])?(t.editor=e.can_edit?z.Editors.CustomNumber:z.Editors.ReadOnlyText,t.formatter=z.Formatters.Numbers):"boolean"==e.cell?(t.editor=e.can_edit?z.Editors.Checkbox:z.Editors.ReadOnlyCheckbox,t.formatter=z.Formatters.Checkmark):"binary"==e.cell?t.formatter=z.Formatters.Binary:"geometry"==e.cell||"geography"==e.cell?(t.width+=28,t.can_edit=!1):(t.editor=e.can_edit?z.Editors.pgText:z.Editors.ReadOnlypgText,t.formatter=z.Formatters.Text),!C.isUndefined(e.can_edit)){t.width+=12;var r="";r=e.can_edit?x("Editable column"):x("Read-only column"),t.toolTip=r}o.push(t)});var u=new T;o=l.grid_columns=u.getColumnDefinitions(o),C.each(o,function(e){"geometry"!=e.column_type_internal&&"geography"!=e.column_type_internal||q.add_header_button(e),C.isUndefined(e.can_edit)||D.addEditableIcon(e,e.can_edit)}),r&&(o[0].width=D.calculateColumnWidth(r));var f={editable:!0,enableAddRow:n,enableCellNavigation:!0,enableColumnReorder:!1,asyncEditorLoading:!1,autoEdit:!1},p=S("#datagrid"),h=S(this.data_output_panel.$container.parent().parent()).height()-35;p.height(h);var g=l.dataView=new z.Data.DataView,_=l.grid=new z.Grid(p,g,o,f);g.getItemMetadata=function(e){var t="",n=l.handler.data_store;return C.has(l.handler,"data_store")&&(e in n.added_index&&n.added_index[e]in n.added?(t="new_row",n.added[n.added_index[e]].err&&(t+=" error")):e in n.updated_index&&e in n.updated&&(t="updated_row",n.updated[n.updated_index[e]].err&&(t+=" error"))),!C.isUndefined(l.handler.rows_to_disable)&&0<l.handler.rows_to_disable.length&&-1!==C.indexOf(l.handler.rows_to_disable,e)&&(t+=" disabled_row"),{cssClasses:t}},_.registerPlugin(new z.AutoTooltips({enableForHeaderCells:!1})),_.registerPlugin(new E),_.setSelectionModel(new O),_.registerPlugin(u),_.registerPlugin(new z.AutoColumnSize);var m=new z.Plugins.HeaderButtons;m.onCommand.subscribe(function(e,t){if("view-geometries"===t.command){var n=t.grid.getColumns(),i=n.indexOf(t.column),r=t.grid.getSelectedRows();if(0===r.length)if(l.handler.has_more_rows)l.fetch_next_all(function(){u.onGridSelectAll.notify(t,new z.EventData);var e=t.grid.getData().getItems();q.render_geometries(l.handler,e,n,i)});else{u.onGridSelectAll.notify(t,new z.EventData);var a=t.grid.getData().getItems();q.render_geometries(l.handler,a,n,i)}else{var o=t.grid.getData().getItems(),s=C.map(r,function(e){return o[e]});q.render_geometries(l.handler,s,n,i)}}}),_.registerPlugin(m);var v={keys:C.isEmpty(l.handler.primary_keys)&&l.handler.has_oids?l.handler.oids:l.handler.primary_keys,vals:e,columns:t,grid:_,selection:_.getSelectionModel(),editor:l,client_primary_key:l.client_primary_key,has_oids:l.handler.has_oids};l.handler.slickgrid=_,l.handler.slickgrid.CSVOptions={quoting:l.preferences.results_grid_quoting,quote_char:l.preferences.results_grid_quote_char,field_separator:l.preferences.results_grid_field_separator},v.selection&&v.selection.onSelectedRangesChanged.subscribe(N.bind(v)),_.onColumnsResized.subscribe(function(){var e=this.getColumns();C.each(e,function(e){l.handler.col_size[l.handler.table_name][e.id]=e.width})}.bind(_)),u.onBeforeGridSelectAll.subscribe(function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all(function(){u.onGridSelectAll.notify(t,new z.EventData)}))}),u.onBeforeGridColumnSelectAll.subscribe(function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all(function(){u.onGridColumnSelectAll.notify(t,new z.EventData)}))}),g.onRowCountChanged.subscribe(function(){_.updateRowCount(),_.render()}),g.onRowsChanged.subscribe(function(e,t){_.invalidateRows(t.rows),_.render()}),_.onBeforeEditCell.subscribe(function(e,t){if("bytea"==t.column.column_type_internal||"bytea[]"==t.column.column_type_internal)return!1;var n=t.item;if(l.handler.rows_to_disable&&C.contains(l.handler.rows_to_disable,t.row))return!1;if(l.handler.can_edit&&n&&l.client_primary_key in n){var i=n[l.client_primary_key],r=l.handler.primary_keys,a={};if(i in l.handler.primary_keys_data)return;C.each(r,function(e,t){a[t]=n[t]}),l.handler.primary_keys_data[i]=a}}),_.onKeyDown.subscribe(function(e,t){var n=e.keyCode;(e.ctrlKey||e.metaKey)&&65==n&&l.handler.has_more_rows?l.fetch_next_all(function(){P(e,t)}):P(e,t)}),_.onCellChange.subscribe(function(e,t){var n=t.grid.getColumns()[t.cell].field,i=t.item[n],r=t.item[l.client_primary_key]||null,a={};l.handler.numberOfModifiedCells++,t.grid.addCellCssStyles(l.handler.numberOfModifiedCells,W({},t.row,W({},n,"highlighted_grid_cells")));var o=t.grid.getDataItem(t.row);if(l.primary_keys&&C.all(C.values(C.pick(o,l.primary_keys)),function(e){return null!=e})&&l.handler.temp_new_rows){var s=l.handler.temp_new_rows.indexOf(t.row);-1<s&&l.handler.temp_new_rows.splice(s,1)}a[n]=i,r&&(r in l.handler.data_store.added?(C.extend(l.handler.data_store.added[r].data,a),l.handler.data_store.added[r].err=!1):r in l.handler.data_store.updated?(C.extend(l.handler.data_store.updated[r].data,a),l.handler.data_store.updated[r].err=!1):(l.handler.data_store.updated[r]={err:!1,data:a,primary_keys:l.handler.primary_keys_data[r]},l.handler.data_store.updated_index[t.row]=r)),S("#btn-save-data").prop("disabled",!1)}.bind(v)),_.onAddNewRow.subscribe(function(e,t){var n=t.column,i=t.item,r=this.grid.getDataLength(),a=(l.client_primary_key_counter++).toString(),o=this.grid.getData();C.isUndefined(i[0])&&l.handler.temp_new_rows.push(r),i&&(i[l.client_primary_key]=a),o.addItem(i),l.handler.data_store.added[a]={err:!1,data:i},l.handler.data_store.added_index[r]=a;({})[n.name]=C.where(this.columns,{pos:n.pos})[0].type,_.updateRowCount(),_.render();var s=o.getRowByItem(i);l.handler.numberOfModifiedCells++,t.grid.addCellCssStyles(l.handler.numberOfModifiedCells,W({},s,W({},n.field,"highlighted_grid_cells"))),S("#btn-save-data").prop("disabled",!1)}.bind(v)),_.onViewportChanged.subscribe(function(e,t){var n=t.grid.getRenderedRange(),i=t.grid.getDataLength();l.handler.has_more_rows&&!l.handler.fetching_rows&&n.bottom>i-100&&setTimeout(l.fetch_next.bind(l))}),_.onValidationError.subscribe(function(e,t){k.error(t.validationResults.msg)}),S(window).resize(function(){l.data_output_panel.isVisible()&&l.grid_resize(_)}),l.data_output_panel.on(B.EVENT.RESIZE_ENDED,function(){l.data_output_panel.isVisible()&&l.grid_resize(_)}),l.data_output_panel.on(B.EVENT.VISIBILITY_CHANGED,function(){l.data_output_panel.isVisible()&&l.grid_resize(_)});for(var b=0;b<e.length;b++){for(var y={},w=1;w<o.length;w++)y[o[w].field]=e[b][o[w].pos];y[l.client_primary_key]=(l.client_primary_key_counter++).toString(),e[b]=y}g.setItems(e,l.client_primary_key)},fetch_next_all:function(e){this.fetch_next(!0,e)},fetch_next:function(e,n){var i=this,t="";i.handler.fetching_rows=!0,S("#btn-flash").prop("disabled",!0),S("#btn-download").prop("disabled",!0),t=e?(i.handler.trigger("pgadmin-sqleditor:loading-icon:show",x("Fetching all records...")),u("sqleditor.fetch_all",{trans_id:i.transId,fetch_all:1})):u("sqleditor.fetch",{trans_id:i.transId}),S.ajax({url:t,method:"GET"}).done(function(e){i.handler.has_more_rows=e.data.has_more_rows,S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),i.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),i.update_grid_data(e.data.result),i.handler.fetching_rows=!1,"function"==typeof n&&n()}).fail(function(e){S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),i.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),i.handler.has_more_rows=!1,i.handler.fetching_rows=!1,"function"==typeof n&&n();var t=p.handleQueryToolAjaxError(f,i,e,null,[],!1);i.update_msg_history(!1,t)})},update_grid_data:function(e){this.dataView.beginUpdate();for(var t=0;t<e.length;t++){for(var n={},i=1;i<this.grid_columns.length;i++)n[this.grid_columns[i].field]=e[t][this.grid_columns[i].pos];n[this.client_primary_key]=(this.client_primary_key_counter++).toString(),this.dataView.addItem(n)}this.dataView.endUpdate()},grid_resize:function(e){var t=S("#datagrid").height(),n=S(this.data_output_panel.$container.parent().parent()).height()-35,i=e.getViewport(),r=e.getRenderedRange(),a=e.getActiveCell();t!=n&&S("#datagrid").css({height:n+"px"}),e.resizeCanvas(),a&&e.scrollCellIntoView(a.row,a.cell),i.top!=r.top&&(i.bottom-2==r.bottom?e.scrollRowIntoView(i.bottom):e.scrollRowIntoView(i.bottom-2))},fetch_query_history:function(){var n=this;S.ajax({url:u("sqleditor.get_query_history",{trans_id:n.handler.transId}),method:"GET",contentType:"application/json"}).done(function(e){e.data.result.map(function(e){var t=JSON.parse(e);t.start_time=new Date(t.start_time),n.history_collection.add(t)})}).fail(function(){})},render_history_grid:function(){var t=this;t.history_collection||(t.history_collection=new F([])),t.historyComponent||(t.historyComponent=new H(S("#history_grid"),t.history_collection),t.historyComponent.onCopyToEditorClick(function(e){t.query_tool_obj.setValue(e),t.sql_panel_obj.focus(),setTimeout(function(){t.query_tool_obj.focus(),t.query_tool_obj.setCursor(t.query_tool_obj.lineCount(),0)},100)}),t.historyComponent.render(),t.history_panel.off(B.EVENT.VISIBILITY_CHANGED),t.history_panel.on(B.EVENT.VISIBILITY_CHANGED,function(){t.history_panel.isVisible()&&setTimeout(function(){t.historyComponent.focus()},100)})),t.handler.is_query_tool||t.historyComponent.setEditorPref({copy_to_editor:!1})},on_delete:function(){this.handler.trigger("pgadmin-sqleditor:button:deleterow",this,this.handler)},_stopEventPropogation:function(e){(e=e||window.event).cancelBubble=!0,e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},_closeDropDown:function(e){var t=e&&(e.currentTarget||e.target);t&&S(t).closest(".editor-toolbar").find(".show").removeClass("show")},on_save_file:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.close_on_save=!1,this.handler.trigger("pgadmin-sqleditor:button:save_file")},on_save_as:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.close_on_save=!1,this.handler.trigger("pgadmin-sqleditor:button:save_file",this,this.handler,!0)},on_find:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("find")},on_find_next:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findNext")},on_find_previous:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findPrev")},on_replace:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("replace")},on_replace_all:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("replaceAll")},on_find_persistent:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("findPersistent")},on_jump:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.query_tool_obj.execCommand("jumpToLine")},on_show_filter:function(){this.handler.trigger("pgadmin-sqleditor:button:show_filter",this,this.handler)},on_include_filter:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.trigger("pgadmin-sqleditor:button:include_filter",this,this.handler)},on_exclude_filter:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.trigger("pgadmin-sqleditor:button:exclude_filter",this,this.handler)},on_remove_filter:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.trigger("pgadmin-sqleditor:button:remove_filter",this,this.handler)},on_cancel:function(){S("#filter").addClass("d-none"),S("#editor-panel").removeClass("sql-editor-busy-fetching")},on_copy_row:function(){this.handler.trigger("pgadmin-sqleditor:button:copy_row",this,this.handler)},on_copy_row_with_header:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:copy_row_with_header",this,this.handler)},on_paste_row:function(){this.handler.trigger("pgadmin-sqleditor:button:paste_row",this,this.handler)},on_limit_change:function(){this.handler.trigger("pgadmin-sqleditor:button:limit",this,this.handler)},on_save_data:function(){this.handler.history_query_source=K.SAVE_DATA,m.saveDataChanges(this.handler)},on_flash:function(){var e=S("#btn-flash").attr("data-click-counter");e=(parseInt(e)+1)%10,S("#btn-flash").attr("data-click-counter",e),this.handler.history_query_source=K.EXECUTE,m.executeQuery(this.handler)},on_cancel_query:function(){this.handler.trigger("pgadmin-sqleditor:button:cancel-query",this,this.handler)},on_comment_line_code:function(){m.commentLineCode(this.handler)},on_uncomment_line_code:function(){m.uncommentLineCode(this.handler)},on_toggle_comment_block_code:function(){m.commentBlockCode(this.handler)},on_indent_code:function(){this.handler.trigger("pgadmin-sqleditor:indent_selected_code",this,this.handler)},on_unindent_code:function(){this.handler.trigger("pgadmin-sqleditor:unindent_selected_code",this,this.handler)},on_clear:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.is_query_changed?k.confirm(x("Unsaved changes"),x("Are you sure you wish to discard the current changes?"),function(){t.query_tool_obj.setValue(""),setTimeout(function(){t.query_tool_obj.focus()},200)},function(){return!0}).set("labels",{ok:x("Yes"),cancel:x("No")}):t.query_tool_obj.setValue("")},on_clear_history:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.history_collection.length()&&k.confirm(x("Clear history"),x("Are you sure you wish to clear the history?")+"</br>"+x("This will remove all of your query history from this and other sessions for this database."),function(){t.history_collection&&t.history_collection.reset(),t.handler.is_query_tool&&S.ajax({url:u("sqleditor.clear_query_history",{trans_id:t.handler.transId}),method:"DELETE",contentType:"application/json"}).done(function(){}).fail(function(){}),setTimeout(function(){t.query_tool_obj.focus()},200)},function(){return!0}).set("labels",{ok:x("Yes"),cancel:x("No")})},on_auto_commit:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:auto_commit",this,this.handler)},on_auto_rollback:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:auto_rollback",this,this.handler)},on_explain:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.history_query_source=K.EXPLAIN,m.explain(this.handler)},on_explain_analyze:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.history_query_source=K.EXPLAIN_ANALYZE,m.explainAnalyze(this.handler)},on_explain_verbose:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-verbose",this,this.handler)},on_explain_costs:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-costs",this,this.handler)},on_explain_buffers:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-buffers",this,this.handler)},on_explain_timing:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-timing",this,this.handler)},on_explain_summary:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-summary",this,this.handler)},on_explain_settings:function(e){this._stopEventPropogation(e),this.handler.trigger("pgadmin-sqleditor:button:explain-settings",this,this.handler)},do_not_close_menu:function(e){e.stopPropagation()},on_file_load:function(e){this._stopEventPropogation(e),this._closeDropDown(e),this.handler.trigger("pgadmin-sqleditor:button:load_file",this,this.handler)},on_download:function(){m.download(this.handler)},keyAction:function(e){var t;t=_.processEventQueryTool(this.handler,m,e,this.docker),C.isNull(t)||C.isUndefined(t)||""==t||setTimeout(function(){U.Events.trigger("pgadmin:query_tool:".concat(t,":focus"))},100)},on_commit_transaction:function(){this.handler.close_on_idle_transaction=!1,this.handler.history_query_source=K.COMMIT,m.executeCommit(this.handler)},on_rollback_transaction:function(){this.handler.close_on_idle_transaction=!1,this.handler.history_query_source=K.ROLLBACK,m.executeRollback(this.handler)}});return C.extend(G.prototype,n.Events,{initialize:function(e){var n=this;this.container=e,this.state={},this.csrf_token=f.csrf_token,y.modifyAlertifyAnimation(),k.dlgGetServerPass||k.dialog("dlgGetServerPass",function(){return{main:function(e,t){this.set("title",e),this.setting("message",t)},setup:function(){return{buttons:[{text:x("OK"),key:13,className:"btn btn-primary"},{text:x("Cancel"),key:27,className:"btn btn-danger"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},settings:{message:null},prepare:function(){this.setContent(this.setting("message"))},callback:function(e){if(e.button.text==x("OK")){var t=S(this.elements.content).find("#frmPassword").serialize();n.init_connection(!1,t)}}}}),this.on("pgadmin-datagrid:transaction:created",function(e){n.transId=e.gridTransId,n.warn_before_continue()}),U.Events.on("pgadmin:user:logged-in",function(){n.initTransaction()})},saveState:function(e,t){this.state=e?{fn:e,args:t}:{}},initTransaction:function(){var e,i=this;i.is_query_tool?(e="datagrid.initialize_query_tool",i.url_params.did&&(e="datagrid.initialize_query_tool_with_did")):e="datagrid.initialize_datagrid";var t=u(e,Q({},i.url_params,{trans_id:i.transId}));S.ajax({url:t,type:"POST",data:i.is_query_tool?null:JSON.stringify(i.url_params.sql_filter),contentType:"application/json"}).done(function(e){U.Events.trigger("pgadmin:query_tool:connected:"+i.transId,e.data)}).fail(function(e,t,n){U.Events.trigger("pgadmin:query_tool:connected_fail:"+i.transId,e,n)})},handle_connection_lost:function(e,t){void 0!==t.responseJSON&&t.responseJSON.data&&!t.responseJSON.data.conn_id?this.init_connection(e):void 0!==t.data&&t.data.data&&!t.data.data.conn_id?this.init_connection(e):this.warn_before_continue()},handle_cryptkey_missing:function(){var e=this;U.set_master_password("",function(){e.warn_before_continue()})},warn_before_continue:function(){var n=this;k.confirm(x("Connection Warning"),'<p style="float:left"><span class="fa fa-exclamation-triangle warn-icon" aria-hidden="true"></span></p><p style="display: inline-block;"><span class="warn-header">'+x("The application has lost the database connection:")+'</span><br><span class="warn-body">'+x(" If the connection was idle it may have been forcibly disconnected.")+"<br>"+x(" The application server or database server may have been restarted.")+"<br>"+x(" The user session may have timed out.")+'</span><br><span class="warn-footer">'+x("Do you want to continue and establish a new session?")+"</span></p>",function(){if("fn"in n.state){var e=n.state.fn,t=n.state.args;n.saveState(),-1==t.indexOf("connect")&&t.push("connect"),n[e].apply(n,t)}},function(){n.saveState()}).set({labels:{ok:x("Continue"),cancel:x("Cancel")}})},init_connection:function(i,e){var r=this;S.post(u("NODE-server.connect_id",{gid:this.url_params.sgid,sid:this.url_params.sid}),e).done(function(e){if(1==e.success)if(k.success(e.info),i)r.initTransaction();else if("fn"in r.state){var t=r.state.fn,n=r.state.args;r.saveState(),r[t].apply(r,n)}}).fail(function(e){var t=p.handleQueryToolAjaxError(f,r,e,null,[],!1);k.dlgGetServerPass(x("Connect to Server"),t)})},start:function(e,t,n){var i=this;if(i.is_query_tool="true"===t.is_query_tool,i.rows_affected=0,i.marked_line_no=0,i.has_more_rows=!1,i.fetching_rows=!1,i.close_on_save=!1,i.close_on_idle_transaction=!1,i.last_transaction_status=-1,i.server_type=t.server_type,i.url_params=t,i.is_transaction_buttons_disabled=!0,!i.gridView){i.gridView=new J({el:i.container,handler:i,layout:n}),i.transId=i.gridView.transId=e,i.gridView.current_file=void 0,i.gridView.render(),i.trigger("pgadmin-sqleditor:loading-icon:hide"),i.gridView.set_editor_title("(".concat(x("Obtaining connection...")," ").concat(C.unescape(t.title)));var r=function(){(i.is_query_tool?["#btn-flash","#btn-explain","#btn-explain-analyze"]:["#btn-flash"]).forEach(function(e){S(e).prop("disabled",!1)}),S("#btn-conn-status i").removeClass("obtaining-conn"),i.gridView.set_editor_title(C.unescape(t.title))};if(U.Events.on("pgadmin:query_tool:connected:"+e,r),U.Events.on("pgadmin:query_tool:connected_fail:"+e,r),U.Events.on("pgadmin:query_tool:connected:"+e,function(e){i.gridView.set_server_version(e.serverVersion)}),U.Events.on("pgadmin:query_tool:connected_fail:"+e,function(e,t){k.pgRespErrorNotify(e,t)}),i.initTransaction(),S(window).on("keydown",function(e){0===S(".sql-editor").find(e.target).length&&e.target!=S("body.wcDesktop")[0]||!i.gridView.keyAction||i.gridView.keyAction(e)}),i.is_query_tool)t.query_url?S.ajax({url:t.query_url,type:"GET"}).done(function(e){i.gridView.query_tool_obj.refresh(),e&&""!==e&&i.gridView.query_tool_obj.setValue(e),i.init_events()}).fail(function(e){var t;i.init_events(),t=p.handleQueryToolAjaxError(f,i,e,null,[],!1),U.report_error(x("Error fetching SQL for script: %s.",t))}):i.init_events();else{i.init_events(),i.gridView.query_tool_obj.setOption("readOnly",!0);var a=i.gridView.query_tool_obj.getWrapperElement();a&&(a.className+=" bg-gray-lighter opacity-5 hide-cursor-workaround"),i.disable_tool_buttons(!0),U.Events.on("pgadmin:query_tool:connected:"+e,function(){i.check_data_changes_to_execute_query()})}}},init_events:function(){var e=this;f.Browser.Events.on("pgadmin-storage:finish_btn:select_file",e._select_file_handler,e),f.Browser.Events.on("pgadmin-storage:finish_btn:create_file",e._save_file_handler,e),e.is_query_tool&&e.gridView.query_tool_obj.on("change",e._on_query_change.bind(e)),e.on("pgadmin-sqleditor:button:load_file",e._load_file,e),e.on("pgadmin-sqleditor:button:save_file",e._save_file,e),e.on("pgadmin-sqleditor:button:deleterow",e._delete,e),e.on("pgadmin-sqleditor:button:show_filter",e._show_filter,e),e.on("pgadmin-sqleditor:button:include_filter",e._include_filter,e),e.on("pgadmin-sqleditor:button:exclude_filter",e._exclude_filter,e),e.on("pgadmin-sqleditor:button:remove_filter",e._remove_filter,e),e.on("pgadmin-sqleditor:button:copy_row",e._copy_row,e),e.on("pgadmin-sqleditor:button:copy_row_with_header",e._copy_row_with_header,e),e.on("pgadmin-sqleditor:button:paste_row",e._paste_row,e),e.on("pgadmin-sqleditor:button:limit",e._set_limit,e),e.on("pgadmin-sqleditor:button:cancel-query",e._cancel_query,e),e.on("pgadmin-sqleditor:button:auto_rollback",e._auto_rollback,e),e.on("pgadmin-sqleditor:button:auto_commit",e._auto_commit,e),e.on("pgadmin-sqleditor:button:explain-verbose",e._explain_verbose,e),e.on("pgadmin-sqleditor:button:explain-costs",e._explain_costs,e),e.on("pgadmin-sqleditor:button:explain-buffers",e._explain_buffers,e),e.on("pgadmin-sqleditor:button:explain-timing",e._explain_timing,e),e.on("pgadmin-sqleditor:button:explain-summary",e._explain_summary,e),e.on("pgadmin-sqleditor:button:explain-settings",e._explain_settings,e),e.on("pgadmin-sqleditor:indent_selected_code",e._indent_selected_code,e),e.on("pgadmin-sqleditor:unindent_selected_code",e._unindent_selected_code,e)},check_data_changes_to_execute_query:function(e,t){var n=0<arguments.length&&void 0!==e?e:null,i=1<arguments.length&&void 0!==t&&t,r=this;C.has(r,"data_store")&&(C.size(r.data_store.added)||C.size(r.data_store.updated)||C.size(r.data_store.deleted))?k.confirm(x("Unsaved changes"),x("The data has been modified, but not saved. Are you sure you wish to discard the changes?"),function(){r.is_query_tool?r._execute_sql_query(n,i):r._execute_view_data_query()},function(){return!0}).set("labels",{ok:x("Yes"),cancel:x("No")}):r.is_query_tool?r._execute_sql_query(n,i):r._execute_view_data_query()},_execute_view_data_query:function(){var n=this,e=u("sqleditor.view_data_start",{trans_id:n.transId});n.query_start_time=new Date,n.rows_affected=0,n._init_polling_flags(),n.has_more_rows=!1,n.fetching_rows=!1,n.trigger("pgadmin-sqleditor:loading-icon:show",x("Running query...")),S("#btn-flash").prop("disabled",!0),S("#btn-download").prop("disabled",!0),n.trigger("pgadmin-sqleditor:loading-icon:message",x("Waiting for the query to complete...")),0<arguments.length&&"connect"==arguments[arguments.length-1]&&(e+="?connect=1"),S.ajax({url:e,method:"GET"}).done(function(e){e.data.status?(n.can_edit=e.data.can_edit,n.can_filter=e.data.can_filter,n.info_notifier_timeout=e.data.info_notifier_timeout,n.gridView.query_tool_obj.setValue(e.data.sql),n.query=e.data.sql,n.can_filter&&e.data.filter_applied?(S("#btn-filter").removeClass("btn-secondary"),S("#btn-filter-dropdown").removeClass("btn-secondary"),S("#btn-filter").addClass("btn-primary"),S("#btn-filter-dropdown").addClass("btn-primary")):(S("#btn-filter").removeClass("btn-primary"),S("#btn-filter-dropdown").removeClass("btn-primary"),S("#btn-filter").addClass("btn-secondary"),S("#btn-filter-dropdown").addClass("btn-secondary")),S("#btn-copy-row").prop("disabled",!0),S("#btn-paste-row").prop("disabled",!0),S(".limit").val(e.data.limit),n._poll()):(n.trigger("pgadmin-sqleditor:loading-icon:hide"),n.update_msg_history(!1,e.data.result))}).fail(function(e){n.trigger("pgadmin-sqleditor:loading-icon:hide");var t=p.handleQueryToolAjaxError(f,n,e,"_execute_view_data_query",[],!0);n.update_msg_history(!1,t)})},_execute_sql_query:function(e,t){var n="";if(this.has_more_rows=!1,this.fetching_rows=!1,C.isUndefined(this.special_sql)){var i=this.gridView.query_tool_obj.getSelection();n=0<i.length?i:this.gridView.query_tool_obj.getValue()}else n=this.special_sql;new s.ExecuteQuery(this,f.Browser.UserManagement).execute(n,e,t)},call_render_after_poll:function(e){A.callRenderAfterPoll(this,k,e)},_poll:function(){new s.ExecuteQuery(this,f.Browser.UserManagement).delayedPoll(this)},_render:function(s){var e=this;e.colinfo=s.colinfo,e.primary_keys=C.isEmpty(s.primary_keys)&&s.has_oids?s.oids:s.primary_keys,e.client_primary_key=s.client_primary_key,e.cell_selected=!1,e.selected_model=null,e.changedModels=[],e.has_oids=s.has_oids,e.oids=s.oids,S(".sql-editor-explain").empty(),e.explain_plan=!1,null!==e.primary_keys&&void 0!==e.primary_keys&&0!==C.size(e.primary_keys)||0!=e.has_oids?e.can_edit=!0:e.can_edit=!1,e.can_filter&&(S(".limit").prop("disabled",!1),S(".limit").addClass("limit-enabled"),S("#btn-filter").prop("disabled",!1),S("#btn-filter-dropdown").prop("disabled",!1)),S("#btn-save-data").prop("disabled",!0),S("#btn-delete-row").prop("disabled",!0),e.can_edit||(S("#btn-delete-row").prop("disabled",!0),S("#btn-copy-row").prop("disabled",!0),S("#btn-paste-row").prop("disabled",!0)),e._fetch_column_metadata.call(e,s,function(){var e=this;e.trigger("pgadmin-sqleditor:loading-icon:message",x("Loading data from the database server and rendering..."),e),e.total_time=w.calculateQueryRunTime(e.query_start_time,e.query_end_time);var t=x("Successfully run. Total query runtime: %s.",e.total_time),n=x("%s rows affected.",e.rows_affected);0<=e.info_notifier_timeout&&k.success(t+" "+n,e.info_notifier_timeout);var i=t+"\n"+n;C.isNull(s.additional_messages)||C.isUndefined(s.additional_messages)||(i=s.additional_messages+"\n"+i),e.update_msg_history(!0,i,!1);var r=[],a=null;if(s.result&&!C.isEmpty(e.colinfo)&&"QUERY PLAN"==e.colinfo[0].name&&!C.isEmpty(s.types)&&s.types[0]&&"json"===s.types[0].typname&&(a=JSON.parse(s.result[0][0])),a&&a[0]&&a[0].hasOwnProperty("Plan")&&C.isObject(a[0].Plan)){var o=[JSON.stringify(a,null,2)];r.push(o),e.gridView.data_output_panel.focus(),setTimeout(function(){e.gridView.render_grid(r,e.columns,e.can_edit,e.client_primary_key,0),e.gridView.explain_panel.focus(),l.DrawJSONPlan(S(".sql-editor-explain"),a)},10)}else e.gridView.data_output_panel.focus(),setTimeout(function(){e.gridView.render_grid(s.result,e.columns,e.can_edit,e.client_primary_key,s.rows_affected)},10);e.trigger("pgadmin-sqleditor:loading-icon:hide"),S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1)}.bind(e))},_fetch_column_metadata:function(e,t){var n=e.colinfo,d=e.primary_keys,c=[],u=this,f=new Array;C.each(e.types,function(e){f[e.oid]=[e.typname]}),C.each(n,function(n){var i=!1,e=u.can_edit&&(!u.is_query_tool||n.is_editable);e&&0<C.size(d)&&C.each(d,function(e,t){t===n.name&&(i=!0)});var t,r,a="",o=f[n.type_code]?f[n.type_code][0]:f[f.length-1][0]?f[f.length-1][0]:"unknown";switch(a+=i?"[PK] "+o:o,n.precision&&0<=n.precision&&65535!=n.precision&&(a+=" ("+n.precision,a+=n.scale&&65535!=n.scale?","+n.scale+")":")"),o){case"oid":r="oid";break;case"json":case"json[]":case"jsonb":case"jsonb[]":r="Json";break;case"smallint":case"smallint[]":case"integer":case"integer[]":case"bigint":case"bigint[]":case"decimal":case"decimal[]":case"numeric":case"numeric[]":case"real":case"real[]":case"double precision":case"double precision[]":r="number";break;case"boolean":r="boolean";break;case"character":case"character[]":case'"char"':case'"char"[]':case"character varying":case"character varying[]":n.internal_size&&0<=n.internal_size&&65535!=n.internal_size&&(a+=" ("+n.internal_size+")"),r="string";break;case"bytea":case"bytea[]":r="binary";break;case"geometry":r="geometry";break;case"geography":r="geography";break;default:r="string"}t=n.display_name+"<br>"+a;var s=o.lastIndexOf("[]"),l={name:n.name,display_name:n.display_name,column_type:a,column_type_internal:o,pos:n.pos,label:t,cell:r,can_edit:"oid"!=n.name&&e,type:o,not_null:n.not_null,has_default_val:n.has_default_val,is_array:-1<s&&s+2==o.length};c.push(l)}),u.columns=c,t&&"function"==typeof t&&t()},resetQueryHistoryObject:function(e){e.total_time="-"},set_sql_message:function(e,t){1<arguments.length&&void 0!==t&&t?S(".sql-editor-message").append(e):S(".sql-editor-message").text(e),setTimeout(function(){S(".sql-editor-message").scrollTop(S(".sql-editor-message")[0].scrollHeight)},10)},update_msg_history:function(e,t,n){var i=this;if(void 0===n&&(n=!0),i.gridView.messages_panel.focus(),n?(i.gridView.handler.slickgrid&&i.gridView.handler.slickgrid.destroy(),i.columns=void 0,i.collection=void 0,i.set_sql_message(t)):i.set_sql_message(C.escape(t),!0),"Busy"!=e){S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),i.trigger("pgadmin-sqleditor:loading-icon:hide"),i.total_time||(i.total_time=w.calculateQueryRunTime(i.query_start_time,new Date)),C.isUndefined(i.history_query_source)&&(i.history_query_source=K.VIEW_DATA);var r={status:e,start_time:i.query_start_time,query:i.query,row_affected:i.rows_affected,total_time:i.total_time,message:t,query_source:i.history_query_source,is_pgadmin_query:!i.is_query_tool};if(!i.is_query_tool){var a=x('This query was generated by pgAdmin as part of a "View/Edit Data" operation');r.info=a}i.add_to_history(r)}},add_to_history:function(e){S.ajax({url:u("sqleditor.add_query_history",{trans_id:this.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(){}).fail(function(){}),this.gridView.history_collection.add(e)},is_editable:function(e){return!(e instanceof n.Collection)&&this.get("can_edit")},rows_to_delete:function(e){var i=this,r=i.primary_keys;i.temp_new_rows=[],e.forEach(function(e,t){var n=C.pick(e,C.keys(r));0<Object.keys(n).length||i.temp_new_rows.push(t)}),i.rows_to_disable=C.clone(i.temp_new_rows)},_delete:function(){var n=this,i=[],e=C.size(n.data_store.added),t=C.size(n.data_store.updated);if(e&&C.each(n.data_store.added,function(e,t){t in n.data_store.staged_rows&&i.push(t)}),0<C.size(n.data_store.staged_rows)&&C.size(n.data_store.staged_rows)===C.size(i)){var r=n.slickgrid,a=r.getData();r.resetActiveCell(),a.beginUpdate();for(var o=0;o<i.length;o++)delete n.data_store.staged_rows[i[o]],delete n.data_store.added[i[o]],delete n.data_store.added_index[i[o]],a.deleteItem(i[o]);a.endUpdate(),n.rows_to_delete.apply(n,[a.getItems()]),r.resetActiveCell(),r.setSelectedRows([]),r.invalidate(),S("#btn-delete-row").prop("disabled",!0),S("#btn-copy-row").prop("disabled",!0),C.size(n.data_store.added)||t?S("#btn-save-data").prop("disabled",!1):S("#btn-save-data").prop("disabled",!0),k.success(x("Row(s) deleted."))}else{var s=!0;C.each(C.keys(n.data_store.staged_rows),function(e){e in n.data_store.deleted&&(s=!1)}),s?(n.data_store.deleted=Object.assign({},n.data_store.deleted,n.data_store.staged_rows),S(n.gridView.grid.getCanvasNode()).find("div.selected").addClass("strikeout")):(S(n.gridView.grid.getCanvasNode()).find("div.selected").removeClass("strikeout"),C.each(C.keys(n.data_store.staged_rows),function(e){e in n.data_store.deleted&&delete n.data_store.deleted[e]})),C.size(n.data_store.added)||t||C.size(n.data_store.deleted)?S("#btn-save-data").prop("disabled",!1):S("#btn-save-data").prop("disabled",!0)}},_save_file:function(e){var t=0<arguments.length&&void 0!==e&&e,n=this.gridView.current_file;if(C.isUndefined(n)||t){f.FileManager.init(),f.FileManager.show_dialog({supported_types:["*","sql"],dialog_type:"create_file",dialog_title:"Save File",btn_primary:"Save"})}else this._save_file_handler(n)},save_data:function(){var g=this;if(g.can_edit){var _=C.size(g.data_store.added),e=C.size(g.data_store.updated),m=C.size(g.data_store.deleted);if(_||e||m){g.trigger("pgadmin-sqleditor:loading-icon:show",x("Saving the updated data...")),g.is_query_tool&&g.disable_tool_buttons(!0,!0);var v=g.data_store,i=g.gridView;v.columns=i?i.handler.columns:g.columns;var b=!1,y=new Date;S.ajax({url:u("sqleditor.save",{trans_id:g.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(v)}).done(function(e){var a=g.slickgrid,t=a.getData(),n=t.getLength(),i=[],r=e.data.transaction_status,o=0<(g.last_transaction_status=r);if(o?g.disable_transaction_buttons(!1):g.disable_transaction_buttons(!0),g.is_query_tool&&g.disable_tool_buttons(!1),e.data.status){S("#btn-save-data").prop("disabled",!0),b=!0;for(var s=1;s<=g.numberOfModifiedCells;s++)a.removeCellCssStyles(s);if(g.numberOfModifiedCells=0,_&&(t.beginUpdate(),C.each(e.data.query_results,function(i){if(!C.isNull(i.row_added)){var r=Object.keys(i.row_added)[0];C.each(v.added_index,function(e,t){if(e==r){var n=a.getDataItem(t);C.extend(n,i.row_added[r])}})}}),t.endUpdate()),C.each(i,function(e){e.is_row_copied&&delete e.is_row_copied}),a.copied_rows&&delete a.copied_rows,m){var l=C.keys(g.data_store.deleted);if(n==l.length)i=[],t.setItems(i,g.client_primary_key);else{t.beginUpdate();for(var d=0;d<l.length;d++){var c=a.getDataItem(l[d]);i.push(c),t.deleteItem(c[g.client_primary_key])}t.endUpdate()}g.rows_to_delete.apply(g,[i])}a.setSelectedRows([]),g.reset_data_store(),g.primary_keys_data={},g.set_sql_message(""),k.success(x("Data saved successfully.")),o&&k.info(x("Auto-commit is off. You still need to commit changes to the database."))}else{g.set_sql_message(e.data.result);var u=x("%s.",e.data.result);if(k.error(u,20),0!=r&&k.info(x("Saving data changes was rolled back but the current transaction is still active; previous queries are unaffected.")),a.setSelectedRows([]),C.has(e.data,"_rowid")&&(!C.isUndefined(e.data._rowid)||!C.isNull(e.data._rowid))){var f=g._find_rowindex(e.data._rowid);if(f in g.data_store.added_index){var p=g.handler.temp_new_rows.indexOf(e.data._rowid);-1<p&&g.handler.temp_new_rows.splice(p,1),g.data_store.added[g.data_store.added_index[f]].err=!0}else f in g.data_store.updated_index&&(g.data_store.updated[g.data_store.updated_index[f]].err=!0)}a.gotoCell(f,1)}var h=x('This query was generated by pgAdmin as part of a "Save Data" operation');C.each(e.data.query_results,function(e){var t={status:e.status,start_time:y,query:e.sql,row_affected:e.rows_affected,total_time:null,message:e.result,query_source:K.SAVE_DATA,is_pgadmin_query:!0,info:h};g.add_to_history(t)}),g.trigger("pgadmin-sqleditor:loading-icon:hide"),a.invalidate(),g.close_on_save&&(b?g.check_needed_confirmations_before_closing_panel():g.close_on_save=!1)}).fail(function(e){var t=[i],n=p.handleQueryToolAjaxError(f,g,e,"save_data",t,!0);g.is_query_tool&&g.disable_tool_buttons(!1),g.update_msg_history(!1,n)})}}},reset_data_store:function(){this.data_store={updated:{},added:{},staged_rows:{},deleted:{},updated_index:{},added_index:{}}},_find_rowindex:function(e){var n,t=this.slickgrid.getData().getItems(),i=0,r=-1;if(C.isObject(e))n=e;else{if(!C.isString(e))return r;(e={})[this.client_primary_key]=e,n=e}return C.find(t,function(e){var t=[];if(t.push(e),C.findWhere(t,n))return r=i,!0;i++}),r},_save_as:function(){return this._save_file(!0)},setTitle:function(t,n){var i=this;i.preferences.new_browser_tab?window.document.title=t:C.each(L.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(e){e.isVisible()&&I.setQueryToolDockerTitle(e,i.is_query_tool,t,n)})},_load_file:function(){var e=this;e.is_query_changed?k.confirm(x("Unsaved changes"),x("Are you sure you wish to discard the current changes?"),function(){e._open_select_file_manager()},function(){return!0}).set("labels",{ok:"Yes",cancel:"No"}):e._open_select_file_manager()},_open_select_file_manager:function(){f.FileManager.init(),f.FileManager.show_dialog({supported_types:["sql"],dialog_type:"select_file"})},_select_file_handler:function(t){var i=this,r=t,e={file_name:decodeURI(t)};i.trigger("pgadmin-sqleditor:loading-icon:show",x("Loading the file..."));var a=S(".sql-editor-busy-fetching");a.addClass("show_progress"),S.ajax({url:u("sqleditor.load_file"),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){i.gridView.query_tool_obj.setValue(e),i.gridView.current_file=t,i.setTitle(i.gridView.current_file.split("\\").pop().split("/").pop(),!0),i.trigger("pgadmin-sqleditor:loading-icon:hide"),a.removeClass("show_progress"),S("#btn-save-file").prop("disabled",!0),S("#btn-file-menu-save").css("display","none"),i.is_query_changed=!1,setTimeout(function(){i.gridView.query_tool_obj.focus()},200)}).fail(function(e){i.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[r],n=p.handleQueryToolAjaxError(f,i,e,"_select_file_handler",t,!1);k.error(n),a.removeClass("show_progress")})},_save_file_handler:function(t){var i=this,r=t,e={file_name:decodeURI(t),file_content:i.gridView.query_tool_obj.getValue()};i.trigger("pgadmin-sqleditor:loading-icon:show",x("Saving the queries in the file...")),S.ajax({url:u("sqleditor.save_file"),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){e.data.status&&(k.success(x("File saved successfully.")),i.gridView.current_file=t,i.setTitle(i.gridView.current_file.replace(/^.*[\\\/]/g,""),!0),S("#btn-save-file").prop("disabled",!0),S("#btn-file-menu-save").css("display","none"),i.is_query_changed=!1,setTimeout(function(){i.gridView.query_tool_obj.focus()},200)),i.trigger("pgadmin-sqleditor:loading-icon:hide"),i.close_on_save&&i.check_needed_confirmations_before_closing_panel()}).fail(function(e){i.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[r],n=p.handleQueryToolAjaxError(f,i,e,"_save_file_handler",t,!1);k.error(n)})},_on_query_change:function(){var t=this;if(!t.is_query_changed){if(t.is_query_changed=!0,t.gridView.current_file){var e=t.gridView.current_file.replace(/^.*[\\\/]/g,"")+" *";t.setTitle(e,!0)}else e=t.preferences.new_browser_tab?window.document.title+" *":(C.each(L.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(e){e.isVisible()&&(t.gridView.panel_title=S(e._title).text())}),t.gridView.panel_title+" *"),t.setTitle(e);S("#btn-save-file").prop("disabled",!1),S("#btn-file-menu-save").css("display","block"),S("#btn-file-menu-dropdown").prop("disabled",!1)}},_init_polling_flags:function(){var t=this;t.POLL_FALLBACK_TIME=function(){var e=parseInt((Date.now()-t.query_start_time.getTime())/1e3);return 10<=e&&e<30?500:30<=e&&e<60?1e3:60<=e&&e<90?2e3:90<=e?5e3:1}},_show_filter:function(){var e=!1;0<arguments.length&&"connect"==arguments[arguments.length-1]&&(e=!0),d.dialog(this,e)},_include_filter:function(){var e,t,n,i,r=this,a={};t=(e=r.slickgrid).getActiveCell(),C.isNull(t)||C.isUndefined(t)||(n=e.getColumns()[t.cell],i=e.getDataItem(t.row,t.cell),C.isNull(i)||C.isUndefined(i)||(a[n.field]=i[n.field]||"",r.trigger("pgadmin-sqleditor:loading-icon:show",x("Applying the new filter...")),S.ajax({url:u("sqleditor.inclusive_filter",{trans_id:r.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(a)}).done(function(e){r.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?m.executeQuery(r):k.alert(x("Filter By Selection Error"),e.data.result)})}).fail(function(e){r.trigger("pgadmin-sqleditor:loading-icon:hide");var t=p.handleQueryToolAjaxError(f,r,e,"_include_filter",[],!0);k.alert(x("Filter By Selection Error"),t)})))},_exclude_filter:function(){var e,t,n,i,r=this,a={};t=(e=r.slickgrid).getActiveCell(),C.isNull(t)||C.isUndefined(t)||(n=e.getColumns()[t.cell],i=e.getDataItem(t.row,t.cell),C.isNull(i)||C.isUndefined(i)||(a[n.field]=i[n.field]||"",r.trigger("pgadmin-sqleditor:loading-icon:show",x("Applying the new filter...")),S.ajax({url:u("sqleditor.exclusive_filter",{trans_id:r.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(a)}).done(function(e){r.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?m.executeQuery(r):k.alert(x("Filter Exclude Selection Error"),e.data.result)},10)}).fail(function(e){r.trigger("pgadmin-sqleditor:loading-icon:hide");var t=p.handleQueryToolAjaxError(f,r,e,"_exclude_filter",[],!0);k.alert(x("Filter Exclude Selection Error"),t)})))},_remove_filter:function(){var n=this;n.trigger("pgadmin-sqleditor:loading-icon:show",x("Removing the filter...")),S.ajax({url:u("sqleditor.remove_filter",{trans_id:n.transId}),method:"POST"}).done(function(e){n.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?m.executeQuery(n):k.alert(x("Remove Filter Error"),e.data.result)})}).fail(function(e){n.trigger("pgadmin-sqleditor:loading-icon:hide");var t=p.handleQueryToolAjaxError(f,n,e,"_remove_filter",[],!0);k.alert(x("Remove Filter Error"),t)})},_copy_row:a,_copy_row_with_header:function(){S(".copy-with-header").toggleClass("visibility-hidden")},_paste_row:function(){var i=this,e=i.slickgrid,r=e.getData(),t=r.getItems(),a=r.getLength(),n=e.getSelectedRows().sort(function(e,t){return e-t}),o=n.map(function(e){return t[e]}),s=[];for(var l in i.columns)i.columns[l].is_array&&s.push(i.columns[l].name);if(n=0==n.length?i.last_copied_rows:n,i.last_copied_rows=n,0<o.length){S("#btn-save-data").prop("disabled",!1);r.beginUpdate(),C.each(o,function(e){var t=function(n){var i={};return C.each(n,function(e,t){void 0!==n[t]&&(C.isObject(n[t])&&-1==s.indexOf(t)?i[String(t)]=JSON.stringify(n[t]):i[String(t)]=n[t])}),i}(e),n=(i.gridView.client_primary_key_counter++).toString();t.is_row_copied=!0,i.temp_new_rows.push(a),t[i.client_primary_key]=n,i.has_oids&&t.oid&&(t.oid=null),r.addItem(t),i.data_store.added[n]={err:!1,data:t},i.data_store.added_index[a]=n,a++}),r.endUpdate(),e.updateRowCount(),e.scrollRowIntoView(r.getLength()),e.setSelectedRows([])}},_set_limit:function(){var n=this,e=parseInt(S(".limit").val());n.trigger("pgadmin-sqleditor:loading-icon:show",x("Setting the limit on the result...")),S.ajax({url:u("sqleditor.set_limit",{trans_id:n.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){n.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?m.executeQuery(n):k.alert(x("Change limit Error"),e.data.result)},10)}).fail(function(e){n.trigger("pgadmin-sqleditor:loading-icon:hide");var t=p.handleQueryToolAjaxError(f,n,e,"_set_limit",[],!0);k.alert(x("Change limit Error"),t)})},disable_tool_buttons:function(e,t){var n=1<arguments.length&&void 0!==t?t:null,i=e;this.is_query_tool||(i=!0),S("#btn-explain").prop("disabled",i),S("#btn-explain-analyze").prop("disabled",i),S("#btn-explain-options-dropdown").prop("disabled",i),S("#btn-edit-dropdown").prop("disabled",i),S("#btn-load-file").prop("disabled",i),S("#btn-save-file").prop("disabled",i),S("#btn-file-menu-dropdown").prop("disabled",i),S("#btn-find").prop("disabled",i),S("#btn-find-menu-dropdown").prop("disabled",i),this.is_query_tool?(null!==n?S("#btn-cancel-query").prop("disabled",n):S("#btn-cancel-query").prop("disabled",!e),this.is_transaction_buttons_disabled?S("#btn-query-dropdown").prop("disabled",e):S("#btn-query-dropdown").prop("disabled",!0)):S("#btn-query-dropdown").prop("disabled",i)},disable_transaction_buttons:function(e){this.is_transaction_buttons_disabled=e,this.is_query_tool&&(S("#btn-commit").prop("disabled",e),S("#btn-rollback").prop("disabled",e))},_highlight_error:function(e){var t=this,n=0,i=0,r=0,a=0;t.gridView.query_tool_obj.removeLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background"),0<t.gridView.query_tool_obj.getSelection().length&&(a=t.gridView.query_tool_obj.getCursor(!0).line);var o=/LINE (\d+)/.exec(e),s=/Character: (\d+)/.exec(e);if(null!=o&&null!=s){n=t.marked_line_no=parseInt(o[1])-1+a;for(var l=parseInt(s[1])-1,d=0,c=0<a?a:0;c<n;c++)d+=t.gridView.query_tool_obj.getLine(c).length+1;i=l-d;var u=t.gridView.query_tool_obj.getLine(n);(r=u.indexOf(" ",i))<0&&(r=u.length),t.gridView.marker=t.gridView.query_tool_obj.markText({line:n,ch:i},{line:n,ch:r},{className:"sql-editor-mark"}),t.gridView.query_tool_obj.addLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background")}},_cancel_query:function(){var n=this;S.ajax({url:u("sqleditor.cancel_transaction",{trans_id:n.transId}),method:"POST",contentType:"application/json"}).done(function(e){e.data.status||k.alert(x("Cancel Query Error"),e.data.result),n.disable_tool_buttons(!1),$=!1,C.isUndefined(n.download_csv_obj)||(n.download_csv_obj.abort(),S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),n.trigger("pgadmin-sqleditor:loading-icon:hide")),setTimeout(function(){n.gridView.query_tool_obj.focus()},200)}).fail(function(e){n.disable_tool_buttons(!1);var t=p.handleQueryToolAjaxError(f,n,e,"_cancel_query",[],!1);k.alert(x("Cancel Query Error"),t)})},trigger_csv_download:function(e,a){var o=this,t=u("sqleditor.query_tool_download",{trans_id:o.transId}),n={query:e,filename:a};S("#btn-flash").prop("disabled",!0),S("#btn-download").prop("disabled",!0),o.disable_tool_buttons(!0),o.set_sql_message(""),o.trigger("pgadmin-sqleditor:loading-icon:show",x("Downloading CSV...")),o.download_csv_obj=S.ajax({type:"POST",url:t,data:n,cache:!1}).done(function(e){if(C.isUndefined(e.data)){var t=new Blob([e],{type:"text/csv"}),n=(window.URL||window.webkitURL).createObjectURL(t),i=f.Browser.get_browser(),r=document.createElement("a");document.body.appendChild(r),"IE"===i.name&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(t,a):(r.setAttribute("href",n),r.setAttribute("download",a),r.click()),document.body.removeChild(r),o.download_csv_obj=void 0}else e.status||(o._highlight_error(e.data.result),o.set_sql_message(e.data.result));S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),o.disable_tool_buttons(!1),o.trigger("pgadmin-sqleditor:loading-icon:hide")}).fail(function(e){var t="";S("#btn-flash").prop("disabled",!1),S("#btn-download").prop("disabled",!1),o.disable_tool_buttons(!1),o.trigger("pgadmin-sqleditor:loading-icon:hide"),t="abort"==e.statusText?x("CSV Download cancelled."):p.handleQueryToolAjaxError(f,o,e,x("Download CSV"),[],!0),k.alert(x("Download CSV error"),t)})},call_cache_preferences:function(){L.default.pgAdmin.Browser.cache_preferences("sqleditor"),U.preference_version(U.generate_preference_version())},_auto_rollback:function(){var n=this,e=!0;!0===S(".auto-rollback").hasClass("visibility-hidden")?S(".auto-rollback").removeClass("visibility-hidden"):(S(".auto-rollback").addClass("visibility-hidden"),e=!1),S.ajax({url:u("sqleditor.auto_rollback",{trans_id:n.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){e.data.status||k.alert(x("Auto Rollback Error"),e.data.result)}).fail(function(e){var t=p.handleQueryToolAjaxError(f,n,e,"_auto_rollback",[],!0);k.alert(x("Auto Rollback Error"),t)})},_auto_commit:function(){var n=this,e=!0;!0===S(".auto-commit").hasClass("visibility-hidden")?S(".auto-commit").removeClass("visibility-hidden"):(S(".auto-commit").addClass("visibility-hidden"),e=!1),S.ajax({url:u("sqleditor.auto_commit",{trans_id:n.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){e.data.status||k.alert(x("Auto Commit Error"),e.data.result)}).fail(function(e){var t=p.handleQueryToolAjaxError(f,n,e,"_auto_commit",[],!0);k.alert(x("Auto Commit Error"),t)})},_toggle_explain_option:function(e){var t=".explain-".concat(e);S(t).toggleClass("visibility-hidden")},_explain_verbose:function(){this._toggle_explain_option("verbose")},_explain_costs:function(){this._toggle_explain_option("costs")},_explain_buffers:function(){this._toggle_explain_option("buffers")},_explain_timing:function(){this._toggle_explain_option("timing")},_explain_summary:function(){this._toggle_explain_option("summary")},_explain_settings:function(){this._toggle_explain_option("settings")},_indent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentMore")},_unindent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentLess")},isQueryRunning:function(){return $},setIsQueryRunning:function(e){$=e},check_needed_confirmations_before_closing_panel:function(e){var t,n=0<arguments.length&&void 0!==e&&e,i=this;i.ignore_on_close&&!n||(i.ignore_on_close={unsaved_data:!1,unsaved_query:!1});var r=i.ignore_on_close.unsaved_data,a=i.ignore_on_close.unsaved_query;if(!r&&i.can_edit&&i.preferences.prompt_save_data_changes&&i.data_store&&(C.size(i.data_store.added)||C.size(i.data_store.updated)||C.size(i.data_store.deleted)))t=x("The data has changed. Do you want to save changes?"),i.unsaved_changes_user_confirmation(t,!0);else if(!a&&i.is_query_tool&&i.is_query_changed&&i.preferences.prompt_save_query_changes)t=x("The text has changed. Do you want to save changes?"),i.unsaved_changes_user_confirmation(t,!1);else if(!i.preferences.prompt_commit_transaction||i.last_transaction_status!==j.TRANSACTION_STATUS_INTRANS&&i.last_transaction_status!==j.TRANSACTION_STATUS_INERROR)i.ignore_on_close=void 0,i.close();else{var o=i.last_transaction_status==j.TRANSACTION_STATUS_INERROR;i.uncommitted_transaction_user_confirmation(o)}return!1},uncommitted_transaction_user_confirmation:function(e){var t=0<arguments.length&&void 0!==e&&e,n=this;k.confirmCommit||k.dialog("confirmCommit",function(){return{main:function(e,t,n){this.is_commit_disabled=n,this.setHeader(e),this.setContent(t)},setup:function(){return{buttons:[{text:x("Cancel"),key:27,invokeOnClose:!0,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:x("Rollback"),className:"btn btn-primary fa fa-lg pg-alertify-button"},{text:x("Commit"),className:"btn btn-primary fa fa-lg pg-alertify-button"}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},prepare:function(){this.is_commit_disabled?this.__internal.buttons[2].element.disabled=!0:this.__internal.buttons[2].element.disabled=!1},callback:function(e){switch(e.index){case 0:break;case 1:n.close_on_idle_transaction=!0,m.executeRollback(n);break;case 2:n.close_on_idle_transaction=!0,m.executeCommit(n)}}}});var i=x("The current transaction is not commited to the database.Do you want to commit or rollback the transaction?");k.confirmCommit(x("Commit transaction?"),i,t)},unsaved_changes_user_confirmation:function(e,t){var n=this;k.confirmSave||k.dialog("confirmSave",function(){return{main:function(e,t,n){this.is_unsaved_data=n,this.setHeader(e),this.setContent(t)},setup:function(){return{buttons:[{text:x("Cancel"),key:27,invokeOnClose:!0,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:x("Don't save"),className:"btn btn-secondary fa fa-lg fa-trash-o pg-alertify-button"},{text:x("Save"),className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},callback:function(e){switch(e.index){case 0:break;case 1:n.close_on_save=!1,this.is_unsaved_data?n.ignore_on_close.unsaved_data=!0:n.ignore_on_close.unsaved_query=!0,n.check_needed_confirmations_before_closing_panel();break;case 2:n.close_on_save=!0,this.is_unsaved_data?n.save_data():n._save_file()}}}}),k.confirmSave(x("Save changes?"),e,t)},close:function(){var t=this;U.Events.off("pgadmin:user:logged-in",this.initTransaction),C.each(L.default.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(e){e.isVisible()&&(window.onbeforeunload=null,e.off(B.EVENT.CLOSING),C.isUndefined(t.col_size)||delete t.col_size,L.default.pgAdmin.Browser.docker.removePanel(e))})},update_notifications:function(e){v.updateNotifications(e)}}),f.SqlEditor={create:function(e){return new G(e)},jquery:S},f.SqlEditor}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";function m(e){return e+22+75*(e<26)}function v(e,t,n){var i=0;for(e=n?w(e/700):e>>1,e+=w(e/t);455<e;i+=36)e=w(e/35);return w(i+36*e/(e+38))}function a(e){var t,n,i=[],r=(e=function(e){for(var t=[],n=0,i=e.length;n<i;){var r=e.charCodeAt(n++);if(55296<=r&&r<=56319&&n<i){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&r)<<10)+(1023&a)+65536):(t.push(r),n--)}else t.push(r)}return t}(e)).length,a=128,o=0,s=72;for(t=0;t<e.length;t++)(n=e[t])<128&&i.push(x(n));var l=i.length,d=l;for(l&&i.push("-");d<r;){var c=b;for(t=0;t<e.length;t++)a<=(n=e[t])&&n<c&&(c=n);var u=d+1;if(c-a>w((b-o)/u))throw RangeError(y);for(o+=(c-a)*u,a=c,t=0;t<e.length;t++){if((n=e[t])<a&&++o>b)throw RangeError(y);if(n==a){for(var f=o,p=36;;p+=36){var h=p<=s?1:s+26<=p?26:p-s;if(f<h)break;var g=f-h,_=36-h;i.push(x(m(h+g%_))),f=w(g/_)}i.push(x(m(f))),s=v(o,u,d==l),o=0,++d}}++o,++a}return i.join("")}var b=2147483647,o=/[^\0-\u007E]/,s=/[.\u3002\uFF0E\uFF61]/g,y="Overflow: input needs wider integers to process",w=Math.floor,x=String.fromCharCode;e.exports=function(e){var t,n,i=[],r=e.toLowerCase().replace(s,".").split(".");for(t=0;t<r.length;t++)n=r[t],i.push(o.test(n)?"xn--"+a(n):n);return i.join(".")}},function(e,t,n){"use strict";n(19);function r(t){try{return decodeURIComponent(t)}catch(e){return t}}function o(e){var t,n=e.replace(N," "),i=4;try{return decodeURIComponent(n)}catch(e){for(;i;)n=n.replace((t=i--,D[t-1]||(D[t-1]=RegExp("((?:%[\\da-f]{2}){"+t+"})","gi"))),r);return n}}function i(e){return A[e]}function a(e){return encodeURIComponent(e).replace(q,i)}function f(e,t){if(t)for(var n,i,r=t.split("&"),a=0;a<r.length;)(n=r[a++]).length&&(i=n.split("="),e.push({key:o(i.shift()),value:o(i.join("="))}))}function p(e){this.entries.length=0,f(this.entries,e)}function d(e,t){if(e<t)throw TypeError("Not enough arguments")}var s=n(17),l=n(315),c=n(60),u=n(123),h=n(91),g=n(230),_=n(78),m=n(104),v=n(52),b=n(101),y=n(45),w=n(44),x=n(441),S=n(150),C=n(39)("iterator"),k="URLSearchParams",T=k+"Iterator",E=_.set,P=_.getterFor(k),O=_.getterFor(T),N=/\+/g,D=Array(4),q=/[!'()~]|%20/g,A={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},R=g(function(e,t){E(this,{type:T,iterator:x(P(e).entries),kind:t})},"Iterator",function(){var e=O(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n}),j=function(e){m(this,j,k);var t,n,i,r,a,o,s,l,d,c=0<arguments.length?e:void 0,u=[];if(E(this,{type:k,entries:u,updateURL:function(){},updateSearchParams:p}),void 0!==c)if(w(c))if("function"==typeof(t=S(c)))for(i=(n=t.call(c)).next;!(r=i.call(n)).done;){if((s=(o=(a=x(y(r.value))).next).call(a)).done||(l=o.call(a)).done||!o.call(a).done)throw TypeError("Expected sequence with length 2");u.push({key:s.value+"",value:l.value+""})}else for(d in c)v(c,d)&&u.push({key:d,value:c[d]+""});else f(u,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},M=j.prototype;u(M,{append:function(e,t){d(arguments.length,2);var n=P(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){d(arguments.length,1);for(var t=P(this),n=t.entries,i=e+"",r=0;r<n.length;)n[r].key===i?n.splice(r,1):r++;t.updateURL()},get:function(e){d(arguments.length,1);for(var t=P(this).entries,n=e+"",i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){d(arguments.length,1);for(var t=P(this).entries,n=e+"",i=[],r=0;r<t.length;r++)t[r].key===n&&i.push(t[r].value);return i},has:function(e){d(arguments.length,1);for(var t=P(this).entries,n=e+"",i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){d(arguments.length,1);for(var n,i=P(this),r=i.entries,a=!1,o=e+"",s=t+"",l=0;l<r.length;l++)(n=r[l]).key===o&&(a?r.splice(l--,1):(a=!0,n.value=s));a||r.push({key:o,value:s}),i.updateURL()},sort:function(){var e,t,n,i=P(this),r=i.entries,a=r.slice();for(n=r.length=0;n<a.length;n++){for(e=a[n],t=0;t<n;t++)if(r[t].key>e.key){r.splice(t,0,e);break}t===n&&r.push(e)}i.updateURL()},forEach:function(e,t){for(var n,i=P(this).entries,r=b(e,1<arguments.length?t:void 0,3),a=0;a<i.length;)r((n=i[a++]).value,n.key,this)},keys:function(){return new R(this,"keys")},values:function(){return new R(this,"values")},entries:function(){return new R(this,"entries")}},{enumerable:!0}),c(M,C,M.entries),c(M,"toString",function(){for(var e,t=P(this).entries,n=[],i=0;i<t.length;)e=t[i++],n.push(a(e.key)+"="+a(e.value));return n.join("&")},{enumerable:!0}),h(j,k),s({global:!0,forced:!l},{URLSearchParams:j}),e.exports={URLSearchParams:j,getState:P}},function(e,t,n){var i=n(45),r=n(150);e.exports=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return i(t.call(e))}},function(e,t,n){var i,r,a;r=[n(0)],void 0===(a="function"==typeof(i=function(T){T.ui=T.ui||{};var e=T.ui.version="1.12.1";(function(){var r,x=Math.max,S=Math.abs,i=/left|center|right/,a=/top|center|bottom/,o=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,t=T.fn.position;function C(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function k(e,t){return parseInt(T.css(e,t),10)||0}function n(e){var t=e[0];if(t.nodeType===9){return{width:e.width(),height:e.height(),offset:{top:0,left:0}}}if(T.isWindow(t)){return{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}}if(t.preventDefault){return{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}}return{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}T.position={scrollbarWidth:function(){if(r!==undefined){return r}var e,t,n=T("<div "+"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>"+"<div style='height:100px;width:auto;'></div></div>"),i=n.children()[0];T("body").append(n);e=i.offsetWidth;n.css("overflow","scroll");t=i.offsetWidth;if(e===t){t=n[0].clientWidth}n.remove();return r=e-t},getScrollInfo:function(e){var t=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),i=t==="scroll"||t==="auto"&&e.width<e.element[0].scrollWidth,r=n==="scroll"||n==="auto"&&e.height<e.element[0].scrollHeight;return{width:r?T.position.scrollbarWidth():0,height:i?T.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=T(e||window),n=T.isWindow(t[0]),i=!!t[0]&&t[0].nodeType===9,r=!n&&!i;return{element:t,isWindow:n,isDocument:i,offset:r?T(e).offset():{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}};T.fn.position=function(u){if(!u||!u.of){return t.apply(this,arguments)}u=T.extend({},u);var f,p,h,g,_,e,m=T(u.of),v=T.position.getWithinInfo(u.within),b=T.position.getScrollInfo(v),y=(u.collision||"flip").split(" "),w={};e=n(m);if(m[0].preventDefault){u.at="left top"}p=e.width;h=e.height;g=e.offset;_=T.extend({},g);T.each(["my","at"],function(){var e=(u[this]||"").split(" "),t,n;if(e.length===1){e=i.test(e[0])?e.concat(["center"]):a.test(e[0])?["center"].concat(e):["center","center"]}e[0]=i.test(e[0])?e[0]:"center";e[1]=a.test(e[1])?e[1]:"center";t=o.exec(e[0]);n=o.exec(e[1]);w[this]=[t?t[0]:0,n?n[0]:0];u[this]=[s.exec(e[0])[0],s.exec(e[1])[0]]});if(y.length===1){y[1]=y[0]}if(u.at[0]==="right"){_.left+=p}else if(u.at[0]==="center"){_.left+=p/2}if(u.at[1]==="bottom"){_.top+=h}else if(u.at[1]==="center"){_.top+=h/2}f=C(w.at,p,h);_.left+=f[0];_.top+=f[1];return this.each(function(){var n,e,o=T(this),s=o.outerWidth(),l=o.outerHeight(),t=k(this,"marginLeft"),i=k(this,"marginTop"),r=s+t+k(this,"marginRight")+b.width,a=l+i+k(this,"marginBottom")+b.height,d=T.extend({},_),c=C(w.my,o.outerWidth(),o.outerHeight());if(u.my[0]==="right"){d.left-=s}else if(u.my[0]==="center"){d.left-=s/2}if(u.my[1]==="bottom"){d.top-=l}else if(u.my[1]==="center"){d.top-=l/2}d.left+=c[0];d.top+=c[1];n={marginLeft:t,marginTop:i};T.each(["left","top"],function(e,t){if(T.ui.position[y[e]]){T.ui.position[y[e]][t](d,{targetWidth:p,targetHeight:h,elemWidth:s,elemHeight:l,collisionPosition:n,collisionWidth:r,collisionHeight:a,offset:[f[0]+c[0],f[1]+c[1]],my:u.my,at:u.at,within:v,elem:o})}});if(u.using){e=function(e){var t=g.left-d.left,n=t+p-s,i=g.top-d.top,r=i+h-l,a={target:{element:m,left:g.left,top:g.top,width:p,height:h},element:{element:o,left:d.left,top:d.top,width:s,height:l},horizontal:n<0?"left":t>0?"right":"center",vertical:r<0?"top":i>0?"bottom":"middle"};if(p<s&&S(t+n)<p){a.horizontal="center"}if(h<l&&S(i+r)<h){a.vertical="middle"}if(x(S(t),S(n))>x(S(i),S(r))){a.important="horizontal"}else{a.important="vertical"}u.using.call(this,e,a)}}o.offset(T.extend(d,{using:e}))})};T.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=e.left-t.collisionPosition.marginLeft,o=i-a,s=a+t.collisionWidth-r-i,l;if(t.collisionWidth>r){if(o>0&&s<=0){l=e.left+o+t.collisionWidth-r-i;e.left+=o-l}else if(s>0&&o<=0){e.left=i}else{if(o>s){e.left=i+r-t.collisionWidth}else{e.left=i}}}else if(o>0){e.left+=o}else if(s>0){e.left-=s}else{e.left=x(e.left-a,e.left)}},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,o=i-a,s=a+t.collisionHeight-r-i,l;if(t.collisionHeight>r){if(o>0&&s<=0){l=e.top+o+t.collisionHeight-r-i;e.top+=o-l}else if(s>0&&o<=0){e.top=i}else{if(o>s){e.top=i+r-t.collisionHeight}else{e.top=i}}}else if(o>0){e.top+=o}else if(s>0){e.top-=s}else{e.top=x(e.top-a,e.top)}}},flip:{left:function(e,t){var n=t.within,i=n.offset.left+n.scrollLeft,r=n.width,a=n.isWindow?n.scrollLeft:n.offset.left,o=e.left-t.collisionPosition.marginLeft,s=o-a,l=o+t.collisionWidth-r-a,d=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,u=-2*t.offset[0],f,p;if(s<0){f=e.left+d+c+u+t.collisionWidth-r-i;if(f<0||f<S(s)){e.left+=d+c+u}}else if(l>0){p=e.left-t.collisionPosition.marginLeft+d+c+u-a;if(p>0||S(p)<l){e.left+=d+c+u}}},top:function(e,t){var n=t.within,i=n.offset.top+n.scrollTop,r=n.height,a=n.isWindow?n.scrollTop:n.offset.top,o=e.top-t.collisionPosition.marginTop,s=o-a,l=o+t.collisionHeight-r-a,d=t.my[1]==="top",c=d?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,u=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,f=-2*t.offset[1],p,h;if(s<0){h=e.top+c+u+f+t.collisionHeight-r-i;if(h<0||h<S(s)){e.top+=c+u+f}}else if(l>0){p=e.top-t.collisionPosition.marginTop+c+u+f-a;if(p>0||S(p)<l){e.top+=c+u+f}}}},flipfit:{left:function(){T.ui.position.flip.left.apply(this,arguments);T.ui.position.fit.left.apply(this,arguments)},top:function(){T.ui.position.flip.top.apply(this,arguments);T.ui.position.fit.top.apply(this,arguments)}}}})();var t=T.ui.position})?i.apply(t,r):i)||(e.exports=a)},function(o,e,s){"use strict";var t,n;s(36),s(53),s(10),s(58),s(19),s(23),s(73),s(30),s(33),s(11),s(12),s(37),s(4),s(46),s(29),s(83),s(22),s(6),s(31),t=[s(5),s(0),s(1),s(3),s(15),s(444),s(445),s(446),s(2),s(146)],void 0===(n=function(e,S,C,k,i,T,E,h,P){k=k||window.pgAdmin||{},E=E.default;var O=null;if(k.Explain)return k.Explain;function N(){function e(e,t,n,i){return['   <li class="nav-item" role="presentation">','    <a class="nav-link ',i?"active":"",'"','       data-toggle="tab" tabindex="-1"','       data-tab-index="'.concat(e,'"'),'       aria-selected="',i?"true":"false",'"','       role="tab" data-explain-role="'.concat(t,'"'),'       href="#pga_explain_'.concat(t,"_").concat(r,'"'),'       aria-controls="pga_explain_'.concat(t,"_").concat(r,'"'),'       id="pgah_explain_'.concat(t,"_").concat(r,'"> '),n,"</a>","</li>"].join("")}function t(e,t,n){return['   <div role="tabpanel" tabindex="-1" class="tab-pane pg-el-sm-12',"        pg-el-md-12 pg-el-lg-12 pg-el-12 fade collapse",t?" active show":""," ".concat(n,'"'),'        data-explain-tabpanel="'.concat(e,'"'),'        id="pga_explain_'.concat(e,"_").concat(r,'"'),'        aria-labelledby="pgah_explain_'.concat(e,"_").concat(r,'">'),"   </div>"].join("")}var r=N.cnt=(N.cnt||0)+1;return S(['<div class="obj_properties container-fluid">',' <div tabindex="1" class="backform-tab pg-el-12" role="tabpanel">','  <ul class="nav nav-tabs" role="tablist">',"   </li>",'   <li class="nav-item" role="presentation">',e(1,"graphical",P("Graphical"),!0),e(2,"table",P("Analysis"),!1),e(3,"statistics",P("Statistics"),!1),"  </ul>",'  <div class="tab-content pg-el-sm-12 pg-el-12">',t("graphical",!0,"w-100 h-100 p-0"),t("table",!1,"p-0"),t("statistics",!1,""),"   </div>","  </div>"," </div>","</div>"].join(""))}var D=k.Explain={prefix:e("misc.index")+"static/explain/img/"},q=C.template(['<tr<% if (className) {%> class="<%=className%>"<%}%>>',' <td class="renderable name"><%- data.name %></td>',' <td class="renderable text-right"><%- data.count %></td>',' <td class="renderable timings d-none text-right">',"<%=Math.ceil10(data.sum_of_times, -3)%> ms","</td>",' <td class="renderable timings d-none text-right">',"<%=Math.ceil10(((data.sum_of_times||0)/(total_time||1)) * 100, -2)%>%","</td>","</tr>"].join("")),A=C.template(['<tr class="pga-ex-row','<% if (data["Plans"] && data["Plans"].length > 0) {%>'," pga-ex-collapsible","<%}%>",'<% if (data["exclusive_flag"] !== "undefined") {%>'," pga-ex-exclusive-",'<%- data["exclusive_flag"] %>',"<%}%>",'<% if (data["inclusive_flag"] !== "undefined") {%>'," pga-ex-inclusive-",'<%- data["inclusive_flag"] %>',"<%}%>",'<% if (data["rowsx_flag"] !== "undefined") {%>'," pga-ex-rowsx-",'<%- data["rowsx_flag"] %>',"<%}%>",'"','<% if (data["parent_node"]) {%>',' data-parent="pga_ex_<%= data["parent_node"] %>"',"<%}%>",' data-ex-id="pga_ex_<%= data["level"].join("_") %>">',' <td class="renderable pg-ex-highlighter clickable">','  <i class="fa fa-circle invisible"></i>',"</td>",' <td class="renderable clickable serial text-right">','<%= (data["_serial"]) %>.</td>',' <td class="renderable clickable" style="padding-left: ','<%= (data["level"].length) * 30%>px"','title="<%= tooltip_text %>"',">",'  <i class="pg-ex-subplans fa fa-long-arrow-right"></i>',"<%= display_text %>","<%if (node_extra_info && node_extra_info.length > 0 ) {%>","<ui>","<%  for (var node_info_idx=0; "," node_info_idx<node_extra_info.length;node_info_idx++) {%>"," <li>","<%= node_extra_info[node_info_idx] %>","</li>","<% }%>","</ui>","<%}%>"," </td>",' <td class="renderable timings d-none text-right ','<% if (data["exclusive_flag"] !== "undefined") {%>',"pga-ex-exclusive-",'<%- data["exclusive_flag"] %>',"<%}%>",'">','<% if (typeof(data["exclusive"]) !== "undefined") {%>','<%= data["exclusive"] %> ms',"<%}%>"," </td>",' <td class="renderable timings d-none text-right ','<% if (data["inclusive_flag"] !== "undefined") {%>',"pga-ex-inclusive-",'<%- data["inclusive_flag"] %>',"<%}%>",'">','<% if (typeof(data["inclusive"]) !== "undefined") {%>','<%= data["inclusive"] %> ms',"<%}%>"," </td>",' <td class="renderable rowsx d-none text-right ','<% if (data["rowsx_flag"] !== "undefined") {%>',"pga-ex-rowsx-",'<%- data["rowsx_flag"] %>',"<%}%>",'">','<% if (data["rowsx_direction"] === "positive") {%>',"&uarr;","<%} else {%>","&darr;","<%}%> ",'<% if (typeof(data["rowsx"]) !== "undefined") {%>','<%- data["rowsx"] %>',"<%}%>  "," </td>",' <td class="renderable rowsx rows d-none text-right">','<% if (typeof(data["Actual Rows"]) !== "undefined") {%>','<%= data["Actual Rows"] %>',"<%}%>"," </td>",' <td class="renderable rowsx plan_rows d-none text-right">','<%= data["Plan Rows"] %>'," </td>",' <td class="renderable rows rowsx d-none text-right">','<% if (typeof(data["Actual Loops"]) !== "undefined") {%>','<%= data["Actual Loops"] %>',"<%}%>"," </td>",' <td class="renderable d-none">','  <i class="fa fa-ellipsis-h"></i>'," </td>","</tr>"].join("")),t=i.Model.extend({defaults:{Plans:[],level:[],image:void 0,image_text:void 0,xpos:void 0,ypos:void 0,width:100,height:100},_createSame:function(){return new t},parse:function(r,a){var o=1,s=r.level=r.level||[o],l=[],e=r["Node Type"],d=r.xpos=r.xpos-100,c=r.ypos,u=0;a.ctx.totalNodes++,a.ctx._explainTable.total_time=r.total_time||r["Actual Total Time"],r._serial=a.ctx.totalNodes,r.width=100,r.height=100,"SubPlan"===r["Parent Relationship"]&&(r.width+=62.5,r.height+=50,r.ypos+=25,d-=25,c+=25),e.startsWith("(slice")&&(e=e.substring(0,7));var t=h.default,n=C.isFunction(t[e])&&t[e].apply(void 0,[r])||t[e]||{image:"ex_unknown.svg",image_text:e};if(r.image=n.image,r.image_text=n.image_text,"Actual Total Time"in r&&"Actual Loops"in r&&(r.inclusive=Math.ceil10(r["Actual Total Time"]*r["Actual Loops"],-3),r.exclusive=r.inclusive,r.inclusive_factor=r.inclusive/(r.total_time||r["Actual Total Time"]),r.inclusive_flag=r.inclusive_factor<=.1?"1":r.inclusive_factor<.5?"2":r.inclusive_factor<=.9?"3":"4"),"Actual Rows"in r&&"Plan Rows"in r&&(0===r["Actual Rows"]||r["Actual Rows"]>r["Plan Rows"]?(r.rowsx=0===r["Plan Rows"]?0:r["Actual Rows"]/r["Plan Rows"],r.rowsx_direction="negative"):(r.rowsx=0===r["Actual Rows"]?0:r["Plan Rows"]/r["Actual Rows"],r.rowsx_direction="positive"),r.rowsx_flag=r.rowsx<=10?"1":r.rowsx<=100?"2":r.rowsx<=1e3?"3":"4",r.rowsx=Math.ceil10(r.rowsx,-2)),"Plans"in r){var f,p=this;r.width+=200,C.each(r.Plans,function(e){var t=C.clone(s),n=p._createSame();t.push(o),n.set(n.parse(C.extend(e,{level:t,xpos:d-200,ypos:c,total_time:r.total_time||r["Actual Total Time"],parent_node:s.join("_")}),a)),u<n.get("width")&&(u=n.get("width")),"exclusive"in r&&(f=n.get("inclusive"))&&(r.exclusive-=f);var i=n.get("height");1!==o?r.height=r.height+i+60:i>r.height&&(r.height=i),c+=i+60,l.push(n),o++})}return"exclusive"in r&&(r.exclusive=Math.ceil10(r.exclusive,-3),r.exclusive_factor=r.exclusive/(r.total_time||r["Actual Total Time"]),r.exclusive_flag=r.exclusive_factor<=.1?"1":r.exclusive_factor<.5?"2":r.exclusive_factor<=.9?"3":"4"),r.width+=u,r.Plans=l,r},draw:function(t,n,i,e,r,a,o,s){var l=t.g(),d=n+this.get("xpos"),c=i+this.get("ypos"),u="SubPlan"===this.get("Parent Relationship");!function(e,t){var n,i,r=['<span class="pg-explain-text-name">'],a=[],o=[],s=t._explainTable;if(/Scan/.test(e["Node Type"])?(r.push(e["Node Type"]),a.push(e["Node Type"])):(r.push(e.image_text),a.push(e.image_text)),n=a.join(""),r.push("</span>"),void 0!==e["Index Name"]&&(r.push(" using "),a.push(" using "),r.push('<span class="pg-explain-text-name">'),r.push(C.escape(e["Index Name"])),a.push(e["Index Name"]),r.push("</span>")),void 0!==e["Relation Name"]&&(r.push(" on "),a.push(" on "),void 0!==e.Schema&&(r.push('<span class="pg-explain-text-name">'),r.push(C.escape(e.Schema)),a.push(e.Schema),r.push("</span>"),r.push("."),a.push(".")),r.push('<span class="pg-explain-text-name">'),r.push(C.escape(e["Relation Name"])),a.push(e["Relation Name"]),r.push("</span>"),void 0!==e.Alias&&(r.push(" as "),a.push(" as "),r.push('<span class="pg-explain-text-name">'),r.push(C.escape(e.Alias)),a.push(C.escape(e.Alias)),r.push("</span>"))),void 0!==e["Plan Rows"]&&void 0!==e["Plan Width"]){var l=[" (cost=",void 0!==e["Startup Cost"]?e["Startup Cost"]:"","..",void 0!==e["Total Cost"]?e["Total Cost"]:""," rows=",e["Plan Rows"]," width=",e["Plan Width"],")"].join("");r.push(l),a.push(l)}if(void 0!==e["Actual Startup Time"]||void 0!==e["Actual Total Time"]||void 0!==e["Actual Rows"]){var d=[" (",void 0!==e["Actual Startup Time"]?"actual="+e["Actual Startup Time"]+"..":"",void 0!==e["Actual Total Time"]?e["Actual Total Time"]+" ":"",void 0!==e["Actual Rows"]?"rows="+e["Actual Rows"]:"",void 0!==e["Actual Loops"]?" loops="+e["Actual Loops"]:"",")"].join("");r.push(d),a.push(d)}if("Join Filter"in e&&o.push("<b>Join Filter</b>: "+C.escape(e["Join Filter"])),"Filter"in e&&o.push("<b>Filter</b>: "+C.escape(e.Filter)),"Index Cond"in e&&o.push("<b>Index Cond</b>: "+C.escape(e["Index Cond"])),"Hash Cond"in e&&o.push("<b>Hash Cond</b>: "+C.escape(e["Hash Cond"])),"Rows Removed by Filter"in e&&o.push("<b>Rows Removed by Filter</b>: "+C.escape(e["Rows Removed by Filter"])),"Peak Memory Usage"in e){var c=["<b>Buckets</b>:",C.escape(e["Hash Buckets"]),"<b>Batches</b>:",C.escape(e["Hash Batches"]),"<b>Memory Usage</b>:",C.escape(e["Peak Memory Usage"]),"kB"].join(" ");o.push(c)}if("Recheck Cond"in e&&o.push("<b>Recheck Cond</b>: "+e["Recheck Cond"]),"Exact Heap Blocks"in e&&o.push("<b>Heap Blocks</b>: exact="+e["Exact Heap Blocks"]),s.rows.push(A({data:e,display_text:r.join(""),tooltip_text:a.join(""),node_extra_info:o})),void 0!==e.exclusive_flag&&(s.show_timings=!0),void 0!==e.rowsx_flag&&(s.show_rowsx=!0),void 0!==e["Actual Loops"]&&(s.show_rows=!0),void 0!==e["Plan Rows"]&&(s.show_plan_rows=!0),void 0!==e.total_time&&(s.total_time=e.total_time),void 0!==e["Relation Name"]){var u=(void 0!==e.Schema?e.Schema+".":"")+e["Relation Name"],f=s.statistics.tables[u]||{name:u,count:0,sum_of_times:0,nodes:{}};i=f.nodes[n]||{name:n,count:0,sum_of_times:0},f.count++,f.sum_of_times+=e.exclusive,i.count++,i.sum_of_times+=e.exclusive,f.nodes[n]=i,s.statistics.tables[u]=f}(i=s.statistics.nodes[n]||{name:n,count:0,sum_of_times:0}).count++,i.sum_of_times+=e.exclusive,s.statistics.nodes[n]=i}(this.toJSON(),s),u&&(l.rect(d-this.get("width")+100+25,c-this.get("height")+100+25-5,this.get("width")-25,this.get("height")+(c-25),5).attr({stroke:"#444444",strokeWidth:1.2,fill:"gray",fillOpacity:.2}),l.text(d+100-this.get("width")/2-25,c+100-this.get("height")/2-25,this.get("Subplan Name")).attr({fontSize:"15px","text-anchor":"start",fill:"red"})),this._drawImage(t,l,D.prefix+this.get("image"),d,c,a,o,s);var f=null==this.get("Schema")?this.get("image_text"):this.get("Schema")+"."+this.get("image_text");if(l.multitext(d+50+5,c+100-5,f,150,{"font-size":"15px","text-anchor":"middle"}),!C.isUndefined(r)){var p=d+100,h=c+50,g=e-10,_=r+50,m=this.get("Startup Cost"),v=this.get("Total Cost"),b=2;null!=m&&null!=v&&(b=(b=Math.round(Math.log((m+v)/2+m)))<1?1:10<b?10:b);var y={stroke:"#000000",strokeWidth:b+2},w={stroke:"#866486",strokeWidth:b+2},x={viewBox:[0,0,20,20].join(" ")};this.drawPolyLine(l,p,h,g,_,u?w:y,x)}var S=this.get("Plans");C.each(S,function(e){e.draw(t,n,i,d,c,a,o,s)})},_drawImage:function(e,t,n,i,r,a,o){this.drawImage(t,n,i,r,a,o)},toJSON:function(e){var t=i.Model.prototype.toJSON.apply(this,arguments);if(e)delete t.Plans;else{var n=[];C.each(t.Plans,function(e){n.push(e.toJSON())}),t.Plans=n}return t},drawPolyLine:function(e,t,n,i,r,a,o){var s=t+(i-t)/3,l=t+(i-t)/3*2,d=e.polygon([0,10,5,10,2.5,0,0,10]).transform("r90").marker(0,0,10,10,0,5).attr(o);e.line(t,n,s,n).attr(a),e.line(s-1,n,l,r).attr(a),e.line(l,r,i,r).attr(a).attr({markerEnd:d})},drawImage:function(e,t,r,a,o,s){var l=e.image(t,r+25,a+25,50,50),d=this.toJSON(),n="<title>";C.each(d,function(e,t){"image"!==t&&"Plans"!==t&&"level"!==t&&"image"!==t&&"image_text"!==t&&"xpos"!==t&&"ypos"!==t&&"width"!==t&&"height"!==t&&(n+="".concat(t,": ").concat(e,"\n"))}),n+="</title>",l.append(O.parse(n)),l.mouseover(function(){s.empty(),l.node.textContent="";var n=S("<table></table>",{class:"pgadmin-tooltip-table"}).appendTo(s);C.each(d,function(e,t){"image"!==t&&"Plans"!==t&&"level"!==t&&"image"!==t&&"image_text"!==t&&"xpos"!==t&&"ypos"!==t&&"width"!==t&&"height"!==t&&(t=C.escape(t),e=C.escape(e),n.append('\n              <tr>\n                <td class="label explain-tooltip">'.concat(t,'</td>\n                <td class="label explain-tooltip-val">').concat(e,"</td>\n              </tr>\n            ")))});var e=o.data("zoom-factor"),t=(r+100)*e-o.scrollLeft(),i=a*e-o.scrollTop();t=t<0?0:t,i=i<0?0:i,s.css({opacity:"0.8"}),s.css("left",t),s.css("top",i),S(".pgadmin-explain-tooltip").css("padding","5px"),S(".pgadmin-explain-tooltip").css("border","1px solid white")}),l.mouseout(function(){l.append(O.parse(n)),s.empty(),s.css({opacity:"0"}),s.css("left",0),s.css("top",0)})}}),R=t.extend({_createSame:function(){return new R({parse:!0})},_drawImage:function(n,i,e,r,a,o,s,l){var t=k.Browser.get_browser();if("IE"===t.name||"Safari"===t.name&&parseInt(t.version)<10)this.drawImage(i,e,r,a,o,s);else{var d=this,c=D.prefix+this.get("image");O.load(c,function(e){var t=O();t.append(e),d.drawImage(i,t.toDataURL(),r,a,o,s),n.parent().attr({"xmlns:xlink":"http://www.w3.org/1999/xlink"}),setTimeout(function(){l._onImageDownloaded()},100)})}}}),j=i.Model.extend({defaults:{Plan:void 0,xpos:0,ypos:0},initialize:function(){this.set("Plan",new t),this.set("Statistics",new T)},parse:function(t,e){if(t&&"Plan"in t){var n=this.get("Plan");n.set(n.parse(C.extend(t.Plan,{xpos:0,ypos:0}),e)),t.xpos=0,t.ypos=0,t.width=n.get("width")+50,t.height=n.get("height")+100,delete t.Plan}var i=this.get("Statistics");if(t&&"JIT"in t&&(i.set("JIT",t.JIT),delete t.JIT),t&&"Triggers"in t&&(i.set("Triggers",t.Triggers),delete t.Triggers),t){var r={};["Planning Time","Execution Time"].forEach(function(e){e in t&&(r[e]=t[e])}),i.set("Summary",r)}return t&&"Settings"in t&&(i.set("Settings",t.Settings),delete t.Settings),t},toJSON:function(){var e=i.Model.prototype.toJSON.apply(this,arguments);return e.Plan&&(e.Plan=e.Plan.toJSON()),e},draw:function(e,t,n,i,r,a){var o=e.g();o.rect(0,0,this.get("width")-10,this.get("height")-10,5).attr({fill:"#FFF"}),this.get("Plan").draw(o,t,n,void 0,void 0,i,r,a),this.get("Statistics").set_statistics(r)}});return C.extend(D,{DrawJSONPlan:function(t,n,i,r){var a=this;s.e(15).then(function(e){(function(e){!function(e){(O=e).plugin(function(v,e,t){t.prototype.multitext=function(e,t,n,o,i){var r=v(),a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",s=r.text(0,0,a);s.attr(i);var l=s.getBBox().width/a.length,d=Math.round(o/l)-1;r.remove();for(var c=n.split(" "),u=0,f=[],p="",h=function e(t,n,i){var r=i.length,a=[];return 0==r||(n&&o<n+r*l?(a.push(t),a=a.concat(e("",0,i))):n?a.push(t+" "+i):(t&&a.push(t),i.length>1+d?a.push(i.slice(0,d)+"-"):a.push(i),a=a.concat(e("",0,i.slice(d))))),a},g=0;g<c.length;g++){var _=h(p,u,c[g]);p&&(f=f.slice(0,f.length-1)),u=(p=(f=f.concat(_))[f.length-1]).length*l}var m=this.text(e,t,f).attr(i);return m.selectAll("tspan:nth-child(n+2)").attr({dy:"1.2em",x:e}),m}})}(s(324)),a.goForDraw(t,n,i,r)}).call(this,s(102)(o))}.bind(null,s)).catch(function(e){throw e})},goForDraw:function(o,e,s,t){var l=C.extend(t||{},{totalNodes:0,totalDownloadedNodes:0,isDownloaded:0});o.empty().attr("el","sm").addClass("pg-no-overflow pg-el-container");var n=N(),i=S(['<table class="backgrid table presentation table-bordered ','       table-noouter-border table-hover">'," <thead>","  <tr>",'    <th class="renderable pga-ex-collapsible" rowspan="2"></th>','    <th class="renderable" rowspan="2"><button disabled>',P("#"),"</button></th>",'    <th class="renderable" rowspan="2"><button disabled>',P("Node"),"</button></th>",'    <th class="renderable timings d-none" colspan="2"><button disabled>',P("Timings"),"</button></th>",'    <th class="renderable rowsx rows plan_rows d-none" colspan="3">',"<button disabled>",P("Rows"),"</button></th>",'    <th class="renderable rows rowsx d-none" rowspan="2">',"<button disabled>",P("Loops"),"</button></th>",'    <th class="renderable d-none" rowspan="2"><button disabled>',"  </tr>","  <tr>",'    <th class="renderable timings d-none"><button disabled>',P("Exclusive"),"</button></th>",'    <th class="renderable timings d-none"><button disabled>',P("Inclusive"),"</button></th>",'    <th class="renderable rowsx d-none"><button disabled>',P("Rows X"),"</button></th>",'    <th class="renderable rows rowsx d-none"><button disabled>',P("Actual"),"</button></th>",'    <th class="renderable plan_rows rowsx d-none"><button disabled>',P("Plan"),"</button></th>","  </tr>"," </thead>","</table>"].join("")),r=S(['<div class="row row-eq-height">',' <div class="col-sm-6 col-xs-6">','  <div class="col-xs-12 badge">',P("Statistics per Node Type"),"  </div>",'  <table class="backgrid table presentation table-bordered ','         table-hover" for="per_node_type">',"   <thead>","    <tr>",'      <th class="renderable"><button disabled>',P("Node type"),"</button></th>",'      <th class="renderable"><button disabled>',P("Count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("Time spent"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("%% of query"),"</button></th>","    </tr>","   </thead>","  </table>"," </div>",' <div class="col-sm-6 col-xs-6">','  <div class="col-xs-12 badge">',P("Statistics per Table"),"  </div>",'  <table class="backgrid table presentation table-bordered ','         table-hover" for="per_table">',"   <thead>","    <tr>",'      <th class="renderable"><button disabled>',P("Table name"),"</button></th>",'      <th class="renderable"><button disabled>',P("Scan count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("Total time"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("%% of query"),"</button></th>","    </tr>","    <tr>",'      <th class="renderable"><button disabled>',P("Node type"),"</button></th>",'      <th class="renderable"><button disabled>',P("Count"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("Sum of times"),"</button></th>",'      <th class="renderable timings d-none"><button disabled>',P("%% of table"),"</button></th>","    </tr>","   </thead>","  </table>"," </div>","</div>"].join("")),a=n.find("[data-explain-tabpanel=graphical]"),d=n.find("[data-explain-tabpanel=table]");l.currentTab=o.find(".nav-link[aria-selected=true]").attr("data-explain-role"),n.appendTo(o),i.appendTo(d),r.appendTo(n.find("[data-explain-tabpanel=statistics]"));var c=S.extend(!0,[],e),u=1,f=S("<div></div>",{class:"pg-explain-zoom-area btn-group btn-group-sm",role:"group"}).appendTo(a),p=S("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn",title:"Zoom in",tabindex:0}).appendTo(f).append(S("<i></i>",{class:"fa fa-search-plus"})),h=S("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn",title:"Zoom to original",tabindex:0}).appendTo(f).append(S("<i></i>",{class:"fa fa-arrows-alt"})),g=S("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn",title:"Zoom out",tabindex:0}).appendTo(f).append(S("<i></i>",{class:"fa fa-search-minus"})),_=S("<div></div>",{class:"pg-explain-download-area btn-group btn-group-sm",role:"group"}).appendTo(a),m=S("<button></button>",{id:"btn-explain-download",class:"btn btn-secondary pg-explain-download-btn",title:"Download",tabindex:0,disabled:function(){var e=k.Browser.get_browser();return"IE"===e.name?(this.title="Not supported for Internet Explorer",!0):"Safari"===e.name&&parseInt(e.version)<10&&(this.title="Not supported for Safari version less than 10.1",!0)}}).appendTo(_).append(S("<i></i>",{class:"fa fa-download"})),v=S("<div></div>",{class:"pg-explain-stats-area btn-group btn-group-sm d-none",role:"group"}).appendTo(a);S("<button></button>",{id:"btn-explain-stats",class:"btn btn-secondary pg-explain-stats-btn",title:"Statistics",tabindex:0}).appendTo(v).append(S("<i></i>",{class:"fa fa-line-chart"}));var b=S("<div></div>",{class:"pgadmin-explain-container w-100 h-100 overflow-auto"}).appendTo(a),y=S("<div></div>",{id:"toolTip",class:"pgadmin-explain-tooltip"}).appendTo(a);y.empty(),b.data("zoom-factor",u);var w=0,x=25;l._explainTable={rows:[],statistics:{tables:{},nodes:{}}},l._onImageDownloaded=function(){if(l.totalDownloadedNodes++,!l.isDownloaded&&l.totalNodes===l.totalDownloadedNodes){l.isDownloaded=!0;var e=O("#".concat(a.attr("id")," .pgadmin-explain-container svg")),t="explain_plan_"+(new Date).getTime()+".svg";E.downloadSVG(e.toString(),t),m.trigger("blur")}},C.each(e,function(e){var t;s?t=new(j.extend({initialize:function(){this.set("Plan",new R({parse:!0})),this.set("Statistics",new T)}}))({parse:!0}):t=new j;t.set(t.parse(e,{ctx:l})),w=t.get("width"),x=t.get("height");var n=O(w,x),i=S(n.node).detach();b.append(i),t.draw(n,w-25,25,b,y,l);var r=b.width();if(r<w){u=1<(u=(u=r/w)<.01?.01:u)?1:u;var a=new O.matrix;a.scale(u,u),i.find("g").first().attr({transform:a}),i.attr({width:w*u,height:x*u}),b.data("zoom-factor",u)}p.on("click",function(){u=2<u+.05?2:u+.05;var e=new O.matrix;e.scale(u,u),i.find("g").first().attr({transform:e}),i.attr({width:w*u,height:x*u}),b.data("zoom-factor",u),p.trigger("blur")}),g.on("click",function(){u=u-.05<.01?.01:u-.05;var e=new O.matrix;e.scale(u,u),i.find("g").first().attr({transform:e}),i.attr({width:w*u,height:x*u}),b.data("zoom-factor",u),g.trigger("blur")}),h.on("click",function(){u=1;var e=new O.matrix;e.scale(u,u),i.find("g").first().attr({transform:e}),i.attr({width:w*u,height:x*u}),b.data("zoom-factor",u),h.trigger("blur")}),m.on("click",function(){D.DrawJSONPlan(o,c,!0),b.on("explain:svg:downloaded",function(){if(l.totalDownloadedNodes++,!l.isDownloaded&&l.totalNodes===l.totalDownloadedNodes){l.isDownloaded=!0;var e=O(".pgadmin-explain-container svg"),t="explain_plan_"+(new Date).getTime()+".svg";E.downloadSVG(e.toString(),t),m.trigger("blur")}})})}),function(e,t){var n=S("<tbody></tbody>");C.each(e.rows,function(e){S(e).appendTo(n)}),n.appendTo(t),!0===e.show_timings&&t.find(".timings").removeClass("d-none"),!0===e.show_rowsx?t.find(".rowsx").removeClass("d-none"):!0===e.show_rows?(t.find(".rows").removeClass("d-none"),t.find("thead .rows[colspan=3]").attr("colspan",1)):!0===e.show_plan_rows&&(t.find(".plan_rows").removeClass("d-none"),t.find("thead .rows[colspan=3]").attr("colspan",1))}(l._explainTable,i),function(n,e){var i=e.find('table[for="per_table"]'),t=e.find('table[for="per_node_type"]');C.each(C.sortBy(C.values(n.statistics.nodes),"name"),function(e){return t.append(q({data:e,total_time:n.total_time,className:""}))}),C.each(C.sortBy(C.values(n.statistics.tables),"name"),function(t){t.sum_of_times=0,C.each(t.nodes,function(e){return t.sum_of_times+=e.sum_of_times}),i.append(q({data:t,total_time:n.total_time,className:"table"})),C.each(C.sortBy(C.values(t.nodes),"name"),function(e){i.append(q({data:e,total_time:t.sum_of_times,className:"node"}))})}),n.show_timings&&e.find(".timings").removeClass("d-none")}(l._explainTable,r),o.on("shown.bs.tab",function(){l.currentTab=o.find(".nav-link[aria-selected=true]").attr("data-explain-role")})}}),S(document).on("mouseenter",".pga-ex-row.pga-ex-collapsible",function(e){var t=S(e.currentTarget);t.parent().find("[data-parent="+t.attr("data-ex-id")+"] > td.pg-ex-highlighter > i").removeClass("invisible")}).on("mouseleave",".pga-ex-row.pga-ex-collapsible",function(e){var t=S(e.currentTarget);t.parent().find(".pga-ex-row[data-parent="+t.attr("data-ex-id")+"] > td.pg-ex-highlighter > i").addClass("invisible")}).on("click",".pga-ex-row.pga-ex-collapsible",function(e){var t=S(e.currentTarget);"true"===t.attr("data-collapsed")?(t.parent().find(".pga-ex-row[data-parent^="+t.attr("data-ex-id")+"]").removeClass("d-none").filter("[data-collapsed=true]").each(function(e,t){var n=S(t);n.parent().find(".pga-ex-row[data-parent^="+n.attr("data-ex-id")+"]").addClass("d-none")}),t.attr("data-collapsed","false")):(t.parent().find(".pga-ex-row[data-parent^="+t.attr("data-ex-id")+"]").addClass("d-none"),t.attr("data-collapsed","true"))}),D}.apply(e,t))||(o.exports=n)},function(n,e,i){"use strict";(function(a){i(36),i(48);var o=e(i(0));function e(e){return e&&e.__esModule?e:{default:e}}var t=e(i(15)).default.Model.extend({defaults:{JIT:[],Triggers:[],Summary:{}},set_statistics:function(e){var t=this.get("JIT"),n=this.get("Triggers"),i=this.get("Summary");(0<Object.keys(t).length||0<Object.keys(n).length||0<Object.keys(i).length)&&(0,o.default)(".pg-explain-stats-area").removeClass("d-none");var r=(0,o.default)("<table></table>",{class:"pgadmin-tooltip-table"});0<Object.keys(t).length&&(r.append('<tr><td class="label explain-tooltip">JIT:</td></tr>'),a.each(t,function(e,t){t=a.escape(t),e=a.escape(e),r.append('\n          <tr>\n            <td class="label explain-tooltip">  '.concat(t,'</td>\n            <td class="label explain-tooltip-val">').concat(e,"</td>\n          </tr>\n        "))})),0<Object.keys(n).length&&(r.append('<tr><td class="label explain-tooltip">Triggers:</td></tr>'),a.each(n,function(e,t){e instanceof Object?a.each(e,function(e,t){"Trigger Name"===t?(t=a.escape(t),e=a.escape(e),r.append('\n                <tr>\n                  <td class="label explain-tooltip">  '.concat(t,'</td>\n                  <td class="label explain-tooltip-val">').concat(e,"</td>\n                </tr>\n              "))):(t=a.escape(t),e=a.escape(e),r.append('\n                <tr>\n                  <td class="label explain-tooltip">    '.concat(t,'</td>\n                  <td class="label explain-tooltip-val">').concat(e,"</td>\n                </tr>\n              ")))}):(t=a.escape(t),e=a.escape(e),r.append('\n            <tr>\n              <td class="label explain-tooltip">  '.concat(t,'</td>\n              <td class="label explain-tooltip-val">').concat(e,"</td>\n            </tr>\n          ")))})),0<Object.keys(i).length&&(r.append('<tr><td class="label explain-tooltip">Summary:</td></tr>'),a.each(i,function(e,t){t=a.escape(t),e=a.escape(e),r.append('\n          <tr>\n            <td class="label explain-tooltip">  '.concat(t,'</td>\n            <td class="label explain-tooltip-val">').concat(e,"</td>\n          </tr>\n        "))})),(0,o.default)(".pg-explain-stats-area").off("mouseover").on("mouseover",function(){0==Object.keys(t).length&&0==Object.keys(n).length&&0==Object.keys(i).length||(e.empty(),e.append(r),e.css({opacity:"0.8",left:"",right:"65px",top:"15px"}),(0,o.default)(".pgadmin-explain-tooltip").css("padding","5px"),(0,o.default)(".pgadmin-explain-tooltip").css("border","1px solid white"))}),(0,o.default)(".pg-explain-stats-area").off("mouseout").on("mouseout",function(){e.empty(),e.css({opacity:"0",left:0,top:0,right:""})})}});n.exports=t}).call(this,i(1))},function(e,t,n){"use strict";n(19),n(7),n(12),n(4),n(24),n(8),n(22),n(314),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={blobURL:function(e,t){var n=new Blob([e],{type:t});return(window.URL||window.webkitURL).createObjectURL(n)},downloadSVG:function(e,t){e=e.replace(/NS\d+:href/gi,"xlink:href");var n=this.blobURL(e,"image/svg+xml"),i=document.createElement("a");i.href=n,i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)}};t.default=i},function(e,t,n){"use strict";n(7),n(83),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={Aggregate:{image:"ex_aggregate.svg",image_text:"Aggregate"},Append:{image:"ex_append.svg",image_text:"Append"},"Bitmap Index Scan":function(e){return{image:"ex_bmp_index.svg",image_text:e["Index Name"]}},"Bitmap Heap Scan":function(e){return{image:"ex_bmp_heap.svg",image_text:e["Relation Name"]}},BitmapAnd:{image:"ex_bmp_and.svg",image_text:"Bitmap AND"},BitmapOr:{image:"ex_bmp_or.svg",image_text:"Bitmap OR"},"CTE Scan":{image:"ex_cte_scan.svg",image_text:"CTE Scan"},"Function Scan":{image:"ex_result.svg",image_text:"Function Scan"},"Foreign Scan":{image:"ex_foreign_scan.svg",image_text:"Foreign Scan"},Gather:{image:"ex_gather_motion.svg",image_text:"Gather"},"Gather Merge":{image:"ex_gather_merge.svg",image_text:"Gather Merge"},Group:{image:"ex_group.svg",image_text:"Group"},GroupAggregate:{image:"ex_aggregate.svg",image_text:"Group Aggregate"},Hash:{image:"ex_hash.svg",image_text:"Hash"},"Hash Join":function(e){if(!e["Join Type"])return{image:"ex_join.svg",image_text:"Join"};switch(e["Join Type"]){case"Anti":return{image:"ex_hash_anti_join.svg",image_text:"Hash Anti Join"};case"Semi":return{image:"ex_hash_semi_join.svg",image_text:"Hash Semi Join"};default:return{image:"ex_hash.svg",image_text:String("Hash "+e["Join Type"]+" Join")}}},HashAggregate:{image:"ex_aggregate.svg",image_text:"Hash Aggregate"},"Index Only Scan":function(e){return{image:"ex_index_only_scan.svg",image_text:e["Index Name"]}},"Index Scan":function(e){return{image:"ex_index_scan.svg",image_text:e["Index Name"]}},"Index Scan Backword":{image:"ex_index_scan.svg",image_text:"Index Backward Scan"},Limit:{image:"ex_limit.svg",image_text:"Limit"},LockRows:{image:"ex_lock_rows.svg",image_text:"Lock Rows"},Materialize:{image:"ex_materialize.svg",image_text:"Materialize"},"Merge Append":{image:"ex_merge_append.svg",image_text:"Merge Append"},"Merge Join":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_merge_anti_join.svg",image_text:"Merge Anti Join"};case"Semi":return{image:"ex_merge_semi_join.svg",image_text:"Merge Semi Join"};default:return{image:"ex_merge.svg",image_text:String("Merge "+e["Join Type"]+" Join")}}},ModifyTable:function(e){switch(e.Operation){case"Insert":return{image:"ex_insert.svg",image_text:"Insert"};case"Update":return{image:"ex_update.svg",image_text:"Update"};case"Delete":return{image:"ex_delete.svg",image_text:"Delete"}}},"Named Tuplestore Scan":{image:"ex_named_tuplestore_scan.svg",image_text:"Named Tuplestore Scan"},"Nested Loop":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_nested_loop_anti_join.svg",image_text:"Nested Loop Anti Join"};case"Semi":return{image:"ex_nested_loop_semi_join.svg",image_text:"Nested Loop Semi Join"};default:return{image:"ex_nested.svg",image_text:"Nested Loop "+e["Join Type"]+" Join"}}},ProjectSet:{image:"ex_projectset.svg",image_text:"ProjectSet"},"Recursive Union":{image:"ex_recursive_union.svg",image_text:"Recursive Union"},Result:{image:"ex_result.svg",image_text:"Result"},"Sample Scan":{image:"ex_scan.svg",image_text:"Sample Scan"},Scan:{image:"ex_scan.svg",image_text:"Scan"},Seek:{image:"ex_seek.svg",image_text:"Seek"},SetOp:function(e){var t=e.Strategy,n=e.Command;return"Hashed"==t?n.startsWith("Intersect")?"Intersect All"==n?{image:"ex_hash_setop_intersect_all.svg",image_text:"Hashed Intersect All"}:{image:"ex_hash_setop_intersect.svg",image_text:"Hashed Intersect"}:n.startsWith("Except")?"Except All"==n?{image:"ex_hash_setop_except_all.svg",image_text:"Hashed Except All"}:{image:"ex_hash_setop_except.svg",image_text:"Hash Except"}:{image:"ex_hash_setop_unknown.svg",image_text:"Hashed SetOp Unknown"}:{image:"ex_setop.svg",image_text:"SetOp"}},"Seq Scan":function(e){return{image:"ex_scan.svg",image_text:e["Relation Name"]}},"Subquery Scan":{image:"ex_subplan.svg",image_text:"SubQuery Scan"},Sort:{image:"ex_sort.svg",image_text:"Sort"},"Tid Scan":{image:"ex_tid_scan.svg",image_text:"Tid Scan"},"Table Function Scan":{image:"ex_table_func_scan.svg",image_text:"Table Function Scan"},Unique:{image:"ex_unique.svg",image_text:"Unique"},"Values Scan":{image:"ex_values_scan.svg",image_text:"Values Scan"},WindowAgg:{image:"ex_window_aggregate.svg",image_text:"Window Aggregate"},"WorkTable Scan":{image:"ex_worktable_scan.svg",image_text:"WorkTable Scan"},Undefined:{image:"ex_unknown.svg",image_text:"Undefined"}};t.default=i},function(e,t,n){"use strict";var i,r;n(18),n(11),i=[n(0),n(2),n(316),n(448),n(81),n(5)],void 0===(r=function(l,d,c,u,f,p){return function(e){var t=window.Slick,i=new u(e),r=new c(e),a=new t.Event,o=new t.Event,n=r.onBeforeColumnSelectAll,s=r.onColumnSelectAll;l.extend(this,{init:function(n){(this.grid=n).onHeaderClick.subscribe(function(e,t){t.column.selectAllOnClick&&!l(e.target).hasClass("slick-resizable-handle")&&function(e,t,n){f.isEntireGridSelected(e)?function(e){e.getSelectionModel().setSelectedRanges([])}(e):(a.notify(n,t),t.isPropagationStopped()||t.isImmediatePropagationStopped()||f.selectAll(e))}(n,e,t)}),n.getSelectionModel().onSelectedRangesChanged.subscribe(function(e){f.isEntireGridSelected(e)?l("[data-id='select-all']").addClass("selected"):l("[data-id='select-all']").removeClass("selected")}.bind(null,n)),n.registerPlugin(i),n.registerPlugin(r),o.subscribe(function(e,t){f.selectAll(t.grid)})},getColumnDefinitions:function(e){return e=r.getColumnDefinitions(e),(e=i.getColumnDefinitions(e))[0].selectAllOnClick=!0,e[0].name='<span data-id="select-all" title="'+d("Select/Deselect All")+'"><br>'+e[0].name+'<img class="select-all-icon" src="'+p("static",{filename:"img/select-all-icon.png"})+'"></img>',e},onBeforeGridSelectAll:a,onGridSelectAll:o,onBeforeGridColumnSelectAll:n,onGridColumnSelectAll:s})}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;n(10),n(18),n(37),i=[n(0),n(81),n(316),n(130)],void 0===(r=function(s,l,e){return function(){var t=new window.Slick.EventHandler,r=new e,n=function(e,t,n){if("row-header-column"===e.getColumns()[n.cell].id){var i=s(t.target);"row-header-selector"!=i.data("cell-type")&&(i=s(t.target).find('[data-cell-type="row-header-selector"]')),i.parent().toggleClass("selected"),a(e,n.row),r.toggleColumnHeaderForCopyHeader(e)}},i=function(r,e,a){s('[data-cell-type="row-header-selector"]').each(function(e,t){var n=s(t),i=parseInt(n.data("row"));o(r,a,i)?n.parent().addClass("selected"):n.parent().removeClass("selected")})},a=function(e,t){var n,i=e.getSelectionModel(),r=i.getSelectedRanges(),a=l.rangeForRow(e,t);n=l.isRangeSelected(r,a)?l.removeRange(r,a):l.areAllRangesSingleRows(r,e)?l.addRange(r,a):[a],i.setSelectedRanges(n)},o=function(e,t,n){var i=l.areAllRangesCompleteColumns(e,t);return function(e,t,n){var i=l.isRangeEntirelyWithinSelectedRanges(t,l.rangeForRow(e,n)),r=l.isAnyCellOfRowSelected(t,n);return i||r}(e,t,n)&&!i};s.extend(this,{init:function(e){e.getSelectionModel().onSelectedRangesChanged.subscribe(i.bind(null,e)),t.subscribe(e.onClick,n.bind(null,e))},getColumnDefinitions:function(e){return e.unshift({id:"row-header-column",name:"",selectable:!1,focusable:!1,formatter:function(e){return'<span data-row="'+e+'" data-cell-type="row-header-selector">'+(e+1)+"</span>"},width:30}),e}})}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;i=[n(0),n(81)],void 0===(r=function(w,x){return function(){var i,t=39,n=37,r=38,a=40,o=!1,s=!1,l=!1;function d(e,t){o=!0,i.setActiveCell(t.range.start.row,t.range.start.cell)}function c(e,t){if(l&&s)return s=!1,void e.stopPropagation();if(!w(e.target).hasClass("slick-resizable-handle")){o=!0;var n=t.column.pos+1;m(0,n)?v()?i.resetActiveCell():i.setActiveCell(0,b().fromCell):function(e){var t=x.rangeForColumn(i,e),n=i.getSelectionModel().getSelectedRanges();return x.isRangeSelected(n,t)}(n)||i.setActiveCell(0,n)}}function u(){l=!1}function f(){s=!(l=!0)}function p(){s=!0}function h(e,t){if(function(e){return"row-header-column"===i.getColumns()[e].id}(t.cell)){o=!0;var n=t.row;if(function(e){return e>=i.getDataLength()}(n))return;m(n,1)?v()?i.resetActiveCell():i.setActiveCell(b().fromRow,1):function(e){var t=x.rangeForRow(i,e),n=i.getSelectionModel().getSelectedRanges();return x.isRangeSelected(n,t)}(n)||i.setActiveCell(n,1)}}function g(e){o&&(o=!1,e.stopPropagation())}function _(e){y()&&function(e){return function(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey}(e)&&function(e){return e.which===t||e.which===r||e.which===n||e.which===a}(e)}(e)&&function(){var e=i.getSelectionModel(),t=e.getSelectedRanges();1<t.length&&e.setSelectedRanges([t.pop()])}()}function m(e,t){return y()&&i.getActiveCell().row===e&&i.getActiveCell().cell===t}function v(){return 1===i.getSelectionModel().getSelectedRanges().length}function b(){var e=i.getSelectionModel().getSelectedRanges();return e[e.length-2]}function y(){return!!i.getActiveCell()}w.extend(this,{init:function(e){(i=e).onDragEnd.subscribe(d),i.onHeaderClick.subscribe(c),i.onClick.subscribe(h),i.onActiveCellChanged.subscribe(g),i.onKeyDown.subscribe(_),i.onHeaderMouseEnter.subscribe(f),i.onHeaderMouseLeave.subscribe(u),i.onColumnsResized.subscribe(p)},destroy:function(){i.onDragEnd.unsubscribe(d),i.onHeaderClick.unsubscribe(c),i.onActiveCellChanged.unsubscribe(g),i.onKeyDown.unsubscribe(_),i.onHeaderMouseEnter.unsubscribe(f),i.onHeaderMouseLeave.unsubscribe(u),i.onColumnsResized.unsubscribe(p)}})}}.apply(t,i))||(e.exports=r)},function(n,i,r){"use strict";(function(c){var e,t;r(58),r(23),r(40),r(95),r(33),r(18),r(12),r(46),r(63),e=[r(81),r(318)],void 0===(t=function(l,d){return{getUnion:function(e){if(c.isEmpty(e))return[];e.sort(function(e,t){return e[0]-t[0]});var n=[e[0]];return e.forEach(function(e){var t=c.last(n);!function(e,t){return e[0]<=t[1]+1}(e,t)?n.push(e):function(e,t){return e[1]<=t[1]}(e,t)||(t[1]=e[1])}),n},mapDimensionBoundaryUnion:function(e,n){var i=[];return e.forEach(function(e){for(var t=e[0];t<=e[1];t+=1)i.push(n(t))}),i},mapOver2DArray:function(e,t,n,i){var r=this.getUnion(e),a=this.getUnion(t);return this.mapDimensionBoundaryUnion(r,function(t){var e=this.mapDimensionBoundaryUnion(a,function(e){return n(t,e)});return i(e)}.bind(this))},getHeaderData:function(e,t){var n=[],i=t.field_separator||"\t",r=t.quote_char||'"';return c.each(e,function(e){e.display_name&&e.selected&&n.push(r+e.display_name+r)}),n.join(i)},rangesToCsv:function(e,t,n,i,r){var a=n.map(function(e){return[e.fromRow,e.toRow]}),o=n.map(function(e){return[e.fromCell,e.toCell]});l.isFirstColumnData(t)||(o=this.removeFirstColumn(o));var s=this.mapOver2DArray(a,o,this.csvCell.bind(this,e,t,i),function(e){var t=i.field_separator||"\t";return e.join(t)});if(r){return this.getHeaderData(t,i)+"\n"+s.join("\n")}return s.join("\n")},removeFirstColumn:function(e){var t=this.getUnion(e);if(0==t.length)return[];return 0==t[0][0]&&(0==t[0][1]?t.shift():t[0][0]=1),t},csvCell:function(e,t,n,i,r){var a=e[i][t[r].field],o=t[r].cell||"",s=n.quoting||"strings",l=n.quote_char||'"';return"all"==s?a&&c.isObject(a)?a=l+d.stringify(a)+l:a?a=l+a.toString()+l:(c.isNull(a)||c.isUndefined(a))&&(a=""):"strings"==s&&(a&&c.isObject(a)?a=l+d.stringify(a)+l:a&&"number"!=o&&"boolean"!=o?a=l+a.toString()+l:(c.isNull(a)||c.isUndefined(a))&&(a="")),a}}}.apply(i,e))||(n.exports=t)}).call(this,r(1))},function(t,n,i){var r;!function(){"use strict";var e,j=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,M=Math.ceil,I=Math.floor,L="[BigNumber Error] ",B=L+"Number primitive has more than 15 significant digits: ",U=1e14,V=14,z=9007199254740991,F=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],H=1e7,K=1e9;function G(e){var t=0|e;return 0<e||e===t?t:t-1}function $(e){for(var t,n,i=1,r=e.length,a=e[0]+"";i<r;){for(t=e[i++]+"",n=V-t.length;n--;t="0"+t);a+=t}for(r=a.length;48===a.charCodeAt(--r););return a.slice(0,r+1||1)}function J(e,t){var n,i,r=e.c,a=t.c,o=e.s,s=t.s,l=e.e,d=t.e;if(!o||!s)return null;if(n=r&&!r[0],i=a&&!a[0],n||i)return n?i?0:-s:o;if(o!=s)return o;if(n=o<0,i=l==d,!r||!a)return i?0:!r^n?1:-1;if(!i)return d<l^n?1:-1;for(s=(l=r.length)<(d=a.length)?l:d,o=0;o<s;o++)if(r[o]!=a[o])return r[o]>a[o]^n?1:-1;return l==d?0:d<l^n?1:-1}function Q(e,t,n,i){if(e<t||n<e||e!==(e<0?M(e):I(e)))throw Error(L+(i||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+e)}function W(e){return"[object Array]"==Object.prototype.toString.call(e)}function Y(e){var t=e.c.length-1;return G(e.e/V)==t&&e.c[t]%2!=0}function Z(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function X(e,t,n){var i,r;if(t<0){for(r=n+".";++t;r+=n);e=r+e}else if(++t>(i=e.length)){for(r=n,t-=i;--t;r+=n);e+=r}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}(e=function e(t){var _,u,f,n,d,m,o,s,l,c,p,i=T.prototype={constructor:T,toString:null,valueOf:null},h=new T(1),v=20,b=4,g=-7,r=21,y=-1e7,w=1e7,x=!1,a=1,S=0,C={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"",fractionGroupSize:0},k="0123456789abcdefghijklmnopqrstuvwxyz";function T(e,t){var n,i,r,a,o,s,l,d,c=this;if(!(c instanceof T))return new T(e,t);if(null==t){if(e instanceof T)return c.s=e.s,c.e=e.e,void(c.c=(e=e.c)?e.slice():e);if((s="number"==typeof e)&&0*e==0){if(c.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,o=e;10<=o;o/=10,a++);return c.e=a,void(c.c=[e])}d=e+""}else{if(!j.test(d=e+""))return f(c,d,s);c.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}-1<(a=d.indexOf("."))&&(d=d.replace(".","")),0<(o=d.search(/e/i))?(a<0&&(a=o),a+=+d.slice(o+1),d=d.substring(0,o)):a<0&&(a=d.length)}else{if(Q(t,2,k.length,"Base"),d=e+"",10==t)return R(c=new T(e instanceof T?e:d),v+c.e+1,b);if(s="number"==typeof e){if(0*e!=0)return f(c,d,s,t);if(c.s=1/e<0?(d=d.slice(1),-1):1,T.DEBUG&&15<d.replace(/^0\.0*|\./,"").length)throw Error(B+e);s=!1}else c.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(n=k.slice(0,t),a=o=0,l=d.length;o<l;o++)if(n.indexOf(i=d.charAt(o))<0){if("."==i){if(a<o){a=l;continue}}else if(!r&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){r=!0,o=-1,a=0;continue}return f(c,e+"",s,t)}-1<(a=(d=u(d,t,10,c.s)).indexOf("."))?d=d.replace(".",""):a=d.length}for(o=0;48===d.charCodeAt(o);o++);for(l=d.length;48===d.charCodeAt(--l););if(d=d.slice(o,++l)){if(l-=o,s&&T.DEBUG&&15<l&&(z<e||e!==I(e)))throw Error(B+c.s*e);if(w<(a=a-o-1))c.c=c.e=null;else if(a<y)c.c=[c.e=0];else{if(c.e=a,c.c=[],o=(a+1)%V,a<0&&(o+=V),o<l){for(o&&c.c.push(+d.slice(0,o)),l-=V;o<l;)c.c.push(+d.slice(o,o+=V));d=d.slice(o),o=V-d.length}else o-=l;for(;o--;d+="0");c.c.push(+d)}}else c.c=[c.e=0]}function E(e,t,n,i){for(var r,a,o=[0],s=0,l=e.length;s<l;){for(a=o.length;a--;o[a]*=t);for(o[0]+=i.indexOf(e.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function P(e,t,n){var i,r,a,o,s=0,l=e.length,d=t%H,c=t/H|0;for(e=e.slice();l--;)s=((r=d*(a=e[l]%H)+(i=c*a+(o=e[l]/H|0)*d)%H*H+s)/n|0)+(i/H|0)+c*o,e[l]=r%n;return s&&(e=[s].concat(e)),e}function O(e,t,n,i){var r,a;if(n!=i)a=i<n?1:-1;else for(r=a=0;r<n;r++)if(e[r]!=t[r]){a=e[r]>t[r]?1:-1;break}return a}function N(e,t,n,i){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*i+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}function D(e,t,n,i){var r,a,o,s,l;if(null==n?n=b:Q(n,0,8),!e.c)return e.toString();if(r=e.c[0],o=e.e,null==t)l=$(e.c),l=1==i||2==i&&o<=g?Z(l,o):X(l,o,"0");else if(a=(e=R(new T(e),t,n)).e,s=(l=$(e.c)).length,1==i||2==i&&(t<=a||a<=g)){for(;s<t;l+="0",s++);l=Z(l,a)}else if(t-=o,l=X(l,a,"0"),s<a+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=a-s))for(a+1==s&&(l+=".");t--;l+="0");return e.s<0&&r?"-"+l:l}function q(e,t){var n,i,r=0;for(W(e[0])&&(e=e[0]),n=new T(e[0]);++r<e.length;){if(!(i=new T(e[r])).s){n=i;break}t.call(n,i)&&(n=i)}return n}function A(e,t,n){for(var i=1,r=t.length;!t[--r];t.pop());for(r=t[0];10<=r;r/=10,i++);return(n=i+n*V-1)>w?e.c=e.e=null:n<y?e.c=[e.e=0]:(e.e=n,e.c=t),e}function R(e,t,n,i){var r,a,o,s,l,d,c,u=e.c,f=F;if(u){e:{for(r=1,s=u[0];10<=s;s/=10,r++);if((a=t-r)<0)a+=V,o=t,c=(l=u[d=0])/f[r-o-1]%10|0;else if((d=M((a+1)/V))>=u.length){if(!i)break e;for(;u.length<=d;u.push(0));l=c=0,o=(a%=V)-V+(r=1)}else{for(l=s=u[d],r=1;10<=s;s/=10,r++);c=(o=(a%=V)-V+r)<0?0:l/f[r-o-1]%10|0}if(i=i||t<0||null!=u[d+1]||(o<0?l:l%f[r-o-1]),i=n<4?(c||i)&&(0==n||n==(e.s<0?3:2)):5<c||5==c&&(4==n||i||6==n&&(0<a?0<o?l/f[r-o]:0:u[d-1])%10&1||n==(e.s<0?8:7)),t<1||!u[0])return u.length=0,i?(t-=e.e+1,u[0]=f[(V-t%V)%V],e.e=-t||0):u[0]=e.e=0,e;if(0==a?(u.length=d,s=1,d--):(u.length=d+1,s=f[V-a],u[d]=0<o?I(l/f[r-o]%f[o])*s:0),i)for(;;){if(0==d){for(a=1,o=u[0];10<=o;o/=10,a++);for(o=u[0]+=s,s=1;10<=o;o/=10,s++);a!=s&&(e.e++,u[0]==U&&(u[0]=1));break}if(u[d]+=s,u[d]!=U)break;u[d--]=0,s=1}for(a=u.length;0===u[--a];u.pop());}e.e>w?e.c=e.e=null:e.e<y&&(e.c=[e.e=0])}return e}return T.clone=e,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(L+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(Q(n=e[t],0,K,t),v=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(Q(n=e[t],0,8,t),b=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&(W(n=e[t])?(Q(n[0],-K,0,t),Q(n[1],0,K,t),g=n[0],r=n[1]):(Q(n,-K,K,t),g=-(r=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if(W(n=e[t]))Q(n[0],-K,-1,t),Q(n[1],1,K,t),y=n[0],w=n[1];else{if(Q(n,-K,K,t),!n)throw Error(L+t+" cannot be zero: "+n);y=-(w=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(L+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw x=!n,Error(L+"crypto unavailable");x=n}else x=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(Q(n=e[t],0,9,t),a=n),e.hasOwnProperty(t="POW_PRECISION")&&(Q(n=e[t],0,K,t),S=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(L+t+" not an object: "+n);C=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|\.|(.).*\1/.test(n))throw Error(L+t+" invalid: "+n);k=n}}return{DECIMAL_PLACES:v,ROUNDING_MODE:b,EXPONENTIAL_AT:[g,r],RANGE:[y,w],CRYPTO:x,MODULO_MODE:a,POW_PRECISION:S,FORMAT:C,ALPHABET:k}},T.isBigNumber=function(e){return e instanceof T||e&&!0===e._isBigNumber||!1},T.maximum=T.max=function(){return q(arguments,i.lt)},T.minimum=T.min=function(){return q(arguments,i.gt)},T.random=(n=9007199254740992,d=Math.random()*n&2097151?function(){return I(Math.random()*n)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,i,r,a,o=0,s=[],l=new T(h);if(null==e?e=v:Q(e,0,K),r=M(e/V),x)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(r*=2));o<r;)9e15<=(a=131072*t[o]+(t[o+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[o]=n[0],t[o+1]=n[1]):(s.push(a%1e14),o+=2);o=r/2}else{if(!crypto.randomBytes)throw x=!1,Error(L+"crypto unavailable");for(t=crypto.randomBytes(r*=7);o<r;)9e15<=(a=281474976710656*(31&t[o])+1099511627776*t[o+1]+4294967296*t[o+2]+16777216*t[o+3]+(t[o+4]<<16)+(t[o+5]<<8)+t[o+6])?crypto.randomBytes(7).copy(t,o):(s.push(a%1e14),o+=7);o=r/7}if(!x)for(;o<r;)(a=d())<9e15&&(s[o++]=a%1e14);for(r=s[--o],e%=V,r&&e&&(a=F[V-e],s[o]=I(r/a)*a);0===s[o];s.pop(),o--);if(o<0)s=[i=0];else{for(i=-1;0===s[0];s.splice(0,1),i-=V);for(o=1,a=s[0];10<=a;a/=10,o++);o<V&&(i-=V-o)}return l.e=i,l.c=s,l}),m="0123456789",u=function(e,t,n,i,r){var a,o,s,l,d,c,u,f,p=e.indexOf("."),h=v,g=b;for(0<=p&&(l=S,S=0,e=e.replace(".",""),c=(f=new T(t)).pow(e.length-p),S=l,f.c=E(X($(c.c),c.e,"0"),10,n,m),f.e=f.c.length),s=l=(u=E(e,t,n,r?(a=k,m):(a=m,k))).length;0==u[--l];u.pop());if(!u[0])return a.charAt(0);if(p<0?--s:(c.c=u,c.e=s,c.s=i,u=(c=_(c,f,h,g,n)).c,d=c.r,s=c.e),p=u[o=s+h+1],l=n/2,d=d||o<0||null!=u[o+1],d=g<4?(null!=p||d)&&(0==g||g==(c.s<0?3:2)):l<p||p==l&&(4==g||d||6==g&&1&u[o-1]||g==(c.s<0?8:7)),o<1||!u[0])e=d?X(a.charAt(1),-h,a.charAt(0)):a.charAt(0);else{if(u.length=o,d)for(--n;++u[--o]>n;)u[o]=0,o||(++s,u=[1].concat(u));for(l=u.length;!u[--l];);for(p=0,e="";p<=l;e+=a.charAt(u[p++]));e=X(e,s,a.charAt(0))}return e},_=function(e,t,n,i,r){var a,o,s,l,d,c,u,f,p,h,g,_,m,v,b,y,w,x=e.s==t.s?1:-1,S=e.c,C=t.c;if(!(S&&S[0]&&C&&C[0]))return new T(e.s&&t.s&&(S?!C||S[0]!=C[0]:C)?S&&0==S[0]||!C?0*x:x/0:NaN);for(p=(f=new T(x)).c=[],x=n+(o=e.e-t.e)+1,r||(r=U,o=G(e.e/V)-G(t.e/V),x=x/V|0),s=0;C[s]==(S[s]||0);s++);if(C[s]>(S[s]||0)&&o--,x<0)p.push(1),l=!0;else{for(v=S.length,y=C.length,x+=2,1<(d=I(r/(C[s=0]+1)))&&(C=P(C,d,r),S=P(S,d,r),y=C.length,v=S.length),m=y,g=(h=S.slice(0,y)).length;g<y;h[g++]=0);w=C.slice(),w=[0].concat(w),b=C[0],C[1]>=r/2&&b++;do{if(d=0,(a=O(C,h,y,g))<0){if(_=h[0],y!=g&&(_=_*r+(h[1]||0)),1<(d=I(_/b)))for(r<=d&&(d=r-1),u=(c=P(C,d,r)).length,g=h.length;1==O(c,h,u,g);)d--,N(c,y<u?w:C,u,r),u=c.length,a=1;else 0==d&&(a=d=1),u=(c=C.slice()).length;if(u<g&&(c=[0].concat(c)),N(h,c,g,r),g=h.length,-1==a)for(;O(C,h,y,g)<1;)d++,N(h,y<g?w:C,g,r),g=h.length}else 0===a&&(d++,h=[0]);p[s++]=d,h[0]?h[g++]=S[m]||0:(h=[S[m]],g=1)}while((m++<v||null!=h[0])&&x--);l=null!=h[0],p[0]||p.splice(0,1)}if(r==U){for(s=1,x=p[0];10<=x;x/=10,s++);R(f,n+(f.e=s+o*V-1)+1,i,l)}else f.e=o,f.r=+l;return f},o=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,l=/^\.([^.]+)$/,c=/^-?(Infinity|NaN)$/,p=/^\s*\+(?=[\w.])|^\s+|\s+$/g,f=function(e,t,n,i){var r,a=n?t:t.replace(p,"");if(c.test(a))e.s=isNaN(a)?null:a<0?-1:1,e.c=e.e=null;else{if(!n&&(a=a.replace(o,function(e,t,n){return r="x"==(n=n.toLowerCase())?16:"b"==n?2:8,i&&i!=r?e:t}),i&&(r=i,a=a.replace(s,"$1").replace(l,"0.$1")),t!=a))return new T(a,r);if(T.DEBUG)throw Error(L+"Not a"+(i?" base "+i:"")+" number: "+t);e.c=e.e=e.s=null}},i.absoluteValue=i.abs=function(){var e=new T(this);return e.s<0&&(e.s=1),e},i.comparedTo=function(e,t){return J(this,new T(e,t))},i.decimalPlaces=i.dp=function(e,t){var n,i,r;if(null!=e)return Q(e,0,K),null==t?t=b:Q(t,0,8),R(new T(this),e+this.e+1,t);if(!(n=this.c))return null;if(i=((r=n.length-1)-G(this.e/V))*V,r=n[r])for(;r%10==0;r/=10,i--);return i<0&&(i=0),i},i.dividedBy=i.div=function(e,t){return _(this,new T(e,t),v,b)},i.dividedToIntegerBy=i.idiv=function(e,t){return _(this,new T(e,t),0,1)},i.exponentiatedBy=i.pow=function(e,t){var n,i,r,a,o,s,l,d=this;if((e=new T(e)).c&&!e.isInteger())throw Error(L+"Exponent not an integer: "+e);if(null!=t&&(t=new T(t)),a=14<e.e,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!e.c||!e.c[0])return l=new T(Math.pow(+d.valueOf(),a?2-Y(e):+e)),t?l.mod(t):l;if(o=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new T(NaN);(i=!o&&d.isInteger()&&t.isInteger())&&(d=d.mod(t))}else{if(9<e.e&&(0<d.e||d.e<-1||(0==d.e?1<d.c[0]||a&&24e7<=d.c[1]:d.c[0]<8e13||a&&d.c[0]<=9999975e7)))return r=d.s<0&&Y(e)?-0:0,-1<d.e&&(r=1/r),new T(o?1/r:r);S&&(r=M(S/V+2))}for(s=a?(n=new T(.5),Y(e)):e%2,o&&(e.s=1),l=new T(h);;){if(s){if(!(l=l.times(d)).c)break;r?l.c.length>r&&(l.c.length=r):i&&(l=l.mod(t))}if(a){if(R(e=e.times(n),e.e+1,1),!e.c[0])break;a=14<e.e,s=Y(e)}else{if(!(e=I(e/2)))break;s=e%2}d=d.times(d),r?d.c&&d.c.length>r&&(d.c.length=r):i&&(d=d.mod(t))}return i?l:(o&&(l=h.div(l)),t?l.mod(t):r?R(l,S,b,void 0):l)},i.integerValue=function(e){var t=new T(this);return null==e?e=b:Q(e,0,8),R(t,t.e+1,e)},i.isEqualTo=i.eq=function(e,t){return 0===J(this,new T(e,t))},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(e,t){return 0<J(this,new T(e,t))},i.isGreaterThanOrEqualTo=i.gte=function(e,t){return 1===(t=J(this,new T(e,t)))||0===t},i.isInteger=function(){return!!this.c&&G(this.e/V)>this.c.length-2},i.isLessThan=i.lt=function(e,t){return J(this,new T(e,t))<0},i.isLessThanOrEqualTo=i.lte=function(e,t){return-1===(t=J(this,new T(e,t)))||0===t},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return 0<this.s},i.isZero=function(){return!!this.c&&0==this.c[0]},i.minus=function(e,t){var n,i,r,a,o=this.s;if(t=(e=new T(e,t)).s,!o||!t)return new T(NaN);if(o!=t)return e.s=-t,this.plus(e);var s=this.e/V,l=e.e/V,d=this.c,c=e.c;if(!s||!l){if(!d||!c)return d?(e.s=-t,e):new T(c?this:NaN);if(!d[0]||!c[0])return c[0]?(e.s=-t,e):new T(d[0]?this:3==b?-0:0)}if(s=G(s),l=G(l),d=d.slice(),o=s-l){for((r=(a=o<0)?(o=-o,d):(l=s,c)).reverse(),t=o;t--;r.push(0));r.reverse()}else for(i=(a=(o=d.length)<(t=c.length))?o:t,o=t=0;t<i;t++)if(d[t]!=c[t]){a=d[t]<c[t];break}if(a&&(r=d,d=c,c=r,e.s=-e.s),0<(t=(i=c.length)-(n=d.length)))for(;t--;d[n++]=0);for(t=U-1;o<i;){if(d[--i]<c[i]){for(n=i;n&&!d[--n];d[n]=t);--d[n],d[i]+=U}d[i]-=c[i]}for(;0==d[0];d.splice(0,1),--l);return d[0]?A(e,d,l):(e.s=3==b?-1:1,e.c=[e.e=0],e)},i.modulo=i.mod=function(e,t){var n,i;return e=new T(e,t),!this.c||!e.s||e.c&&!e.c[0]?new T(NaN):!e.c||this.c&&!this.c[0]?new T(this):(9==a?(i=e.s,e.s=1,n=_(this,e,0,3),e.s=i,n.s*=i):n=_(this,e,0,a),(e=this.minus(n.times(e))).c[0]||1!=a||(e.s=this.s),e)},i.multipliedBy=i.times=function(e,t){var n,i,r,a,o,s,l,d,c,u,f,p,h,g,_,m=this.c,v=(e=new T(e,t)).c;if(!(m&&v&&m[0]&&v[0]))return!this.s||!e.s||m&&!m[0]&&!v||v&&!v[0]&&!m?e.c=e.e=e.s=null:(e.s*=this.s,m&&v?(e.c=[0],e.e=0):e.c=e.e=null),e;for(i=G(this.e/V)+G(e.e/V),e.s*=this.s,(l=m.length)<(u=v.length)&&(h=m,m=v,v=h,r=l,l=u,u=r),r=l+u,h=[];r--;h.push(0));for(g=U,_=H,r=u;0<=--r;){for(n=0,f=v[r]%_,p=v[r]/_|0,a=r+(o=l);r<a;)n=((d=f*(d=m[--o]%_)+(s=p*d+(c=m[o]/_|0)*f)%_*_+h[a]+n)/g|0)+(s/_|0)+p*c,h[a--]=d%g;h[a]=n}return n?++i:h.splice(0,1),A(e,h,i)},i.negated=function(){var e=new T(this);return e.s=-e.s||null,e},i.plus=function(e,t){var n,i=this.s;if(t=(e=new T(e,t)).s,!i||!t)return new T(NaN);if(i!=t)return e.s=-t,this.minus(e);var r=this.e/V,a=e.e/V,o=this.c,s=e.c;if(!r||!a){if(!o||!s)return new T(i/0);if(!o[0]||!s[0])return s[0]?e:new T(o[0]?this:0*i)}if(r=G(r),a=G(a),o=o.slice(),i=r-a){for((n=0<i?(a=r,s):(i=-i,o)).reverse();i--;n.push(0));n.reverse()}for((i=o.length)-(t=s.length)<0&&(n=s,s=o,o=n,t=i),i=0;t;)i=(o[--t]=o[t]+s[t]+i)/U|0,o[t]=U===o[t]?0:o[t]%U;return i&&(o=[i].concat(o),++a),A(e,o,a)},i.precision=i.sd=function(e,t){var n,i,r;if(null!=e&&e!==!!e)return Q(e,1,K),null==t?t=b:Q(t,0,8),R(new T(this),e,t);if(!(n=this.c))return null;if(i=(r=n.length-1)*V+1,r=n[r]){for(;r%10==0;r/=10,i--);for(r=n[0];10<=r;r/=10,i++);}return e&&this.e+1>i&&(i=this.e+1),i},i.shiftedBy=function(e){return Q(e,-z,z),this.times("1e"+e)},i.squareRoot=i.sqrt=function(){var e,t,n,i,r,a=this.c,o=this.s,s=this.e,l=v+4,d=new T("0.5");if(1!==o||!a||!a[0])return new T(!o||o<0&&(!a||a[0])?NaN:a?this:1/0);if((n=0==(o=Math.sqrt(+this))||o==1/0?(((t=$(a)).length+s)%2==0&&(t+="0"),o=Math.sqrt(t),s=G((s+1)/2)-(s<0||s%2),new T(t=o==1/0?"1e"+s:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+s)):new T(o+"")).c[0])for((o=(s=n.e)+l)<3&&(o=0);;)if(r=n,n=d.times(r.plus(_(this,r,l,1))),$(r.c).slice(0,o)===(t=$(n.c)).slice(0,o)){if(n.e<s&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(R(n,n.e+v+2,1),e=!n.times(n).eq(this));break}if(!i&&(R(r,r.e+v+2,0),r.times(r).eq(this))){n=r;break}l+=4,o+=4,i=1}return R(n,n.e+v+1,b,e)},i.toExponential=function(e,t){return null!=e&&(Q(e,0,K),e++),D(this,e,t,1)},i.toFixed=function(e,t){return null!=e&&(Q(e,0,K),e=e+this.e+1),D(this,e,t)},i.toFormat=function(e,t){var n=this.toFixed(e,t);if(this.c){var i,r=n.split("."),a=+C.groupSize,o=+C.secondaryGroupSize,s=C.groupSeparator,l=r[0],d=r[1],c=this.s<0,u=c?l.slice(1):l,f=u.length;if(o&&(i=a,a=o,f-=o=i),0<a&&0<f){for(i=f%a||a,l=u.substr(0,i);i<f;i+=a)l+=s+u.substr(i,a);0<o&&(l+=s+u.slice(i)),c&&(l="-"+l)}n=d?l+C.decimalSeparator+((o=+C.fractionGroupSize)?d.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+C.fractionGroupSeparator):d):l}return n},i.toFraction=function(e){var t,n,i,r,a,o,s,l,d,c,u,f,p=this.c;if(null!=e&&(!(l=new T(e)).isInteger()&&(l.c||1!==l.s)||l.lt(h)))throw Error(L+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+e);if(!p)return this.toString();for(n=new T(h),c=i=new T(h),r=d=new T(h),f=$(p),o=n.e=f.length-this.e-1,n.c[0]=F[(s=o%V)<0?V+s:s],e=!e||0<l.comparedTo(n)?0<o?n:c:l,s=w,w=1/0,l=new T(f),d.c[0]=0;u=_(l,n,0,1),1!=(a=i.plus(u.times(r))).comparedTo(e);)i=r,r=a,c=d.plus(u.times(a=c)),d=a,n=l.minus(u.times(a=n)),l=a;return a=_(e.minus(i),r,0,1),d=d.plus(a.times(c)),i=i.plus(a.times(r)),d.s=c.s=this.s,t=_(c,r,o*=2,b).minus(this).abs().comparedTo(_(d,i,o,b).minus(this).abs())<1?[c.toString(),r.toString()]:[d.toString(),i.toString()],w=s,t},i.toNumber=function(){return+this},i.toPrecision=function(e,t){return null!=e&&Q(e,1,K),D(this,e,t,2)},i.toString=function(e){var t,n=this.s,i=this.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=$(this.c),t=null==e?i<=g||r<=i?Z(t,i):X(t,i,"0"):(Q(e,2,k.length,"Base"),u(X(t,i,"0"),10,e,n,!0)),n<0&&this.c[0]&&(t="-"+t)),t},i.valueOf=i.toJSON=function(){var e,t=this.e;return null===t?this.toString():(e=$(this.c),e=t<=g||r<=t?Z(e,t):X(e,t,"0"),this.s<0?"-"+e:e)},i._isBigNumber=!0,null!=t&&T.set(t),T}()).default=e.BigNumber=e,void 0===(r=function(){return e}.call(n,i,n,t))||(t.exports=r)}()},function(e,t,n){"use strict";var i,r;i=[n(317),n(81)],void 0===(r=function(a,o){return function(e,t){var n=e.keyCode,i=e.ctrlKey||e.metaKey,r=this||window;r.slickgrid=t.grid,r.csvOptions,i&&67==n&&a.apply(r),i&&65==n&&o.selectAll(r.slickgrid)}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;i=[n(0),n(1),n(81),n(41),n(130)],void 0===(r=function(f,p,h,g){return function(t){var v,n,b=39,y=37,w=38,x=40,S=window.Slick,i=[],r=this,a=new S.CellRangeSelector({selectionCss:{border:"2px solid black"},offset:{top:0,left:-1,height:2,width:1}}),o={selectActiveCell:!0};function C(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];v.canCellBeSelected(i.fromRow,i.fromCell)&&v.canCellBeSelected(i.toRow,i.toCell)&&t.push(i)}return t}function k(e){(i&&0!==i.length||e&&0!==e.length)&&(i=C(e),r.onSelectedRangesChanged.notify(i))}function T(){return i}function s(e){if(v.getEditorLock().isActive())return e.stopPropagation(),!1}function l(e,t){k([t.range])}function d(e,t){n.selectActiveCell&&null!=t.row&&null!=t.cell&&k([new S.Range(t.row,t.cell)])}function E(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey&&function(e){return e.which==b||e.which==y||e.which==w||e.which==x}(e)}function c(t){var e,n,i,r,a,o,s,l,d,c,u,f=v.getActiveCell();function p(e){return t.which===e}if(f&&E(t)){(e=T()).length||e.push(new S.Range(f.row,f.cell)),(n=e.pop()).contains(f.row,f.cell)||(n=new S.Range(f.row,f.cell));var h=(c=f,(u={}).row=(d=n).fromRow===c.row?d.toRow:d.fromRow,u.cell=d.fromCell===c.cell?d.toCell:d.fromCell,u);switch(t.which){case y:h.cell-=1;break;case b:h.cell+=1;break;case w:h.row-=1;break;case x:h.row+=1}var g=(r=h,a=(i=f).cell<=r.cell?i.cell:r.cell,o=i.cell<=r.cell?r.cell:i.cell,s=i.row<=r.row?i.row:r.row,l=i.row<=r.row?r.row:i.row,new S.Range(s,a,l,o));if(function(e){return C([e]).length}(g)){var _=f.row===g.fromRow?g.toRow:g.fromRow,m=f.cell===g.fromCell?g.toCell:g.fromCell;p(b)||p(y)?v.scrollColumnIntoView(m):(p(w)||p(x))&&v.scrollRowIntoView(_),e.push(g)}else e.push(n);k(e),t.preventDefault(),t.stopPropagation()}}function u(){var e=a.getCurrentRange();p.isUndefined(e)||v.onDragEnd.notify({range:e})}f.extend(this,{getSelectedRanges:T,setSelectedRanges:k,setSelectedRows:function(e){i=[];for(var t=0;t<e.length;t++)i.push(h.rangeForRow(v,e[t]))},init:function(e){n=f.extend(!0,{},o,t),(v=e).onActiveCellChanged.subscribe(d),v.onKeyDown.subscribe(c),e.registerPlugin(a),a.onCellRangeSelected.subscribe(l),a.onBeforeCellRangeSelected.subscribe(s),f(g.default).on("mouseup",u)},destroy:function(){v.onActiveCellChanged.unsubscribe(d),v.onKeyDown.unsubscribe(c),a.onCellRangeSelected.unsubscribe(l),a.onBeforeCellRangeSelected.unsubscribe(s),v.unregisterPlugin(a),f(g.default).off("mouseup",u)},onSelectedRangesChanged:new S.Event})}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i,r;n(10),n(19),n(455),n(12),n(22),i=[n(0),n(1),n(81)],void 0===(r=function(t,o,r){function a(e){t(e).prop("disabled",!0)}function s(e){t(e).prop("disabled",!1)}function l(e,i,r,a){return o.reduce(e,function(e,t){var n=r.getItem(t);return function(t,e){if(o.isUndefined(t))return!0;return!o.isUndefined(o.find(e,function(e){return o.isUndefined(t[e])}))}(n,i)||(e[n[a]]=function(t,n){var i={};t&&t.length&&o.each(o.keys(n),function(e){o.contains(t,e)&&(i[e]=n[e])});return i}(i,n)),e},{})}return function(){var t=this;function e(e){t.editor.handler.data_store.staged_rows=e}if(a("#btn-delete-row"),a("#btn-copy-row"),0<this.selection.getSelectedRanges().length&&s("#btn-copy-row"),r.areAllRangesCompleteRows(t.grid,t.selection.getSelectedRanges())){var n=r.getIndexesOfCompleteRows(this.grid,this.selection.getSelectedRanges()),i=function(e,t){var n=e.grid.getData();return l(t,o.keys(e.keys),n,e.client_primary_key)}(t,n);e(i),o.isEmpty(i)&&this.selection.setSelectedRows([]),t.editor.handler.can_edit&&!o.isEmpty(i)&&s("#btn-delete-row")}else e({})}}.apply(t,i))||(e.exports=r)},function(e,t,n){"use strict";var i=n(17),r=n(456).left;i({target:"Array",proto:!0,forced:n(86)("reduce")},{reduce:function(e,t){return r(this,e,arguments.length,1<arguments.length?t:void 0)}})},function(e,t,n){function i(d){return function(e,t,n,i){c(t);var r=u(e),a=f(r),o=p(r.length),s=d?o-1:0,l=d?-1:1;if(n<2)for(;;){if(s in a){i=a[s],s+=l;break}if(s+=l,d?s<0:o<=s)throw TypeError("Reduce of empty array with no initial value")}for(;d?0<=s:s<o;s+=l)s in a&&(i=t(i,a[s],s,r));return i}}var c=n(92),u=n(64),f=n(108),p=n(61);e.exports={left:i(!1),right:i(!0)}},function(_,e,m){"use strict";(function(t){m(21),m(26),m(27),m(19),m(33),m(7),m(32),m(12),m(24),m(49),m(22),m(6);var n=a(m(2)),i=a(m(0)),r=a(m(5)),o=a(m(70)),s=e(m(219)),l=e(m(319));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function e(e){if(e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function a(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}var h=function(){function t(e){u(this,t),this.sqlEditor=e}return p(t,[{key:"setMessage",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:message",(0,n.default)(e))}},{key:"show",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:show",e)}},{key:"hide",value:function(){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:hide")}}]),t}(),g=function(){function a(e,t){u(this,a),this.sqlServerObject=e,this.loadingScreen=new h(e),this.userManagement=t}return p(a,[{key:"delayedPoll",value:function(){var e=this;setTimeout(function(){e.poll()},e.sqlServerObject.POLL_FALLBACK_TIME())}},{key:"execute",value:function(e,t,n){if(!(e.length<=0)){var i=this;i.explainPlan=t;var r=a.prepareAnalyzeSql(e,t);i.initializeExecutionOnSqlEditor(r),o.default.post(this.generateURLReconnectionFlag(n),JSON.stringify(r),{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.data;i.removeGridViewMarker(),i.updateSqlEditorLastTransactionStatus(t.data.transaction_status),a.isSqlCorrect(t)?(i.loadingScreen.setMessage("Waiting for the query to complete..."),i.updateSqlEditorStateWithInformationFromServer(t.data),i.delayedPoll()):(i.loadingScreen.hide(),i.enableSQLEditorButtons(),e.data.data.transaction_status==l.TRANSACTION_STATUS_INTRANS||e.data.data.transaction_status==l.TRANSACTION_STATUS_INERROR?i.enableTransactionButtons():i.disableTransactionButtons(),i.sqlServerObject.update_msg_history(!1,t.data.result),"notifies"in t.data&&i.sqlServerObject.update_notifications(t.data.notifies),i.sqlServerObject._highlight_error(t.data.result))}).catch(function(e){i.onExecuteHTTPError(e)})}}},{key:"generateURLReconnectionFlag",value:function(e){var t=(0,r.default)("sqleditor.query_tool_start",{trans_id:this.sqlServerObject.transId});return e&&(t+="?connect=1"),t}},{key:"poll",value:function(){var t=this,i=this;o.default.get((0,r.default)("sqleditor.poll",{trans_id:i.sqlServerObject.transId})).then(function(e){i.updateSqlEditorLastTransactionStatus(e.data.data.transaction_status),e.data.data.transaction_status==l.TRANSACTION_STATUS_INTRANS||e.data.data.transaction_status==l.TRANSACTION_STATUS_INERROR?i.enableTransactionButtons():i.disableTransactionButtons(),a.isQueryFinished(e)?(t.sqlServerObject.close_on_idle_transaction&&e.data.data.transaction_status==l.TRANSACTION_STATUS_IDLE&&t.sqlServerObject.check_needed_confirmations_before_closing_panel(),i.loadingScreen.setMessage("Loading data from the database server and rendering..."),i.sqlServerObject.call_render_after_poll(e.data.data),"notifies"in e.data.data&&i.sqlServerObject.update_notifications(e.data.data.notifies)):a.isQueryStillRunning(e)?(t.delayedPoll(),i.sqlServerObject.setIsQueryRunning(!0),e.data.data.result&&i.sqlServerObject.update_msg_history(e.data.data.status,e.data.data.result,!1)):a.isConnectionToServerLostWhilePolling(e)?(i.loadingScreen.hide(),i.sqlServerObject.is_query_tool&&i.enableSQLEditorButtons(),i.sqlServerObject.update_msg_history(!1,e.data.data.result,!0)):a.isQueryCancelled(e)&&(i.loadingScreen.hide(),i.sqlServerObject.update_msg_history(!1,"Execution Cancelled!",!0))}).catch(function(e){if(i.sqlServerObject.resetQueryHistoryObject(i.sqlServerObject),i.loadingScreen.hide(),i.sqlServerObject.setIsQueryRunning(!1),i.sqlServerObject.is_query_tool&&i.enableSQLEditorButtons(),e.response){if(a.wasConnectionLostToPythonServer(e.response))return void i.handleConnectionToServerLost();var t=e.response.data;if(i.userManagement.isPgaLoginRequired(t))return i.userManagement.pgaLogin();var n=a.extractErrorMessage(t);i.sqlServerObject.update_msg_history(!1,n),i.sqlServerObject._highlight_error(n)}else{if(e.request)return void i.handleConnectionToServerLost();console.error(e)}})}},{key:"initializeExecutionOnSqlEditor",value:function(e){this.loadingScreen.show("Running query..."),(0,i.default)("#btn-flash").prop("disabled",!0),(0,i.default)("#btn-download").prop("disabled",!0),this.sqlServerObject.query_start_time=new Date,"object"===c(e)?this.sqlServerObject.query=e.sql:this.sqlServerObject.query=e,this.sqlServerObject.rows_affected=0,this.sqlServerObject._init_polling_flags(),this.disableSQLEditorButtons(),this.disableTransactionButtons()}},{key:"onExecuteHTTPError",value:function(e){if(this.loadingScreen.hide(),this.enableSQLEditorButtons(),a.wasConnectionLostToPythonServer(e.response))this.handleConnectionToServerLost();else{if(this.userManagement.isPgaLoginRequired(e.response)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.userManagement.pgaLogin()),s.httpResponseRequiresNewTransaction(e.response)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.sqlServerObject.initTransaction()),this.wasDatabaseConnectionLost(e)&&(this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),this.sqlServerObject.handle_connection_lost(!1,e)),this.isCryptKeyMissing(e))return this.sqlServerObject.saveState("check_data_changes_to_execute_query",[this.explainPlan]),void this.sqlServerObject.handle_cryptkey_missing();var t=e.response.data.errormsg;this.sqlServerObject.update_msg_history(!1,t)}}},{key:"wasDatabaseConnectionLost",value:function(e){return 503===e.response.status&&void 0!==e.response.data.info&&"CONNECTION_LOST"===e.response.data.info}},{key:"isCryptKeyMissing",value:function(e){return 503===e.response.status&&void 0!==e.response.data.info&&"CRYPTKEY_MISSING"===e.response.data.info}},{key:"removeGridViewMarker",value:function(){this.sqlServerObject.gridView.marker&&(this.sqlServerObject.gridView.marker.clear(),delete this.sqlServerObject.gridView.marker,this.sqlServerObject.gridView.marker=null,this.sqlServerObject.gridView.query_tool_obj.removeLineClass(this.sqlServerObject.marked_line_no,"wrap","CodeMirror-activeline-background"))}},{key:"enableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!1)}},{key:"disableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!0)}},{key:"enableTransactionButtons",value:function(){this.sqlServerObject.disable_transaction_buttons(!1)}},{key:"disableTransactionButtons",value:function(){this.sqlServerObject.special_sql=void 0,this.sqlServerObject.disable_transaction_buttons(!0)}},{key:"handleConnectionToServerLost",value:function(){this.sqlServerObject.update_msg_history(!1,(0,n.default)("Not connected to the server or the connection to the server has been closed."))}},{key:"updateSqlEditorStateWithInformationFromServer",value:function(e){this.sqlServerObject.can_edit=e.can_edit,this.sqlServerObject.can_filter=e.can_filter,this.sqlServerObject.info_notifier_timeout=e.info_notifier_timeout}},{key:"updateSqlEditorLastTransactionStatus",value:function(e){this.sqlServerObject.last_transaction_status=e}}],[{key:"prepareAnalyzeSql",value:function(e,t){return{sql:e,explain_plan:t}}},{key:"wasConnectionLostToPythonServer",value:function(e){return t.isUndefined(e)||t.isUndefined(e.data)}},{key:"isSqlCorrect",value:function(e){return e.data.status}},{key:"extractErrorMessage",value:function(e){var t=e.errormsg;return void 0!==e.responseJSON&&void 0!==e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),t}},{key:"isQueryFinished",value:function(e){return"Success"===e.data.data.status}},{key:"isQueryStillRunning",value:function(e){return"Busy"===e.data.data.status}},{key:"isQueryCancelled",value:function(e){return"Cancel"===e.data.data.status}},{key:"isConnectionToServerLostWhilePolling",value:function(e){return"NotConnected"===e.data.data.status}}]),a}();_.exports={ExecuteQuery:g}}).call(this,m(1))},function(e,t,n){"use strict";n(10),n(30),n(11),n(6),n(31);var o=r(n(2)),s=r(n(5)),l=r(n(0)),d=r(n(14)),c=r(n(3)),u=r(n(13)),f=r(n(70)),p=r(n(459)),i=n(219);function r(e){return e&&e.__esModule?e:{default:e}}var h=n(320),a={geturl:function(e,t){var n=(0,s.default)("sqleditor.get_filter_data",{trans_id:e});return t&&(n+="?connect=1"),n},dialog:function(a,e){var t=(0,o.default)("Sort/Filter options");l.default.ajax({url:this.geturl(a.transId,e),headers:{"Cache-Control":"no-cache"}}).done(function(e){var r=e.data.result;d.default.filterDialog&&delete d.default.filterDialog,d.default.dialog("filterDialog",function(){var i=(0,l.default)("<div class='data_sorting_dialog'></div>");return{main:function(){this.set("title",(0,o.default)("Sort/Filter options"))},build:function(){this.elements.content.appendChild(i.get(0)),d.default.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,o.default)("Help"),url:(0,s.default)("help.static",{filename:"editgrid.html"})}},{text:(0,o.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,o.default)("OK"),className:"btn btn-primary fa fa-check pg-alertify-button","data-btn-name":"ok"}],options:{title:t,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1}}},hooks:{onclose:function(){this.view&&(this.filterCollectionModel.stopSession(),this.view.model.stopSession(),this.view.remove({data:!0,internal:!0,silent:!0}))}},prepare:function(){var t=this;i.html(""),this.__internal.buttons[2].element.disabled=!0,this.statusBar=(0,l.default)('<div class=\'pg-prop-status-bar pg-el-xs-12 d-none\'>  <div class="error-in-footer">     <div class="d-flex px-2 py-1">       <div class="pr-2">         <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>       </div>       <div class="alert-text" role="status"></div>     </div>   </div> </div>').appendTo(i),this.showFilterProgress=(0,l.default)('<div id="show_filter_progress" class="pg-sp-container sql-editor-busy-fetching d-none">\n                  <div class="pg-sp-content">\n                      <div class="row"><div class="col-12 pg-sp-icon sql-editor-busy-icon"></div></div>\n                      <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'.concat((0,o.default)("Loading data..."),"</div></div>\n                  </div>\n              </div>")).appendTo(i),(0,l.default)(t.showFilterProgress[0]).removeClass("d-none"),t.filterCollectionModel=(0,p.default)(r);var e=u.default.generateViewSchema(null,t.filterCollectionModel,"create",null,null,!0),n=this.view=new u.default.Dialog({el:"<div></div>",model:t.filterCollectionModel,schema:e});(0,l.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),i.append(n.render().$el),n.listenTo(n.model,"pgadmin-session:start",function(){n.listenTo(n.model,"pgadmin-session:invalid",function(e){t.statusBar.removeClass("d-none"),(0,l.default)(t.statusBar.find(".alert-text")).html(e),t.__internal.buttons[2].element.disabled=!0}),n.listenTo(n.model,"pgadmin-session:valid",function(){t.statusBar.addClass("d-none"),(0,l.default)(t.statusBar.find(".alert-text")).html(""),t.__internal.buttons[2].element.disabled=!1})}),n.listenTo(n.model,"pgadmin-session:stop",function(){n.stopListening(n.model,"pgadmin-session:invalid"),n.stopListening(n.model,"pgadmin-session:valid")}),n.model.startNewSession(),n.model.get("data_sorting").add(r.data_sorting),(0,l.default)(t.showFilterProgress[0]).addClass("d-none")},callback:function(e){var n=this;if("dialog_help"==e.button.element.name)return e.cancel=!0,void c.default.Browser.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null);if("ok"===e.button["data-btn-name"]){e.cancel=!0;var t=this.filterCollectionModel.toJSON();(0,l.default)(n.showFilterProgress[0]).removeClass("d-none"),f.default.put((0,s.default)("sqleditor.set_filter_data",{trans_id:a.transId}),t).then(function(e){(0,l.default)(n.showFilterProgress[0]).addClass("d-none");var t=e.data.data;t.status?setTimeout(function(){n.close(),d.default.success((0,o.default)("Filter updated successfully")),h.executeQuery(a)},10):d.default.alert((0,o.default)("Validation Error"),t.result)}).catch(function(e){(0,l.default)(n.showFilterProgress[0]).addClass("d-none"),a.onExecuteHTTPError(e),setTimeout(function(){d.default.error(e)},10)})}else n.close()}}}),d.default.filterDialog(t).resizeTo(c.default.Browser.stdW.md,c.default.Browser.stdH.md)}).fail(function(e){(0,i.handleQueryToolAjaxError)(c.default,a,e,"_show_filter",[],!0)})}};e.exports=a},function(e,t,n){"use strict";n(40),n(7),n(4),n(8),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={asc:(0,i.default)("ASC"),desc:(0,i.default)("DESC")},n=a.default.Browser.DataModel.extend({idAttribute:"name",defaults:{name:void 0,order:"asc"},schema:[{id:"name",name:"name",label:(0,i.default)("Column"),cell:"select2",editable:!0,cellHeaderClasses:"width_percent_60",headerCell:o.default.Extension.CustomHeaderCell,disabled:!1,control:"select2",select2:{allowClear:!1},options:function(){return r.default.map(e.column_list,function(e){return{value:e,label:e}})}},{id:"order",name:"order",label:(0,i.default)("Order"),control:"select2",cell:"select2",cellHeaderClasses:"width_percent_40",headerCell:o.default.Extension.CustomHeaderCell,editable:!0,deps:["type"],select2:{allowClear:!1},options:function(){return r.default.map(t,function(e,t){return{value:t,label:e}})}}],validate:function(){var e=null;return this.errorModel.clear(),r.default.isUndefined(this.get("name"))||r.default.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=(0,i.default)("Please select a column."),this.errorModel.set("name",e),e):r.default.isUndefined(this.get("order"))||r.default.isNull(this.get("order"))||""==String(this.get("order")).replace(/^\s+|\s+$/g,"")?(e=(0,i.default)("Please select the order."),this.errorModel.set("order",e),e):null}});return new(a.default.Browser.DataModel.extend({idAttribute:"sql",defaults:{sql:e.sql||null},schema:[{id:"sql",label:(0,i.default)("SQL Filter"),cell:"string",type:"text",mode:["create"],control:s.default.SqlFieldControl.extend({render:function(){var e=s.default.SqlFieldControl.prototype.render.apply(this,arguments);return setTimeout(function(){e.sqlCtrl.focus()},1e3),e}}),extraClasses:["custom_height_css_class"]},{id:"data_sorting",name:"data_sorting",label:(0,i.default)("Data Sorting"),model:n,editable:!0,type:"collection",mode:["create"],control:"unique-col-collection",uniqueCol:["name"],canAdd:!0,canEdit:!1,canDelete:!0,visible:!0,version_compatible:!0}],validate:function(){return null}}))};var i=l(n(2)),r=l(n(1)),a=l(n(3)),o=l(n(28)),s=l(n(13));function l(e){return e&&e.__esModule?e:{default:e}}},function(n,e,o){"use strict";(function(w){o(214),o(16),o(19),o(23),o(40),o(461),o(463),o(12),o(37),o(24),o(22),o(6);var x=e(o(2)),S=o(322),l=e(o(0));function e(e){return e&&e.__esModule?e:{default:e}}var m=null,d=null,t={panel_closed:!0,go_for_render:function(e,t,n,i){var r=this;if(r.map_component||(r.map_component=function(){var n={radius:4,weight:3},c={closeButton:!1,minWidth:260,maxWidth:300,maxHeight:300},e=(0,l.default)('<div class="geometry-viewer-container"></div>'),u=m.map(e.get(0),{preferCanvas:!0}).setZoom(0);u.attributionControl.setPrefix("");var f=m.geoJSON([],{style:{weight:2},pointToLayer:function(e,t){return m.circleMarker(t,n)}});f.addTo(u);var t={Empty:m.tileLayer(""),Street:m.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'}),Topography:m.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:17,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://viewfinderpanoramas.org" target="_blank">SRTM</a>, &copy; <a href="https://opentopomap.org" target="_blank">OpenTopoMap</a>'}),"Gray Style":m.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Light Color":m.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Dark Matter":m.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19})},p=m.control.layers(t),i=t.Street,r=w.values(t),h=m.control({position:"topright"});h.onAdd=function(){return this._div=m.DomUtil.create("div","geometry-viewer-info-control"),this._div},h.update=function(e){this._div.innerHTML=e};function g(){u.options.crs!==m.CRS.EPSG3857&&(u.options.crs=m.CRS.EPSG3857,p.addTo(u),u.addLayer(i),e.addClass("geometry-viewer-container-plain-background"),u.setMinZoom(0))}function _(){u.options.crs!==m.CRS.Simple&&(u.options.crs=m.CRS.Simple,p.remove(),w.each(r,function(e){u.hasLayer(e)&&(i=e).remove()}),e.removeClass("geometry-viewer-container-plain-background"))}return _(),g(),{mapContainer:e,clearMap:function(){u.closePopup(),h.remove(),f.clearLayers()},loseFocus:function(){u.fire("blur")},renderMap:function(e){var t=e.geoJSONs,n=e.selectedSRID,i=e.getPopupContent,r=e.infoList,a=!1;0===t.length&&(a=!0);try{f.addData(t)}catch(e){r.push("An error occurred while rendering data."),a=!0}var o=f.getBounds();if(o.isValid()||(a=!0),0<r.length){u.options.crs===m.CRS.EPSG3857?(p.remove(),h.addTo(u),p.addTo(u)):h.addTo(u);var s=function(e){return e.join("<br>")}(r);h.update(s)}if(a)return _(),void u.setView([0,0],u.getZoom());if("function"==typeof i){f.eachLayer(function(e){e.bindPopup(function(){return i(e.feature.geometry)},c)})}o=o.pad(.1);var l=Math.max(o.getNorth()-o.getSouth(),o.getEast()-o.getWest());if(4326===n)g();else if(_(),180<=l){var d=Math.floor(Math.log2(360/l))-2;u.setMinZoom(d)}else u.setMinZoom(0);0<l?u.fitBounds(o):u.setView(o.getCenter(),u.getZoom())},resizeMap:function(){setTimeout(function(){u.invalidateSize()},10)}}}()),r.panel_closed){var a=window.wcDocker,o=e.gridView.geometry_viewer=e.gridView.docker.addPanel("geometry_viewer",a.DOCK.STACKED,e.gridView.data_output_panel);(0,l.default)("#geometry_viewer_panel")[0].appendChild(r.map_component.mapContainer.get(0)),r.panel_closed=!1,o.on(a.EVENT.CLOSED,function(){(0,l.default)("#geometry_viewer_panel").empty(),r.map_component.clearMap(),r.panel_closed=!0}),o.on(a.EVENT.RESIZE_ENDED,function(){o.isVisible()&&r.map_component.resizeMap()}),o.on(a.EVENT.VISIBILITY_CHANGED,function(e){e?r.map_component.resizeMap():r.map_component.loseFocus()})}e.gridView.geometry_viewer.focus(),r.map_component.clearMap();var s=c(t,n,i,d);r.map_component.renderMap(s)},render_geometries:function(t,n,i,r){var a=this;o.e(14).then(function(e){m=o(325),d=o(326).Geometry,a.go_for_render(t,n,i,r)}.bind(null,o)).catch(function(e){throw e})},add_header_button:function(e){e.header={buttons:[{cssClass:"div-view-geometry-column",tooltip:"View all geometries in this column",showOnHover:!1,command:"view-geometries",content:'<button class="btn-xs btn-primary"><i class="fa fa-eye" aria-hidden="true"></i></button>'}]}},parse_data:c};function c(e,n,i,r){var a=n[i].field,o=[],s=[],l=[],t=[],d=new Map,c=!1,u=0,f=!1,p=!1;if(0===e.length)return t.push("Empty row."),{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:t};if(w.every(e,function(t){try{var e=t[a],n=S.Buffer.from(e,"hex"),i=r.parse(n);if(i.hasZ)o.push(i);else{if(20971520<(u+=n.byteLength))return!(f=!0);if(1e5<=s.length)return!(p=!0);i.srid||(i.srid=0),s.push(i),d.set(i,t)}}catch(e){l.push(t)}return!0}),(f||p)&&t.push(s.length+" of "+e.length+" geometries rendered."),0<o.length&&t.push((0,x.default)("3D geometries not rendered.")),0<l.length&&t.push((0,x.default)("Unsupported geometries not rendered.")),0===s.length)return{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:t};var h=w.groupBy(s,"srid"),g=w.pairs(h);1<g.length&&(c=!0);var _,m=w.max(g,function(e){return e[1].length}),v=parseInt(m[0]),b=m[1],y=w.map(b,function(e){return e.toGeoJSON()});return 3<=n.length&&(_=function(e){var t=b[y.indexOf(e)];return function(e,t,n){for(var i='<table class="table table-bordered table-striped view-geometry-property-table"><tbody>',r=1;r<t.length;r++)if(r!==n){var a=t[r];i+="<tr><th>"+a.display_name+"</th>";var o=e[a.field];w.isUndefined(o)&&a.has_default_val?i+='<td class="td-disabled">[default]</td>':w.isUndefined(o)&&a.not_null||w.isUndefined(o)||null===o?i+='<td class="td-disabled">[null]</td>':i+="<td>"+o+"</td>",i+="</tr>"}return i+="</tbody></table>"}(d.get(t),n,i)}),c&&t.push((0,x.default)("Geometries with non-SRID")+v+" not rendered."),{geoJSONs:y,selectedSRID:v,getPopupContent:_,infoList:t}}n.exports=t}).call(this,o(1))},function(e,t,n){"use strict";var i=n(252),r=n(462);e.exports=i("Map",function(t){return function(e){return t(this,arguments.length?e:void 0)}},r,!0)},function(e,t,n){"use strict";var d=n(55).f,c=n(100),u=n(123),f=n(101),p=n(104),h=n(149),o=n(173),s=n(181),g=n(43),_=n(151).fastKey,i=n(78),m=i.set,v=i.getterFor;e.exports={getConstructor:function(e,n,i,r){function a(e,t,n){var i,r,a=s(e),o=l(e,t);return o?o.value=n:(a.last=o={index:r=_(t,!0),key:t,value:n,previous:i=a.last,next:void 0,removed:!1},a.first||(a.first=o),i&&(i.next=o),g?a.size++:e.size++,"F"!==r&&(a.index[r]=o)),e}var o=e(function(e,t){p(e,o,n),m(e,{type:n,index:c(null),first:void 0,last:void 0,size:0}),g||(e.size=0),null!=t&&h(t,e[r],e,i)}),s=v(n),l=function(e,t){var n,i=s(e),r=_(t);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==t)return n};return u(o.prototype,{clear:function(){for(var e=s(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,g?e.size=0:this.size=0},delete:function(e){var t=s(this),n=l(this,e);if(n){var i=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=i),i&&(i.previous=r),t.first==n&&(t.first=i),t.last==n&&(t.last=r),g?t.size--:this.size--}return!!n},forEach:function(e,t){for(var n,i=s(this),r=f(e,1<arguments.length?t:void 0,3);n=n?n.next:i.first;)for(r(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(e){return!!l(this,e)}}),u(o.prototype,i?{get:function(e){var t=l(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),g&&d(o.prototype,"size",{get:function(){return s(this).size}}),o},setStrong:function(e,t,n){var i=t+" Iterator",r=v(t),a=v(i);o(e,t,function(e,t){m(this,{type:i,target:e,state:r(e),kind:t,last:void 0})},function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),s(t)}}},function(e,t,n){var i=n(17),r=Math.log,a=Math.LN2;i({target:"Math",stat:!0},{log2:function(e){return r(e)/a}})},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=u(e),r=i[0],a=i[1],o=new c(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),s=0,l=0<a?r-4:r;for(n=0;n<l;n+=4)t=d[e.charCodeAt(n)]<<18|d[e.charCodeAt(n+1)]<<12|d[e.charCodeAt(n+2)]<<6|d[e.charCodeAt(n+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=255&t;2===a&&(t=d[e.charCodeAt(n)]<<2|d[e.charCodeAt(n+1)]>>4,o[s++]=255&t);1===a&&(t=d[e.charCodeAt(n)]<<10|d[e.charCodeAt(n+1)]<<4|d[e.charCodeAt(n+2)]>>2,o[s++]=t>>8&255,o[s++]=255&t);return o},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,r=[],a=0,o=n-i;a<o;a+=16383)r.push(l(e,a,o<a+16383?o:a+16383));1==i?(t=e[n-1],r.push(s[t>>2]+s[t<<4&63]+"==")):2==i&&(t=(e[n-2]<<8)+e[n-1],r.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return r.join("")};for(var s=[],d=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,a=i.length;r<a;++r)s[r]=i[r],d[i.charCodeAt(r)]=r;function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,r,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(s[(r=i)>>18&63]+s[r>>12&63]+s[r>>6&63]+s[63&r]);return a.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,d=l>>1,c=-7,u=n?r-1:0,f=n?-1:1,p=e[t+u];for(u+=f,a=p&(1<<-c)-1,p>>=-c,c+=s;0<c;a=256*a+e[t+u],u+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=i;0<c;o=256*o+e[t+u],u+=f,c-=8);if(0===a)a=1-d;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),a-=d}return(p?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,n,i,r,a){var o,s,l,d=8*a-r-1,c=(1<<d)-1,u=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:a-1,h=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),2<=(t+=1<=o+u?f/l:f*Math.pow(2,1-u))*l&&(o++,l/=2),c<=o+u?(s=0,o=c):1<=o+u?(s=(t*l-1)*Math.pow(2,r),o+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,r),o=0));8<=r;e[n+p]=255&s,p+=h,s/=256,r-=8);for(o=o<<r|s,d+=r;0<d;e[n+p]=255&o,p+=h,o/=256,d-=8);e[n+p-h]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,r){"use strict";(function(n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}r(50),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.historyList=n.sortBy(e,function(e){return e.start_time}),this.onAdd(function(){})}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"length",value:function(){return this.historyList.length}},{key:"add",value:function(e){var t=n.sortedIndex(this.historyList,e,function(e){return e.start_time});this.historyList.splice(t,0,e),this.onAddHandler(e)}},{key:"reset",value:function(){this.historyList=[],this.onResetHandler(this.historyList)}},{key:"onAdd",value:function(e){this.onAddHandler=e}},{key:"onReset",value:function(e){this.onResetHandler=e}}]),t}();t.default=e}).call(this,r(1))},function(e,t,n){"use strict";n(21),n(53),n(58),n(40),n(18),n(75),n(7),n(32),n(76),n(48),n(63),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(n(469)),r=n(470),a=l(n(471)),o=l(n(2)),s=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.parentNode=e,this.histCollection=t,this.editorPref={},this.onCopyToEditorHandler=function(){},this.histCollection.onAdd(this.onAddEntry.bind(this)),this.histCollection.onReset(this.onResetEntries.bind(this))}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(n,[{key:"focus",value:function(){this.queryHistEntries&&this.queryHistEntries.focus()}},{key:"onAddEntry",value:function(e){1==this.histCollection.length()?this.render():this.queryHistEntries&&this.queryHistEntries.addEntry(e)}},{key:"onResetEntries",value:function(){this.isRendered=!1,this.queryHistEntries=null,this.queryHistDetails=null,this.render()}},{key:"onCopyToEditorClick",value:function(e){this.onCopyToEditorHandler=e,this.queryHistDetails&&this.queryHistDetails.onCopyToEditorClick(this.onCopyToEditorHandler)}},{key:"setEditorPref",value:function(e){this.editorPref=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(n,!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},this.editorPref,{},e),this.queryHistDetails&&this.queryHistDetails.setEditorPref(this.editorPref)}},{key:"render",value:function(){var t=this;if(0==this.histCollection.length())this.parentNode.empty().removeClass("d-flex").append("<div class='alert alert-info pg-panel-message'>".concat((0,o.default)("No history found"),"</div>"));else{this.parentNode.empty().addClass("d-flex");var e=(0,s.default)("<div><div>").appendTo(this.parentNode),n=(0,s.default)("<div><div>").appendTo(this.parentNode);(0,a.default)([e[0],n[0]],{gutterSize:1,cursor:"ew-resize"}),this.queryHistDetails=new i.default(n),this.queryHistDetails.setEditorPref(this.editorPref),this.queryHistDetails.onCopyToEditorClick(this.onCopyToEditorHandler),this.queryHistDetails.render(),this.queryHistEntries=new r.QueryHistoryEntries(e),this.queryHistEntries.onSelectedChange(function(e){t.queryHistDetails.setEntry(e)}.bind(this)),this.queryHistEntries.render(),this.histCollection.historyList.map(function(e){t.queryHistEntries.addEntry(e)})}}}]),n}();t.default=f},function(e,t,n){"use strict";n(21),n(36),n(53),n(10),n(58),n(18),n(75),n(7),n(32),n(76),n(48),n(4),n(62),n(63),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(n(84)),r=l(n(218)),a=l(n(2)),o=l(n(0)),s=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.parentNode=e,this.isCopied=!1,this.timeout=null,this.isRendered=!1,this.sqlFontSize=null,this.onCopyToEditorHandler=function(){},this.editorPref={sql_font_size:"1em",copy_to_editor:!0}}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(t,[{key:"setEntry",value:function(e){this.entry=e,this.isRendered?this.selectiveRender():this.render()}},{key:"setEditorPref",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.editorPref=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(n,!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},this.editorPref,{},t),this.query_codemirror&&!s.default.isUndefined(t.sql_font_size)&&((0,o.default)(this.query_codemirror.getWrapperElement()).css("font-size",this.editorPref.sql_font_size),this.query_codemirror.refresh()),this.$copyToEditor&&!s.default.isUndefined(t.copy_to_editor)&&(t.copy_to_editor?this.$copyToEditor.removeClass("d-none"):this.$copyToEditor.addClass("d-none"))}},{key:"parseErrorMessage",value:function(e){return e.match(/ERROR:\s*([^\n\r]*)/i)?e.match(/ERROR:\s*([^\n\r]*)/i)[1]:e}},{key:"formatDate",value:function(e){return e.toLocaleDateString()+" "+e.toLocaleTimeString()}},{key:"copyAllHandler",value:function(){var e=this;r.default.copyTextToClipboard(this.entry.query),this.clearPreviousTimeout(),this.updateCopyButton(!0),this.timeout=setTimeout(function(){e.updateCopyButton(!1)},1500)}},{key:"onCopyToEditorClick",value:function(e){this.onCopyToEditorHandler=e}},{key:"clearPreviousTimeout",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}},{key:"updateCopyButton",value:function(e){e?(this.$copyBtn.addClass("was-copied").removeClass("copy-all"),this.$copyBtn.text("Copied!")):(this.$copyBtn.addClass("copy-all").removeClass("was-copied"),this.$copyBtn.text("Copy"))}},{key:"updateQueryMetaData",value:function(){function e(e,t){return e?"<div class='item'>\n                  <span class='value'>".concat(e,"</span>\n                  <span class='description'>").concat(t,"</span>\n              </div>"):""}this.$metaData.empty().append("<div class='metadata'>\n                ".concat(e(this.formatDate(this.entry.start_time),"Date"),"\n                ").concat(e(this.entry.row_affected.toLocaleString(),"Rows Affected"),"\n                ").concat(e(this.entry.total_time,"Duration"),"\n            </div>"))}},{key:"updateMessageContent",value:function(){this.$message_content.empty().append("<pre class='content-value'>".concat(s.default.escape(this.entry.message),"</pre>"))}},{key:"updateErrorMessage",value:function(){this.entry.status?(this.$errMsgBlock.addClass("d-none"),this.$errMsgBlock.empty()):(this.$errMsgBlock.removeClass("d-none"),this.$errMsgBlock.empty().append("<div class='history-error-text'>\n            <span>Error Message</span> ".concat(s.default.escape(this.parseErrorMessage(this.entry.message)),"\n        </div>")))}},{key:"updateInfoMessage",value:function(){this.entry.info?(this.$infoMsgBlock.removeClass("d-none"),this.$infoMsgBlock.empty().append("<div class='history-info-text'>\n            ".concat(this.entry.info,"\n        </div>"))):(this.$infoMsgBlock.addClass("d-none"),this.$infoMsgBlock.empty())}},{key:"selectiveRender",value:function(){this.updateErrorMessage(),this.updateInfoMessage(),this.updateCopyButton(!1),this.updateQueryMetaData(),this.query_codemirror.setValue(this.entry.query),this.updateMessageContent()}},{key:"render",value:function(){var e=this;this.entry&&(this.parentNode.empty().append("<div id='query_detail' class='query-detail'>\n            <div class='error-message-block'></div>\n            <div class='info-message-block'></div>\n            <div class='metadata-block'></div>\n            <div class='query-statement-block'>\n              <div id='history-detail-query'>\n                <button class='btn-copy' tabindex=0 accesskey='y'></button>\n                <button class='btn-copy-editor copy-to-editor' tabindex=0 accesskey='y'>"+(0,a.default)("Copy to Query Editor")+"</button>\n                <div></div>\n              </div>\n            </div>\n            <div>\n              <hr class='block-divider'/>\n            </div>\n            <div class='message-block'>\n              <div class='message'>\n                <div class='message-header'>Messages</div>\n                <div class='content'></div>\n              </div>\n            </div>\n        </div>"),this.$errMsgBlock=this.parentNode.find(".error-message-block"),this.$infoMsgBlock=this.parentNode.find(".info-message-block"),this.$copyBtn=this.parentNode.find("#history-detail-query .btn-copy"),this.$copyBtn.off("click").on("click",this.copyAllHandler.bind(this)),this.$copyToEditor=this.parentNode.find("#history-detail-query .btn-copy-editor"),this.$copyToEditor.off("click").on("click",function(){e.onCopyToEditorHandler(e.entry.query)}),this.$copyToEditor.addClass(this.editorPref.copy_to_editor?"":"d-none"),this.$metaData=this.parentNode.find(".metadata-block"),this.query_codemirror=(0,i.default)(this.parentNode.find("#history-detail-query div")[0],{tabindex:-1,mode:"text/x-pgsql",readOnly:!0}),(0,o.default)(this.query_codemirror.getWrapperElement()).css("font-size",this.editorPref.sql_font_size),this.$message_content=this.parentNode.find(".message-block .content"),this.isRendered=!0,this.selectiveRender())}}]),t}();t.default=f},function(e,t,n){"use strict";n(36),n(10),n(16),n(40),n(18),n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.QueryHistoryEntries=t.QueryHistoryItem=t.QueryHistoryEntryDateGroup=void 0;var i=r(n(118)),l=r(n(0)),d=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n(184);var c=function(){function n(e,t){a(this,n),this.date=e,this.formatString="MMM DD YYYY",this.groupKey=t}return s(n,[{key:"getDatePrefix",value:function(){var e="";return this.isDaysBefore(0)?e="Today - ":this.isDaysBefore(1)&&(e="Yesterday - "),e}},{key:"getDateFormatted",value:function(e){return e.toLocaleDateString()}},{key:"isDaysBefore",value:function(e){return this.getDateFormatted(this.date)===this.getDateFormatted((0,i.default)().subtract(e,"days").toDate())}},{key:"render",value:function(){return(0,l.default)("<div class='query-group' data-key='".concat(this.groupKey,"'>\n            <div class='date-label'>").concat(this.getDatePrefix()).concat(this.getDateFormatted(this.date),"</div>\n            <ul class='query-entries'></ul>\n        </div>"))}}]),n}();t.QueryHistoryEntryDateGroup=c;var u=function(){function t(e){a(this,t),this.entry=e,this.$el=null,this.onClickHandler=null}return s(t,[{key:"onClick",value:function(e){var t=this;this.onClickHandler=e,this.$el&&this.$el.off("click").on("click",function(e){t.onClickHandler((0,l.default)(e.currentTarget))})}},{key:"formatDate",value:function(e){return(0,i.default)(e).format("HH:mm:ss")}},{key:"dataKey",value:function(){return this.formatDate(this.entry.start_time)}},{key:"render",value:function(e){var t=this;this.$el=(0,l.default)("<li class='list-item' tabindex='0' data-key='".concat(this.dataKey(),"'>\n          <div class='entry ").concat(this.entry.status?"":"error",'\'>\n              <div class=\'query\'>\n                  <i id="query_source_icon" class="query-history-icon sql-icon-lg"></i>\n                  ').concat(d.default.escape(this.entry.query),"\n              </div>\n              <div class='other-info'>\n              <div class='timestamp'>").concat(this.formatDate(this.entry.start_time),"</div>\n              </div>\n          </div>\n      </li>")).data("entrydata",this.entry).on("click",function(e){t.onClickHandler((0,l.default)(e.currentTarget))});var n=this.entry.query_source;n&&this.$el.find("#query_source_icon").addClass(n.ICON_CSS_CLASS),this.entry.is_pgadmin_query&&(this.$el.addClass("pgadmin-query-history-entry"),e||this.$el.addClass("d-none"))}}]),t}();t.QueryHistoryItem=u;var f=function(){function t(e){a(this,t),this.parentNode=e,this.$selectedItem=null,this.groupKeyFormat="YYYY MM DD",this.$el=null,this.is_pgadmin_queries_shown=null}return s(t,[{key:"onSelectedChange",value:function(e){this.onSelectedChangeHandler=e}},{key:"focus",value:function(){this.$selectedItem||this.setSelectedListItem(this.$entriesEl.find(".list-item").first()),this.$selectedItem.trigger("click"),this.$entriesEl.focus()}},{key:"isArrowDown",value:function(e){return 40===(e.keyCode||e.which)}},{key:"isArrowUp",value:function(e){return 38===(e.keyCode||e.which)}},{key:"navigateUpAndDown",value:function(e){var t=[38,40],n=e.keyCode||e.which;return!(-1<t.indexOf(n))||(e.preventDefault(),this.onKeyDownHandler(e),!1)}},{key:"onKeyDownHandler",value:function(e){if(this.isArrowDown(e))if(0<this.$selectedItem.next().length)this.setSelectedListItem(this.$selectedItem.next());else{var t=this.$selectedItem.closest(".query-group");0<t.next().length&&this.setSelectedListItem(t.next().find(".list-item").first())}else if(this.isArrowUp(e))if(0<this.$selectedItem.prev().length)this.setSelectedListItem(this.$selectedItem.prev());else{var n=this.$selectedItem.closest(".query-group");0<n.prev().length&&this.setSelectedListItem(n.prev().find(".list-item").last())}}},{key:"onSelectListItem",value:function(e){this.setSelectedListItem((0,l.default)(e.currentTarget))}},{key:"dateAsGroupKey",value:function(e){return(0,i.default)(e).format(this.groupKeyFormat)}},{key:"setSelectedListItem",value:function(e){this.$selectedItem&&this.$selectedItem.removeClass("selected"),e.addClass("selected"),this.$selectedItem=e,this.$selectedItem[0].scrollIntoView({block:"center"}),this.onSelectedChangeHandler&&this.onSelectedChangeHandler(this.$selectedItem.data("entrydata"))}},{key:"addEntry",value:function(e){var t=this.$entriesEl.find(".query-group"),n=l.default.map(t,function(e){return(0,l.default)(e).attr("data-key")}),i=this.dateAsGroupKey(e.start_time),r=d.default.indexOf(n,i),a=null;if(0==t.length)a=new c(e.start_time,i).render(),this.$entriesEl.prepend(a);else if(r<0&&0!=t.length){a=new c(e.start_time,i).render();for(var o=0;o<n.length;){if(i>n[o]){a.insertBefore(t[o]);break}o++}o==n.length&&this.$entriesEl.append(a)}else 0<=r&&(a=(0,l.default)(t[r]));var s=new u(e);s.onClick(this.setSelectedListItem.bind(this)),s.render(this.is_pgadmin_queries_shown),a.find(".query-entries").prepend(s.$el),this.setSelectedListItem(s.$el)}},{key:"toggleGeneratedQueries",value:function(){this.$el.find(".pgadmin-query-history-entry").each(function(){(0,l.default)(this).toggleClass("d-none")}),this.is_pgadmin_queries_shown=!this.is_pgadmin_queries_shown}},{key:"render",value:function(){var e=this;e.$el=(0,l.default)('\n        <div class="toggle-and-history-container">\n            <div class="query-history-toggle">\n                <label class="control-label">\n                    Show queries generated internally by pgAdmin?\n                </label>\n                <input id="generated-queries-toggle" type="checkbox"\n                  class="pgadmin-controls" data-style="quick"\n                  data-size="mini" data-on="Yes" data-off="No"\n                  data-onstyle="success" data-offstyle="primary" checked>\n            </div>\n            <div id=\'query_list\' class=\'query-history\' tabindex=\'0\'></div>\n        </div>\n    '),e.$entriesEl=e.$el.find("#query_list"),e.$entriesEl.on("keydown",this.navigateUpAndDown.bind(this)),e.is_pgadmin_queries_shown=!0,e.$el.find("#generated-queries-toggle").bootstrapToggle().change(function(){e.toggleGeneratedQueries()}),e.parentNode.empty().append(e.$el)}}]),t}();t.QueryHistoryEntries=f},function(e,t,n){"use strict";n.r(t);function M(){return!1}function r(e){return"string"==typeof e||e instanceof String}function I(e){if(r(e)){var t=H.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e}function L(e,t,n){var i=e[t];return void 0!==i?i:n}function B(e,t,n,i){if(t){if("end"===i)return 0;if("center"===i)return e/2}else if(n){if("start"===i)return 0;if("center"===i)return e/2}return e}function U(e,t){var n=H.createElement("div");return n.className="gutter gutter-"+t,n}function V(e,t,n){var i={};return r(t)?i[e]=t:i[e]=Q?t+"%":a+"("+t+"% - "+n+"px)",i}function z(e,t){var n;return(n={})[e]=t+"px",n}var F=window,H=F.document,K="addEventListener",G="removeEventListener",$="getBoundingClientRect",J="horizontal",Q=F.attachEvent&&!F[K],a=["","-webkit-","-moz-","-o-"].filter(function(e){var t=H.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length}).shift()+"calc";t.default=function(e,r){void 0===r&&(r={});var o,t,a,s,i,l,d=e;Array.from&&(d=Array.from(d));var c=I(d[0]).parentNode,n=getComputedStyle?getComputedStyle(c):null,u=n?n.flexDirection:null,f=L(r,"sizes")||d.map(function(){return 100/d.length}),p=L(r,"minSize",100),h=Array.isArray(p)?p:d.map(function(){return p}),g=L(r,"expandToMin",!1),_=L(r,"gutterSize",10),m=L(r,"gutterAlign","center"),v=L(r,"snapOffset",30),b=L(r,"dragInterval",1),y=L(r,"direction",J),w=L(r,"cursor",y===J?"col-resize":"row-resize"),x=L(r,"gutter",U),S=L(r,"elementStyle",V),C=L(r,"gutterStyle",z);function k(t,e,n,i){var r=S(o,e,n,i);Object.keys(r).forEach(function(e){t.style[e]=r[e]})}function T(){return l.map(function(e){return e.size})}function E(e){return"touches"in e?e.touches[0][t]:e[t]}function P(e){var t=l[this.a],n=l[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,k(t.element,t.size,this._b,t.i),k(n.element,n.size,this._c,n.i)}function O(){var e=l[this.a].element,t=l[this.b].element,n=e[$](),i=t[$]();this.size=n[o]+i[o]+this._b+this._c,this.start=n[a],this.end=n[s]}function N(a){var o=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[i];return 0===n?null:n-=y===J?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(c);if(null===o)return a;if(h.reduce(function(e,t){return e+t},0)>o)return a;var s=0,l=[],e=a.map(function(e,t){var n=o*e/100,i=B(_,0===t,t===a.length-1,m),r=h[t]+i;return n<r?(s+=r-n,l.push(0),r):(l.push(n-r),n)});return 0===s?a:e.map(function(e,t){var n=e;if(0<s&&0<l[t]-s){var i=Math.min(s,l[t]-s);s-=i,n=e-i}return n/o*100})}function D(e){if(!("button"in e&&0!==e.button)){var t=this,n=l[t.a].element,i=l[t.b].element;t.dragging||L(r,"onDragStart",M)(T()),e.preventDefault(),t.dragging=!0,t.move=function(e){var t,n=l[this.a],i=l[this.b];this.dragging&&(t=E(e)-this.start+(this._b-this.dragOffset),1<b&&(t=Math.round(t/b)*b),t<=n.minSize+v+this._b?t=n.minSize+this._b:t>=this.size-(i.minSize+v+this._c)&&(t=this.size-(i.minSize+this._c)),P.call(this,t),L(r,"onDrag",M)())}.bind(t),t.stop=function(){var e=this,t=l[e.a].element,n=l[e.b].element;e.dragging&&L(r,"onDragEnd",M)(T()),e.dragging=!1,F[G]("mouseup",e.stop),F[G]("touchend",e.stop),F[G]("touchcancel",e.stop),F[G]("mousemove",e.move),F[G]("touchmove",e.move),e.stop=null,e.move=null,t[G]("selectstart",M),t[G]("dragstart",M),n[G]("selectstart",M),n[G]("dragstart",M),t.style.userSelect="",t.style.webkitUserSelect="",t.style.MozUserSelect="",t.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",e.gutter.style.cursor="",e.parent.style.cursor="",H.body.style.cursor=""}.bind(t),F[K]("mouseup",t.stop),F[K]("touchend",t.stop),F[K]("touchcancel",t.stop),F[K]("mousemove",t.move),F[K]("touchmove",t.move),n[K]("selectstart",M),n[K]("dragstart",M),i[K]("selectstart",M),i[K]("dragstart",M),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.MozUserSelect="none",i.style.pointerEvents="none",t.gutter.style.cursor=w,t.parent.style.cursor=w,H.body.style.cursor=w,O.call(t),t.dragOffset=E(e)-t.end}}y===J?(o="width",t="clientX",a="left",s="right",i="clientWidth"):"vertical"===y&&(o="height",t="clientY",a="top",s="bottom",i="clientHeight"),f=N(f);var q=[];function A(e){var t=e.i===q.length,n=t?q[e.i-1]:q[e.i];O.call(n);var i=t?n.size-e.minSize-n._c:e.minSize+n._b;P.call(n,i)}function R(e){var a=N(e);a.forEach(function(e,t){if(0<t){var n=q[t-1],i=l[n.a],r=l[n.b];i.size=a[t-1],r.size=e,k(i.element,i.size,n._b,i.i),k(r.element,r.size,n._c,r.i)}})}function j(n,i){q.forEach(function(t){if(!0!==i?t.parent.removeChild(t.gutter):(t.gutter[G]("mousedown",t._a),t.gutter[G]("touchstart",t._a)),!0!==n){var e=S(o,t.a.size,t._b);Object.keys(e).forEach(function(e){l[t.a].element.style[e]="",l[t.b].element.style[e]=""})}})}return(l=d.map(function(e,t){var n,i={element:I(e),size:f[t],minSize:h[t],i:t};if(0<t&&((n={a:t-1,b:t,dragging:!1,direction:y,parent:c})._b=B(_,t-1==0,!1,m),n._c=B(_,!1,t===d.length-1,m),"row-reverse"===u||"column-reverse"===u)){var r=n.a;n.a=n.b,n.b=r}if(!Q&&0<t){var a=x(t,y,i.element);!function(t,e,n){var i=C(o,e,n);Object.keys(i).forEach(function(e){t.style[e]=i[e]})}(a,_,t),n._a=D.bind(n),a[K]("mousedown",n._a),a[K]("touchstart",n._a),c.insertBefore(a,i.element),n.gutter=a}return k(i.element,i.size,B(_,0===t,t===d.length-1,m),t),0<t&&q.push(n),i})).forEach(function(e){var t=e.element[$]()[o];t<e.minSize&&(g?A(e):e.minSize=t)}),Q?{setSizes:R,destroy:j}:{setSizes:R,getSizes:T,collapse:function(e){A(l[e])},destroy:j,parent:c,pairs:q}}},function(e,t,n){"use strict";n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.QuerySources=void 0;t.QuerySources={EXECUTE:{ICON_CSS_CLASS:"fa fa-play"},EXPLAIN:{ICON_CSS_CLASS:"fa fa-hand-pointer-o"},EXPLAIN_ANALYZE:{ICON_CSS_CLASS:"fa fa-list-alt"},COMMIT:{ICON_CSS_CLASS:"icon-commit"},ROLLBACK:{ICON_CSS_CLASS:"icon-rollback"},SAVE_DATA:{ICON_CSS_CLASS:"icon-save-data-changes"},VIEW_DATA:{ICON_CSS_CLASS:"icon-view-data"}}},function(e,t,n){"use strict";n(10);var i=s(n(2)),r=s(n(28)),a=s(n(15)),o=s(n(14));function s(e){return e&&e.__esModule?e:{default:e}}var l=a.default.Model.extend({defaults:{recorded_time:void 0,event:void 0,pid:void 0,payload:void 0},schema:[{id:"recorded_time",label:(0,i.default)("Recorded time"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:r.default.Extension.CustomHeaderCell},{id:"channel",label:(0,i.default)("Event"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:r.default.Extension.CustomHeaderCell},{id:"pid",label:(0,i.default)("Process ID"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:r.default.Extension.CustomHeaderCell},{id:"payload",label:(0,i.default)("Payload"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_40",headerCell:r.default.Extension.CustomHeaderCell}]}),d=a.default.Collection.extend({model:l}),c={collection:null,renderNotificationsGrid:function(e){c.collection||(c.collection=new d);var t=[{name:"recorded_time",label:(0,i.default)("Recorded time"),type:"text",editable:!1,cell:"string"},{name:"channel",label:(0,i.default)("Event"),type:"text",editable:!1,cell:"string"},{name:"pid",label:(0,i.default)("Process ID"),type:"text",editable:!1,cell:"string"},{name:"payload",label:(0,i.default)("Payload"),type:"text",editable:!1,cell:"string"}],n=new r.default.Grid({emptyText:"No data found",columns:t,collection:c.collection,className:"backgrid presentation table table-bordered table-hover table-noouter-border table-bottom-border"});n&&e.$container.find(".sql-editor-notifications").append(n.render().el)},updateNotifications:function(e){if(null!=e&&0<e.length){for(var t in e){var n="";n=""!=e[t].payload?(0,i.default)('Asynchronous notification "')+e[t].channel+(0,i.default)('" with payload "')+e[t].payload+(0,i.default)('" received from server process with PID ')+e[t].pid:(0,i.default)('Asynchronous notification "')+e[t].channel+(0,i.default)('" received from server process with PID ')+e[t].pid,o.default.info(n)}c.collection.add(e)}}};e.exports=c},function(e,t,n){"use strict";n(33),n(7),Object.defineProperty(t,"__esModule",{value:!0}),t.callRenderAfterPoll=function(e,t,n){if(e.query_end_time=new Date,e.rows_affected=n.rows_affected,e.has_more_rows=n.has_more_rows,function(e){return null!=e.colinfo}(n))e._render(n);else{e.total_time=(0,r.calculateQueryRunTime)(e.query_start_time,e.query_end_time);var i=(0,o.sprintf)((0,a.default)("Query returned successfully in %s."),e.total_time);n.result?n.result+="\n\n"+i:n.result=i,e.update_msg_history(!0,n.result,!1),e.reset_data_store(),function(e){return 0<=e.info_notifier_timeout}(e)&&t.success(i,e.info_notifier_timeout)}!function(e){return e.is_query_tool}(e)||e.disable_tool_buttons(!1);e.setIsQueryRunning(!1),e.trigger("pgadmin-sqleditor:loading-icon:hide")};var i,r=n(321),a=(i=n(2))&&i.__esModule?i:{default:i},o=n(25)},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(21),n(26),n(27),n(10),n(19),n(18),n(7),n(32),n(12),n(24),n(49),n(22),n(6),Object.defineProperty(t,"__esModule",{value:!0}),t.updateUIPreferences=function(e){var t=e.$el,n=e.preferences;e.handler.slickgrid&&(e.handler.slickgrid.CSVOptions={quoting:e.preferences.results_grid_quoting,quote_char:e.preferences.results_grid_quote_char,field_separator:e.preferences.results_grid_field_separator});t.find("#btn-load-file").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Open File"),n.btn_open_file)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Open File"),n.btn_open_file)).attr("accesskey",(0,s.shortcut_key)(n.btn_open_file)),t.find("#btn-save-file").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Save File"),n.btn_save_file)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Save File"),n.btn_save_file)).attr("accesskey",(0,s.shortcut_key)(n.btn_save_file)),t.find("#btn-find-menu-dropdown").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Find"),n.btn_find_options)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Find"),n.btn_find_options)).attr("accesskey",(0,s.shortcut_key)(n.btn_find_options)),t.find("#btn-copy-row").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Copy"),n.btn_copy_row)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Copy"),n.btn_copy_row)).attr("accesskey",(0,s.shortcut_key)(n.btn_copy_row)),t.find("#btn-paste-row").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Paste"),n.btn_paste_row)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Paste"),n.btn_paste_row)).attr("accesskey",(0,s.shortcut_key)(n.btn_paste_row)),t.find("#btn-delete-row").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Delete"),n.btn_delete_row)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Delete"),n.btn_delete_row)).attr("accesskey",(0,s.shortcut_key)(n.btn_delete_row)),t.find("#btn-filter").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Filter"),n.btn_filter_dialog)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Filter"),n.btn_filter_dialog)).attr("accesskey",(0,s.shortcut_key)(n.btn_filter_dialog)),t.find("#btn-filter-dropdown").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Filter options"),n.btn_filter_options)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Filter options"),n.btn_filter_options)).attr("accesskey",(0,s.shortcut_key)(n.btn_filter_options)),t.find("#btn-rows-limit").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Rows limit"),n.btn_rows_limit)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Rows limit"),n.btn_rows_limit)).attr("accesskey",(0,s.shortcut_key)(n.btn_rows_limit)),t.find("#btn-query-dropdown").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Execute options"),n.btn_execute_options)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Execute options"),n.btn_execute_options)).attr("accesskey",(0,s.shortcut_key)(n.btn_execute_options)),t.find("#btn-cancel-query").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Cancel query"),n.btn_cancel_query)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Cancel query"),n.btn_cancel_query)).attr("accesskey",(0,s.shortcut_key)(n.btn_cancel_query)),t.find("#btn-clear-dropdown").attr("title",(0,s.shortcut_accesskey_title)((0,c.default)("Clear"),n.btn_clear_options)).attr("aria-label",(0,s.shortcut_accesskey_title)((0,c.default)("Clear"),n.btn_clear_options)).attr("accesskey",(0,s.shortcut_key)(n.btn_clear_options)),t.find("#btn-conn-status").attr("accesskey",(0,s.shortcut_key)(n.btn_conn_status)).find("i").attr("title",(0,s.shortcut_accesskey_title)("Connection status (click for details)",n.btn_conn_status)),t.find("#btn-flash").attr("title",(0,s.shortcut_title)((0,c.default)("Execute/Refresh"),n.execute_query)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Execute/Refresh"),n.execute_query)),t.find("#btn-explain").attr("title",(0,s.shortcut_title)((0,c.default)("Explain"),n.explain_query)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Explain"),n.explain_query)),t.find("#btn-explain-analyze").attr("title",(0,s.shortcut_title)((0,c.default)("Explain Analyze"),n.explain_analyze_query)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Explain Analyze"),n.explain_analyze_query)),t.find("#btn-download").attr("title",(0,s.shortcut_title)((0,c.default)("Download as CSV"),n.download_csv)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Download as CSV"),n.download_csv)),t.find("#btn-save-data").attr("title",(0,s.shortcut_title)((0,c.default)("Save Data Changes"),n.save_data)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Save Data Changes"),n.save_data)),t.find("#btn-commit").attr("title",(0,s.shortcut_title)((0,c.default)("Commit"),n.commit_transaction)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Commit"),n.commit_transaction)),t.find("#btn-rollback").attr("title",(0,s.shortcut_title)((0,c.default)("Rollback"),n.rollback_transaction)).attr("aria-label",(0,s.shortcut_title)((0,c.default)("Rollback"),n.rollback_transaction)),n.explain_verbose?t.find(".explain-verbose").removeClass("visibility-hidden"):t.find(".explain-verbose").addClass("visibility-hidden");n.explain_costs?t.find(".explain-costs").removeClass("visibility-hidden"):t.find(".explain-costs").addClass("visibility-hidden");n.explain_buffers?t.find(".explain-buffers").removeClass("visibility-hidden"):t.find(".explain-buffers").addClass("visibility-hidden");n.explain_timing?t.find(".explain-timing").removeClass("visibility-hidden"):t.find(".explain-timing").addClass("visibility-hidden");n.explain_summary?t.find(".explain-summary").removeClass("visibility-hidden"):t.find(".explain-summary").addClass("visibility-hidden");n.explain_settings?t.find(".explain-settings").removeClass("visibility-hidden"):t.find(".explain-settings").addClass("visibility-hidden");null!=e.connIntervalId&&(clearInterval(e.connIntervalId),e.connIntervalId=null);if(n.connection_status){var i=t.find("#btn-conn-status"),r=i.find("i");i.popover(),i.removeClass("connection-status-hide"),l.fetchConnectionStatus(e.handler,i,r),e.connIntervalId=setInterval(l.fetchConnectionStatus.bind(null,e.handler,i,r),1e3*n.connection_status_fetch_time)}else t.find("#btn-conn-status").addClass("connection-status-hide");var a=l.calcFontSize(n.sql_font_size);(0,d.default)(e.query_tool_obj.getWrapperElement()).css("font-size",a),n.plain_editor_mode?(e.query_tool_obj.setOption("mode","text/plain"),e.query_tool_obj.setOption("foldGutter",!1)):(e.query_tool_obj.setOption("mode","gpdb"===e.handler.server_type?"text/x-gpsql":"text/x-pgsql"),e.query_tool_obj.setOption("foldGutter",n.code_folding));e.query_tool_obj.setOption("foldGutter",n.code_folding),e.query_tool_obj.setOption("indentWithTabs",!n.use_spaces),e.query_tool_obj.setOption("indentUnit",n.tab_size),e.query_tool_obj.setOption("tabSize",n.tab_size),e.query_tool_obj.setOption("lineWrapping",n.wrap_code),e.query_tool_obj.setOption("autoCloseBrackets",n.insert_pair_brackets),e.query_tool_obj.setOption("matchBrackets",n.brace_matching),e.query_tool_obj.refresh(),e.historyComponent.setEditorPref({sql_font_size:a})};var s=n(74),l=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(n(69)),d=i(n(0)),c=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}},function(e,t,n){"use strict";(function(e,s){function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,n,i){return s.isUndefined(n)&&i.has_default_val?"<span class='pull-left disabled_cell'>[default]</span>":s.isUndefined(n)&&i.not_null||s.isUndefined(n)||null===n?"<span class='pull-left disabled_cell'>[null]</span>":null}var c;n(21),n(26),n(27),n(126),n(19),n(23),n(12),n(24),n(22),(c=e).extend(!0,window,{Slick:{Formatters:{JsonString:function(e,t,n,i,r){var a=d(e,t,n,i);{if(a)return a;if("object"!==l(n)||Array.isArray(n)){if(Array.isArray(n)){var o=[];return c.each(n,function(e,t){"object"===l(t)?o.push(JSON.stringify(t)):o.push(t)}),s.escape("["+o.join()+"]")}return s.escape(n)}return s.escape(JSON.stringify(n))}},Numbers:function(e,t,n,i,r){var a=function(e,t,n,i){{if(s.isUndefined(n)&&i.has_default_val)return"<span class='pull-right disabled_cell'>[default]</span>";if(s.isUndefined(n)&&i.not_null||s.isUndefined(n)||null===n)return"<span class='pull-right disabled_cell'>[null]</span>"}return null}(0,0,n,i);return a||"<span style='float:right'>"+s.escape(n)+"</span>"},Checkmark:function(e,t,n,i,r){var a=d(e,t,n,i);return a||(n?"true":"false")},Text:function(e,t,n,i,r){var a=d(e,t,n,i);return a||s.escape(n)},Binary:function(e,t,n,i,r){var a=d(e,t,n,i);return a||"<span class='pull-left disabled_cell'>["+s.escape(n)+"]</span>"}}}})}).call(this,n(0),n(1))},function(e,t,i){"use strict";(function(e,d){i(21),i(26),i(27),i(10),i(126),i(19),i(23),i(73),i(12),i(4),i(24),i(29),i(87),i(22);var s,c,t=n(i(318)),l=n(i(2));function n(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return s("<div class='pg-text-editor' />")}function p(){return s("<textarea class='pg-textarea text-12' hidefocus rows=5'>")}function h(e){var t=s("<div class='pg_buttons' />"),n=e?(0,l.default)("Cancel"):(0,l.default)("OK");return s("<button class='btn "+(e?"btn-secondary":"btn-primary")+" long_text_editor pg-alertify-button' data-label=\""+n+'"><span class="fa '+(e?"fa-times":"fa-check")+' pg-alertify-button"></span>&nbsp;'+n+"</button>").appendTo(t),e&&s("<button class='btn btn-primary long_text_editor' data-label=\""+(0,l.default)("OK")+'"><span class="fa fa-check pg-alertify-button"></span>&nbsp;'+(0,l.default)("OK")+"</button>").appendTo(t),t}function g(e){return!(""!=(e=s.trim(e))&&("{"!=e.charAt(0)||"}"!=e.charAt(e.length-1)))}function _(e,t,n,i){var r=e.grid;if(t.is_row_copied){r.copied_rows||(r.copied_rows=[[]]);var a=r.getActiveCell(),o=a.row,s=a.cell,l=t[e.column.pos];l="number"===i&&d.isEmpty(l)||l,t[e.column.field]=n,l&&d.isNull(n)&&(d.isUndefined(r.copied_rows[o])||d.isUndefined(r.copied_rows[o][s]))&&(t[e.column.field]=void 0,null==r.copied_rows[o]&&(r.copied_rows[o]=[]),r.copied_rows[o][s]=1)}else t[e.column.field]="jsonb"===i?c.stringify(c.parse(n)):n}function m(e,t){var n=t.parent().find("#datagrid");e.top=e.top-t.height();var i=n.width(),r=t.width()+32;return i<(r+=e.left)&&(e.left-=r-i),e}s=e,c=t.default,s.extend(!0,window,{Slick:{Editors:{pgText:function(n){var t,i,r,a,o=this;this.init=function(){var e=s("body");i=f().appendTo(e),t=p().appendTo(i),(r=h(!0).appendTo(i)).find("button:first").on("click",this.cancel),r.find("button:last").on("click",this.save),t.on("keydown",this.handleKeyDown),o.position(n.position),t.trigger("focus").trigger("select")},this.handleKeyDown=function(e){e.which==s.ui.keyCode.ENTER&&e.ctrlKey?o.save():e.which==s.ui.keyCode.ESCAPE?(e.preventDefault(),o.cancel()):e.which==s.ui.keyCode.TAB&&e.shiftKey?(e.preventDefault(),n.grid.navigatePrev()):e.which==s.ui.keyCode.TAB&&(e.preventDefault(),n.grid.navigateNext())},this.save=function(){n.commitChanges()},this.cancel=function(){t.val(a),n.cancelChanges()},this.hide=function(){i.hide()},this.show=function(){i.show()},this.position=function(e){m(e,i),i.css("top",e.top).css("left",e.left)},this.destroy=function(){i.remove()},this.focus=function(){t.trigger("focus")},this.loadValue=function(e){d.isUndefined(e[n.column.field])||d.isNull(e[n.column.field])?t.val(a=""):n.column.is_array?(t.val(a=e[n.column.field]),t.trigger("select")):""===e[n.column.field]?t.val(a="''"):"''"===e[n.column.field]?t.val(a="\\'\\'"):'""'===e[n.column.field]?t.val(a='\\"\\"'):(t.val(a=e[n.column.field]),t.trigger("select"))},this.serializeValue=function(){var e=t.val();return""===e?null:n.column.is_array?s.trim(e):"''"===e||'""'===e?"":"\\'\\'"===e?"''":'\\"\\"'===e?'""':e},this.applyValue=function(e,t){_(n,e,t,"text")},this.isValueChanged=function(){return(""!=t.val()||!d.isUndefined(a))&&(!(""==t.val()&&d.isNull(a))&&t.val()!==a)},this.validate=function(){if(n.column.validator){var e=n.column.validator(t.val());if(!e.valid)return e}return n.column.is_array&&!g(t.val())?{valid:!1,msg:(0,l.default)('Arrays must start with "{" and end with "}"')}:{valid:!0,msg:null}},this.init()},JsonText:function(i){var r,t,n,a,o=this;this.init=function(){var e=s("body");t=f().appendTo(e),r=p().appendTo(t),(n=h(!0).appendTo(t)).find("button:first").on("click",this.cancel),n.find("button:last").on("click",this.save),r.on("keydown",this.handleKeyDown),o.position(i.position),r.trigger("focus").trigger("select")},this.handleKeyDown=function(e){e.which==s.ui.keyCode.ENTER&&e.ctrlKey?o.save():e.which==s.ui.keyCode.ESCAPE?(e.preventDefault(),o.cancel()):e.which==s.ui.keyCode.TAB&&e.shiftKey?(e.preventDefault(),i.grid.navigatePrev()):e.which==s.ui.keyCode.TAB&&(e.preventDefault(),i.grid.navigateNext())},this.save=function(){i.commitChanges()},this.cancel=function(){r.val(a),i.cancelChanges()},this.hide=function(){t.hide()},this.show=function(){t.show()},this.position=function(e){m(e,t),t.css("top",e.top).css("left",e.left)},this.destroy=function(){t.remove()},this.focus=function(){r.trigger("focus")},this.loadValue=function(e){var t=a=e[i.column.field];if("jsonb"!==i.column.column_type_internal||Array.isArray(t)){if(Array.isArray(t)){var n=[];s.each(t,function(e,t){"object"===u(t)?n.push(c.stringify(t,null,4)):n.push(t)}),t="["+n.join()+"]"}}else t=c.stringify(c.parse(t),null,4);r.val(t),r.trigger("select")},this.serializeValue=function(){return""===r.val()?null:r.val()},this.applyValue=function(e,t){"jsonb"===i.column.column_type_internal?_(i,e,t,"jsonb"):_(i,e,t,"text")},this.isValueChanged=function(){return(""!=r.val()||!d.isUndefined(a))&&(!(""==r.val()&&d.isNull(a))&&r.val()!=a)},this.validate=function(){if("jsonb"===i.column.column_type_internal||"json"===i.column.column_type_internal)try{JSON.parse(r.val())}catch(e){return r.addClass("pg-text-invalid"),{valid:!1,msg:e.message}}return r.removeClass("pg-text-invalid"),{valid:!0,msg:null}},this.init()},CustomNumber:function(a){var o,t;this.init=function(){(o=s("<input type=text class='editor-text' />")).on("keydown.nav",function(e){e.keyCode!==s.ui.keyCode.LEFT&&e.keyCode!==s.ui.keyCode.RIGHT||e.stopImmediatePropagation()}),o.appendTo(a.container),o.trigger("focus").trigger("select")},this.destroy=function(){o.remove()},this.focus=function(){o.trigger("focus")},this.loadValue=function(e){t=e[a.column.field],!Array.isArray(t)||d.isNull(t)||d.isUndefined(t)?o.val(t):o.val("{"+t.join()+"}"),o[0].defaultValue=t,o.trigger("select")},this.serializeValue=function(){var e=o.val();return""===e?null:e},this.applyValue=function(e,t){_(a,e,t,"number")},this.isValueChanged=function(){return(""!=o.val()||!d.isUndefined(t))&&(""==o.val()&&""==t||!(""==o.val()&&d.isNull(t))&&o.val()!=t)},this.validate=function(){var e=o.val();if(!a.column.is_array&&isNaN(e))return{valid:!1,msg:(0,l.default)("Please enter a valid number")};if(a.column.validator){var t=a.column.validator(e);if(!t.valid)return t}if(a.column.is_array){if(!g(e))return{valid:!1,msg:(0,l.default)('Arrays must start with "{" and end with "}"')};var n,i=e.trim().slice(1,-1);for(var r in n=""==i?[]:i.split(","))if(isNaN(n[r]))return{valid:!1,msg:(0,l.default)("Please enter a valid number")}}return{valid:!0,msg:null}},this.init()},Checkbox:function(n){var i,t,r;this.init=function(){var t=this;(i=s("<div class='multi-checkbox' tabindex=\"0\"><span class='check' hideFocus></span></div>")).appendTo(n.container),i.trigger("focus"),i.on("click",this.changeValue),i.on("keydown",function(e){e.which==s.ui.keyCode.SPACE&&(e.preventDefault(),t.changeValue(e))})},this.changeValue=function(){var e=["unchecked","partial","checked"],t=i.find(".check").data("state")||0;t++,i.find(".check").removeClass("unchecked partial checked").addClass(e[t%e.length]).data("state",t%e.length)},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.loadValue=function(e){t=e[n.column.field],r=1,d.isNull(t)||d.isUndefined(t)?i.find(".check").data("state",1).addClass("partial"):(t=!!e[n.column.field],r=t?(i.find(".check").data("state",2).addClass("checked"),2):(i.find(".check").data("state",0).addClass("unchecked"),0))},this.serializeValue=function(){return 1==i.find(".check").data("state")?null:2==i.find(".check").data("state")},this.applyValue=function(e,t){e[n.column.field]=t},this.isValueChanged=function(){return i.find(".check").data("state")!==r},this.validate=function(){if(n.column.validator){var e=n.column.validator(this.serializeValue());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyText:function(n){var i,r;this.init=function(){i=s("<input type=text class='editor-text' readonly/>").appendTo(n.container).on("keydown.nav",function(e){e.keyCode!==s.ui.keyCode.LEFT&&e.keyCode!==s.ui.keyCode.RIGHT||e.stopImmediatePropagation()}).trigger("focus").trigger("select")},this.destroy=function(){i.remove()},this.focus=function(){i.trigger("focus")},this.getValue=function(){return i.val()},this.loadValue=function(e){var t=e[n.column.field];void 0===t&&void 0===t&&(t=""),r=t,i.val(r),i[0].defaultValue=r,i.trigger("select")},this.serializeValue=function(){return i.val()},this.applyValue=function(e,t){e[n.column.field]=t},this.isValueChanged=function(){return!(""==i.val()&&null==r)&&i.val()!=r},this.validate=function(){if(n.column.validator){var e=n.column.validator(i.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyCheckbox:function(n){var t,i;this.init=function(){(t=s("<input type=checkbox value='true' class='editor-checkbox' hideFocus disabled>")).appendTo(n.container),t.trigger("focus")},this.destroy=function(){t.remove()},this.focus=function(){t.trigger("focus")},this.loadValue=function(e){i=e[n.column.pos],d.isNull(i)||d.isUndefined(i)?(t.prop("indeterminate",!0),t.data("checked",2)):(i=!!e[n.column.pos])?(t.prop("checked",!0),t.data("checked",0)):(t.prop("checked",!1),t.data("checked",1))},this.serializeValue=function(){return t.prop("indeterminate")?null:t.prop("checked")},this.applyValue=function(e,t){e[n.column.pos]=t},this.isValueChanged=function(){var e=t.data("checked");return!(2===e&&(null==i||null==i))&&e!==i},this.validate=function(){return{valid:!0,msg:null}},this.init()},ReadOnlypgText:function(n){var t,i,r,a=this;this.init=function(){var e=s("body");i=f().appendTo(e),t=p().appendTo(i),h(!1).appendTo(i).find("button:first").on("click",this.cancel),t.on("keydown",this.handleKeyDown),a.position(n.position),t.trigger("focus").trigger("select")},this.handleKeyDown=function(e){e.which==s.ui.keyCode.ENTER&&e.ctrlKey?a.cancel():e.which==s.ui.keyCode.ESCAPE?(e.preventDefault(),a.cancel()):e.which==s.ui.keyCode.TAB&&e.shiftKey?(a.cancel(),e.preventDefault(),n.grid.navigatePrev()):e.which==s.ui.keyCode.TAB&&(a.cancel(),e.preventDefault(),n.grid.navigateNext())},this.cancel=function(){t.val(r),n.cancelChanges()},this.hide=function(){i.hide()},this.show=function(){i.show()},this.position=function(e){m(e,i),i.css("top",e.top).css("left",e.left)},this.destroy=function(){i.remove()},this.focus=function(){t.trigger("focus")},this.loadValue=function(e){t.val(r=e[n.column.field]),t.trigger("select")},this.serializeValue=function(){return t.val()},this.applyValue=function(e,t){e[n.column.field]=t},this.isValueChanged=function(){return!(""==t.val()&&null==r)&&t.val()!=r},this.validate=function(){if(n.column.validator){var e=n.column.validator(t.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},ReadOnlyJsonText:function(i){var r,t,a,n=this;this.init=function(){var e=s("body");t=f().appendTo(e),r=p().appendTo(t),h(!1).appendTo(t).find("button:first").on("click",this.cancel),r.on("keydown",this.handleKeyDown),n.position(i.position),r.trigger("focus").trigger("select")},this.handleKeyDown=function(e){e.which==s.ui.keyCode.ENTER&&e.ctrlKey?n.cancel():e.which==s.ui.keyCode.ESCAPE?(e.preventDefault(),n.cancel()):e.which==s.ui.keyCode.TAB&&e.shiftKey?(n.cancel(),e.preventDefault(),i.grid.navigatePrev()):e.which==s.ui.keyCode.TAB&&(n.cancel(),e.preventDefault(),i.grid.navigateNext())},this.cancel=function(){r.val(a),i.cancelChanges()},this.hide=function(){t.hide()},this.show=function(){t.show()},this.position=function(e){m(e,t),t.css("top",e.top).css("left",e.left)},this.destroy=function(){t.remove()},this.focus=function(){r.trigger("focus")},this.loadValue=function(e){var t=a=e[i.column.field];if("jsonb"!==i.column.column_type_internal||Array.isArray(t)){if(Array.isArray(t)){var n=[];s.each(t,function(e,t){"object"===u(t)?n.push(c.stringify(t,null,4)):n.push(t)}),t="["+n.join()+"]"}}else t=c.stringify(c.parse(t),null,4);r.val(t),r.trigger("select")},this.serializeValue=function(){return r.val()},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return!(""==r.val()&&null==a)&&r.val()!=a},this.validate=function(){if(i.column.validator){var e=i.column.validator(r.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}}}})}).call(this,i(0),i(1))},function(e,t,n){"use strict";(function(e){var h;n(10),(h=e).extend(!0,window,{Slick:{AutoColumnSize:function(l){var d,c,u,t={A:65};function n(e){e.ctrlKey&&e.shiftKey&&e.keyCode===t.A&&function(){var e=c.find(".slick-header-column"),s=d.getColumns();e.each(function(e,t){var n=h(t).data("column"),i=p(t),r=d.getColumnIndex(n.id),a=s[r],o=Math.max(i,f(n,r))+1;o=Math.min(l,o),a.width=o}),d.setColumns(s),d.onColumnsResized.notify()}()}function i(e){var t=h(e.currentTarget).closest(".slick-header-column"),n=t.data("column");if(n&&n.resizable){e.preventDefault(),e.stopPropagation();var i=p(t[0]),r=d.getColumnIndex(n.id),a=d.getColumns(),o=a[r],s=Math.max(i,f(n,r))+1;s!==o.width&&(o.width=s,d.setColumns(a),d.onColumnsResized.notify())}}function f(e,t){var n=[],i=function(){var e=h('<div class="slick-row"><div class="slick-cell"></div></div>');e.find(".slick-cell").css({visibility:"hidden","text-overflow":"initial","white-space":"nowrap"});var t=c.find(".grid-canvas");return h(t).append(e),e}(),r=d.getData();window.Slick.Data&&r instanceof window.Slick.Data.DataView&&(r=r.getItems());for(var a=0;a<r.length;a++)n.push(r[a][e.field]);var o=function(e,t){var n=h(e.find(".slick-cell"));return n.append(t),h(n).find("*").css("position","relative"),n.outerWidth()+1}(i,function(e,r,a,o,s){var l=0,d=null,c=r.formatter;return h(e).each(function(e,t){var n;c&&(t=(n=h("<span>"+c(e,a,t,r,o[e])+"</span>")).text()||t);var i=t?function(e,t){return u.font=e.css("font-size")+" "+e.css("font-family"),u.measureText(t).width}(s,t):0;l<i&&(l=i,d=n||t)}),d}(n,e,t,r,i));return function(e){h(e).remove()}(i),o}function p(e){var t,n=e.cloneNode(!0);return n.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.parentNode.insertBefore(n,e),t=n.offsetWidth,n.parentNode.removeChild(n),t}return{init:function(e){l=l||200,(c=h((d=e).getContainerNode())).on("dblclick.autosize",".slick-resizable-handle",i),c.keydown(n),u=document.createElement("canvas").getContext("2d")},destroy:function(){c.off()}}}}})}).call(this,n(0))}]).default});