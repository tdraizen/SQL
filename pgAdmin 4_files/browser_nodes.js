(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{160:function(e,t,i){"use strict";var n,o;i(16),i(30),i(11),i(4),i(8),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(270),i(161),i(14),i(13),i(197),i(54)],void 0===(o=function(h,e,g,f,c,i,b,t,n,_,p,o){if(!b.Nodes.server){var l=["prefer","require","verify-ca","verify-full"];b.SecLabelModel=b.Node.Model.extend({defaults:{provider:void 0,label:void 0},schema:[{id:"provider",label:h("Provider"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"label",label:h("Security label"),type:"text",editable:!0,cellHeaderClasses:"override_label_class_font_size"}],validate:function(){if(this.errorModel.clear(),f.isUndefined(this.get("label"))||f.isNull(this.get("label"))||""==String(this.get("label")).replace(/^\s+|\s+$/g,"")){var e=h("Label must be specified.");return this.errorModel.set("label",e),e}return null}}),i.Browser.Nodes.server=i.Browser.Node.extend({parent_type:"server_group",type:"server",dialogHelp:e("help.static",{filename:"server_dialog.html"}),label:h("Server"),canDrop:!0,dropAsRemove:!0,dropPriority:5,hasStatistics:!0,hasCollectiveStatistics:!0,can_expand:function(e){return e&&e.connected},Init:function(){this.initialized||(this.initialized=!0,b.add_menus([{name:"create_server_on_sg",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:h("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"create_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:3,label:h("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"connect_server",node:"server",module:this,applies:["object","context"],callback:"connect_server",category:"connect",priority:4,label:h("Connect Server"),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_server",node:"server",module:this,applies:["object","context"],callback:"disconnect_server",category:"drop",priority:5,label:h("Disconnect Server"),icon:"fa fa-chain-broken",enable:"is_connected"},{name:"reload_configuration",node:"server",module:this,applies:["tools","context"],callback:"reload_configuration",category:"reload",priority:6,label:h("Reload Configuration"),icon:"fa fa-repeat",enable:"enable_reload_config"},{name:"restore_point",node:"server",module:this,applies:["tools","context"],callback:"restore_point",category:"restore",priority:9,label:h("Add Named Restore Point..."),icon:"fa fa-anchor",enable:"is_applicable"},{name:"change_password",node:"server",module:this,applies:["object"],callback:"change_password",label:h("Change Password..."),priority:10,icon:"fa fa-lock",enable:"is_connected"},{name:"wal_replay_pause",node:"server",module:this,applies:["tools","context"],callback:"pause_wal_replay",category:"wal_replay_pause",priority:7,label:h("Pause Replay of WAL"),icon:"fa fa-pause-circle",enable:"wal_pause_enabled"},{name:"wal_replay_resume",node:"server",module:this,applies:["tools","context"],callback:"resume_wal_replay",category:"wal_replay_resume",priority:8,label:h("Resume Replay of WAL"),icon:"fa fa-play-circle",enable:"wal_resume_enabled"},{name:"clear_saved_password",node:"server",module:this,applies:["object","context"],callback:"clear_saved_password",label:h("Clear Saved Password"),icon:"fa fa-eraser",priority:11,enable:function(e){return!(!e||"server"!==e._type||!e.is_password_saved)}},{name:"clear_sshtunnel_password",node:"server",module:this,applies:["object","context"],callback:"clear_sshtunnel_password",label:h("Clear SSH Tunnel Password"),icon:"fa fa-eraser",priority:12,enable:function(e){return!(!e||"server"!==e._type||!e.is_tunnel_password_saved)}}]),f.bindAll(this,"connection_lost"),b.Events.on("pgadmin:server:connection:lost",this.connection_lost))},is_not_connected:function(e){return e&&1!=e.connected},is_connected:function(e){return e&&1==e.connected},enable_reload_config:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser)},is_applicable:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&0==e.in_recovery)},wal_pause_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&0==e.wal_pause)},wal_resume_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&1==e.wal_pause)},callbacks:{connect_server:function(e){var t=e||{},i=b.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0;return o&&a(this,o,i,n,!1),!1},disconnect_server:function(e,t){var i=e||{},n=this,o=b.tree,l="item"in i?i.item:o.selected(),a=l&&1==l.length?o.itemData(l):void 0;if(!a)return!1;t=t||f.isUndefined(t)||f.isNull(t);function r(){g.ajax({url:n.generate_url(l,"connect",a,!0),type:"DELETE"}).done(function(e){if(1==e.success)_.success(e.info),a=o.itemData(l),o.removeIcon(l),a.connected=!1,a.icon="icon-server-not-connected",o.addIcon(l,{icon:a.icon}),n.callbacks.refresh.apply(n,[null,l]),b.serverInfo&&a._id in b.serverInfo&&delete b.serverInfo[a._id],b.enable_disable_menus(l),b.Events.trigger("pgadmin:server:disconnect",{item:l,data:a},!1);else{try{_.error(e.errormsg)}catch(e){console.warn(e.stack||e)}o.unload(l)}}).fail(function(e,t,i){_.pgRespErrorNotify(e,i),o.unload(l)})}return t?_.confirm(h("Disconnect server"),h("Are you sure you want to disconnect the server %s?",a.label),function(){r()},function(){return!0}):r(),!1},beforeopen:function(e,t){return!(!t||"server"!=t._type)&&(b.tree.addIcon(e,{icon:t.icon}),!!t.connected||(a(this,t,b.tree,e,!1),!1))},added:function(e,t){return b.serverInfo=b.serverInfo||{},b.serverInfo[t._id]=f.extend({},t),i.Browser.Node.callbacks.added.apply(this,arguments),t.was_connected&&r(this,t,b.tree,e),!0},reload_configuration:function(e){var t=e||{},i=this,n=b.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;return l&&_.confirm(h("Reload server configuration"),h("Are you sure you want to reload the server configuration on %s?",l.label),function(){g.ajax({url:i.generate_url(o,"reload",l,!0),method:"GET"}).done(function(e){e.data.status?_.success(e.data.result):_.error(e.data.result)}).fail(function(e,t,i){_.pgRespErrorNotify(e,i),n.unload(o)})},function(){return!0}),!1},restore_point:function(e){var t=e||{},i=this,n=b.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;_.prompt(h("Enter the name of the restore point to add"),"",function(e,t){f.isUndefined(t)||f.isNull(t)||""===t||""===String(t).replace(/^\s+|\s+$/g,"")?(e.cancel=!0,_.error(h("Please enter a valid name."),10)):g.ajax({url:i.generate_url(o,"restore_point",l,!0),method:"POST",data:{value:JSON.stringify(t)}}).done(function(e){_.success(e.data.result,10)}).fail(function(e,t,i){_.pgRespErrorNotify(e,i),n.unload(o)})},function(e){e.cancel=!1}).set({title:h("Restore point name")})},change_password:function(e){var t=e||{},i=b.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0,l=this.generate_url(n,"change_password",o,!0),a=!1,r=this.generate_url(n,"check_pgpass",o,!0);if(!o)return!1;if(!_.changeServerPassword){var s=c.Model.extend({defaults:{user_name:void 0,password:void 0,newPassword:void 0,confirmPassword:void 0},validate:function(){return null}}),d=[{name:"user_name",label:h("User"),type:"text",disabled:!0,control:"input"},{name:"password",label:h("Current Password"),type:"password",disabled:function(){return a},control:"input",required:!0},{name:"newPassword",label:h("New Password"),type:"password",disabled:!1,control:"input",required:!0},{name:"confirmPassword",label:h("Confirm Password"),type:"password",disabled:!1,control:"input",required:!0}];_.dialog("changeServerPassword",function(){return{main:function(e){var t=h("Change Password ");this.set("title",t),this.user_name=e.user.name},setup:function(){return{buttons:[{text:h("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button",attrs:{name:"cancel"}},{text:h("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button",attrs:{name:"submit"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var o=this;this.__internal.buttons[1].element.disabled=!0;var e=g("<div class='change_password'></div>"),t=new s({user_name:o.user_name});(this.view=new p.Form({el:e,model:t,fields:d})).render(),this.elements.content.appendChild(e.get(0)),this.view.model.on("change",function(){var e=this,t=this.get("password"),i=this.get("newPassword"),n=this.get("confirmPassword");!a&&(f.isUndefined(t)||f.isNull(t)||""==t)||f.isUndefined(i)||f.isNull(i)||""==i||f.isUndefined(n)||f.isNull(n)||""==n?o.__internal.buttons[1].element.disabled=!0:i!=n?(o.__internal.buttons[1].element.disabled=!0,this.errorTimeout&&clearTimeout(this.errorTimeout),this.errorTimeout=setTimeout(function(){e.errorModel.set("confirmPassword",h("Passwords do not match."))},400)):(e.errorModel.clear(),o.__internal.buttons[1].element.disabled=!1)})},callback:function(e){if("submit"==e.button.element.name){var t=this,i=this.view.model.toJSON();e.cancel=!0,g.ajax({url:l,method:"POST",data:{data:JSON.stringify(i)}}).done(function(e){e.success?(a&&_.alert(h("Change Password"),h("Please make sure to disconnect the server and update the new password in the pgpass file before performing any other operation")),_.success(e.info),t.close()):_.error(e.errormsg)}).fail(function(e,t,i){_.pgRespErrorNotify(e,i)})}}}})}return g.ajax({url:r,method:"GET"}).done(function(e){e.success&&e.data.is_pgpass&&(a=!0),_.changeServerPassword(o).resizeTo("40%","52%")}).fail(function(e,t,i){_.pgRespErrorNotify(e,i)}),!1},pause_wal_replay:function(e){var t=e||{},n=b.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;g.ajax({url:this.generate_url(o,"wal_replay",i,!0),type:"DELETE",dataType:"json"}).done(function(e){1==e.success&&(_.success(e.info),n.itemData(o).wal_pause=e.data.wal_pause,n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){_.pgRespErrorNotify(e,i),n.unload(o)})},resume_wal_replay:function(e){var t=e||{},n=b.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;g.ajax({url:this.generate_url(o,"wal_replay",i,!0),type:"PUT",dataType:"json"}).done(function(e){1==e.success&&(_.success(e.info),n.itemData(o).wal_pause=e.data.wal_pause,n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){_.pgRespErrorNotify(e,i),n.unload(o)})},clear_saved_password:function(e){var t=e||{},i=this,n=b.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;return l&&_.confirm(h("Clear saved password"),h("Are you sure you want to clear the saved password for server %s?",l.label),function(){g.ajax({url:i.generate_url(o,"clear_saved_password",l,!0),method:"PUT"}).done(function(e){1==e.success?(_.success(e.info),n.itemData(o).is_password_saved=e.data.is_password_saved):_.error(e.info)}).fail(function(e,t,i){_.pgRespErrorNotify(e,i)})},function(){return!0}),!1},clear_sshtunnel_password:function(e){var t=e||{},i=this,n=b.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;return l&&_.confirm(h("Clear SSH Tunnel password"),h("Are you sure you want to clear the saved password of SSH Tunnel for server %s?",l.label),function(){g.ajax({url:i.generate_url(o,"clear_sshtunnel_password",l,!0),method:"PUT"}).done(function(e){1==e.success?(_.success(e.info),n.itemData(o).is_tunnel_password_saved=e.data.is_tunnel_password_saved):_.error(e.info)}).fail(function(e,t,i){_.pgRespErrorNotify(e,i)})},function(){return!0}),!1}},model:i.Browser.Node.Model.extend({defaults:{gid:void 0,id:void 0,name:"",sslmode:"prefer",host:"",hostaddr:"",port:5432,db:"postgres",username:n.name,role:null,connect_now:!0,password:void 0,save_password:!1,db_res:"",passfile:void 0,sslcompression:!1,sslcert:void 0,sslkey:void 0,sslrootcert:void 0,sslcrl:void 0,service:void 0,use_ssh_tunnel:0,tunnel_host:void 0,tunnel_port:22,tunnel_username:void 0,tunnel_identity_file:void 0,tunnel_password:void 0,tunnel_authentication:0,save_tunnel_password:!1,connect_timeout:10},initialize:function(e,t){0===f.size(e)&&this.set({gid:t.node_info.server_group._id}),i.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"id",label:h("ID"),type:"int",mode:["properties"]},{id:"name",label:h("Name"),type:"text",mode:["properties","edit","create"]},{id:"gid",label:h("Server group"),type:"int",control:"node-list-by-id",node:"server_group",mode:["create","edit"],select2:{allowClear:!1}},{id:"server_type",label:h("Server type"),type:"options",mode:["properties"],visible:"isConnected",options:t},{id:"connected",label:h("Connected?"),type:"switch",mode:["properties"],group:h("Connection"),options:{onText:h("True"),offText:h("False"),size:"mini"}},{id:"version",label:h("Version"),type:"text",group:null,mode:["properties"],visible:"isConnected"},{id:"bgcolor",label:h("Background"),type:"color",group:null,mode:["edit","create"],disabled:"isfgColorSet",deps:["fgcolor"]},{id:"fgcolor",label:h("Foreground"),type:"color",group:null,mode:["edit","create"],disabled:"isConnected"},{id:"connect_now",controlLabel:h("Connect now?"),type:"checkbox",group:null,mode:["create"]},{id:"comment",label:h("Comments"),type:"multiline",group:null,mode:["properties","edit","create"]},{id:"host",label:h("Host name/address"),type:"text",group:h("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"port",label:h("Port"),type:"int",group:h("Connection"),mode:["properties","edit","create"],disabled:"isConnected",min:1,max:65535},{id:"db",label:h("Maintenance database"),type:"text",group:h("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"username",label:h("Username"),type:"text",group:h("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"password",label:h("Password"),type:"password",group:h("Connection"),control:"input",mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()}},{id:"save_password",controlLabel:h("Save password?"),type:"checkbox",group:h("Connection"),mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(){return!n.allow_save_password}},{id:"role",label:h("Role"),type:"text",group:h("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"sslmode",label:h("SSL mode"),type:"options",group:h("SSL"),mode:["properties","edit","create"],disabled:"isConnected",options:[{label:h("Allow"),value:"allow"},{label:h("Prefer"),value:"prefer"},{label:h("Require"),value:"require"},{label:h("Disable"),value:"disable"},{label:h("Verify-CA"),value:"verify-ca"},{label:h("Verify-Full"),value:"verify-full"}]},{id:"sslcert",label:h("Client certificate"),type:"text",group:h("SSL"),mode:["edit","create"],disabled:"isSSL",control:p.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslkey",label:h("Client certificate key"),type:"text",group:h("SSL"),mode:["edit","create"],disabled:"isSSL",control:p.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslrootcert",label:h("Root certificate"),type:"text",group:h("SSL"),mode:["edit","create"],disabled:"isSSL",control:p.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcrl",label:h("Certificate revocation list"),type:"text",group:h("SSL"),mode:["edit","create"],disabled:"isSSL",control:p.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcompression",label:h("SSL compression?"),type:"switch",mode:["edit","create"],group:h("SSL"),options:{size:"mini"},deps:["sslmode"],disabled:"isSSL"},{id:"sslcert",label:h("Client certificate"),type:"text",group:h("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcert");return!f.isUndefined(t)&&!f.isNull(t)}},{id:"sslkey",label:h("Client certificate key"),type:"text",group:h("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslkey");return!f.isUndefined(t)&&!f.isNull(t)}},{id:"sslrootcert",label:h("Root certificate"),type:"text",group:h("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslrootcert");return!f.isUndefined(t)&&!f.isNull(t)}},{id:"sslcrl",label:h("Certificate revocation list"),type:"text",group:h("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcrl");return!f.isUndefined(t)&&!f.isNull(t)}},{id:"sslcompression",label:h("SSL compression?"),type:"switch",mode:["properties"],group:h("SSL"),options:{size:"mini"},deps:["sslmode"],visible:function(e){var t=e.get("sslmode");return-1!=f.indexOf(l,t)}},{id:"use_ssh_tunnel",label:h("Use SSH tunneling"),type:"switch",mode:["properties","edit","create"],group:h("SSH Tunnel"),options:{size:"mini"},disabled:function(e){return i.Browser.utils.support_ssh_tunnel?e.get("connected"):(setTimeout(function(){e.set("use_ssh_tunnel",0)},10),!0)}},{id:"tunnel_host",label:h("Tunnel host"),type:"text",group:h("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")||e.get("connected")}},{id:"tunnel_port",label:h("Tunnel port"),type:"int",group:h("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],max:65535,disabled:function(e){return!e.get("use_ssh_tunnel")||e.get("connected")}},{id:"tunnel_username",label:h("Username"),type:"text",group:h("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")||e.get("connected")}},{id:"tunnel_authentication",label:h("Authentication"),type:"switch",mode:["properties","edit","create"],group:h("SSH Tunnel"),options:{onText:h("Identity file"),offText:h("Password"),size:"mini",width:"90"},deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")||e.get("connected")}},{id:"tunnel_identity_file",label:h("Identity file"),type:"text",group:h("SSH Tunnel"),mode:["edit","create"],control:p.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["tunnel_authentication","use_ssh_tunnel"],disabled:function(e){var t=e.get("tunnel_identity_file");return!e.get("tunnel_authentication")&&t&&setTimeout(function(){e.set("tunnel_identity_file",null)},10),!e.get("tunnel_authentication")||!e.get("use_ssh_tunnel")}},{id:"tunnel_identity_file",label:h("Identity file"),type:"text",group:h("SSH Tunnel"),mode:["properties"]},{id:"tunnel_password",label:h("Password"),type:"password",group:h("SSH Tunnel"),control:"input",mode:["create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")||e.get("connected")}},{id:"save_tunnel_password",controlLabel:h("Save password?"),type:"checkbox",group:h("SSH Tunnel"),mode:["create"],deps:["connect_now","use_ssh_tunnel"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(e){return!n.allow_save_tunnel_password||!e.get("use_ssh_tunnel")}},{id:"hostaddr",label:h("Host address"),type:"text",group:h("Advanced"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"db_res",label:h("DB restriction"),type:"select2",group:h("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",select2:{multiple:!0,allowClear:!1,tags:!0,tokenSeparators:[","],first_empty:!1,selectOnClose:!0,emptyOptions:!0}},{id:"passfile",label:h("Password file"),type:"text",group:h("Advanced"),mode:["edit","create"],disabled:"isConnectedWithValidLib",control:p.FileControl,dialog_type:"select_file",supp_types:["*"]},{id:"passfile",label:h("Password file"),type:"text",group:h("Advanced"),mode:["properties"],visible:function(e){var t=e.get("passfile");return!f.isUndefined(t)&&!f.isNull(t)}},{id:"service",label:h("Service"),type:"text",mode:["properties","edit","create"],disabled:"isConnected",group:h("Connection")},{id:"connect_timeout",label:h("Connection timeout (seconds)"),type:"int",group:h("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",min:0}],validate:function(){return new o.ModelValidation(this).validate()},isConnected:function(e){return e.get("connected")},isfgColorSet:function(e){var t=e.get("bgcolor"),i=e.get("fgcolor");return!!e.get("connected")||((f.isUndefined(t)||f.isNull(t)||!t)&&i&&e.set("bgcolor","#ffffff"),!1)},isSSL:function(e){var t=e.get("sslmode");return!!e.get("connected")||-1==f.indexOf(l,t)},isConnectedWithValidLib:function(e){return!!e.get("connected")||b.utils.pg_libpq_version<1e5}}),connection_lost:function(i,n){if(b.tree){for(var e=b.tree,o=i&&e.itemData(i),t=this;o&&"server"!=o._type;)i=e.parent(i),o=i&&e.itemData(i);if(i&&o&&"server"==o._type&&(f.isUndefined(o.is_connecting)||!o.is_connecting)){o.is_connecting=!0;b.Events.on("pgadmin:server:connect:cancelled",function e(t){o._id==t&&(o.is_connecting=!1,b.Events.off("pgadmin:server:connect:cancelled",e),b.Events.trigger("pgadmin:database:connect:cancelled",t,n.data.database||o.db),b.Events.trigger("pgadmin:server:disconnect",{item:i,data:o},!1))}),_.confirm(h("Connection lost"),h("Would you like to reconnect to the database?"),function(){a(t,o,e,i,!0)},function(){o.is_connecting=!1,e.unload(i),e.setInode(i),e.addIcon(i,{icon:"icon-database-not-connected"}),b.Events.trigger("pgadmin:server:connect:cancelled",i,o,t),e.select(i)})}}}});var a=function s(a,d,c,n,e){function p(e,t,i,n,o,l,a,r){d.connected=!1,r||(c.setInode(a),c.addIcon(a,{icon:"icon-server-not-connected"})),_.pgNotifier("error",e,i,function(e){setTimeout(function(){"CRYPTKEY_SET"==e?s(n,o,l,a,r):_.dlgServerPass(h("Connect to Server"),e,n,o,l,a,r).resizeTo()},100)})}function u(e,t,i,n,o,l){e&&e.data&&("string"==typeof e.data.icon&&(n.removeIcon(o),i.icon=e.data.icon,n.addIcon(o,{icon:i.icon})),f.extend(i,e.data),i.is_connecting=!1,(b.serverInfo=b.serverInfo||{})[i._id]=f.extend({},i),_.success(e.info),a.trigger("connected",a,o,i),b.Events.trigger("pgadmin:server:connected",i._id,o,i),b.Events.trigger("pgadmin:database:connected",i._id,i.db,o,i),l?setTimeout(function(){t.callbacks.refresh.apply(t,[!0])},10):(n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o),n.open(o)},10)))}var o=e||d.connected;_.dlgServerPass||_.dialog("dlgServerPass",function(){return{main:function(e,t,i,n,o,l,a,r,s,d){this.set("title",e),this.message=t,this.tree=o,this.nodeData=n,this.nodeItem=l,this.node=i,this.connected=a,this.onSuccess=r||u,this.onFailure=s||p,this.onCancel=d||m},setup:function(){return{buttons:[{text:h("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:h("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},prepare:function(){this.setContent(this.message)},callback:function(e){var n=this.tree,o=this.nodeItem,l=this.node,a=this.nodeData,r=this.connected,t=this.onSuccess,s=this.onFailure,i=this.onCancel;if(e.button.text==h("OK")){var d=l.generate_url(o,"connect",a,!0);r||(n.setLeaf(o),n.removeIcon(o),n.addIcon(o,{icon:"icon-server-connecting"})),g.ajax({type:"POST",timeout:3e4,url:d,data:g("#frmPassword").serialize()}).done(function(e){return t(e,l,a,n,o,r)}).fail(function(e,t,i){return s(e,t,i,l,a,n,o,r)})}else i&&"function"==typeof i&&i(n,o,a,r)}}});var m=function(e,t,i,n){i.is_connecting=!1,e.unload(t),e.setInode(t),e.removeIcon(t),e.addIcon(t,{icon:"icon-server-not-connected"}),a.trigger("connect:cancelled",d._id,d.db,a,t,i),b.Events.trigger("pgadmin:server:connect:cancelled",d._id,t,i,a),b.Events.trigger("pgadmin:database:connect:cancelled",d._id,d.db,t,i,a),n&&e.select(t)};if(!d.is_connecting){d.is_connecting=!0,c.setLeaf(n),c.removeIcon(n),c.addIcon(n,{icon:"icon-server-connecting"});var t=a.generate_url(n,"connect",d,!0);g.post(t).done(function(e){if(1==e.success)return u(e,a,d,c,n,o)}).fail(function(e,t,i){return p(e,0,i,a,d,c,n,o)}).always(function(){d.is_connecting=!1})}},r=function(e,t,n,o){var i=e.generate_url(o,"connect",t,!0);n.setLeaf(o),n.removeIcon(o),n.addIcon(o,{icon:"icon-server-connecting"}),g.get(i).done(function(e){n.setInode(o),e&&e.data&&("string"==typeof e.data.icon&&(n.removeIcon(o),t.icon=e.data.icon,n.addIcon(o,{icon:t.icon})),f.extend(t,e.data),(b.serverInfo=b.serverInfo||{})[t._id]=f.extend({},t),t.errmsg&&_.error(t.errmsg))}).fail(function(e,t,i){n.setInode(o),n.addIcon(o,{icon:"icon-server-not-connected"}),_.pgRespErrorNotify(e,i)})}}return b.Nodes.server}.apply(t,n))||(e.exports=o)},211:function(e,t,i){"use strict";var n,o;i(30),i(11),i(4),i(8),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(13),i(51),i(38),i(20),i(54)],void 0===(o=function(l,e,t,a,i,n,o,r,s,d){o.Nodes["coll-function"]||(o.Nodes["coll-function"]=o.Collection.extend({node:"function",label:l("Functions"),type:"coll-function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=o.Node.Model.extend({idAttribute:"argid",defaults:{argid:void 0,argtype:void 0,argmode:void 0,argname:void 0,argdefval:void 0},schema:[{id:"argid",visible:!1,type:"text",mode:["properties","edit","create"]},{id:"argtype",label:l("Data type"),cell:"node-ajax-options",cellHeaderClasses:"width_percent_30",control:"node-ajax-options",type:"text",url:"get_types",editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!a.isUndefined(e.isNew)||e.isNew())},first_empty:!0},{id:"argmode",label:l("Mode"),type:"options",control:"node-ajax-options",cellHeaderClasses:"width_percent_20",options:[{label:"IN",value:"IN"},{label:"OUT",value:"OUT"},{label:"INOUT",value:"INOUT"},{label:"VARIADIC",value:"VARIADIC"}],editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!a.isUndefined(e.isNew)||e.isNew())}},{id:"argname",label:l("Argument name"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_30"},{id:"argdefval",label:l("Default"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_20"}],toJSON:i.Model.prototype.toJSON,isInCatalog:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&!!(a.isUndefined(e.get("argmode"))||a.isUndefined(this.get("name"))||"argdefval"!=this.get("name")||"INOUT"!=e.get("argmode")&&"OUT"!=e.get("argmode"))},validate:function(){}});return o.Nodes.function||(o.Nodes.function=s.SchemaChildNode.extend({type:"function",sqlAlterHelp:"sql-alterfunction.html",sqlCreateHelp:"sql-createfunction.html",dialogHelp:e("help.static",{filename:"function_dialog.html"}),label:l("Function"),collection_type:"coll-function",hasSQL:!0,hasDepends:!0,width:o.stdW.md+"px",hasStatistics:function(e){return"gpdb"!==e.server.server_type},hasScriptTypes:["create","select"],Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_function_on_coll",node:"coll-function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:o.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===a.size(e)){var i=t.node_info.schema._id;this.set({pronamespace:i},{silent:!0});var n=o.serverInfo[t.node_info.server._id].user;this.set({funcowner:n.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,proparallel:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,prosupportfunc:void 0,arguments:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:l("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:l("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:l("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:l("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:l("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:l("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:l("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:l("Argument count"),cell:"string",type:"text",group:l("Definition"),mode:["properties"]},{id:"proargs",label:l("Arguments"),cell:"string",type:"text",group:l("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"proargtypenames",label:l("Signature arguments"),cell:"string",type:"text",group:l("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:l("Return type"),cell:"string",control:"node-ajax-options",type:"text",group:l("Definition"),url:"get_types",disabled:"isDisabled",first_empty:!0,mode:["create"],visible:"isVisible"},{id:"prorettypename",label:l("Return type"),cell:"string",type:"text",group:l("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:l("Language"),cell:"string",control:"node-ajax-options",type:"text",group:l("Definition"),url:"get_languages",disabled:"isDisabled"},{id:"prosrc",label:l("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:l("Code"),deps:["lanname"],tabPanelCodeClass:"sql-code-control",control:r.SqlCodeControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:l("Object file"),cell:"string",type:"text",group:l("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:l("Link symbol"),cell:"string",type:"text",group:l("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:l("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:l("Options"),deps:["lanname"],options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:l("Returns a set?"),type:"switch",disabled:"isDisabled",group:l("Options"),visible:"isVisible"},{id:"proisstrict",label:l("Strict?"),type:"switch",group:l("Options"),disabled:"isDisabled",deps:["lanname"]},{id:"prosecdef",label:l("Security of definer?"),group:l("Options"),type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:l("Window?"),group:l("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"proparallel",label:l("Parallel"),cell:"string",control:"node-ajax-options",type:"text",group:l("Options"),deps:["lanname"],options:[{label:"UNSAFE",value:"u"},{label:"RESTRICTED",value:"r"},{label:"SAFE",value:"s"}],disabled:"isDisabled",min_version:90600,select2:{allowClear:!1}},{id:"procost",label:l("Estimated cost"),group:l("Options"),cell:"string",type:"text",disabled:"isDisabled",deps:["lanname"]},{id:"prorows",label:l("Estimated rows"),type:"text",deps:["proretset"],visible:"isVisible",disabled:"isDisabled",group:l("Options")},{id:"proleakproof",label:l("Leak proof?"),group:l("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled",deps:["lanname"]},{id:"prosupportfunc",label:l("Support function"),type:"text",disabled:"isDisabled",group:l("Options"),visible:"isVisible",control:"node-ajax-options",url:"get_support_functions",cache_node:"function",min_version:12e4},{id:"proacl",label:l("Privileges"),type:"text",mode:["properties"],group:l("Security")},{id:"arguments",label:l("Arguments"),cell:"string",group:l("Definition"),type:"collection",canAdd:function(e){return e.isNew()},canDelete:!0,model:c,mode:["create","edit"],columns:["argtype","argmode","argname","argdefval"],disabled:"isDisabled",canDeleteRow:function(e){return e.isNew()}},{id:"variables",label:"",type:"collection",group:l("Parameters"),control:"variable-collection",model:o.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},o.SecurityGroupSchema,{id:"acl",label:l("Privileges"),editable:!1,model:o.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"isDisabled"},{id:"seclabels",label:l("Security labels"),canAdd:!0,model:o.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canEdit:!1,canDelete:!0,uniqueCol:["provider"],disabled:"isDisabled",control:"unique-col-collection",visible:function(){return this.node&&"procedure"!=this.node.type}}],validate:function(){var e,t={},i=this.get("seclabels");if(!a.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(t.name=l("Name cannot be empty."),e=e||t.name),!a.isUndefined(this.get("funcowner"))&&""!=String(this.get("funcowner")).replace(/^\s+|\s+$/g,"")||(t.funcowner=l("Owner cannot be empty."),e=e||t.funcowner),!a.isUndefined(this.get("pronamespace"))&&""!=String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")||(t.pronamespace=l("Schema cannot be empty."),e=e||t.pronamespace),!a.isUndefined(this.get("prorettypename"))&&""!=String(this.get("prorettypename")).replace(/^\s+|\s+$/g,"")||(t.prorettypename=l("Return type cannot be empty."),e=e||t.prorettypename),!a.isUndefined(this.get("lanname"))&&""!=String(this.get("lanname")).replace(/^\s+|\s+$/g,"")||(t.lanname=l("Language cannot be empty."),e=e||t.lanname),"c"==String(this.get("lanname"))?(!a.isUndefined(this.get("probin"))&&""!=String(this.get("probin")).replace(/^\s+|\s+$/g,"")||(t.probin=l("Object File cannot be empty."),e=e||t.probin),!a.isUndefined(this.get("prosrc_c"))&&""!=String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")||(t.prosrc_c=l("Link Symbol cannot be empty."),e=e||t.prosrc_c)):!a.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")||(t.prosrc=l("Code cannot be empty."),e=e||t.prosrc),i)for(var n,o=0;o<i.models.length&&!n;o++)(n=i.models[o].validate.apply(i.models[o]))&&(t.seclabels=n,e=e||n);return this.errorModel.clear().set(t),a.size(t)?(this.trigger("on-status",{msg:e}),e):null},isVisible:function(){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");case"prosupportfunc":var t=n.Browser.tree.selected();return!n.Browser.Nodes.function.getTreeNodeHierarchy(t).server.user.is_superuser;default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),o.Nodes.function}.apply(t,n))||(e.exports=o)},212:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20),i(54)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-edbfunc"]||(l.Nodes["coll-edbfunc"]=l.Collection.extend({node:"edbfunc",label:e("Functions"),type:"coll-edbfunc",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),l.Nodes.edbfunc||(l.Nodes.edbfunc=l.Node.extend({type:"edbfunc",dialogHelp:t("help.static",{filename:"edbfunc_dialog.html"}),label:e("Function"),collection_type:"coll-edbfunc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,funcowner:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",prosrc:void 0,proacl:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),disabled:!0,mode:["properties"],visible:"isVisible"},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"lanname",label:e("Language"),cell:"string",type:"text",group:e("Definition"),disabled:!0},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties"],group:e("Code"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,visible:function(e){return"c"!=e.get("lanname")},disabled:!0}],validate:function(){return null},isVisible:function(){return"sysproc"!=this.name}})})),l.Nodes.edbfunc}.apply(t,n))||(e.exports=o)},213:function(e,t,i){"use strict";var n,o;i(16),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(38)],void 0===(o=function(n,e,t,d,i,c,o,l){return c.Nodes["coll-rule"]||(i.Browser.Nodes["coll-rule"]=i.Browser.Collection.extend({node:"rule",label:n("Rules"),type:"coll-rule",columns:["name","owner","comment"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),c.Nodes.rule||(i.Browser.Nodes.rule=c.Node.extend({parent_type:["table","view","partition"],type:"rule",sqlAlterHelp:"sql-alterrule.html",sqlCreateHelp:"sql-createrule.html",dialogHelp:e("help.static",{filename:"rule_dialog.html"}),label:n("rule"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,canDrop:function(e,t){return l.isTreeItemOfChildOfSchema.apply(this,[e,t]),!d.has(e,"label")||"_RETURN"!==e.label},canDropCascade:function(e,t){return l.isTreeItemOfChildOfSchema.apply(this,[e,t]),!d.has(e,"label")||"_RETURN"!==e.label},Init:function(){this.initialized||(this.initialized=!0,c.add_menus([{name:"create_rule_on_coll",node:"coll-rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:n("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:n("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:n("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"}]))},model:i.Browser.Node.Model.extend({idAttribute:"oid",schema:[{id:"name",label:n("Name"),type:"text",disabled:function(e){return!(!e||"_RETURN"!=e.get("name"))||!e.isNew()&&!(90400<=e.node_info.server.version)}},{id:"oid",label:n("OID"),type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:"",type:"text",visible:!1,disabled:function(e){e.set("schema",e.node_info.schema.label)}},{id:"view",label:"",type:"text",visible:!1,disabled:function(e){e.set("view",this.node_data.label)}},{id:"event",label:n("Event"),control:"select2",group:n("Definition"),type:"text",select2:{width:"100%",allowClear:!1},options:[{label:"Select",value:"Select"},{label:"Insert",value:"Insert"},{label:"Update",value:"Update"},{label:"Delete",value:"Delete"}]},{id:"do_instead",label:n("Do instead?"),group:n("Definition"),type:"switch"},{id:"condition",label:n("Condition"),type:"text",group:n("Condition"),tabPanelCodeClass:"sql-code-control",control:o.SqlCodeControl},{id:"statements",label:n("Commands"),type:"text",group:n("Commands"),tabPanelCodeClass:"sql-code-control",control:o.SqlCodeControl},{id:"system_rule",label:n("System rule?"),type:"switch",mode:["properties"]},{id:"enabled",label:n("Enabled?"),type:"switch",mode:["properties"]},{id:"comment",label:n("Comment"),cell:"string",type:"multiline"}],validate:function(){var e,t={},i=this.get("name");return d.isUndefined(i)||d.isNull(i)||""===String(i).replace(/^\s+|\s+$/g,"")?(t.name=n("Please specify name."),e=e||t.name,this.errorModel.set("name",e),e):(this.errorModel.unset("name"),null)}}),canCreate:function(e,t,i){if(i&&!1===i.check)return!0;for(var n=c.tree,o=t,l=e;o;){if(-1<d.indexOf(["schema"],l._type))return!0;if("coll-rule"==l._type){var a=n.hasParent(o)?n.parent(o):null,r=n.hasParent(a)?n.parent(a):null,s=(r&&n.itemData(r),n.hasParent(r)?n.parent(r):null);return"catalog"!=(s?n.itemData(s):null)._type}if("view"==l._type||"table"==l._type)return a=n.hasParent(o)?n.parent(o):null,"schema"==((r=n.hasParent(a)?n.parent(a):null)?n.itemData(r):null)._type;l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!0}})),c.Nodes["coll-rule"]}.apply(t,n))||(e.exports=o)},271:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(80)],void 0===(o=function(t,e,i,n,o){return o.Browser.Nodes.server_group||(o.Browser.Nodes.server_group=o.Browser.Node.extend({parent_type:null,type:"server_group",dialogHelp:e("help.static",{filename:"server_group_dialog.html"}),label:t("Server Group"),width:"250px",height:"150px",is_collection:!0,Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menus([{name:"create_server_group",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:t("Server Group..."),data:{action:"create"},icon:"wcTabIcon icon-server_group"}]))},model:o.Browser.Node.Model.extend({defaults:{id:void 0,name:null},schema:[{id:"id",label:t("ID"),type:"int",group:null,mode:["properties"]},{id:"name",label:t("Name"),type:"text",group:null,mode:["properties","edit","create"]}],validate:function(){var e=null;return this.errorModel.clear(),!this.isNew()&&"id"in this.changed?(e=t("The ID cannot be changed."),this.errorModel.set("id",e),e):n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=t("Name cannot be empty."),this.errorModel.set("name",e),e):null}}),canDrop:function(e){return e.can_delete},dropAsRemove:!0,canDelete:function(e){var t=o.Browser.tree.siblings(e,!0);return!(!t||0==t.length)}})),o.Browser.Nodes.server_group}.apply(t,n))||(e.exports=o)},272:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(25),i(3),i(124),i(14),i(13),i(20),i(54),i(273)],void 0===(o=function(m,e,r,a,i,t,s,h,n){if(s.Nodes["coll-database"]||(s.Nodes["coll-database"]=s.Collection.extend({node:"database",label:m("Databases"),type:"coll-database",columns:["name","datowner","comments"],hasStatistics:!0,canDrop:!0,canDropCascade:!1,statsPrettifyFields:[m("Size"),m("Size of temporary files")]})),!s.Nodes.database){s.Nodes.database=s.Node.extend({parent_type:"server",type:"database",sqlAlterHelp:"sql-alterdatabase.html",sqlCreateHelp:"sql-createdatabase.html",dialogHelp:e("help.static",{filename:"database_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[m("Size"),m("Size of temporary files")],canDrop:function(e){return e.canDrop},label:m("Database"),node_image:function(){return"pg-icon-database"},Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_database_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database_on_coll",node:"coll-database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"connect_database",node:"database",module:this,applies:["object","context"],callback:"connect_database",category:"connect",priority:4,label:m("Connect Database..."),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_database",node:"database",module:this,applies:["object","context"],callback:"disconnect_database",category:"drop",priority:5,label:m("Disconnect Database..."),icon:"fa fa-chain-broken",enable:"is_connected"}]),a.bindAll(this,"connection_lost"),s.Events.on("pgadmin:database:connection:lost",this.connection_lost))},can_create_database:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.can_create_db},is_not_connected:function(e){return e&&1!=e.connected&&1==e.allowConn},is_connected:function(e){return e&&1==e.connected&&1==e.canDisconn},is_conn_allow:function(e){return e&&1==e.allowConn},connection_lost:function(e,t,i){if(s.tree){for(var n=s.tree,o=e&&n.itemData(e),l=this;o&&"database"!=o._type;)e=n.parent(e),o=e&&n.itemData(e);if(e&&o){if(!o.allowConn)return!1;if(a.isUndefined(o.is_connecting)||!o.is_connecting){o.is_connecting=!0;if(s.Events.on("pgadmin:database:connect:cancelled",function e(t,i){i._id==this._id&&(o.is_connecting=!1,s.Events.off("pgadmin:database:connect:cancelled",e),i=(t=t&&n.parent(t))&&n.itemData(t),t&&i&&s.Events.trigger("pgadmin:server:disconnect",{item:t,data:i},!1))}),i)return void d(l,o,n,e,!0);h.confirm(m("Connection lost"),m("Would you like to reconnect to the database?"),function(){d(l,o,n,e,!0)},function(){o.is_connecting=!1,n.unload(e),n.setInode(e),n.addIcon(e,{icon:"icon-database-not-connected"}),s.Events.trigger("pgadmin:database:connect:cancelled",e,o,l)})}}}},callbacks:{connect_database:function(e){var t=e||{},i=s.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0;return o&&"template0"!=o.label&&g(this,o,i,n,!0),!1},disconnect_database:function(e){var t=e||{},n=this,o=s.tree,l=t.item||o.selected(),a=l&&1==l.length?o.itemData(l):void 0;return a&&h.confirm(m("Disconnect the database"),i.sprintf(m("Are you sure you want to disconnect the database - %s?"),a.label),function(){var i=a;r.ajax({url:n.generate_url(l,"connect",a,!0),type:"DELETE"}).done(function(e){if(1==e.success){var t=o.parent(l);h.success(e.info),o.removeIcon(l),i.connected=!1,i.icon="icon-database-not-connected",o.addIcon(l,{icon:i.icon}),o.unload(l),o.setInode(l),setTimeout(function(){o.select(t)},10)}else{try{h.error(e.errormsg)}catch(e){console.warn(e.stack||e)}o.unload(l)}}).fail(function(e,t,i){h.pgRespErrorNotify(e,i),o.unload(l)})},function(){return!0}),!1},beforeopen:function(e,t){return!(!t||"database"!=t._type||"template0"==t.label)&&(s.tree.addIcon(e,{icon:t.icon}),!(!t.connected&&t.allowConn)||(g(this,t,s.tree,e,!0),!1))},selected:function(e,t){return!(!t||"database"!=t._type)&&(s.tree.addIcon(e,{icon:t.icon}),!t.connected&&t.allowConn?(g(this,t,s.tree,e,!1),!1):s.Node.callbacks.selected.apply(this,arguments))},refresh:function(e,t){var i=s.tree,n=t||i.selected();i.itemData(n).allowConn&&s.Node.callbacks.refresh.apply(this,arguments)}},model:s.Node.Model.extend({idAttribute:"did",defaults:{name:void 0,owner:void 0,comment:void 0,encoding:"UTF8",template:void 0,tablespace:void 0,collation:void 0,char_type:void 0,datconnlimit:-1,datallowconn:void 0,variables:[],privileges:[],securities:[],datacl:[],deftblacl:[],deffuncacl:[],defseqacl:[],is_template:!1,deftypeacl:[]},initialize:function(e,t){if(0===a.size(e)){var i=s.serverInfo[t.node_info.server._id].user;this.set({datowner:i.name},{silent:!0})}s.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:m("Database"),cell:"string",editable:!1,type:"text"},{id:"did",label:m("OID"),cell:"string",mode:["properties"],editable:!1,type:"text"},{id:"datowner",label:m("Owner"),editable:!1,type:"text",node:"role",control:n.NodeListByNameControl,select2:{allowClear:!1}},{id:"acl",label:m("Privileges"),type:"text",group:m("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:m("Default TABLE privileges"),type:"text",group:m("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:m("Default SEQUENCE privileges"),type:"text",group:m("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:m("Default FUNCTION privileges"),type:"text",group:m("Security"),mode:["properties"],disabled:!0},{id:"typeacl",label:m("Default TYPE privileges"),type:"text",group:m("Security"),mode:["properties"],disabled:!0,min_version:90200},{id:"comments",label:m("Comment"),editable:!1,type:"multiline"},{id:"encoding",label:m("Encoding"),editable:!1,type:"text",group:m("Definition"),disabled:function(e){return!e.isNew()},url:"get_encodings",control:"node-ajax-options",cache_level:"server"},{id:"template",label:m("Template"),editable:!1,type:"text",group:m("Definition"),disabled:function(e){return!e.isNew()},control:"node-list-by-name",url:"get_databases",cache_level:"server",select2:{allowClear:!1},mode:["create"],transform:function(e,t){var i=[],n=t||this,o=n.model.get("name");return n.model.isNew()?e&&a.isArray(e)&&a.each(e,function(e){i.push({label:e,value:e,image:"pg-icon-database"})}):i.push({label:o,value:o}),i}},{id:"spcname",label:m("Tablespace"),editable:!1,type:"text",group:m("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"datcollate",label:m("Collation"),editable:!1,type:"text",group:m("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datctype",label:m("Character type"),editable:!1,type:"text",group:m("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datconnlimit",label:m("Connection limit"),editable:!1,type:"int",group:m("Definition"),min:-1},{id:"is_template",label:m("Template?"),editable:!1,type:"switch",group:m("Definition"),disabled:!0,mode:["properties","edit"]},{id:"datallowconn",label:m("Allow connections?"),editable:!1,type:"switch",group:m("Definition"),mode:["properties"],disabled:!0},{id:"datacl",label:m("Privileges"),type:"collection",model:s.Node.PrivilegeRoleModel.extend({privileges:["C","T","c"]}),uniqueCol:["grantee","grantor"],editable:!1,group:m("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"variables",label:"",type:"collection",model:s.Node.VariableModel.extend({keys:["name","role"]}),editable:!1,group:m("Parameters"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0,hasRole:!0,control:n.VariableCollectionControl,node:"role"},{id:"seclabels",label:m("Security labels"),model:s.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:m("Security"),canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"],min_version:90200},{type:"nested",control:"tab",group:m("Default Privileges"),mode:["edit"],schema:[{id:"deftblacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:!1,type:"collection",group:m("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:!1,type:"collection",group:m("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:!1,type:"collection",group:m("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:!1,type:"collection",group:"deftypesacl_group",mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200},{id:"deftypesacl_group",type:"group",label:m("Types"),mode:["edit","create"],min_version:90200}]}],validate:function(){var e=this.get("name");if(a.isUndefined(e)||a.isNull(e)||""==String(e).replace(/^\s+|\s+$/g,"")){var t=m("Name cannot be empty.");return this.errorModel.set("name",t),t}return this.errorModel.unset("name"),null}})}),s.SecurityGroupSchema={id:"security",label:m("Security"),type:"group",visible:function(e){return!(e&&"node_info"in e)||!("catalog"in(e.node_info||e.handler.node_info))}};var g=function(e,t,i,n){d(e,t,i,n)},d=function(a,n,d,o,c){var l=c||n.connected,p=function(e,t,i,n,o,l){i.is_connecting=!1,l||(n.deselect(o),n.setInode(o)),e&&e.data&&("boolean"==typeof e.data.connected&&(i.connected=e.data.connected),"string"==typeof e.data.icon&&(n.removeIcon(o),i.icon=e.data.icon,n.addIcon(o,{icon:i.icon})),h.success(e.info),a.trigger("connected",a,o,i),s.Events.trigger("pgadmin:database:connected",o,i),l||setTimeout(function(){n.select(o),n.open(o)},10))},u=function(e,t,i){i.is_connecting=!1;var n=e.parent(t);e.unload(t),e.setInode(t),e.removeIcon(t),e.addIcon(t,{icon:"icon-database-not-connected"}),a.trigger("connect:cancelled",a,t,i),s.Events.trigger("pgadmin:database:connect:cancelled",t,i,a),e.select(n)};r.post(a.generate_url(o,"connect",n,!0)).done(function(e){if(1==e.success)return p(e,a,n,d,o,l)}).fail(function(e,t,i){return function t(e,i,n,o,l,a,r,s){s||(d.setInode(r),d.addIcon(r,{icon:"icon-database-not-connected"})),h.pgNotifier("error",e,n,function(e){setTimeout(function(){"CRYPTKEY_SET"==e?g(o,l,a,r,c):h.dlgServerPass(m("Connect to database"),e,o,l,a,r,s,p,t,u).resizeTo()},100)})}(e,0,i,a,n,d,o,l)})}}return s.Nodes["coll-database"]}.apply(t,n))||(e.exports=o)},274:function(e,t,i){"use strict";var n,o;i(10),i(16),i(23),i(50),i(30),i(11),i(4),i(8),i(29),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(47),i(13),i(185),i(20),i(106),i(273)],void 0===(o=function(m,e,h,g,t,i,n,f){i.Nodes["coll-role"]||(t.Browser.Nodes["coll-role"]=t.Browser.Collection.extend({node:"role",type:"coll-role",columns:["rolname","rolvaliduntil","rolconnlimit","rolcanlogin","rolsuper","rolcreaterole","rolcreatedb","rolcatupdate","rolinherit","rolreplication"],canDrop:!0,canDropCascade:!1}));var o=t.Browser.SecurityModel=t.Browser.SecurityModel||t.Browser.Node.Model.extend({defaults:{provider:null,label:null},schema:[{id:"provider",label:m("Provider"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"},{id:"label",label:m("Security label"),type:"text",disabled:!1}],validate:function(){var e,t=this.toJSON();return g.isUndefined(t.provider)||g.isNull(t.provider)||""==String(t.provider).replace(/^\s+|\s+$/g,"")?(e=m("Please specify the value for all the security providers."),this.errorModel.set("provider",e),e):(this.errorModel.unset("provider"),g.isUndefined(t.label)||g.isNull(t.label)||""==String(t.label).replace(/^\s+|\s+$/g,"")?(e=m("Please specify the value for all the security providers."),this.errorModel.set("label",e),e):(this.errorModel.unset("label"),null))}}),l=f.Control.extend({defaults:g.defaults({extraClasses:["col-12 col-sm-12 col-md-12"]},f.NodeListByNameControl.prototype.defaults),initialize:function(){f.NodeListByNameControl.prototype.initialize.apply(this,arguments)},formatter:{fromRaw:function(e){var t=g.isObject(e)?e:JSON.parse(e);return g.pluck(t,"role")},toRaw:function(e){return e}},template:g.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" style="width:100%;" class="pgadmin-controls <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>>',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value=<%-option.value%> data-icon=<%-option.image%> <%=value != null && _.indexOf(value, option.value) != -1 ? "selected" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),selectionTemplate:g.template(["<span>",'  <span class="wcTabIcon <%= optimage %>"></span>',"  <span><%= opttext %><span>","  <% if (checkbox) { %>",'  <input type="checkbox" <%=disabled ? "disabled=\'disabled\'" : ""%>/>',"  <% } %>","</span>"].join("\n")),events:{"change select":"onChange"},getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each(function(){e.push(h(this).attr("value"))}),e},render:function(){function e(e,t,i){return g.isFunction(e)?!!e.apply(t,[i]):!!e}var t,i,n,o=g.defaults(this.field.toJSON(),this.defaults),l=this.model.toJSON(),a=o.name.split("."),r=a.shift(),s=a.join("."),d=this.keyPathAccessor(l[r],s),c=g.extend(o,{rawValue:d,value:this.formatter.fromRaw(d,this.model),attributes:l,formatter:this.formatter});if(g.extend(c,{disabled:e(c.disabled,c,this.model),visible:e(c.visible,c,this.model),required:e(c.required,c,this.model),helpMessage:(t=c.helpMessage,i=c,n=this.model,g.isFunction(t)?t.apply(i,[n]):t)}),g.isFunction(c.options))try{c.options=c.options.apply(this)}catch(e){c.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}this.$el.removeClass(f.hiddenClassName),c.visible||this.$el.addClass(f.hiddenClassName),this.$el.html(this.template(c)).addClass(o.name),this.updateInvalid();var p=this,u=this.model.get(this.field.get("name"));return this.$el.find("select").select2({templateResult:function(e){if(!e.id)return e.text;var t=h(e.element).data("icon");if(t){var i=g.extend({},c,{opttext:g.escape(e.text),optimage:t,checkbox:!1});return h(p.selectionTemplate(i))}return e.text},templateSelection:function(e){if(!e.id)return e.text;var t=h(e.element).data("icon");if(t){var i=g.extend({},c,{opttext:g.escape(e.text),optimage:t,checkbox:!0}),n=h(p.selectionTemplate(i));return setTimeout(function(){g.each(u.where({role:e.id}),function(e){n.find("input").prop("checked",e.get("admin"))})},200),n.find("input").on("change",function(t){return g.each(u.where({role:e.id}),function(e){e.set("admin",h(t.target).is(":checked"))}),!1}),n}return e.text},multiple:!0,tags:!0,allowClear:!c.disabled,placeholder:c.disabled?"":m("Select members"),width:"style"}).on("change",function(e){h(e.target).find(":selected").each(function(){})}),this},onChange:function(){var e=this.model,t=this.field.get("name").split(".").shift(),n=this.getValueFromDOM(),i=e.get(t),o=[];this.stopListening(this.model,"change:"+t,this.render),i.each(function(e){var t=e.get("role"),i=g.indexOf(n,t);-1<i?n.splice(i,1):o.push(t)}),g.each(n,function(e){i.add({role:e})}),g.each(o,function(e){i.remove(i.where({role:e}))}),this.listenTo(this.model,"change:"+t,this.render)}});return i.Nodes.role||(t.Browser.Nodes.role=t.Browser.Node.extend({parent_type:"server",type:"role",sqlAlterHelp:"sql-alterrole.html",sqlCreateHelp:"sql-createrole.html",dialogHelp:e("help.static",{filename:"role_dialog.html"}),label:m("Login/Group Role"),hasSQL:!0,width:"550px",canDrop:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return e.is_superuser?i.connected&&i.user.is_superuser:i.connected&&i.user.can_create_role},hasDepends:!0,node_label:function(e){return e.label},node_image:function(e){return null==e||null==e?"icon-role":e.can_login?"icon-role":"icon-group"},title:function(e){return e?e.can_login?m("Login Role")+" - "+e.label:m("Group Role")+" - "+e.label:this.label},Init:function(){this.initialized||(this.initialized=!0,i.add_menus([{name:"create_role_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role_on_roles",node:"coll-role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role",node:"role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"}]))},can_create_role:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.can_create_role},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:null,rolname:void 0,rolcanlogin:!1,rolpassword:null,rolconnlimit:-1,rolsuper:!1,rolcreaterole:!1,rolcreatedb:!1,rolinherit:!0,rolcatupdate:!1,rolreplication:!1,rolmembership:[],rolvaliduntil:null,seclabels:[],variables:[]},schema:[{id:"rolname",label:m("Name"),type:"text",disabled:"readonly"},{id:"oid",label:m("OID"),cell:"string",mode:["properties"],editable:!1,type:"text",visible:!0,disabled:!0},{id:"rolpassword",label:m("Password"),type:"password",group:m("Definition"),mode:["edit","create"],control:"input",deps:["rolcanlogin"],retype:!0,cell:"string",disabled:function(e){if(e.isNew())return!1;var t=this.node_info.server.user;return!(t.is_superuser||t.can_create_role)&&t.id!=e.get("oid")}},{id:"rolvaliduntil",disabled:"readonly",type:"text",group:m("Definition"),label:m("Account expires"),mode:["properties","edit","create"],control:"datetimepicker",deps:["rolcanlogin"],options:{format:"YYYY-MM-DD HH:mm:ss Z"}},{id:"rolconnlimit",type:"int",group:m("Definition"),label:m("Connection limit"),cell:"integer",min:-1,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcanlogin",label:m("Can login?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:m("Privileges"),disabled:"readonly"},{id:"rolsuper",label:m("Superuser?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:m("Privileges"),control:f.SwitchControl.extend({onChange:function(){f.SwitchControl.prototype.onChange.apply(this,arguments),this.model.set("rolcatupdate",this.model.get("rolsuper")),this.model.set("rolcreaterole",this.model.get("rolsuper")),this.model.set("rolcreatedb",this.model.get("rolsuper"))}}),disabled:"readonly"},{id:"rolcreaterole",label:m("Create roles?"),group:m("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"description",label:m("Comments"),type:"multiline",group:null,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcreatedb",label:m("Create databases?"),group:m("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolcatupdate",label:m("Update catalog?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",max_version:90400,group:m("Privileges"),disabled:function(e){return e.get("read_only")||!e.get("rolsuper")}},{id:"rolinherit",group:m("Privileges"),label:m("Inherit rights from the parent roles?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolreplication",group:m("Privileges"),label:m("Can initiate streaming replication and backups?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",min_version:90100,disabled:"readonly"},{id:"rolmembership",label:m("Roles"),group:m("Membership"),type:"collection",cell:"string",disabled:"readonly",mode:["properties","edit","create"],control:l,model:i.Node.Model.extend({keys:["role"],idAttribute:"role",defaults:{role:void 0,admin:!1},validate:function(){return null}}),filter:function(e){return this.model.isNew()||this.model.get("rolname")!=e.label},helpMessage:function(e){return e.has("read_only")&&0==e.get("read_only")?m("Select the checkbox for roles to include WITH ADMIN OPTION."):m("Roles shown with a check mark have the WITH ADMIN OPTION set.")}},{id:"variables",label:"",type:"collection",group:m("Parameters"),hasDatabase:!0,url:"variables",model:i.Node.VariableModel.extend({keys:["name","database"]}),control:"variable-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,disabled:"readonly"},{id:"seclabels",label:m("Security labels"),model:o,editable:!1,type:"collection",group:m("Security"),mode:["edit","create"],min_version:90200,disabled:"readonly",canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],readonly:function(e){if(!e.has("read_only")){var t=this.node_info.server.user;e.set("read_only",!(t.is_superuser||t.can_create_role))}return e.get("read_only")},validate:function(){var e,t={},i=this.get("seclabels");if(!g.isUndefined(this.get("rolname"))&&""!=String(this.get("rolname")).replace(/^\s+|\s+$/g,"")||(t.name=m("Name cannot be empty."),e=e||t.name),i)for(var n,o=0;o<i.models.length&&!n;o++)(n=i.models[o].validate.apply(i.models[o]))&&(t.seclabels=n,e=e||n);return this.errorModel.clear().set(t),g.size(t)?(this.trigger("on-status",{msg:e}),e):null}})})),i.Nodes.role}.apply(t,n))||(e.exports=o)},275:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(14),i(13),i(20)],void 0===(o=function(n,e,a,o,t,i,r,l){return i.Nodes["coll-cast"]||(t.Browser.Nodes["coll-cast"]=t.Browser.Collection.extend({node:"cast",label:n("Casts"),type:"coll-cast",columns:["name","description"]})),i.Nodes.cast||(t.Browser.Nodes.cast=t.Browser.Node.extend({parent_type:"database",type:"cast",sqlAlterHelp:"sql-altercast.html",sqlCreateHelp:"sql-createcast.html",dialogHelp:e("help.static",{filename:"cast_dialog.html"}),canDrop:!0,canDropCascade:!0,label:n("Cast"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,i.add_menus([{name:"create_cast_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"},enable:i.Nodes.database.is_conn_allow},{name:"create_cast_on_coll",node:"coll-cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}},{name:"create_cast",node:"cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}}]))},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,encoding:"UTF8",srctyp:void 0,trgtyp:void 0,proname:void 0,castcontext:void 0,syscast:void 0,description:void 0},schema:[{id:"name",label:n("Name"),cell:"string",editable:!1,type:"text",disabled:!0,cellHeaderClasses:"width_percent_50"},{id:"oid",label:n("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"srctyp",label:n("Source type"),url:"get_type",type:"text",group:n("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return o.each(e,function(e){e.image="icon-cast"}),e},control:l.NodeAjaxOptionsControl.extend({onChange:function(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");null!=e&&""!=e&&null!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"srctyp",label:n("Source type"),type:"text",group:n("Definition"),disabled:!0,mode:["properties","edit"]},{id:"trgtyp",label:n("Target type"),url:"get_type",type:"text",group:n("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return o.each(e,function(e){e.image="icon-cast"}),e},control:l.NodeAjaxOptionsControl.extend({onChange:function(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");null!=e&&""!=e&&null!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"trgtyp",label:n("Target type"),type:"text",group:n("Definition"),disabled:!0,mode:["properties","edit"]},{id:"proname",label:n("Function"),deps:["srctyp","trgtyp"],type:"text",disabled:function(e){return!e.isNew()},group:n("Definition"),mode:["create"],control:"node-ajax-options",options:function(e){var t=e.model.get("srctyp"),i=e.model.get("trgtyp"),n=[];if(null!=t&&""!=t&&null!=i&&""!=i){var o=e.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_functions",e.field.get("node_data"),!1,e.field.get("node_info")]);a.ajax({type:"POST",timeout:3e4,url:l,cache:!1,async:!1,data:{srctyp:t,trgtyp:i}}).done(function(e){return n=e.data}).fail(function(e,t,i){r.pgRespErrorNotify(e,i)})}return n}},{id:"proname",label:n("Function"),type:"text",group:n("Definition"),disabled:!0,mode:["properties","edit"]},{id:"castcontext",label:n("Context"),options:{onText:"IMPLICIT",offText:"EXPLICIT",width:"90"},editable:!1,type:"string",group:n("Definition"),mode:["create"],control:l.SwitchControl.extend({getValueFromDOM:function(){return this.$input.prop("checked")?"IMPLICIT":"EXPLICIT"}})},{id:"castcontext",label:n("Context"),disabled:!0,options:[{label:"IMPLICIT",value:"IMPLICIT"},{label:"EXPLICIT",value:"EXPLICIT"},{label:"ASSIGNMENT",value:"ASSIGNMENT"}],editable:!1,type:"select2",group:n("Definition"),mode:["properties","edit"]},{id:"syscast",label:n("System cast?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0},{id:"description",label:n("Comment"),type:"multiline",cellHeaderClasses:"width_percent_50"}],validate:function(){var e,t=this.get("srctyp"),i=this.get("trgtyp");return o.isUndefined(t)||o.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=n("Source type must be selected."),this.errorModel.set("srctyp",e),e):(this.errorModel.unset("srctyp"),o.isUndefined(i)||o.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=n("Target type must be selected."),this.errorModel.set("trgtyp",e),e):(this.errorModel.unset("trgtyp"),this.trigger("on-status-clear"),null))}})})),i.Nodes["coll-cast"]}.apply(t,n))||(e.exports=o)},276:function(e,t,i){"use strict";var n,o;i(30),i(11),i(4),i(8),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(14),i(13),i(20),i(106),i(54)],void 0===(o=function(p,r,u,m,s,e,h,d,g){return h.Nodes["coll-tablespace"]||(h.Nodes["coll-tablespace"]=h.Collection.extend({node:"tablespace",label:p("Tablespaces"),type:"coll-tablespace",columns:["name","spcuser","description"],hasStatistics:!0,statsPrettifyFields:[p("Size")],canDrop:!0,canDropCascade:!1})),h.Nodes.tablespace||(h.Nodes.tablespace=h.Node.extend({parent_type:"server",type:"tablespace",sqlAlterHelp:"sql-altertablespace.html",sqlCreateHelp:"sql-createtablespace.html",dialogHelp:r("help.static",{filename:"tablespace_dialog.html"}),label:p("Tablespace"),hasSQL:!0,canDrop:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[p("Size")],Init:function(){this.initialized||(this.initialized=!0,h.add_menus([{name:"create_tablespace_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace_on_coll",node:"coll-tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"move_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"move_objects",category:"move_tablespace",priority:5,label:p("Move objects to..."),icon:"fa fa-exchange",data:{action:"create"},enable:"can_move_objects"}]))},can_create_tablespace:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.is_superuser},can_move_objects:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.is_superuser&&90400<=i.version},callbacks:{move_objects:function(e){var t=e||{},i=h.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0,l=this.generate_url(n,"move_objects",o,!0),a=this.generate_url(n,"move_objects_sql",o,!0);if(!o)return!1;var c=s.Model.extend({idAttribute:"id",defaults:{new_tblspc:void 0,obj_type:"all",user:void 0},schema:[{id:"tblspc",label:p("New tablespace"),type:"text",disabled:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return e&&e.label!=o.label}},{id:"obj_type",label:p("Object type"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:p("All"),value:"all"},{label:p("Tables"),value:"tables"},{label:p("Indexes"),value:"indexes"},{label:p("Materialized views"),value:"materialized_views"}]},{id:"user",label:p("Object owner"),type:"text",disabled:!1,control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"sqltab",label:p("SQL"),group:p("SQL"),type:"text",disabled:!1,control:g.SqlTabControl.extend({initialize:function(){g.SqlTabControl.prototype.initialize.apply(this,arguments)},onTabChange:function(e){if(this.dialog&&e.shown==this.tabIndex){var t=this,i=t.model.toJSON();i.old_tblspc=o.label,u.ajax({url:a,type:"GET",cache:!1,data:i,dataType:"json",contentType:"application/json"}).done(function(e){t.sqlCtrl.clearHistory(),t.sqlCtrl.setValue(e.data),t.sqlCtrl.refresh()}).fail(function(){t.model.trigger("pgadmin-view:msql:error")}).always(function(){t.model.trigger("pgadmin-view:msql:fetched")})}}})}],validate:function(){return null}});d.move_objects_dlg||d.dialog("move_objects_dlg",function(){return{main:function(){var e=p("Move objects to another tablespace");this.set("title",e)},build:function(){d.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:p("Users"),url:r("help.static",{filename:"move_objects.html"})}},{text:p("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:p("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var e=this,t=u("<div class='move_objects'></div>");this.__internal.buttons[2].element.disabled=!0;var i=h.tree,n=i.selected(),o=n&&1==n.length?i.itemData(n):void 0,l=o&&h.Nodes[o._type];if(o){var a=l.getTreeNodeHierarchy.apply(l,[n]),r=new c({},{node_info:a}),s=g.generateViewSchema(a,r,"create",l,a.server,!0),d=this.view=new g.Dialog({el:t,model:r,schema:s});u(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),d.render(),this.elements.content.appendChild(t.get(0)),this.view.model.on("change",function(){m.isUndefined(this.get("tblspc"))||""===this.get("tblspc")?(e.__internal.buttons[2].element.disabled=!0,this.errorModel.set("tblspc",p("Please select tablespace"))):(this.errorModel.clear(),e.__internal.buttons[2].element.disabled=!1)})}},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void h.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null);if(e.button.text===p("OK")){var t=this,i=this.view.model.toJSON();i.old_tblspc=o.label,e.cancel=!0,d.confirm(p("Move objects..."),p("Are you sure you wish to move the objects from %s to %s?",i.old_tblspc,i.tblspc),function(){u.ajax({url:l,method:"PUT",data:{data:JSON.stringify(i)}}).done(function(e){e.success?(d.success(e.info),t.close()):d.error(e.errormsg)}).fail(function(e,t,i){d.pgRespErrorNotify(e,i)})},function(){})}}}}),d.move_objects_dlg(!0).resizeTo(h.stdW.md,h.stdH.md)}},model:h.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,comment:void 0,spclocation:void 0,spcoptions:[],spcacl:[],seclabels:[]},initialize:function(e,t){if(0===m.size(e)){var i=h.serverInfo[t.node_info.server._id].user;this.set({spcuser:i.name},{silent:!0})}h.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:p("Name"),cell:"string",type:"text"},{id:"oid",label:p("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"spclocation",label:p("Location"),cell:"string",group:p("Definition"),type:"text",mode:["properties","edit","create"],disabled:function(e){return!e.isNew()}},{id:"spcuser",label:p("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"acl",label:p("Privileges"),type:"text",group:p("Security"),mode:["properties"],disabled:!0},{id:"description",label:p("Comment"),cell:"string",type:"multiline"},{id:"spcoptions",label:"",type:"collection",group:p("Parameters"),control:"variable-collection",model:h.Node.VariableModel,mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},{id:"spcacl",label:p("Privileges"),type:"collection",group:p("Security"),control:"unique-col-collection",model:h.Node.PrivilegeRoleModel.extend({privileges:["C"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],columns:["grantee","grantor","privileges"]},{id:"seclabels",label:p("Security labels"),model:h.SecLabelModel,editable:!1,type:"collection",group:p("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var e;return m.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=p("Name cannot be empty."),this.errorModel.set("name",e)):this.isNew()&&(m.isUndefined(this.get("spclocation"))||""==String(this.get("spclocation")).replace(/^\s+|\s+$/g,""))?(e=p("Location cannot be empty."),this.errorModel.set("spclocation",e),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("spclocation")),null}})})),h.Nodes["coll-tablespace"]}.apply(t,n))||(e.exports=o)},277:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(1),i(9),i(20)],void 0===(o=function(o,e,l,t){return t.Nodes["coll-resource_group"]||(t.Nodes["coll-resource_group"]=t.Collection.extend({node:"resource_group",label:o("Resource Groups"),type:"coll-resource_group",columns:["name","cpu_rate_limit","dirty_rate_limit"],canDrop:!0,canDropCascade:!1})),t.Nodes.resource_group||(t.Nodes.resource_group=t.Node.extend({parent_type:"server",type:"resource_group",dialogHelp:e("help.static",{filename:"resource_group_dialog.html"}),label:o("Resource Group"),hasSQL:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,t.add_menus([{name:"create_resourcegroup_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"},enable:function(e,t){return this.getTreeNodeHierarchy(t).server.connected&&"ppas"===e.server_type&&90400<=e.version}},{name:"create_resource_group_on_coll",node:"coll-resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}},{name:"create_resource_group",node:"resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}}]))},model:t.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,cpu_rate_limit:0,dirty_rate_limit:0},schema:[{id:"oid",label:o("OID"),type:"text",editable:!1,disabled:!0,mode:["properties"]},{id:"name",label:o("Name"),cell:"string",type:"text"},{id:"cpu_rate_limit",label:o("CPU rate limit (percentage)"),cell:"string",type:"numeric",min:0,max:16777216},{id:"dirty_rate_limit",label:o("Dirty rate limit (KB)"),cell:"string",type:"numeric",min:0,max:16777216}],validate:function(){var e,t=this.get("name");if(l.isUndefined(t)||l.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,""))return e=o("Name cannot be empty."),this.errorModel.set("name",e),e;this.errorModel.unset("name");var i=this.get("cpu_rate_limit");if(l.isUndefined(i)||l.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))return e=o("CPU rate limit cannot be empty."),this.errorModel.set("cpu_rate_limit",e),e;this.errorModel.unset("cpu_rate_limit");var n=this.get("dirty_rate_limit");return l.isUndefined(n)||l.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=o("Dirty rate limit cannot be empty."),this.errorModel.set("dirty_rate_limit",e),e):(this.errorModel.unset("dirty_rate_limit"),null)}})})),t.Nodes["coll-resource_group"]}.apply(t,n))||(e.exports=o)},278:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20)],void 0===(o=function(t,e,i,n,o,l,a){return l.Nodes["coll-event_trigger"]||(o.Browser.Nodes["coll-event_trigger"]=o.Browser.Collection.extend({node:"event_trigger",label:t("Event Trigger"),type:"coll-event_trigger",columns:["name","eventowner","comment"],canDrop:!0,canDropCascade:!1})),l.Nodes.event_trigger||(o.Browser.Nodes.event_trigger=o.Browser.Node.extend({parent_type:"database",type:"event_trigger",sqlAlterHelp:"sql-altereventtrigger.html",sqlCreateHelp:"sql-createeventtrigger.html",dialogHelp:e("help.static",{filename:"event_trigger_dialog.html"}),label:t("Event Trigger"),hasSQL:!0,hasDepends:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_event_trigger_on_coll",node:"coll-event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,eventowner:void 0,comment:void 0,enabled:"O",eventfuncoid:void 0,eventfunname:void 0,eventname:"DDL_COMMAND_START",when:void 0,xmin:void 0,source:void 0,language:void 0},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({eventowner:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),cell:"string",type:"text"},{id:"oid",label:t("OID"),cell:"string",type:"text",mode:["properties"]},{id:"eventowner",label:t("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:a.NodeListByNameControl},{id:"comment",label:t("Comment"),type:"multiline"},{id:"enabled",label:t("Enabled?"),type:"radio",group:t("Definition"),mode:["properties","edit","create"],options:[{label:"Enable",value:"O"},{label:"Disable",value:"D"},{label:"Replica",value:"R"},{label:"Always",value:"A"}]},{id:"eventfunname",label:t("Trigger function"),type:"text",control:"node-ajax-options",group:t("Definition"),url:"fopts",cache_node:"trigger_function"},{id:"eventname",label:t("Events"),type:"radio",group:t("Definition"),cell:"string",options:[{label:"DDL COMMAND START",value:"DDL_COMMAND_START"},{label:"DDL COMMAND END",value:"DDL_COMMAND_END"},{label:"SQL DROP",value:"SQL_DROP"}]},{id:"when",label:t("When"),cell:"string",type:"text",group:t("Definition"),control:a.SqlFieldControl,extraClasses:["custom_height_css_class"]},{id:"seclabels",label:t("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",group:t("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var e=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=t("Event trigger name cannot be empty."),this.errorModel.set("name",e),e):n.isUndefined(this.get("eventowner"))||""==String(this.get("eventowner")).replace(/^\s+|\s+$/g,"")?(e=t("Event trigger owner cannot be empty."),this.errorModel.set("eventowner",e),e):n.isUndefined(this.get("enabled"))?(e=t("Event trigger enabled status cannot be empty."),this.errorModel.set("enabled",e),e):n.isUndefined(this.get("eventfunname"))||""==String(this.get("eventfunname")).replace(/^\s+|\s+$/g,"")?(e=t("Event trigger function cannot be empty."),this.errorModel.set("eventfunname",e),e):n.isUndefined(this.get("eventname"))?(e=t("Event trigger event cannot be empty."),this.errorModel.set("eventname",e),e):null}})})),l.Nodes["coll-event_trigger"]}.apply(t,n))||(e.exports=o)},279:function(e,t,i){"use strict";var n,o;i(10),i(11),i(4),i(8),i(87),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20)],void 0===(o=function(n,e,t,l,i,o,a){return o.Nodes["coll-extension"]||(i.Browser.Nodes["coll-extension"]=i.Browser.Collection.extend({node:"extension",label:n("Extension"),type:"coll-extension",columns:["name","owner","comment"]})),o.Nodes.extension||(i.Browser.Nodes.extension=i.Browser.Node.extend({parent_type:"database",type:"extension",sqlAlterHelp:"sql-alterextension.html",sqlCreateHelp:"sql-createextension.html",dialogHelp:e("help.static",{filename:"extension_dialog.html"}),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,label:n("Extension"),Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_extension_on_coll",node:"coll-extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"},enable:o.Nodes.database.is_conn_allow}]))},model:i.Browser.Node.Model.extend({idAttribute:"eid",schema:[{id:"name",label:n("Name"),first_empty:!0,type:"text",mode:["properties","create","edit"],visible:!0,url:"avails",disabled:function(e){return!e.isNew()},transform:function(e,t){var i=[],n=t||this,o=n.model.get("name");return n.model.isNew()?e&&l.isArray(e)&&l.each(e,function(e){null===e.installed_version&&i.push({label:e.name,value:JSON.stringify(e)})}):i.push({label:o,value:o}),i},control:a.NodeAjaxOptionsControl.extend({getValueFromDOM:function(){var e=this.formatter.toRaw(l.unescape(this.$el.find("select").val()),this.model);return""===e?null:("string"==typeof e&&(e=JSON.parse(e)),e.name)},onChange:function(){a.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.$el.find("select").val();if(""!=e.trim()){var t=this.formatter.toRaw(e,this.model);"string"==typeof t&&(t=JSON.parse(t)),this.model.set({version:"",relocatable:l.isNull(t.relocatable[0])||l.isUndefined(t.relocatable[0])?"":t.relocatable[0]})}else this.model.set({version:"",relocatable:!0,schema:""})}})},{id:"eid",label:n("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:n("Owner"),control:"node-list-by-name",mode:["properties"],node:"role",cell:"string",cache_level:"server"},{id:"schema",label:n("Schema"),type:"text",control:"node-list-by-name",group:n("Definition"),mode:["properties","create","edit"],deps:["relocatable"],node:"schema",first_empty:!0,disabled:function(e){return!!e.has("relocatable")&&!e.get("relocatable")}},{id:"relocatable",label:n("Relocatable?"),cell:"switch",group:n("Definition"),type:"switch",mode:["properties"]},{id:"version",label:n("Version"),cell:"string",mode:["properties","create","edit"],group:n("Definition"),control:"node-ajax-options",url:"avails",first_empty:!0,transform:function(e,t){var i=[],n=(t||this).model.get("name");return l.each(e,function(e){e.name==n&&e.version&&l.isArray(e.version)&&l.each(e.version,function(e){i.push({label:e,value:e})})}),i}},{id:"comment",label:n("Comment"),cell:"string",type:"multiline",disabled:!0}],validate:function(){var e,t={},i=this.get("name");return l.isUndefined(i)||l.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t.name=n("Name cannot be empty."),e=e||t.name,this.errorModel.set("name",e),e):(this.errorModel.unset("name"),null)}})})),o.Nodes["coll-extension"]}.apply(t,n))||(e.exports=o)},280:function(e,t,i){"use strict";var n,o;i(16),i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20),i(54)],void 0===(o=function(n,e,t,a,i,o,l){return o.Nodes["coll-language"]||(o.Nodes["coll-language"]=o.Collection.extend({node:"language",label:n("Languages"),type:"coll-language",columns:["name","lanowner","description"]})),o.Nodes.language||(o.Nodes.language=o.Node.extend({parent_type:"database",type:"language",sqlAlterHelp:"sql-alterlanguage.html",sqlCreateHelp:"sql-createlanguage.html",dialogHelp:e("help.static",{filename:"language_dialog.html"}),label:n("Language"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_language_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"},enable:o.Nodes.database.is_conn_allow},{name:"create_language_on_coll",node:"coll-language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}},{name:"create_language",node:"language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}}]))},model:o.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,lanowner:void 0,comment:void 0,lanacl:[],seclabels:[],trusted:!0,lanproc:void 0,laninl:void 0,lanval:void 0,is_template:!1,template_list:[]},initialize:function(e,t){if(0===a.size(e)){var i=o.serverInfo[t.node_info.server._id].user;this.set({lanowner:i.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:n("Name"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],url:"get_templates",select2:{allowClear:!1,tags:!0,multiple:!1},transform:function(e,t){var i=[],n=t||this,o=n.model.get("name");if(n.model.isNew()){var l=[];e&&a.isArray(e)&&a.each(e,function(e){i.push({label:e.tmplname,value:e.tmplname}),l.push(e.tmplname)}),this.model.set({template_list:l})}else i.push({label:o,value:o});return i}},{id:"oid",label:n("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"lanowner",label:n("Owner"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","properties","create"],select2:{allowClear:!1}},{id:"acl",label:n("Privileges"),type:"text",group:n("Security"),mode:["properties"],disabled:!0},{id:"description",label:n("Comment"),cell:"string",type:"multiline"},{id:"trusted",label:n("Trusted?"),type:"switch",group:n("Definition"),mode:["edit","properties","create"],deps:["name"],disabled:function(e){if(e.isNew()){if(-1==e.get("template_list").indexOf(e.get("name")))return e.set({is_template:!1}),!1;e.set({is_template:!0})}return!0}},{id:"lanproc",label:n("Handler function"),type:"text",control:"node-ajax-options",group:n("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&a.isArray(e)&&a.each(e,function(e){"handler"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"laninl",label:n("Inline function"),type:"text",control:"node-ajax-options",group:n("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&a.isArray(e)&&a.each(e,function(e){"inline"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanval",label:n("Validator function"),type:"text",control:"node-ajax-options",group:n("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],transform:function(e){var t=[];return e&&a.isArray(e)&&a.each(e,function(e){"validator"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanacl",label:n("Privileges"),type:"collection",group:n("Security"),control:"unique-col-collection",mode:["edit","create"],model:o.Node.PrivilegeRoleModel.extend({privileges:["U"]}),canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:n("Security labels"),mode:["edit","create"],model:o.SecLabelModel,editable:!1,type:"collection",group:n("Security"),min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var e,t=this.get("name");if(a.isUndefined(t)||a.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,""))return e=n("Name cannot be empty."),this.errorModel.set("name",e),e;if(this.errorModel.unset("name"),!this.get("is_template")){var i=this.get("lanproc");if(a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))return e=n("Handler function cannot be empty."),this.errorModel.set("lanproc",e),e;this.errorModel.unset("lanproc")}return null}})})),o.Nodes["coll-language"]}.apply(t,n))||(e.exports=o)},281:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20),i(54)],void 0===(o=function(i,e,t,n,o,l,a){var r=l.Node.Model.extend({idAttribute:"fdwoption",defaults:{fdwoption:void 0,fdwvalue:void 0},schema:[{id:"fdwoption",label:i("Option"),type:"text",cellHeaderClasses:"width_percent_50",editable:!0},{id:"fdwvalue",label:i("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("fdwoption"))||n.isNull(this.get("fdwoption"))||""==String(this.get("fdwoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fdwoption",e),e}return this.errorModel.unset("fdwoption"),null}});return l.Nodes["coll-foreign_data_wrapper"]||(l.Nodes["coll-foreign_data_wrapper"]=l.Collection.extend({node:"foreign_data_wrapper",label:i("Foreign Data Wrappers"),type:"coll-foreign_data_wrapper",columns:["name","fdwowner","description"]})),l.Nodes.foreign_data_wrapper||(l.Nodes.foreign_data_wrapper=l.Node.extend({parent_type:"database",type:"foreign_data_wrapper",sqlAlterHelp:"sql-alterforeigndatawrapper.html",sqlCreateHelp:"sql-createforeigndatawrapper.html",dialogHelp:e("help.static",{filename:"foreign_data_wrapper_dialog.html"}),label:i("Foreign Data Wrapper"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_foreign_data_wrapper_on_coll",node:"coll-foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:l.Node.Model.extend({idAttribute:"fdwoid",defaults:{name:void 0,fdwowner:void 0,comment:void 0,fdwvalue:void 0,fdwhan:void 0,fdwoption:void 0,fdwacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({fdwowner:i.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",disabled:function(){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fdwoid",label:i("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fdwowner",label:i("Owner"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fdwhan",label:i("Handler"),type:"text",control:"node-ajax-options",group:i("Definition"),mode:["edit","create","properties"],url:"get_handlers"},{id:"description",label:i("Comment"),cell:"string",type:"multiline"},{id:"fdwoptions",label:i("Options"),type:"collection",group:i("Options"),model:r,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fdwoption"],columns:["fdwoption","fdwvalue"]},{id:"fdwvalue",label:i("Validator"),type:"text",control:"node-ajax-options",group:i("Definition"),mode:["edit","create","properties"],url:"get_validators"},{id:"security",label:i("Security"),type:"group"},{id:"fdwacl",label:i("Privileges"),type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection"},{id:"acl",label:i("Privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:!0}],validate:function(){var e=this.get("name");if(n.isUndefined(e)||n.isNull(e)||""==String(e).replace(/^\s+|\s+$/g,"")){var t=i("Name cannot be empty.");return this.errorModel.set("name",t),t}return this.errorModel.unset("name"),null}})})),l.Nodes.foreign_data_wrapper}.apply(t,n))||(e.exports=o)},282:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(0),i(1),i(3),i(9),i(13),i(20),i(54)],void 0===(o=function(i,e,n,o,l,t){var a=o.Browser.Node.Model.extend({idAttribute:"fsrvoption",defaults:{fsrvoption:void 0,fsrvvalue:void 0},schema:[{id:"fsrvoption",label:i("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"fsrvvalue",label:i("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("fsrvoption"))||n.isNull(this.get("fsrvoption"))||""==String(this.get("fsrvoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fsrvoption",e),e}return this.errorModel.unset("fsrvoption"),null}});return l.Nodes["coll-foreign_server"]||(o.Browser.Nodes["coll-foreign_server"]=o.Browser.Collection.extend({node:"foreign_server",label:i("Foreign Servers"),type:"coll-foreign_server",columns:["name","fsrvowner","description"]})),l.Nodes.foreign_server||(o.Browser.Nodes.foreign_server=o.Browser.Node.extend({parent_type:"foreign_data_wrapper",type:"foreign_server",sqlAlterHelp:"sql-alterforeignserver.html",sqlCreateHelp:"sql-createforeignserver.html",label:i("Foreign Server"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_foreign_server_on_coll",node:"coll-foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({idAttribute:"fsrvid",defaults:{name:void 0,fsrvtype:void 0,fsrvversion:void 0,fsrvvalue:void 0,fsrvoptions:[],fsrvowner:void 0,description:void 0,fsrvacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({fsrvowner:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",disabled:function(){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fsrvid",label:i("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fsrvowner",label:i("Owner"),type:"text",control:t.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fsrvtype",label:i("Type"),cell:"string",group:i("Definition"),type:"text",mode:["edit","create","properties"],disabled:function(e){return!e.isNew()}},{id:"fsrvversion",label:i("Version"),cell:"string",group:i("Definition"),type:"text"},{id:"description",label:i("Comment"),cell:"string",type:"multiline"},{id:"fsrvoptions",label:i("Options"),type:"collection",group:i("Options"),model:a,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fsrvoption"],columns:["fsrvoption","fsrvvalue"]},l.SecurityGroupSchema,{id:"fsrvacl",label:i("Privileges"),type:"collection",group:"security",model:o.Browser.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"acl",label:i("Privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:!0}],validate:function(){var e=this.get("name");if(n.isUndefined(e)||n.isNull(e)||""==String(e).replace(/^\s+|\s+$/g,"")){var t=i("Name cannot be empty.");return this.errorModel.set("name",t),t}return this.errorModel.unset("name"),null}})})),l.Nodes["coll-foreign_server"]}.apply(t,n))||(e.exports=o)},283:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(20)],void 0===(o=function(i,e,t,n,o,l,a){var r=o.Browser.Node.Model.extend({idAttribute:"umoption",defaults:{umoption:void 0,umvalue:void 0},schema:[{id:"umoption",label:i("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"umvalue",label:i("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("umoption"))||n.isNull(this.get("umoption"))||""==String(this.get("umoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("umoption",e),e}return this.errorModel.unset("umoption"),null}});return l.Nodes["coll-user_mapping"]||(o.Browser.Nodes["coll-user_mapping"]=o.Browser.Collection.extend({node:"user_mapping",label:i("User Mappings"),type:"coll-user_mapping",columns:["name"]})),l.Nodes.user_mapping||(o.Browser.Nodes.user_mapping=o.Browser.Node.extend({parent_type:"foreign_server",type:"user_mapping",sqlAlterHelp:"sql-alterusermapping.html",sqlCreateHelp:"sql-createusermapping.html",dialogHelp:e("help.static",{filename:"user_mapping_dialog.html"}),label:i("User Mapping"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_user_mapping_on_coll",node:"coll-user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({idAttribute:"um_oid",defaults:{name:void 0,um_options:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({name:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("User"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1},disabled:function(e){return!e.isNew()},transform:function(){var e=this.field.get("schema_node"),t=a.NodeListByNameControl.prototype.defaults.transform.apply(this,arguments);return t.unshift({label:"CURRENT_USER",value:"CURRENT_USER",image:"icon-"+e.type},{label:"PUBLIC",value:"PUBLIC",image:"icon-"+e.type}),t}},{id:"um_oid",label:i("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"umoptions",label:i("Options"),type:"collection",group:i("Options"),model:r,control:"unique-col-collection",mode:["create","edit"],canAdd:!0,canDelete:!0,uniqueCol:["umoption"]}],validate:function(){var e=this.get("name");if(n.isUndefined(e)||n.isNull(e)||""==String(e).replace(/^\s+|\s+$/g,"")){var t=i("Name cannot be empty.");return this.errorModel.set("name",t),t}return this.errorModel.unset("name"),null}})})),l.Nodes["coll-user_mapping"]}.apply(t,n))||(e.exports=o)},284:function(e,t,i){"use strict";var n,o;i(10),i(23),i(30),i(11),i(4),i(8),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(28),i(20),i(54)],void 0===(o=function(t,e,s,d,i,n,c,l){return c.VacuumCollectionControl=c.Control.extend({grid_columns:void 0,initialize:function(){c.Control.prototype.initialize.apply(this,arguments);var e=this,t=this.model,i=e.field.get("url");if(i&&t.isNew()){var n,o=e.field.get("node"),l=e.field.get("node_data"),a=e.field.get("node_info"),r=o.generate_url.apply(o,[null,i,l,!1,a]);t.trigger("pgadmin-view:fetching",t,e.field),s.ajax({async:!1,url:r}).done(function(e){n=e}).fail(function(){t.trigger("pgadmin-view:fetch:error",t,e.field)}),t.trigger("pgadmin-view:fetched",t,e.field),n&&d.isArray(n)&&t.get(e.field.get("name")).reset(n,{silent:!0})}},render:function(){var e=this,t=e.field.attributes;e.grid&&(e.grid.remove(),delete e.grid,e.grid=void 0),e.$el.empty();var i=d.template(['<div class="subnode-header">','  <label class="control-label col-sm-4"><%-label%></label>',"</div>"].join("\n")),n=s('<div class="pgadmin-control-group backgrid form-group col-12 object subnode"></div>').append(i(t)),o=e.grid=new l.Grid({columns:e.grid_columns,collection:e.model.get(e.field.get("name")),className:"backgrid table table-bordered table-noouter-border table-hover"});return e.$el.addClass("mb-0"),e.$el.append(s(n).append(o.render().$el)),e}}),c.cellFunction=function(e){switch(e.get("column_type")){case"integer":return l.IntegerCell;case"number":return l.NumberCell;case"string":return l.StringCell;default:return l.Cell}},c.VacuumTableModel=n.Node.Model.extend({defaults:{name:void 0,setting:void 0,label:void 0,value:void 0,column_type:void 0},toJSON:function(){var e=n.Node.Model.prototype.toJSON.apply(this);return delete e.label,delete e.setting,delete e.column_type,e}}),c.VacuumSettingsSchema=[{id:"spacer_ctrl",group:t("Table"),mode:["edit","create"],type:"spacer"},{id:"autovacuum_custom",label:t("Custom auto-vacuum?"),group:t("Table"),mode:["edit","create"],type:"switch",disabled:function(e){return e.top&&e.top.get("is_partitioned")?(setTimeout(function(){e.set("autovacuum_custom",!1)},10),!0):!!e.top.inSchema.apply(this,[e])}},{id:"autovacuum_enabled",label:t("Enabled?"),group:t("Table"),mode:["edit","create"],type:"switch",deps:["autovacuum_custom"],disabled:function(e){return e.top.inSchema.apply(this,[e])||1!=e.get("autovacuum_custom")?(setTimeout(function(){e.set("autovacuum_enabled",!1)},10),!0):(!d.isUndefined(e.get("reloptions"))&&d.isNull(e.get("reloptions"))&&setTimeout(function(){e.set("autovacuum_enabled",!0)},10),!1)},control:c.SwitchControl.extend({onChange:function(){c.SwitchControl.prototype.onChange.apply(this,arguments);var e=this.model;e.get("autovacuum_enabled")||d.isUndefined(e.get("reloptions"))||!d.isNull(e.get("reloptions"))||setTimeout(function(){e.set("autovacuum_custom",!1)},10)}})},{id:"vacuum_table",label:"",model:c.VacuumTableModel,editable:!1,type:"collection",canEdit:!0,group:t("Table"),mode:["edit","create"],url:"get_table_vacuum",control:c.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:t("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:t("Value"),cellHeaderClasses:"width_percent_30",cellFunction:c.cellFunction,editable:function(e){return e.handler.get("autovacuum_enabled")},headerCell:l.Extension.CustomHeaderCell},{name:"setting",label:t("Default"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:c.cellFunction,editable:!1}]}),deps:["autovacuum_enabled"]},{id:"spacer_ctrl",group:t("TOAST table"),mode:["edit","create"],type:"spacer"},{id:"toast_autovacuum",label:t("Custom auto-vacuum?"),group:t("TOAST table"),mode:["edit","create"],type:"switch",disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&e.isNew())&&!!(e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum_enabled")&&!0!==e.top.get("hastoasttable"))}},{id:"toast_autovacuum_enabled",label:t("Enabled?"),group:t("TOAST table"),mode:["edit","create"],type:"switch",deps:["toast_autovacuum"],disabled:function(e){return e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum")?((e.isNew()||e.get("hastoasttable"))&&setTimeout(function(){e.set("toast_autovacuum_enabled",!1)},10),!0):(!d.isUndefined(e.get("toast_reloptions"))&&d.isNull(e.get("toast_reloptions"))&&setTimeout(function(){e.set("toast_autovacuum_enabled",!0)},10),!1)},control:c.SwitchControl.extend({onChange:function(){c.SwitchControl.prototype.onChange.apply(this,arguments);var e=this.model;e.get("toast_autovacuum_enabled")||d.isUndefined(e.get("toast_reloptions"))||!d.isNull(e.get("toast_reloptions"))||setTimeout(function(){e.set("toast_autovacuum",!1)},10)}})},{id:"vacuum_toast",label:"",model:c.VacuumTableModel,type:"collection",editable:function(e){return e.isNew()},canEdit:!0,group:t("TOAST table"),mode:["properties","edit","create"],url:"get_toast_table_vacuum",control:c.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:t("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:t("Value"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:c.cellFunction,editable:function(e){return e.handler.get("toast_autovacuum_enabled")}},{name:"setting",label:t("Default"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:c.cellFunction,editable:!1}]}),deps:["toast_autovacuum_enabled"]}],n.Nodes["coll-schema"]||(n.Nodes["coll-schema"]=n.Collection.extend({node:"schema",label:t("Schemas"),type:"coll-schema",columns:["name","namespaceowner","description"]})),n.Nodes.schema||(n.Nodes.schema=n.Node.extend({parent_type:"database",type:"schema",sqlAlterHelp:"sql-alterschema.html",sqlCreateHelp:"sql-createschema.html",dialogHelp:e("help.static",{filename:"schema_dialog.html"}),label:t("Schema"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,n.add_menus([{name:"create_schema_on_coll",node:"coll-schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"},enable:"can_create_schema"}]))},can_create_schema:function(e){return n.Nodes.database.is_conn_allow.call(this,e)},model:n.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,namespaceowner:void 0,description:void 0,is_system_obj:void 0},initialize:function(e,t){if(0===d.size(e)){var i=n.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:i.name},{silent:!0})}n.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),cell:"string",type:"text"},{id:"oid",label:t("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"namespaceowner",label:t("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"is_sys_object",label:t("System schema?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0},{id:"description",label:t("Comment"),cell:"string",type:"multiline"},{id:"acl",label:t("Privileges"),type:"text",group:t("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:t("Default TABLE privileges"),type:"text",group:t("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:t("Default SEQUENCE privileges"),type:"text",group:t("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:t("Default FUNCTION privileges"),group:t("Security"),type:"text",mode:["properties"],disabled:!0},{id:"typeacl",label:t("Default TYPE privileges"),type:"text",group:t("Security"),mode:["properties"],disabled:!0,min_version:90200,visible:function(){return this.version_compatible}},{id:"nspacl",label:t("Privileges"),model:n.Node.PrivilegeRoleModel.extend({privileges:["C","U"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:t("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:t("Security labels"),model:n.SecLabelModel,editable:!1,type:"collection",group:t("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"},{type:"nested",control:"tab",group:t("Default privileges"),mode:["create","edit"],schema:[{id:"deftblacl",model:n.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:!1,type:"collection",group:t("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:n.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:!1,type:"collection",group:t("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:n.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:!1,type:"collection",group:t("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:n.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:!1,type:"collection",group:t("Types"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200}]}],validate:function(){var e=null;return this.errorModel.clear(),d.isUndefined(this.get("name"))||d.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=t("Name cannot be empty."),this.errorModel.set("name",e),e):d.isUndefined(this.get("namespaceowner"))||d.isNull(this.get("namespaceowner"))||""==String(this.get("namespaceowner")).replace(/^\s+|\s+$/g,"")?(e=t("Owner cannot be empty."),this.errorModel.set("namespaceowner",e),e):null}})}),n.tableChildTreeNodeHierarchy=function(e){return this.getTreeNodeHierarchy(e)}),l.Extension.TableChildSwitchCell=l.Extension.SwitchCell.extend({initialize:function(){l.Extension.SwitchCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),n=this.$el.find("input[type=checkbox]").first(),o=t.get("name");return(d.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),n.bootstrapToggle("disabled",!1)):(this.$el.removeClass("editable"),n.bootstrapToggle("disabled",!0),setTimeout(function(){e.set(o,!1)},10)),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),n.Nodes.schema}.apply(t,n))||(e.exports=o)},285:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(0),i(1),i(3),i(9),i(20)],void 0===(o=function(e,t,n,i,o){return o.Nodes["coll-catalog"]||(o.Nodes["coll-catalog"]=o.Collection.extend({node:"catalog",label:e("Catalogs"),type:"coll-catalog",columns:["name","namespaceowner","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog||(o.Nodes.catalog=o.Node.extend({parent_type:"database",type:"catalog",label:e("Catalog"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0,securitylabel:[]},initialize:function(e,t){if(0===n.size(e)){var i=o.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:i.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"seclabels",label:e("Security labels"),model:o.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){return null}})})),o.Nodes.catalog}.apply(t,n))||(e.exports=o)},286:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(9),i(20)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-catalog_object"]||(n.Browser.Nodes["coll-catalog_object"]=n.Browser.Collection.extend({node:"catalog_object",label:e("Catalog Objects"),type:"coll-catalog_object",columns:["name","owner","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog_object||(n.Browser.Nodes.catalog_object=n.Browser.Node.extend({parent_type:"catalog",type:"catalog_object",label:e("Catalog Object"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:n.Browser.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0},{id:"owner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),o.Nodes.catalog_object}.apply(t,n))||(e.exports=o)},287:function(e,t,i){"use strict";var n,o;i(30),i(11),i(4),i(62),i(8),i(31),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(51),i(38),i(20)],void 0===(o=function(r,e,t,s,o,l,i,n){return l.Nodes["coll-collation"]||(o.Browser.Nodes["coll-collation"]=o.Browser.Collection.extend({node:"collation",label:r("Collations"),type:"coll-collation",columns:["name","owner","description"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})),l.Nodes.collation||(o.Browser.Nodes.collation=i.SchemaChildNode.extend({type:"collation",sqlAlterHelp:"sql-altercollation.html",sqlCreateHelp:"sql-createcollation.html",dialogHelp:e("help.static",{filename:"collation_dialog.html"}),label:r("Collation"),collection_type:"coll-collation",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_collation_on_coll",node:"coll-collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!1},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,lc_type:void 0,lc_collate:void 0,description:void 0},initialize:function(e,t){if(0===s.size(e)){var i=l.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({owner:i.name},{silent:!0}),this.set({schema:n._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:r("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:r("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",control:"node-list-by-name",node:"role"},{id:"schema",label:r("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},control:"node-list-by-name",cache_node:"database",cached_level:"database"},{id:"copy_collation",label:r("Copy collation"),cell:"string",control:"node-ajax-options",type:"text",mode:["create","edit"],group:r("Definition"),url:"get_collations",disabled:"inSchemaWithModelCheck",deps:["locale","lc_collate","lc_type"]},{id:"locale",label:r("Locale"),cell:"string",type:"text",mode:["create","edit"],group:r("Definition"),disabled:"inSchemaWithModelCheck",deps:["lc_collate","lc_type","copy_collation"]},{id:"lc_collate",label:r("LC_COLLATE"),cell:"string",type:"text",mode:["properties","create","edit"],group:r("Definition"),deps:["locale","copy_collation"],disabled:"inSchemaWithModelCheck"},{id:"lc_type",label:r("LC_TYPE"),cell:"string",type:"text",mode:["properties","create","edit"],group:r("Definition"),disabled:"inSchemaWithModelCheck",deps:["locale","copy_collation"]},{id:"description",label:r("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(){var e=void 0,t=this.changed,i=!1,n=!1,o=!1,l=!1,a=this.toJSON();return this.errorModel.clear(),(s.has(t,a.name)&&s.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(e=r("Name cannot be empty."),this.errorModel.set("name",e)),s.has(t,a.locale)&&(s.isUndefined(this.get("locale"))||""==String(this.get("locale")).replace(/^\s+|\s+$/g,""))&&(i=!0),s.has(t,a.lc_collate)&&(s.isUndefined(this.get("lc_collate"))||""==String(this.get("lc_collate")).replace(/^\s+|\s+$/g,""))&&(o=!0),s.has(t,a.lc_type)&&(s.isUndefined(this.get("lc_type"))||""==String(this.get("lc_type")).replace(/^\s+|\s+$/g,""))&&(n=!0),s.has(t,a.copy_collation)&&(s.isUndefined(this.get("copy_collation"))||""==String(this.get("copy_collation")).replace(/^\s+|\s+$/g,""))&&(l=!0),i&&(o||n)&&l&&(e=r("Definition incomplete. Please provide Locale OR Copy Collation OR LC_TYPE/LC_COLLATE.")),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||(e.isNew()&&"copy_collation"==this.name?!!e.get("locale")||!(!e.get("lc_collate")&&!e.get("lc_type")):!e.isNew()||"lc_collate"!=this.name&&"lc_type"!=this.name?e.isNew()&&"locale"==this.name?!(!e.get("lc_collate")&&!e.get("lc_type"))||!!e.get("copy_collation"):!e.isNew():!!e.get("locale")||!!e.get("copy_collation"))}})})),l.Nodes.collation}.apply(t,n))||(e.exports=o)},288:function(e,t,i){"use strict";var n,o;i(30),i(11),i(4),i(8),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(13),i(28),i(51),i(38),i(20)],void 0===(o=function(i,e,t,o,n,l,a,r,s,d,c){a.Nodes["coll-domain"]||(a.Nodes["coll-domain"]=a.Collection.extend({node:"domain",label:i("Domains"),type:"coll-domain",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var p=a.Node.Model.extend({idAttribute:"conoid",initialize:function(e){0===!o.size(e)&&(this.convalidated_default=this.get("convalidated")),a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,convalidated:!0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:i("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_40",editable:function(e){if(o.isUndefined(e.isNew))return!0;if(!e.isNew()&&this.get("node_info").server.version<90200)return!1;return!0}},{id:"consrc",label:i("Check"),type:"multiline",cell:s.Extension.TextareaCell,group:i("Definition"),cellHeaderClasses:"width_percent_60",editable:function(e){return!!o.isUndefined(e.isNew)||e.isNew()}},{id:"convalidated",label:i("Validate?"),type:"switch",cell:"boolean",group:i("Definition"),editable:function(e){return!(this.get("node_info").server.version<90200)&&(!!o.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default)))}}],toJSON:n.Model.prototype.toJSON,validate:function(){return null}});return a.Nodes.domain||(a.Nodes.domain=d.SchemaChildNode.extend({type:"domain",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-createdomain.html",dialogHelp:e("help.static",{filename:"domain_dialog.html"}),label:i("Domain"),collection_type:"coll-domain",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_domain_on_coll",node:"coll-domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===o.size(e)){var i=t.node_info.schema.label;this.set({basensp:i},{silent:!0});var n=a.serverInfo[t.node_info.server._id].user;this.set({owner:n.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,basetype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,typnotnull:void 0,sysdomain:void 0,collname:void 0,constraints:[],seclabels:[]},type_options:void 0,schema:[{id:"name",label:i("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:i("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",mode:["edit","create","properties"]},{id:"basensp",label:i("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"sysdomain",label:i("System domain?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:i("Comment"),cell:"string",type:"multiline"},{id:"basetype",label:i("Base type"),cell:"string",control:"node-ajax-options",type:"text",url:"get_types",mode:["properties","create","edit"],group:i("Definition"),first_empty:!0,cache_node:"type",disabled:function(e){return!e.isNew()},transform:function(e){return this.model.type_options=e}},{id:"typlen",label:i("Length"),cell:"string",type:"text",group:i("Definition"),deps:["basetype"],disabled:function(t){if(!t.isNew())return!0;var i=t.get("basetype");return t.type_options&&(o.each(t.type_options,function(e){i==e.value&&(e.length?(t.set("is_tlength",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0})):t.set("is_tlength",!1,{silent:!0}))}),t.get("is_tlength")||setTimeout(function(){t.get("typlen")&&t.set("typlen",null)},10)),!t.get("is_tlength")}},{id:"precision",label:i("Precision"),cell:"string",type:"text",group:i("Definition"),deps:["basetype"],disabled:function(t){if(!t.isNew())return!0;var i=t.get("basetype");return t.type_options&&(o.each(t.type_options,function(e){i==e.value&&(e.precision?(t.set("is_precision",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0})):t.set("is_precision",!1,{silent:!0}))}),t.get("is_precision")||setTimeout(function(){t.get("precision")&&t.set("precision",null)},10)),!t.get("is_precision")}},{id:"typdefault",label:i("Default"),cell:"string",type:"text",group:i("Definition"),placeholder:"Enter an expression or a value."},{id:"typnotnull",label:i("Not NULL?"),cell:"boolean",type:"switch",group:i("Definition")},{id:"collname",label:i("Collation"),cell:"string",control:"node-ajax-options",type:"text",url:"get_collations",group:i("Definition"),cache_level:"database",cache_node:"schema",disabled:function(e){return!e.isNew()}},{id:"constraints",label:i("Constraints"),cell:"string",type:"collection",group:i("Constraints"),mode:["edit","create"],model:p,canAdd:!0,canDelete:!0,canEdit:!1,columns:["conname","consrc","convalidated"]},a.SecurityGroupSchema,{id:"seclabels",label:i("Security labels"),model:a.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var e,t={};return!o.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(t.name=i("Name cannot be empty."),e=e||t.name),!o.isUndefined(this.get("basetype"))&&""!=String(this.get("basetype")).replace(/^\s+|\s+$/g,"")||(t.basetype=i("Base Type cannot be empty."),e=e||t.basetype),this.errorModel.clear().set(t),e}}),isDisabled:function(e){if(!e.isNew()&&this.node_info.server.version<90200)return!1;return!0}})),a.Nodes.domain}.apply(t,n))||(e.exports=o)},289:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(38),i(20)],void 0===(o=function(i,e,t,n,o,l,a){return l.Nodes["coll-domain_constraints"]||(o.Browser.Nodes["coll-domain_constraints"]=o.Browser.Collection.extend({node:"domain_constraints",label:i("Domain Constraints"),type:"coll-domain_constraints",columns:["name","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:!1})),l.Nodes.domain_constraints||(o.Browser.Nodes.domain_constraints=l.Node.extend({type:"domain_constraints",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-alterdomain.html",dialogHelp:e("help.static",{filename:"domain_constraint_dialog.html"}),label:i("Domain Constraints"),collection_type:"coll-domain_constraints",hasSQL:!0,hasDepends:!0,parent_type:["domain"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_domain_on_coll",node:"coll-domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:i("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:i("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:i("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:a.isTreeItemOfChildOfSchema,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:i("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"description",label:i("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],min_version:90500},{id:"consrc",label:i("Check"),type:"multiline",cel:"string",group:i("Definition"),mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"connoinherit",label:i("No inherit?"),type:"switch",cell:"boolean",group:i("Definition"),mode:["properties","create","edit"],disabled:"isDisabled",visible:!1},{id:"convalidated",label:i("Validate?"),type:"switch",cell:"boolean",group:i("Definition"),min_version:90200,disabled:function(e){return!e.isNew()&&(this.node_info.server.version<90200||!!e.get("convalidated"))},mode:["properties","create","edit"]}],validate:function(){var e,t={};return!n.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(t.name=i("Name cannot be empty."),e=e||t.name),!n.isUndefined(this.get("consrc"))&&""!=String(this.get("consrc")).replace(/^\s+|\s+$/g,"")||(t.consrc=i("Check cannot be empty."),e=e||t.consrc),this.errorModel.clear().set(t),n.size(t)?(this.trigger("on-status",{msg:e}),e):null},isDisabled:function(e){if(!e.isNew()&&this.node_info.server.version<90200)return!0;return!1}})})),l.Nodes.domain}.apply(t,n))||(e.exports=o)},290:function(e,t,i){"use strict";var n,o;i(23),i(30),i(11),i(37),i(4),i(8),i(29),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(13),i(28),i(51),i(38),i(20)],void 0===(o=function(i,e,c,u,m,t,p,n,o,l,a){p.Nodes["coll-foreign_table"]||(p.Nodes["coll-foreign_table"]=p.Collection.extend({node:"foreign_table",label:i("Foreign Tables"),type:"coll-foreign_table",columns:["name","owner","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema}));var r=p.Node.Model.extend({idAttribute:"option",defaults:{option:void 0,value:void 0},schema:[{id:"option",label:i("Option"),type:"text",editable:!0,cellHeaderClasses:"width_percent_30"},{id:"value",label:i("Value"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){if(u.isUndefined(this.get("value"))||u.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var e="Please enter a value.";return this.errorModel.set("value",e),e}return this.errorModel.unset("value"),null}}),s=p.Node.Model.extend({idAttribute:"attnum",defaults:{attname:void 0,datatype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,attnotnull:void 0,collname:void 0,attnum:void 0,inheritedfrom:void 0,inheritedid:void 0,attstattarget:void 0,coloptions:[]},type_options:void 0,schema:[{id:"attname",label:i("Name"),cell:"string",type:"text",editable:"is_editable_column",cellHeaderClasses:"width_percent_40"},{id:"datatype",label:i("Data type"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_types",editable:"is_editable_column",cellHeaderClasses:"width_percent_0",group:i("Definition"),transform:function(e,t){return t.model.type_options=e}},{id:"typlen",label:i("Length"),cell:"string",group:i("Definition"),type:"int",deps:["datatype"],disabled:function(t){var e=t.get("typlen");if(!(u.isUndefined(t.get("inheritedid"))||u.isNull(t.get("inheritedid"))||u.isUndefined(t.get("inheritedfrom"))||u.isNull(t.get("inheritedfrom"))))return u.isUndefined(e)||setTimeout(function(){t.set("typlen",void 0)},10),!0;var i=t.get("datatype"),n=!1;return t.type_options?(t.set("is_tlength",!1,{silent:!0}),u.each(t.type_options,function(e){i==e.value&&e.length&&(n=!0,t.set("is_tlength",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0}))}),n||u.isUndefined(e)||setTimeout(function(){t.set("typlen",void 0)},10),!t.get("is_tlength")):(n||u.isUndefined(e)||setTimeout(function(){t.set("typlen",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"precision",label:i("Precision"),type:"int",deps:["datatype"],cell:"string",group:i("Definition"),disabled:function(t){var e=t.get("precision");if(!(u.isUndefined(t.get("inheritedid"))||u.isNull(t.get("inheritedid"))||u.isUndefined(t.get("inheritedfrom"))||u.isNull(t.get("inheritedfrom"))))return u.isUndefined(e)||setTimeout(function(){t.set("precision",void 0)},10),!0;var i=t.get("datatype"),n=!1;return t.type_options?(t.set("is_precision",!1,{silent:!0}),u.each(t.type_options,function(e){i==e.value&&e.precision&&(n=!0,t.set("is_precision",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0}))}),n||u.isUndefined(e)||setTimeout(function(){t.set("precision",void 0)},10),!t.get("is_precision")):(n||u.isUndefined(e)||setTimeout(function(){t.set("precision",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"typdefault",label:i("Default"),type:"text",cell:"string",min_version:90300,group:i("Definition"),placeholder:"Enter an expression or a value.",cellHeaderClasses:"width_percent_10",editable:function(e){return!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom")))&&!(this.get("node_info").server.version<90300)}},{id:"attnotnull",label:i("Not NULL?"),cell:"boolean",type:"switch",editable:"is_editable_column",cellHeaderClasses:"width_percent_10",group:i("Definition")},{id:"attstattarget",label:i("Statistics"),min_version:90200,cell:"integer",type:"int",group:i("Definition"),editable:function(e){return!u.isUndefined(e.isNew)&&!e.isNew()&&(!(this.get("node_info").server.version<90200)&&!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom"))))},cellHeaderClasses:"width_percent_10"},{id:"collname",label:i("Collation"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_collations",min_version:90300,editable:function(e){return!(!u.isUndefined(e.isNew)&&!e.isNew())&&!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom")))},cellHeaderClasses:"width_percent_20",group:i("Definition")},{id:"attnum",cell:"string",type:"text",visible:!1},{id:"inheritedfrom",label:i("Inherited From"),cell:"string",type:"text",visible:!1,mode:["properties","edit"],cellHeaderClasses:"width_percent_10"},{id:"coloptions",label:i("Options"),cell:"string",type:"collection",group:i("Options"),mode:["edit","create"],model:r,canAdd:!0,canDelete:!0,canEdit:!1,control:n.UniqueColCollectionControl,uniqueCol:["option"],min_version:90200}],validate:function(){var e=null;return u.isUndefined(this.get("attname"))||""==String(this.get("attname")).replace(/^\s+|\s+$/g,"")?(e=i("Column Name cannot be empty."),this.errorModel.set("attname",e)):this.errorModel.unset("attname"),u.isUndefined(this.get("datatype"))||""==String(this.get("datatype")).replace(/^\s+|\s+$/g,"")?(e=i("Column Datatype cannot be empty."),this.errorModel.set("datatype",e)):this.errorModel.unset("datatype"),e},is_editable_column:function(e){return!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom")))},toJSON:m.Model.prototype.toJSON}),d=n.NodeAjaxOptionsControl.extend({onChange:function(){var e=this.model,t=this.field.get("name").split("."),i=t.shift(),n=t.join("."),o=this.getValueFromDOM(),l={},a=e.get("columns"),r=e.get(i);if(this.model.errorModel instanceof m.Model)if(u.isEmpty(n))this.model.errorModel.unset(i);else{var s=this.model.errorModel.get(i);s&&(this.keyPathSetter(s,n,null),this.model.errorModel.set(i,s))}var d=this;if("string"==typeof r&&(r=JSON.parse(r)),u.size(o)<u.size(r)){var c=u.difference(r,o),p=a.where({inheritedid:parseInt(c[0])});a.remove(p)}else u.each(o,function(e){var t=a.where({inheritedid:parseInt(e)});if(t&&t.length<=0){var i=d.fetchColumns(e);a.add(i)}});l[i]=u.isEmpty(n)?o:u.clone(e.get(i))||{},this.stopListening(this.model,"change:"+i,this.render),e.set(l),this.listenTo(this.model,"change:"+i,this.render)},fetchColumns:function(e){var t=this,i="get_columns",n=t.model.top||t.model,o=this.field.get("schema_node"),l=this.field.get("node_info"),a=o.generate_url.apply(o,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,l]),r=this.field.get("cache_level")||o.type,s=this.field.get("cache_node");s=s&&p.Nodes.cache_node||o,n.trigger("pgadmin:view:fetching",n,t.field);var d={attrelid:e};return c.ajax({async:!1,url:a,data:d}).done(function(e){d=s.cache(i,l,r,e.data)}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)}),n.trigger("pgadmin:view:fetched",n,t.field),d=d&&d.data||[]}}),h=p.Node.Model.extend({idAttribute:"conoid",initialize:function(e){0===u.size(e)||(this.convalidated_default=this.get("convalidated")),p.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0,conislocal:void 0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:i("Name"),type:"text",cell:"string",editable:"is_editable",cellHeaderClasses:"width_percent_30"},{id:"consrc",label:i("Check"),type:"multiline",editable:"is_editable",cell:o.Extension.TextareaCell,cellHeaderClasses:"width_percent_30"},{id:"connoinherit",label:i("No inherit?"),type:"switch",cell:"boolean",editable:"is_editable",cellHeaderClasses:"width_percent_20"},{id:"convalidated",label:i("Validate?"),type:"switch",cell:"boolean",cellHeaderClasses:"width_percent_20",editable:function(e){return!!u.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default))}}],validate:function(){var e,t={};return!u.isUndefined(this.get("conname"))&&""!=String(this.get("conname")).replace(/^\s+|\s+$/g,"")||(t.conname=i("Constraint Name cannot be empty."),e=e||t.conname),!u.isUndefined(this.get("consrc"))&&""!=String(this.get("consrc")).replace(/^\s+|\s+$/g,"")||(t.consrc=i("Constraint Check cannot be empty."),e=e||t.consrc),this.errorModel.clear().set(t),e},is_editable:function(e){return!!u.isUndefined(e.isNew)||e.isNew()},toJSON:m.Model.prototype.toJSON}),g=p.Node.Model.extend({defaults:{option:void 0,value:void 0},schema:[{id:"option",label:i("Option"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"value",label:i("Value"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){},toJSON:m.Model.prototype.toJSON});return p.Nodes.foreign_table||(p.Nodes.foreign_table=l.SchemaChildNode.extend({type:"foreign_table",sqlAlterHelp:"sql-alterforeigntable.html",sqlCreateHelp:"sql-createforeigntable.html",dialogHelp:e("help.static",{filename:"foreign_table_dialog.html"}),label:i("Foreign Table"),collection_type:"coll-foreign_table",hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert","update","delete"],parent_type:["schema"],Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"create_foreign_table_on_coll",node:"coll-foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!1},enable:"canCreate"}]))},model:p.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===u.size(e)){var i=t.node_info.schema._label,n=p.serverInfo[t.node_info.server._id].user;this.set({basensp:i,owner:n.name},{silent:!0})}p.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,ftsrvname:void 0,strftoptions:void 0,inherits:[],columns:[],constraints:[],ftoptions:[],relacl:[],stracl:[],seclabels:[]},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:i("Owner"),cell:"string",control:n.NodeListByNameControl,node:"role",type:"text",select2:{allowClear:!1}},{id:"basensp",label:i("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"description",label:i("Comment"),cell:"string",type:"multiline"},{id:"ftsrvname",label:i("Foreign server"),cell:"string",control:"node-ajax-options",type:"text",group:i("Definition"),url:"get_foreign_servers",disabled:function(e){return!e.isNew()},cache_node:"database"},{id:"inherits",label:i("Inherits"),group:i("Definition"),type:"array",min_version:90500,control:d,url:"get_tables",select2:{multiple:!0},cache_level:"database",transform:function(e){if("edit"==this.field.get("mode")){var t=this.model.get("oid"),i=u.findWhere(e,{id:t});i&&(e=u.reject(e,i))}return e}},{id:"columns",label:i("Columns"),cell:"string",type:"collection",group:i("Columns"),mode:["edit","create"],model:s,canAdd:!0,canDelete:!0,canEdit:!0,columns:["attname","datatype","inheritedfrom"],canDeleteRow:function(e){return!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom")))},canEditRow:function(e){return!!(u.isUndefined(e.get("inheritedid"))||u.isNull(e.get("inheritedid"))||u.isUndefined(e.get("inheritedfrom"))||u.isNull(e.get("inheritedfrom")))}},{id:"constraints",label:i("Constraints"),cell:"string",type:"collection",group:i("Constraints"),mode:["edit","create"],model:h,canAdd:!0,canDelete:!0,columns:["conname","consrc","connoinherit","convalidated"],canEdit:function(e){return!(e instanceof m.Model&&e instanceof h)||e.isNew()},min_version:90500,canDeleteRow:function(e){return!(1!=e.get("conislocal")&&!u.isUndefined(e.get("conislocal")))}},{id:"strftoptions",label:i("Options"),cell:"string",type:"text",group:i("Definition"),mode:["properties"]},{id:"ftoptions",label:i("Options"),cell:"string",type:"collection",group:i("Options"),mode:["edit","create"],model:g,canAdd:!0,canDelete:!0,canEdit:!1,control:"unique-col-collection",uniqueCol:["option"]},{id:"relacl",label:i("Privileges"),cell:"string",type:"text",group:i("Security"),mode:["properties"],min_version:90200},p.SecurityGroupSchema,{id:"acl",label:i("Privileges"),model:t.Browser.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",min_version:90200},{id:"seclabels",label:i("Security labels"),model:p.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var e={},t=null;return!u.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(e.name=i("Name cannot be empty."),t=t||e.name),!u.isUndefined(this.get("basensp"))&&""!=String(this.get("basensp")).replace(/^\s+|\s+$/g,"")||(e.basensp=i("Schema cannot be empty."),t=t||e.basensp),!u.isUndefined(this.get("ftsrvname"))&&""!=String(this.get("ftsrvname")).replace(/^\s+|\s+$/g,"")||(e.ftsrvname=i("Foreign server cannot be empty."),t=t||e.ftsrvname),this.errorModel.clear().set(e),t}})})),p.Nodes.foreign_table}.apply(t,n))||(e.exports=o)},291:function(e,t,i){"use strict";var n,o;i(36),i(10),i(16),i(23),i(30),i(18),i(11),i(4),i(8),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(13),i(28),i(51),i(38),i(20)],void 0===(o=function(a,e,c,p,o,u,l,m,r,t,i){var n=u.Browser.Node.Model.extend({defaults:{token:void 0,dictname:void 0},keys:["token"],schema:[{id:"token",label:a("Token"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!1,cell:"string",url:"tokens"},{id:"dictname",label:a("Dictionaries"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0,cell:r.Extension.MultiSelectAjaxCell,url:"dictionaries"}],validate:function(){var e;this.errorModel.clear();var t=this.get("token"),i=this.get("dictname");return p.isNull(t)||p.isUndefined(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=a("Token cannot be empty."),this.errorModel.set("token",e),e):p.isNull(i)||p.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=a("Dictionary name cannot be empty."),this.errorModel.set("dictname",e),e):null}}),s=m.TokenControl=m.UniqueColCollectionControl.extend({initialize:function(){m.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this,t=[{id:"token",label:"",type:"text",url:"tokens",node:"fts_configuration",canAdd:!0,url_with_id:!0,control:m.NodeAjaxOptionsControl.extend({formatter:m.NodeAjaxOptionsControl.prototype.formatter,initialize:function(){m.NodeAjaxOptionsControl.prototype.initialize.apply(this,arguments);var e=this,t=e.field.get("url")||e.defaults.url,i=e.model.top||e.model;if(t){var n=this.field.get("schema_node"),o=this.field.get("node_info"),l=n.generate_url.apply(n,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,o]),a=this.field.get("cache_level")||n.type,r=this.field.get("cache_node"),s=(r=r&&u.Browser.Nodes[r]||n).cache(t,o,a);this.field.get("version_compatible")&&(p.isUndefined(s)||p.isNull(s))&&(i.trigger("pgadmin:view:fetching",i,e.field),c.ajax({async:!1,url:l}).done(function(e){s=r.cache(t,o,a,e.data)}).fail(function(){i.trigger("pgadmin:view:fetch:error",i,e.field)}),i.trigger("pgadmin:view:fetched",i,e.field)),s=s&&s.data||[];var d=this.field.get("transform")||e.defaults.transform;d&&p.isFunction(d)?e.field.set("options",d.bind(e,s)):e.field.set("options",s)}}}),select2:{allowClear:!0,width:"style",placeholder:a("Select token")},first_empty:!0,disabled:function(){return p.isUndefined(e.model.get("oid"))}}];e.headerData=new(o.Model.extend({defaults:{token:null},schema:t}))({});var i=m.generateViewSchema(e.field.get("node_info"),e.headerData,"create",e.field.get("schema_node"),e.field.get("node_data")),n=[];p.each(i,function(e){n=n.concat(e.fields)}),e.headerFields=new m.Fields(n),e.gridSchema=m.generateGridColumnsFromModel(e.field.get("node_info"),e.field.get("model"),"edit",["token","dictname"],e.field.get("schema_node")),e.controls=[],e.listenTo(e.headerData,"change",e.headerDataChanged),e.listenTo(e.headerData,"select2",e.headerDataChanged),e.listenTo(e.collection,"add",e.onAddorRemoveTokens),e.listenTo(e.collection,"remove",e.onAddorRemoveTokens)},generateHeader:function(e){var t=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-3">','    <label class="control-label"><%-token_label%></label>',"   </div>",'   <div class="col-6" header="token"></div>','   <div class="col-2">','     <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");p.extend(e,{token_label:a("Tokens")});var i=this,n=p.template(t),o=c(n(e)),l=this.controls;return i.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:i.headerData});o.find('div[header="'+e.get("name")+'"]').append(t.render().$el),t.$el.find(".control-label").remove(),l.push(t)}),"properties"==e.mode&&o.find("button.add").remove(),"create"==e.mode&&o.find("button.add").attr("disabled",!0),i.$header=o},events:p.extend({},m.UniqueColCollectionControl.prototype.events,{"click button.add":"addTokens"}),showGridControl:function(e){var t=this,i=p.template("<div class='subnode-header'></div>"),n=c("<div></div>",{class:"pgadmin-control-group backgrid form-group col-12 object subnode"}).append(i({label:e.label}));n.append(t.generateHeader(e));var o=p.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&o.unshift({name:"pg-backform-delete",label:"",cell:r.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var l=t.grid=new r.Grid({columns:o,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=l.render().$el,n.append(t.$grid),setTimeout(function(){t.headerData.set({token:t.$header.find('div[header="token"] select').val()},{silent:!0})},10),n},headerDataChanged:function(){var e=this.headerData.toJSON(),t=p.isEmpty(e)||p.isUndefined(e);this.$header&&this.$header.find("button.add").prop("disabled",t)},addTokens:function(e){e.preventDefault();var t=this,i=t.headerData.get("token");if(!i||""==i)return!1;var n=t.model.get(t.field.get("name")),o=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.model.top,collection:n,handler:n}),l=["token"],a=-1;t.collection.each(function(t){p.each(l,function(e){t.get(e)==i&&(a=n.indexOf(t))})}),-1==a&&(n.add(o),a=n.indexOf(o)),t.$grid.find(".new").removeClass("new");var r=t.grid.body.rows[a].$el;return r.addClass("new"),c(r).pgMakeVisible("backform-tab"),!1},onAddorRemoveTokens:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:tokens:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveTokens),p.each(this.controls,function(e){e.remove()}),s.__super__.remove.apply(this,arguments),delete this.headerData}});return l.Nodes["coll-fts_configuration"]||(u.Browser.Nodes["coll-fts_configuration"]=u.Browser.Collection.extend({node:"fts_configuration",label:a("FTS Configurations"),type:"coll-fts_configuration",columns:["name","description"],canDrop:i.isTreeItemOfChildOfSchema,canDropCascade:i.isTreeItemOfChildOfSchema})),l.Nodes.fts_configuration||(u.Browser.Nodes.fts_configuration=t.SchemaChildNode.extend({type:"fts_configuration",sqlAlterHelp:"sql-altertsconfig.html",sqlCreateHelp:"sql-createtsconfig.html",dialogHelp:e("help.static",{filename:"fts_configuration_dialog.html"}),label:a("FTS Configuration"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_configuration_on_schema",node:"schema",module:this,category:"create",priority:4,applies:["object","context"],callback:"show_obj_properties",label:a("FTS Configuration..."),icon:"wcTabIcon icon-fts_configuration",data:{action:"create"},enable:"canCreate"},{name:"create_fts_configuration_on_coll",module:this,priority:4,node:"coll-fts_configuration",applies:["object","context"],callback:"show_obj_properties",category:"create",label:a("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"},{name:"create_fts_configuration",node:"fts_configuration",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"}]))},model:u.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,prsname:void 0,copy_config:void 0,tokens:void 0},initialize:function(e,t){var i=0===p.size(e);if(u.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var n=l.serverInfo[t.node_info.server._id].user;this.set({owner:n.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:a("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:a("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:a("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:m.NodeListByNameControl,select2:{allowClear:!1}},{id:"schema",label:a("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:a("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsname",label:a("Parser"),type:"text",url:"parsers",first_empty:!0,group:a("Definition"),control:"node-ajax-options",deps:["copy_config"],disabled:function(e){var t=e.get("copy_config");return!e.isNew()||!p.isNull(t)&&!p.isUndefined(t)&&""!==t}},{id:"copy_config",label:a("Copy config"),type:"text",mode:["create"],group:a("Definition"),control:"node-ajax-options",url:"copyConfig",deps:["prsname"],disabled:function(e){var t=e.get("prsname");return!e.isNew()||!p.isNull(t)&&!p.isUndefined(t)&&""!==t}},{id:"tokens",label:a("Tokens"),type:"collection",group:a("Tokens"),control:s,model:n,columns:["token","dictionary"],uniqueCol:["token"],mode:["create","edit"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var e,t=this.get("name"),i=this.get("prsname"),n=""===i||p.isUndefined(i)||p.isNull(i)?this.get("copy_config"):this.get("prsname"),o=this.get("schema");return this.errorModel.clear(),this.trigger("on-status-clear"),p.isUndefined(t)||p.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=a("Name must be specified."),this.errorModel.set("name",e),e):p.isUndefined(n)||p.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=a("Select parser or configuration to copy."),this.errorModel.set("parser",e),e):p.isUndefined(o)||p.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(e=a("Schema must be selected."),this.errorModel.set("schema",e),e):null}})})),l.Nodes["coll-fts_configuration"]}.apply(t,n))||(e.exports=o)},292:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(51),i(38),i(20)],void 0===(o=function(o,e,t,l,a,r,i,n,s){var d=a.Browser.Node.Model.extend({defaults:{options:void 0,value:void 0},schema:[{id:"option",label:o("Option"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0},{id:"value",label:o("Value"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0}],validate:function(){var e;return this.errorModel.clear(),l.isUndefined(this.get("option"))||""==String(this.get("option")).replace(/^\s+|\s+$/g,"")?(e=o("Option cannot be empty."),this.errorModel.set("option",e)):!l.isUndefined(this.get("value"))&&""!=String(this.get("value")).replace(/^\s+|\s+$/g,"")||(e=o("Value cannot be empty."),this.errorModel.set("value",e)),e}});return r.Nodes["coll-fts_dictionary"]||(a.Browser.Nodes["coll-fts_dictionary"]=a.Browser.Collection.extend({node:"fts_dictionary",label:o("FTS Dictionaries"),type:"coll-fts_dictionary",columns:["name","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),r.Nodes.fts_dictionary||(a.Browser.Nodes.fts_dictionary=n.SchemaChildNode.extend({type:"fts_dictionary",sqlAlterHelp:"sql-altertsdictionary.html",sqlCreateHelp:"sql-createtsdictionary.html",dialogHelp:e("help.static",{filename:"fts_dictionary_dialog.html"}),label:o("FTS Dictionary"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_fts_dictionary_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"},{name:"create_fts_dictionary_on_coll",node:"coll-fts_dictionary",module:this,applies:["object","context"],priority:4,callback:"show_obj_properties",category:"create",label:o("FTS Dictionary..."),data:{action:"create"},icon:"wcTabIcon icon-fts_dictionary",enable:"canCreate"},{name:"create_fts_dictionary",node:"fts_dictionary",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,template:void 0,options:void 0},initialize:function(e,t){var i=0===l.size(e);if(a.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var n=r.serverInfo[t.node_info.server._id].user;this.set({owner:n.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:o("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:o("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:i.NodeListByNameControl},{id:"schema",label:o("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",cache_node:"database",control:"node-list-by-id"},{id:"description",label:o("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"template",label:o("Template"),type:"text",disabled:function(e){return!e.isNew()},url:"fetch_templates",group:o("Definition"),control:"node-ajax-options",cache_node:"fts_template"},{id:"options",label:o("Option"),type:"collection",group:o("Options"),control:"unique-col-collection",model:d,columns:["option","value"],uniqueCol:["option"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var e,t=this.get("name"),i=this.get("template"),n=this.get("schema");return l.isUndefined(t)||l.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=o("Name must be specified."),this.errorModel.set("name",e),e):l.isUndefined(i)||l.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=o("Template must be selected."),this.errorModel.set("template",e),e):l.isUndefined(n)||l.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=o("Schema must be selected."),this.errorModel.set("schema",e),e):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),r.Nodes.fts_dictionary}.apply(t,n))||(e.exports=o)},293:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(51),i(38),i(20)],void 0===(o=function(r,e,t,s,n,i,o,l){return i.Nodes["coll-fts_parser"]||(n.Browser.Nodes["coll-fts_parser"]=n.Browser.Collection.extend({node:"fts_parser",label:r("FTS Parsers"),type:"coll-fts_parser",columns:["name","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),i.Nodes.fts_parser||(n.Browser.Nodes.fts_parser=o.SchemaChildNode.extend({type:"fts_parser",sqlAlterHelp:"sql-altertsparser.html",sqlCreateHelp:"sql-createtsparser.html",dialogHelp:e("help.static",{filename:"fts_parser_dialog.html"}),label:r("FTS Parser"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,i.add_menus([{name:"create_fts_parser_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"},{name:"create_fts_parser_on_coll",node:"coll-fts_parser",applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},module:this,enable:"canCreate"},{name:"create_fts_parser",node:"fts_parser",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"}]))},model:n.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,prsstart:void 0,prstoken:void 0,prsend:void 0,prslextype:void 0,prsheadline:void 0},initialize:function(e,t){var i=0===s.size(e);n.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:r("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:r("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:r("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsstart",label:r("Start function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"start_functions",group:r("Definition"),cache_level:"database",cache_node:"schema"},{id:"prstoken",label:r("Get next token function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"token_functions",group:r("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsend",label:r("End function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"end_functions",group:r("Definition"),cache_level:"database",cache_node:"schema"},{id:"prslextype",label:r("Lextypes function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"lextype_functions",group:r("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsheadline",label:r("Headline function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"headline_functions",group:r("Definition"),cache_level:"database",cache_node:"schema"}],validate:function(){var e,t=this.get("name"),i=this.get("prsstart"),n=this.get("prstoken"),o=this.get("prsend"),l=this.get("prslextype"),a=this.get("schema");return s.isUndefined(t)||s.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=r("Name must be specified."),this.errorModel.set("name",e),e):s.isUndefined(i)||s.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=r("Start function must be selected."),this.errorModel.set("prsstart",e),e):s.isUndefined(n)||s.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=r("Get next token function must be selected."),this.errorModel.set("prstoken",e),e):s.isUndefined(o)||s.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(e=r("End function must be selected."),this.errorModel.set("prsend",e),e):s.isUndefined(l)||s.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(e=r("Lextype function must be selected."),this.errorModel.set("prslextype",e),e):s.isUndefined(a)||s.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(e=r("Schema must be selected."),this.errorModel.set("schema",e),e):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),i.Nodes["coll-fts_parser"]}.apply(t,n))||(e.exports=o)},294:function(e,t,i){"use strict";var n,o;i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(51),i(38),i(20)],void 0===(o=function(o,e,t,l,n,i,a,r){return i.Nodes["coll-fts_template"]||(n.Browser.Nodes["coll-fts_template"]=n.Browser.Collection.extend({node:"fts_template",label:o("FTS Templates"),type:"coll-fts_template",columns:["name","description"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})),i.Nodes.fts_template||(n.Browser.Nodes.fts_template=a.SchemaChildNode.extend({type:"fts_template",sqlAlterHelp:"sql-altertstemplate.html",sqlCreateHelp:"sql-createtstemplate.html",dialogHelp:e("help.static",{filename:"fts_template_dialog.html"}),label:o("FTS Template"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,i.add_menus([{name:"create_fts_template_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template_on_coll",node:"coll-fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template",node:"fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"}]))},model:n.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,tmplinit:void 0,tmpllexize:void 0},initialize:function(e,t){var i=0===l.size(e);n.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:o("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:o("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:o("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"tmplinit",label:o("Init function"),group:o("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_init",cache_level:"database",cache_node:"schema"},{id:"tmpllexize",label:o("Lexize function"),group:o("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_lexize",cache_level:"database",cache_node:"schema"}],validate:function(){var e,t=this.get("name"),i=this.get("tmpllexize"),n=this.get("schema");return l.isUndefined(t)||l.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=o("Name must be specified."),this.errorModel.set("name",e),e):l.isUndefined(i)||l.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=o("Lexize function must be selected."),this.errorModel.set("tmpllexize",e),e):l.isUndefined(n)||l.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=o("Schema must be selected."),this.errorModel.set("schema",e),e):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),i.Nodes.fts_template}.apply(t,n))||(e.exports=o)},295:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(47),i(211),i(51),i(38),i(20),i(54)],void 0===(o=function(l,e,t,a,i,n,o,r,s,d){return n.Nodes["coll-procedure"]||(i.Browser.Nodes["coll-procedure"]=i.Browser.Collection.extend({node:"procedure",label:l("Procedures"),type:"coll-procedure",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),n.Nodes.procedure||(i.Browser.Nodes.procedure=s.SchemaChildNode.extend({type:"procedure",sqlAlterHelp:"sql-alterprocedure.html",sqlCreateHelp:"sql-createprocedure.html",dialogHelp:e("help.static",{filename:"procedure_dialog.html"}),label:l("Procedure"),collection_type:"coll-procedure",hasSQL:!0,hasDepends:!0,hasStatistics:!0,hasScriptTypes:["create","exec"],width:n.stdW.md+"px",Init:function(){this.proc_initialized||(this.proc_initialized=!0,n.add_menus([{name:"create_procedure_on_coll",node:"coll-procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!1},enable:"canCreateProc"},{name:"create_procedure",node:"procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"},{name:"create_procedure",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"}]))},canCreateProc:function(e,t){var i=this.getTreeNodeHierarchy.apply(this,[t]);return!("catalog"in i)&&("server"in i&&("ppas"==i.server.server_type||"pg"==i.server.server_type&&11e4<=i.server.version))},model:r.model.extend({defaults:a.extend({},r.model.prototype.defaults,{lanname:"edbspl"}),canVarAdd:function(){return!(this.node_info.server.version<90500)},isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"provolatile":case"proisstrict":case"procost":case"proleakproof":return(this.node_info.server.version<90500||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout(function(){e.set("provolatile",void 0),e.set("proisstrict",void 0),e.set("procost",void 0),e.set("proleakproof",void 0)},10),!0);case"variables":case"prosecdef":return this.node_info.server.version<90500;case"prorows":return!(90500<=this.node_info.server.version&&1==e.get("proretset"));case"funcowner":case"proargs":return!0;case"proparallel":return(this.node_info.server.version<90600||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout(function(){e.set("proparallel",void 0)},10),!0);case"lanname":return this.node_info.server.version<11e4;default:return!1}},validate:function(){var e,t={},i=this.get("seclabels");if(!a.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(t.name=l("Name cannot be empty."),e=e||t.name),!a.isUndefined(this.get("pronamespace"))&&""!=String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")||(t.pronamespace=l("Schema cannot be empty."),e=e||t.pronamespace),!a.isUndefined(this.get("lanname"))&&""!=String(this.get("lanname")).replace(/^\s+|\s+$/g,"")||(t.lanname=l("Language cannot be empty."),e=e||t.lanname),"c"==String(this.get("lanname"))?(!a.isUndefined(this.get("probin"))&&""!=String(this.get("probin")).replace(/^\s+|\s+$/g,"")||(t.probin=l("Object File cannot be empty."),e=e||t.probin),!a.isUndefined(this.get("prosrc_c"))&&""!=String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")||(t.prosrc_c=l("Link Symbol cannot be empty."),e=e||t.prosrc_c)):!a.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")||(t.prosrc=l("Code cannot be empty."),e=e||t.prosrc),i)for(var n,o=0;o<i.models.length&&!n;o++)(n=i.models[o].validate.apply(i.models[o]))&&(t.seclabels=n,e=e||n);return this.errorModel.clear().set(t),null}})})),n.Nodes.procedure}.apply(t,n))||(e.exports=o)},296:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(212),i(20),i(54)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-edbproc"]||(o.Browser.Nodes["coll-edbproc"]=o.Browser.Collection.extend({node:"edbproc",label:e("Procedures"),type:"coll-edbproc",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:!1,canDropCascade:!1})),l.Nodes.edbproc||(o.Browser.Nodes.edbproc=l.Node.extend({type:"edbproc",dialogHelp:t("help.static",{filename:"edbproc_dialog.html"}),label:e("Procedure"),collection_type:"coll-edbproc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.proc_initialized||(this.proc_initialized=!0)},canDrop:!1,canDropCascade:!1,model:a.model.extend({defaults:n.extend({},a.model.prototype.defaults,{lanname:"edbspl"}),isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},validate:function(){return null}})})),l.Nodes.edbproc}.apply(t,n))||(e.exports=o)},297:function(e,t,i){"use strict";var n,o;n=[i(2),i(5),i(0),i(1),i(3),i(9),i(20),i(54)],void 0===(o=function(e,t,i,n,o,l){return l.Nodes["coll-edbvar"]||(l.Nodes["coll-edbvar"]=l.Collection.extend({node:"edbvar",label:e("Variables"),type:"coll-edbvar",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),l.Nodes.edbvar||(l.Nodes.edbvar=l.Node.extend({type:"edbvar",dialogHelp:t("help.static",{filename:"edbvar_dialog.html"}),label:e("Function"),collection_type:"coll-edbvar",canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,datatype:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"datatype",label:e("Data type"),cell:"string",type:"text",disabled:!0},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0}],validate:function(){return null}})})),l.Nodes.edbvar}.apply(t,n))||(e.exports=o)},298:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(51),i(38),i(20),i(54)],void 0===(o=function(a,e,t,r,i,o,n,l,s){return o.Nodes["coll-trigger_function"]||(o.Nodes["coll-trigger_function"]=o.Collection.extend({node:"trigger_function",label:a("Trigger functions"),type:"coll-trigger_function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),o.Nodes.trigger_function||(o.Nodes.trigger_function=l.SchemaChildNode.extend({type:"trigger_function",sqlAlterHelp:"plpgsql-trigger.html",sqlCreateHelp:"plpgsql-trigger.html",dialogHelp:e("help.static",{filename:"trigger_function_dialog.html"}),label:a("Trigger function"),collection_type:"coll-trigger_function",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_trigger_function_on_coll",node:"coll-trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:o.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===r.size(e)){var i=t.node_info.schema._id;this.set({pronamespace:i},{silent:!0});var n=o.serverInfo[t.node_info.server._id].user;this.set({funcowner:n.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:"trigger",lanname:"plpgsql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,args:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:a("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:a("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:a("Owner"),cell:"string",control:n.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:a("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:a("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:a("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:a("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:a("Argument count"),cell:"string",type:"text",group:a("Definition"),mode:["properties"]},{id:"proargs",label:a("Arguments"),cell:"string",type:"text",group:a("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:a("Signature arguments"),cell:"string",type:"text",group:a("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:a("Return type"),cell:"string",control:"select2",type:"text",group:a("Definition"),disabled:"isDisabled",first_empty:!0,select2:{width:"100%",allowClear:!1},mode:["create"],visible:"isVisible",options:[{label:a("trigger"),value:"trigger"},{label:a("event_trigger"),value:"event_trigger"}]},{id:"prorettypename",label:a("Return type"),cell:"string",type:"text",group:a("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:a("Language"),cell:"string",control:"node-ajax-options",type:"text",group:a("Definition"),url:"get_languages",disabled:"isDisabled",transform:function(e){return r.reject(e,function(e){return"sql"==e.label||"edbspl"==e.label})},select2:{allowClear:!1}},{id:"prosrc",label:a("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:a("Code"),deps:["lanname"],tabPanelCodeClass:"sql-code-control",control:n.SqlCodeControl,visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:a("Object file"),cell:"string",type:"text",group:a("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:a("Link symbol"),cell:"string",type:"text",group:a("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:a("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:a("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:a("Returns a set?"),type:"switch",group:a("Options"),disabled:"isDisabled",visible:"isVisible"},{id:"proisstrict",label:a("Strict?"),type:"switch",disabled:"isDisabled",group:a("Options")},{id:"prosecdef",label:a("Security of definer?"),group:a("Options"),cell:"boolean",type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:a("Window?"),group:a("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"procost",label:a("Estimated cost"),type:"text",group:a("Options"),disabled:"isDisabled"},{id:"prorows",label:a("Estimated rows"),type:"text",group:a("Options"),disabled:"isDisabled",deps:["proretset"],visible:"isVisible"},{id:"proleakproof",label:a("Leak proof?"),group:a("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled"},o.SecurityGroupSchema,{id:"proacl",label:a("Privileges"),mode:["properties"],group:a("Security"),type:"text"},{id:"variables",label:"",type:"collection",group:a("Parameters"),control:"variable-collection",model:o.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},{id:"acl",label:a("Privileges"),editable:!1,type:"collection",group:"security",mode:["edit","create"],model:o.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],disabled:"isDisabled",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:a("Security labels"),canEdit:!0,model:o.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",canAdd:!0,uniqueCol:["provider"],disabled:"isDisabled"}],validate:function(e){var t,i={},n=this.get("seclabels");if(e&&0==e.length)return this.errorModel.clear(),null;if(!r.isUndefined(this.get("name"))&&""!=String(this.get("name")).replace(/^\s+|\s+$/g,"")||(i.name=a("Name cannot be empty."),t=t||i.name),!r.isUndefined(this.get("funcowner"))&&""!=String(this.get("funcowner")).replace(/^\s+|\s+$/g,"")||(i.funcowner=a("Owner cannot be empty."),t=t||i.funcowner),!r.isUndefined(this.get("pronamespace"))&&""!=String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")||(i.pronamespace=a("Schema cannot be empty."),t=t||i.pronamespace),!r.isUndefined(this.get("prorettypename"))&&""!=String(this.get("prorettypename")).replace(/^\s+|\s+$/g,"")||(i.prorettypename=a("Return type cannot be empty."),t=t||i.prorettypename),!r.isUndefined(this.get("lanname"))&&""!=String(this.get("lanname")).replace(/^\s+|\s+$/g,"")||(i.lanname=a("Language cannot be empty."),t=t||i.lanname),"c"==String(this.get("lanname"))?(!r.isUndefined(this.get("probin"))&&""!=String(this.get("probin")).replace(/^\s+|\s+$/g,"")||(i.probin=a("Object File cannot be empty."),t=t||i.probin),!r.isUndefined(this.get("prosrc_c"))&&""!=String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")||(i.prosrc_c=a("Link Symbol cannot be empty."),t=t||i.prosrc_c)):!r.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")||(i.prosrc=a("Code cannot be empty."),t=t||i.prosrc),n)for(var o,l=0;l<n.models.length&&!o;l++)(o=n.models[l].validate.apply(n.models[l]))&&(i.seclabels=o,t=t||o);return this.errorModel.clear().set(i),r.size(i)?(this.trigger("on-status",{msg:t}),t):null},isVisible:function(){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),o.Nodes.trigger_function}.apply(t,n))||(e.exports=o)},299:function(e,t,i){"use strict";var n,o;i(11),i(4),i(62),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(51),i(38),i(20)],void 0===(o=function(t,e,i,o,l,a,n,r,s){return a.Nodes["coll-package"]||(a.Nodes["coll-package"]=a.Collection.extend({node:"package",label:t("Packages"),type:"coll-package",columns:["name","owner","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),a.Nodes.package||(a.Nodes.package=r.SchemaChildNode.extend({type:"package",dialogHelp:e("help.static",{filename:"package_dialog.html"}),label:t("Package"),collection_type:"coll-package",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_package_on_coll",node:"coll-package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||"pg"!==o.server_type)&&null==n.catalog},model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,is_sys_object:void 0,description:void 0,pkgheadsrc:void 0,pkgbodysrc:void 0,acl:void 0,pkgacl:[]},initialize:function(e,t){if(0===o.size(e)){var i=a.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({owner:i.name,schema:n._label},{silent:!0})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"oid",label:t("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:t("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,editable:!1,visible:function(e){return!e.isNew()}},{id:"schema",label:t("Schema"),type:"text",node:"schema",control:"node-list-by-name",disabled:function(e){return!e.isNew()},filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"is_sys_object",label:t("System package?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:t("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"pkgheadsrc",label:t("Header"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Header"),tabPanelCodeClass:"sql-code-control",control:n.SqlCodeControl},{id:"pkgbodysrc",label:t("Body"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Body"),tabPanelCodeClass:"sql-code-control",control:n.SqlCodeControl},{id:"acl",label:t("Privileges"),type:"text",group:t("Security"),mode:["properties"]},{id:"pkgacl",label:t("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],editable:!1,group:t("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"}],validate:function(){var e=void 0;return this.errorModel.clear(),o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=t("Name cannot be empty."),this.errorModel.set("name",e),e):o.isUndefined(this.get("pkgheadsrc"))||""==String(this.get("pkgheadsrc")).replace(/^\s+|\s+$/g,"")?(e=t("Header cannot be empty."),this.errorModel.set("pkgheadsrc",e),e):null}})})),a.Nodes.package}.apply(t,n))||(e.exports=o)},300:function(e,t,i){"use strict";var n,o;i(11),i(37),i(4),i(62),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(51),i(38),i(20)],void 0===(o=function(r,e,t,s,i,o,n,l,a){return o.Nodes["coll-sequence"]||(o.Nodes["coll-sequence"]=o.Collection.extend({node:"sequence",label:r("Sequences"),type:"coll-sequence",columns:["name","seqowner","comment"],hasStatistics:!0,canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema})),o.Nodes.sequence||(o.Nodes.sequence=l.SchemaChildNode.extend({type:"sequence",sqlAlterHelp:"sql-altersequence.html",sqlCreateHelp:"sql-createsequence.html",dialogHelp:e("help.static",{filename:"sequence_dialog.html"}),label:r("Sequence"),collection_type:"coll-sequence",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_sequence_on_coll",node:"coll-sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!1},enable:"canCreate"}]))},model:o.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,seqowner:void 0,schema:void 0,comment:void 0,increment:void 0,start:void 0,current_value:void 0,minimum:void 0,maximum:void 0,cache:void 0,cycled:void 0,relacl:[],securities:[]},initialize:function(e,t){if(0===s.size(e)){var i=o.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({seqowner:i.name},{silent:!0}),this.set({schema:n._label},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:r("OID"),cell:"string",type:"text",mode:["properties"]},{id:"seqowner",label:r("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],node:"role",control:n.NodeListByNameControl},{id:"schema",label:r("Schema"),cell:"string",control:"node-list-by-name",node:"schema",type:"text",mode:["create","edit"],filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"comment",label:r("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"current_value",label:r("Current value"),type:"int",mode:["properties","edit"],group:r("Definition")},{id:"increment",label:r("Increment"),type:"int",mode:["properties","create","edit"],group:r("Definition")},{id:"start",label:r("Start"),type:"int",mode:["properties","create"],group:r("Definition"),disabled:function(e){return!e.isNew()}},{id:"minimum",label:r("Minimum"),type:"int",mode:["properties","create","edit"],group:r("Definition")},{id:"maximum",label:r("Maximum"),type:"int",mode:["properties","create","edit"],group:r("Definition")},{id:"cache",label:r("Cache"),type:"int",mode:["properties","create","edit"],group:r("Definition"),min:1},{id:"cycled",label:r("Cycled"),type:"switch",mode:["properties","create","edit"],group:r("Definition")},o.SecurityGroupSchema,{id:"acl",label:r("Privileges"),type:"text",group:r("Security"),mode:["properties"],disabled:!0},{id:"relacl",label:r("Privileges"),group:"security",model:o.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),uniqueCol:["grantee","grantor"],mode:["edit","create"],editable:!1,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"securities",label:r("Security labels"),canAdd:!0,model:o.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",min_version:90200,uniqueCol:["provider"]}],validate:function(){var e=void 0,t=this.get("minimum"),i=this.get("maximum"),n=this.get("start");if(s.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return e=r("Name cannot be empty."),this.errorModel.set("name",e),e;if(this.errorModel.unset("name"),s.isUndefined(this.get("seqowner"))||""==String(this.get("seqowner")).replace(/^\s+|\s+$/g,""))return e=r("Owner cannot be empty."),this.errorModel.set("seqowner",e),e;if(this.errorModel.unset("seqowner"),s.isUndefined(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return e=r("Schema cannot be empty."),this.errorModel.set("schema",e),e;if(this.errorModel.unset("schema"),!this.isNew()){if(s.isUndefined(this.get("current_value"))||""==String(this.get("current_value")).replace(/^\s+|\s+$/g,""))return e=r("Current value cannot be empty."),this.errorModel.set("current_value",e),e;if(this.errorModel.unset("current_value"),s.isUndefined(this.get("increment"))||""==String(this.get("increment")).replace(/^\s+|\s+$/g,""))return e=r("Increment value cannot be empty."),this.errorModel.set("increment",e),e;if(this.errorModel.unset("increment"),s.isUndefined(this.get("minimum"))||""==String(this.get("minimum")).replace(/^\s+|\s+$/g,""))return e=r("Minimum value cannot be empty."),this.errorModel.set("minimum",e),e;if(this.errorModel.unset("minimum"),s.isUndefined(this.get("maximum"))||""==String(this.get("maximum")).replace(/^\s+|\s+$/g,""))return e=r("Maximum value cannot be empty."),this.errorModel.set("maximum",e),e;if(this.errorModel.unset("maximum"),s.isUndefined(this.get("cache"))||""==String(this.get("cache")).replace(/^\s+|\s+$/g,""))return e=r("Cache value cannot be empty."),this.errorModel.set("cache",e),e;this.errorModel.unset("cache")}var o=r("Minimum value must be less than maximum value."),l=r("Start value cannot be less than minimum value."),a=r("Start value cannot be greater than maximum value.");return s.isEmpty(t)||s.isEmpty(i)?null:0==t&&0==i||parseInt(t,10)>=parseInt(i,10)?(this.errorModel.set("minimum",o),o):(this.errorModel.unset("minimum"),n&&t&&parseInt(n)<parseInt(t)?(this.errorModel.set("start",l),l):(this.errorModel.unset("start"),n&&i&&parseInt(n)>parseInt(i)?(this.errorModel.set("start",a),a):(this.errorModel.unset("start"),null)))}})})),o.Nodes.sequence}.apply(t,n))||(e.exports=o)},301:function(e,t,i){"use strict";var n,o;i(16),i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(14),i(51),i(38),i(20)],void 0===(o=function(t,e,a,o,l,r,s,i,n){return r.Nodes["coll-synonym"]||(l.Browser.Nodes["coll-synonym"]=l.Browser.Collection.extend({node:"synonym",label:t("Synonyms"),type:"coll-synonym",columns:["name","owner","is_public_synonym"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})),r.Nodes.synonym||(l.Browser.Nodes.synonym=i.SchemaChildNode.extend({type:"synonym",dialogHelp:e("help.static",{filename:"synonym_dialog.html"}),label:t("Synonym"),collection_type:"coll-synonym",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_synonym_on_coll",node:"coll-synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"}]))},model:l.Browser.Node.Model.extend({isNew:function(){return!this.fetchFromServer},idAttribute:"name",initialize:function(e,t){if(0===o.size(e)){var i=r.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({owner:i.name,synobjschema:n._label,schema:n._label,targettype:"r"},{silent:!0})}else this.fetchFromServer=!0;l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"owner",label:t("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,control:"node-list-by-name",node:"role",visible:!1},{id:"schema",label:t("Schema"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()},node:"schema",control:"node-list-by-name",cache_node:"database",cache_level:"database"},{id:"targettype",label:t("Target type"),cell:"string",disabled:"inSchema",group:t("Definition"),select2:{width:"50%",allowClear:!1},options:function(){return[{label:t("Function"),value:"f"},{label:t("Package"),value:"P"},{label:t("Procedure"),value:"p"},{label:t("Public Synonym"),value:"s"},{label:t("Sequence"),value:"S"},{label:t("Table"),value:"r"},{label:t("View"),value:"v"}]},control:"select2"},{id:"synobjschema",label:t("Target schema"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Definition"),deps:["targettype"],select2:{allowClear:!1},control:"node-list-by-name",node:"schema",filter:function(e){return e&&-1==o.indexOf(["pg_catalog","sys","dbo","pgagent","information_schema","dbms_job_procedure"],e.label)},disabled:function(e){return!!e.inSchema.apply(this,[e])||"s"==e.get("targettype")&&(e.set("synobjschema","public",{silent:!0}),!0)}},{id:"synobjname",label:t("Target object"),cell:"string",type:"text",disabled:"inSchema",group:t("Definition"),deps:["targettype","synobjschema"],control:"node-ajax-options",options:function(e){var t=e.model.get("targettype"),i=e.model.get("synobjschema"),n=[],o=e.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_target_objects",e.field.get("node_data"),!1,e.field.get("node_info")]);return a.ajax({type:"GET",timeout:3e4,url:l,cache:!1,async:!1,data:{trgTyp:t,trgSchema:i}}).done(function(e){return n=e.data}).fail(function(e,t,i){s.pgRespErrorNotify(e,i)}),n}},{id:"is_public_synonym",label:t("Public synonym?"),disabled:!0,type:"switch",mode:["properties"],cell:"switch",options:{onText:t("Yes"),offText:t("No"),onColor:"success",offColor:"primary",size:"mini"}}],validate:function(){var e=void 0;return this.errorModel.clear(),o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=t("Name cannot be empty."),this.errorModel.set("name",e)):o.isUndefined(this.get("synobjschema"))||""==String(this.get("synobjschema")).replace(/^\s+|\s+$/g,"")?(e=t("Target schema cannot be empty."),this.errorModel.set("synobjschema",e)):!o.isUndefined(this.get("synobjname"))&&""!=String(this.get("synobjname")).replace(/^\s+|\s+$/g,"")||(e=t("Target object cannot be empty."),this.errorModel.set("synobjname",e)),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||"pg"!==o.server_type)&&null==n.catalog}})),r.Nodes.synonym}.apply(t,n))||(e.exports=o)},302:function(e,t,i){"use strict";var n,o;i(10),i(11),i(4),i(62),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(28),i(51),i(38),i(20)],void 0===(o=function(t,e,a,r,i,o,n,l,s,d){o.Nodes["coll-type"]||(o.Nodes["coll-type"]=o.Collection.extend({node:"type",label:t("Types"),type:"coll-type",columns:["name","typeowner","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=l.IntegerCell.extend({initialize:function(){l.NumberCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(r.isFunction(i)?!!i.apply(t,[e]):!!i)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),p=l.Extension.NodeAjaxOptionsCell.extend({initialize:function(){l.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),n=this.$el.find("select").first();return(r.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),n.prop("disabled",!1)):(this.$el.removeClass("editable"),n.prop("disabled",!0)),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),u=n.CompositeModel=o.Node.Model.extend({idAttribute:"attnum",defaults:{attnum:void 0,member_name:void 0,type:void 0,tlength:void 0,is_tlength:!1,precision:void 0,is_precision:!1,collation:void 0,min_val:void 0,max_val:void 0},type_options:void 0,subtypes:void 0,schema:[{id:"member_name",label:t("Member Name"),type:"text",disabled:!1,editable:!0},{id:"type",label:t("Type"),control:"node-ajax-options",type:"text",url:"get_types",disabled:!1,node:"type",cache_node:"domain",editable:!0,cell:"node-ajax-options",select2:{allowClear:!1},transform:function(e,t){return t.model.type_options=e}},{id:"tlength",label:t("Length/Precision"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(t){var i=t.get("type");return t.type_options&&r.each(t.type_options,function(e){i==e.value&&(e.length?(t.set("is_tlength",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0})):t.set("is_tlength",!1,{silent:!0}))}),t.get("is_tlength")}},{id:"precision",label:t("Scale"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(t){var i=t.get("type");return t.type_options&&r.each(t.type_options,function(e){i==e.value&&(e.precision?(t.set("is_precision",!0,{silent:!0}),t.set("min_val",e.min_val,{silent:!0}),t.set("max_val",e.max_val,{silent:!0})):t.set("is_precision",!1,{silent:!0}))}),t.get("is_precision")}},{id:"collation",label:t("Collation"),cell:p,deps:["type"],select2:{allowClear:!1},control:"node-ajax-options",editable:function(e){var t=e.get("type"),i=!1;return e.type_options&&r.each(e.type_options,function(e){t==e.value&&e.is_collatable&&(i=!0)}),i&&setTimeout(function(){e.set("collspcname","",{silent:!0})},10),i},type:"text",disabled:!1,url:"get_collations",node:"type"}],validate:function(){var e=null;if(this.errorModel.clear(),r.isUndefined(this.get("member_name"))||r.isNull(this.get("member_name"))||""==String(this.get("member_name")).replace(/^\s+|\s+$/g,""))return e=t("Please specify the value for member name."),this.errorModel.set("member_name",e),e;if(r.isUndefined(this.get("type"))||r.isNull(this.get("type"))||""==String(this.get("type")).replace(/^\s+|\s+$/g,""))return e=t("Please specify the type."),this.errorModel.set("type",e),e;if(this.get("is_tlength")&&!r.isUndefined(this.get("tlength"))){if(this.get("tlength")<this.get("min_val")&&(e=t("Length/Precision should not be less than %s",this.get("min_val"))),this.get("tlength")>this.get("max_val")&&(e=t("Length/Precision should not be greater than %s",this.get("max_val"))),e)return this.errorModel.set("tlength",e),e}else if(this.get("is_precision")&&!r.isUndefined(this.get("precision"))&&(this.get("precision")<this.get("min_val")&&(e=t("Scale should not be less than %s",this.get("min_val"))),this.get("precision")>this.get("max_val")&&(e=t("Scale should not be greater than %s",this.get("max_val"))),e))return this.errorModel.set("precision",e),e;return null}}),m=n.EnumModel=o.Node.Model.extend({defaults:{label:void 0},schema:[{id:"label",label:t("Label"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_99",editable:function(e){return r.isUndefined(e.get("label"))}}],validate:function(){return null}});return o.Nodes.type||(o.Nodes.type=s.SchemaChildNode.extend({type:"type",sqlAlterHelp:"sql-altertype.html",sqlCreateHelp:"sql-createtype.html",dialogHelp:e("help.static",{filename:"type_dialog.html"}),label:t("Type"),collection_type:"coll-type",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_type_on_coll",node:"coll-type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!1},enable:"canCreate"}]))},ext_funcs:void 0,model:o.Node.Model.extend({defaults:{name:void 0,oid:void 0,is_sys_type:!1,typtype:void 0},initialize:function(e,t){if(0===r.size(e)){var i=o.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({typeowner:i.name,schema:n._label},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"schemaCheck"},{id:"oid",label:t("OID"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"typeowner",label:t("Owner"),cell:"string",control:"node-list-by-name",type:"text",mode:["properties","create","edit"],node:"role",disabled:"inSchema",select2:{allowClear:!1}},{id:"schema",label:t("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"schemaCheck",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database",control:"node-list-by-name",select2:{allowClear:!1}},{id:"typtype",label:t("Type"),mode:["create","edit"],disabled:"inSchemaWithModelCheck",group:t("Definition"),select2:{allowClear:!1},options:function(){return[{label:"Composite",value:"c"},{label:"Enumeration",value:"e"},{label:"External",value:"b"},{label:"Range",value:"r"},{label:"Shell",value:"p"}]},control:n.Select2Control.extend({render:function(){return n.Select2Control.prototype.render.apply(this,arguments),this.model.isNew()&&this.model.set({typtype:"c"}),this}})},{id:"composite",label:t("Composite Type"),model:u,editable:!0,type:"collection",group:t("Definition"),mode:["edit","create"],control:"unique-col-collection",uniqueCol:["member_name"],canAdd:!0,canEdit:!1,canDelete:!0,disabled:"inSchema",deps:["typtype"],visible:function(e){return"c"===e.get("typtype")}},{id:"enum",label:t("Enumeration type"),model:m,editable:!0,type:"collection",group:t("Definition"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:function(e){return!!e.isNew()},disabled:"inSchema",deps:["typtype"],control:"unique-col-collection",uniqueCol:["label"],visible:function(e){return"e"===e.get("typtype")}},{type:"nested",control:"plain-fieldset",group:t("Definition"),mode:["edit","create"],visible:function(e){return"r"===e.get("typtype")},deps:["typtype"],label:"",schema:[{id:"typname",label:t("Subtype"),cell:"string",control:"node-ajax-options",select2:{allowClear:!0,placeholder:"",width:"100%"},url:"get_stypes",type:"text",mode:["properties","create","edit"],group:t("Range Type"),disabled:"inSchemaWithModelCheck",transform:function(e,t){return t.model.subtypes=e}},{id:"opcname",label:t("Subtype operator class"),cell:"string",mode:["properties","create","edit"],group:t("Range Type"),disabled:"inSchemaWithModelCheck",deps:["typname"],control:"select",options:function(){var e=this.model.get("typname"),t=this,i=[];if(!r.isUndefined(e)&&""!=e){var n=this.field.get("schema_node"),o=n.generate_url.apply(n,[null,"get_subopclass",this.field.get("node_data"),!1,this.field.get("node_info")]);a.ajax({async:!1,url:o,cache:!1,data:{typname:e}}).done(function(e){i=e.data}).fail(function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)})}return i}},{id:"collname",label:t("Collation"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Range Type"),deps:["typname"],control:"node-ajax-options",url:"get_collations",select2:{allowClear:!0,placeholder:"",width:"100%"},disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("typname"),i=void 0;return r.isUndefined(t)||r.each(e.subtypes,function(e){t===e.label&&(i=e.is_collate)}),!i}},{id:"rngcanonical",label:t("Canonical function"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Range Type"),disabled:"inSchemaWithModelCheck",deps:["name","typname"],control:"select",options:function(){var e=this.model.get("name"),t=this,i=[];if(!r.isUndefined(e)&&""!=e){var n=this.field.get("schema_node"),o=n.generate_url.apply(n,[null,"get_canonical",this.field.get("node_data"),!1,this.field.get("node_info")]);a.ajax({async:!1,url:o,cache:!1,data:{name:e}}).done(function(e){i=e.data}).fail(function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)})}return i}},{id:"rngsubdiff",label:t("Subtype diff function"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Range Type"),disabled:"inSchemaWithModelCheck",deps:["opcname"],control:"select",options:function(){var e=this.model.get("typname"),t=this.model.get("opcname"),i=this,n=[];if(!r.isUndefined(e)&&""!=e&&!r.isUndefined(t)&&""!=t){var o=this.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_stypediff",this.field.get("node_data"),!1,this.field.get("node_info")]);a.ajax({async:!1,url:l,cache:!1,data:{typname:e,opcname:t}}).done(function(e){n=e.data}).fail(function(){i.model.trigger("pgadmin:view:fetch:error",i.model,i.field)})}return n}}]},{type:"nested",control:"tab",group:t("Definition"),label:t("External Type"),deps:["typtype"],mode:["create","edit"],tabPanelExtraClasses:"inline-tab-panel-padded",visible:function(e){return"b"===e.get("typtype")},schema:[{id:"spacer_ctrl",group:t("Required"),mode:["edit","create"],type:"spacer"},{id:"typinput",label:t("Input function"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typoutput",label:t("Output function"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"spacer_ctrl_optional_1",group:t("Optional-1"),mode:["edit","create"],type:"spacer"},{id:"typreceive",label:t("Receive function"),cell:"string",type:"text",group:t("Optional-1"),mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typsend",label:t("Send function"),cell:"string",group:t("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typmodin",label:t("Typmod in function"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Optional-1"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return r.each(e,function(e){"typmodin"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typmodout",label:t("Typmod out function"),cell:"string",group:t("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return r.each(e,function(e){"typmodout"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typlen",label:t("Internal length"),cell:"integer",group:t("Optional-1"),type:"int",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"variable",label:t("Variable?"),cell:"switch",group:t("Optional-1"),type:"switch",mode:["create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typdefault",label:t("Default?"),cell:"string",group:t("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typanalyze",label:t("Analyze function"),cell:"string",group:t("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typcategory",label:t("Category type"),cell:"string",group:t("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"Array types",value:"A"},{label:"Boolean types",value:"B"},{label:"Composite types",value:"C"},{label:"Date/time types",value:"D"},{label:"Enum types",value:"E"},{label:"Geometric types",value:"G"},{label:"Network address types",value:"I"},{label:"Numeric types",value:"N"},{label:"Pseudo-types",value:"P"},{label:"String types",value:"S"},{label:"Timespan types",value:"T"},{label:"User-defined types",value:"U"},{label:"Bit-string types",value:"V"},{label:"unknown type",value:"X"}]},{id:"typispreferred",label:t("Preferred?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:t("Optional-1")},{id:"spacer_ctrl_optional_2",group:t("Optional-2"),mode:["edit","create"],type:"spacer"},{id:"element",label:t("Element type"),cell:"string",control:"node-ajax-options",group:t("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_types"},{id:"typdelim",label:t("Delimiter"),cell:"string",type:"text",mode:["properties","create","edit"],group:t("Optional-2"),disabled:"inSchemaWithModelCheck"},{id:"typalign",label:t("Alignment type"),cell:"string",group:t("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"char",value:"c"},{label:"int2",value:"s"},{label:"int4",value:"i"},{label:"double",value:"d"}]},{id:"typstorage",label:t("Storage type"),type:"text",mode:["properties","create","edit"],group:t("Optional-2"),cell:"string",disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"PLAIN",value:"p"},{label:"EXTERNAL",value:"e"},{label:"MAIN",value:"m"},{label:"EXTENDED",value:"x"}]},{id:"typbyval",label:t("Passed by value?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:t("Optional-2")},{id:"is_collatable",label:t("Collatable?"),cell:"switch",min_version:90100,group:t("Optional-2"),type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"}]},{id:"alias",label:t("Alias"),cell:"string",type:"text",mode:["properties"],disabled:"inSchema"},o.SecurityGroupSchema,{id:"type_acl",label:t("Privileges"),cell:"string",type:"text",mode:["properties"],group:"security",disabled:"inSchema"},{id:"member_list",label:t("Members"),cell:"string",type:"text",mode:["properties"],group:t("Definition"),disabled:"inSchema",visible:function(e){return"c"===e.get("typtype")}},{id:"enum_list",label:t("Labels"),cell:"string",type:"text",mode:["properties"],group:t("Definition"),disabled:"inSchema",visible:function(e){return"e"===e.get("typtype")}},{id:"is_sys_type",label:t("System type?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{id:"description",label:t("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"typacl",label:t("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:o.Node.PrivilegeRoleModel.extend({privileges:["U"]}),mode:["edit","create"],canDelete:!0,uniqueCol:["grantee"],deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("typacl");0<t.length&&t.reset()}return!("p"===e.get("typtype"))}},{id:"seclabels",label:t("Security labels"),model:o.SecLabelModel,editable:!1,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection",deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("seclabels");0<t.length&&t.reset()}return!("p"===e.get("typtype"))}}],validate:function(){var e;if(this.errorModel.clear(),r.isUndefined(this.get("name"))||r.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return e=t("Name cannot be empty."),this.errorModel.set("name",e),e;if(r.isUndefined(this.get("schema"))||r.isNull(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return e=t("Schema cannot be empty."),this.errorModel.set("schema",e),e;if(r.isUndefined(this.get("typtype"))||r.isNull(this.get("typtype"))||""==String(this.get("typtype")).replace(/^\s+|\s+$/g,""))return e=t("Type cannot be empty."),this.errorModel.set("typtype",e),e;if("r"==this.get("typtype")&&(r.isUndefined(this.get("typname"))||r.isNull(this.get("typname"))||""==String(this.get("typname")).replace(/^\s+|\s+$/g,"")))return e=t("Subtype name cannot be empty."),this.errorModel.set("typname",e),e;if("b"==this.get("typtype")){if(r.isUndefined(this.get("typinput"))||r.isNull(this.get("typinput"))||""==String(this.get("typinput")).replace(/^\s+|\s+$/g,""))return e=t("Input function cannot be empty."),this.errorModel.set("typinput",e),e;if(r.isUndefined(this.get("typoutput"))||r.isNull(this.get("typoutput"))||""==String(this.get("typoutput")).replace(/^\s+|\s+$/g,""))return e=t("Output function cannot be empty."),this.errorModel.set("typoutput",e),e}return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},schemaCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&"p"===e.get("typtype")},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithEditMode:function(e){return!(this.node_info&&"schema"in this.node_info)||!!e.isNew()},external_func_combo:function(e){var t=[];return r.each(e,function(e){"all"==e.cbtype&&t.push(e)}),t}})})),o.Nodes.type}.apply(t,n))||(e.exports=o)},303:function(e,t,i){"use strict";var n,o;i(214),i(10),i(16),i(4),i(62),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(14),i(13),i(28),i(38),i(20)],void 0===(o=function(o,e,t,c,i,n,p,l,a,r,s){p.Nodes["coll-index"]||(n.Browser.Nodes["coll-index"]=n.Browser.Collection.extend({node:"index",label:o("Indexes"),type:"coll-index",columns:["name","description"],hasStatistics:!0,statsPrettifyFields:[o("Size"),o("Index size")],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema}));var d=r.Extension.NodeAjaxOptionsCell.extend({initialize:function(){r.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),r.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),n=this.$el.find("select").first();return(c.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),n.prop("disabled",!1)):(this.$el.removeClass("editable"),n.prop("disabled",!0)),this.delegateEvents(),this},remove:r.Extension.DependentCell.prototype.remove}),u=n.Browser.Node.Model.extend({defaults:{colname:void 0,collspcname:void 0,op_class:void 0,sort_order:!1,nulls:!1,is_sort_nulls_applicable:!0},schema:[{id:"colname",label:o("Column"),cell:"node-list-by-name",type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof i.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-list-by-name",node:"column"},{id:"collspcname",label:o("Collation"),cell:d,type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof i.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-ajax-options",url:"get_collations",node:"index"},{id:"op_class",label:o("Operator class"),cell:d,tags:!0,type:"text",disabled:"checkAccessMethod",editable:function(e){return!(e instanceof i.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&!e.checkAccessMethod.apply(this,arguments))},control:"node-ajax-options",url:"get_op_class",node:"index",deps:["amname"],transform:function(e,t){var i=t.model.top.get("amname"),n=e.btree;return c.isUndefined(i)||c.each(e,function(e,t){i===t&&(n=e)}),n}},{id:"sort_order",label:o("Sort order"),cell:r.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof i.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname"],options:{onText:"DESC",offText:"ASC"}},{id:"nulls",label:o("NULLs"),cell:r.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof i.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname","sort_order"],options:{onText:"FIRST",offText:"LAST"}}],validate:function(){if(this.errorModel.clear(),c.isUndefined(this.get("colname"))||""==String(this.get("colname")).replace(/^\s+|\s+$/g,"")){var e=o("Column Name cannot be empty.");return this.errorModel.set("colname",e),e}},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(e.top.node_info&&"schema"in e.top.node_info)||!e.top.isNew()},checkAccessMethod:function(e){var t=e.top;return c.isUndefined(t.get("amname"))||c.isNull(t.get("amname"))||""==String(t.get("amname")).replace(/^\s+|\s+$/g,"")||"btree"===t.get("amname")?1==e.get("sort_order")&&0==e.previous("sort_order")&&setTimeout(function(){e.set("nulls",!0)},10):e.set("is_sort_nulls_applicable",!1),!1}});return p.Nodes.index||(n.Browser.Nodes.index=p.Node.extend({parent_type:["table","view","mview","partition"],collection_type:["coll-table","coll-view"],sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",dialogHelp:e("help.static",{filename:"index_dialog.html"}),type:"index",label:o("Index"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,width:p.stdW.md+"px",statsPrettifyFields:[o("Size"),o("Index size")],Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"create_index_on_coll",node:"coll-index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index",node:"index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onMatView",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:o("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema,model:n.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,nspname:void 0,tabname:void 0,spcname:void 0,amname:"btree"},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:o("OID"),cell:"string",type:"int",disabled:!0,mode:["edit","properties"]},{id:"spcname",label:o("Tablespace"),cell:"string",control:"node-list-by-name",node:"tablespace",select2:{allowClear:!0},type:"text",mode:["properties","create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/pg_global/)}},{id:"amname",label:o("Access Method"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_access_methods",group:o("Definition"),select2:{allowClear:!0},control:a.NodeAjaxOptionsControl.extend({onChange:function(){a.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var i=this,e=i.model.get("amname"),t=i.model.previous("amname");if(e!=t&&0!==i.model.get("columns").length){var n=o("Changing access method will clear columns collection");l.confirm(n,function(){for(var e=i.model.get("columns"),t=e.length-1;0<=t;t--)e.remove(e.models[t])},function(){setTimeout(function(){i.model.set("amname",t)},10)})}}})},{id:"columns_csv",label:o("Columns"),cell:"string",type:"text",disabled:"inSchema",mode:["properties"],group:o("Definition")},{id:"include",label:o("Include columns"),type:"array",group:o("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties"],disabled:"inSchemaWithModelCheck",visible:function(e){return!c.isUndefined(e.node_info)&&!c.isUndefined(e.node_info.server)&&!c.isUndefined(e.node_info.server.version)&&11e4<=e.node_info.server.version},control:a.MultiSelectAjaxControl.extend({defaults:c.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:o("Select the column(s)")}})}),transform:function(e){var t=[];return e&&c.isArray(e)&&c.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},node:"column"},{id:"fillfactor",label:o("Fill factor"),cell:"string",type:"int",disabled:"inSchema",mode:["create","edit","properties"],min:10,max:100,group:o("Definition")},{id:"indisunique",label:o("Unique?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",group:o("Definition")},{id:"indisclustered",label:o("Clustered?"),cell:"string",type:"switch",disabled:"inSchema",group:o("Definition")},{id:"indisvalid",label:o("Valid?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:o("Definition")},{id:"indisprimary",label:o("Primary?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:o("Definition")},{id:"is_sys_idx",label:o("System index?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"isconcurrent",label:o("Concurrent build?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["create","edit"],group:o("Definition")},{id:"indconstraint",label:o("Constraint"),cell:"string",type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit"],control:"sql-field",visible:!0,group:o("Definition")},{id:"columns",label:o("Columns"),type:"collection",deps:["amname"],group:o("Definition"),model:u,mode:["edit","create"],canAdd:function(e){return!!e.isNew()},canEdit:!1,canDelete:function(e){return!!e.isNew()},control:"unique-col-collection",uniqueCol:["colname"],columns:["colname","op_class","sort_order","nulls","collspcname"]},{id:"include",label:o("Include columns"),type:"array",group:o("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["edit","create"],disabled:"inSchemaWithModelCheck",visible:function(e){return!c.isUndefined(e.node_info)&&!c.isUndefined(e.node_info.server)&&!c.isUndefined(e.node_info.server.version)&&11e4<=e.node_info.server.version},control:a.MultiSelectAjaxControl.extend({defaults:c.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:o("Select the column(s)")}})}),transform:function(e){var t=[];return e&&c.isArray(e)&&c.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},node:"column"},{id:"description",label:o("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(e){var t;if(e&&0==e.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),c.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=o("Name cannot be empty."),this.errorModel.set("name",t),t;if(c.isUndefined(this.get("spcname"))||""==String(this.get("spcname")).replace(/^\s+|\s+$/g,""))return t=o("Tablespace cannot be empty."),this.errorModel.set("spcname",t),t;if(c.isUndefined(this.get("amname"))||""==String(this.get("amname")).replace(/^\s+|\s+$/g,""))return t=o("Access method cannot be empty."),this.errorModel.set("amname",t),t;var i=this.get("columns");if(i&&0<i.length){if(!c.every(i.pluck("colname")))return t=o("You must specify column name."),this.errorModel.set("columns",t),t}else if(i)return t=o("You must specify at least one column."),this.errorModel.set("columns",t),t;return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!c.isUndefined(e.get("attnum"))&&1<=e.get("attnum"))}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=p.tree,o=t,l=e,a=[],r=!1,s=!1,d=this.getTreeNodeHierarchy(o).server.version;o;){if(!r&&-1<c.indexOf(["table","partition"],l._type)&&(r=!0,"is_partitioned"in l&&l.is_partitioned&&d<11e4&&(s=!0)),-1<c.indexOf(["schema"],l._type))return!s;a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<c.indexOf(a,"catalog"))&&!s}})),p.Nodes.index}.apply(t,n))||(e.exports=o)},304:function(e,t,i){"use strict";var n,o;i(16),i(11),i(48),i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(14),i(38),i(20)],void 0===(o=function(a,e,r,l,t,s,i,d,n){return s.Nodes["coll-trigger"]||(t.Browser.Nodes["coll-trigger"]=t.Browser.Collection.extend({node:"trigger",label:a("Triggers"),type:"coll-trigger",columns:["name","description"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})),s.Nodes.trigger||(t.Browser.Nodes.trigger=s.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"trigger",label:a("Trigger"),hasSQL:!0,hasDepends:!0,width:s.stdW.sm+"px",sqlAlterHelp:"sql-altertrigger.html",sqlCreateHelp:"sql-createtrigger.html",dialogHelp:e("help.static",{filename:"trigger_dialog.html"}),Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_trigger_on_coll",node:"coll-trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger",node:"trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"enable_trigger",category:"connect",priority:3,label:a("Enable trigger"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"disable_trigger",category:"drop",priority:3,label:a("Disable trigger"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"create_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_trigger:function(e){var t=e||{},n=s.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;r.ajax({url:this.generate_url(o,"enable",i,!0),type:"PUT",data:{is_enable_trigger:"O"},dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),l.icon="icon-trigger",n.addIcon(o,{icon:l.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)})},disable_trigger:function(e){var t=e||{},n=s.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;r.ajax({url:this.generate_url(o,"enable",i,!0),type:"PUT",data:{is_enable_trigger:"D"},dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),l.icon="icon-trigger-bad",n.addIcon(o,{icon:l.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i,a("Disable trigger failed")),n.unload(o)})}},canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema,model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,is_row_trigger:!0,fires:"BEFORE"},schema:[{id:"name",label:a("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:a("OID"),cell:"string",type:"int",disabled:!0,mode:["properties"]},{id:"is_enable_trigger",label:a("Trigger enabled?"),mode:["edit","properties"],group:a("Definition"),disabled:function(){return!(!this.node_info||!("catalog"in this.node_info||"view"in this.node_info))},options:[{label:"Enable",value:"O"},{label:"Enable Replica",value:"R"},{label:"Enable Always",value:"A"},{label:"Disable",value:"D"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{id:"is_row_trigger",label:a("Row trigger?"),type:"switch",group:a("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){if(l.has(e,"node_info")&&l.has(e.node_info,"table")&&l.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned&&e.node_info.server.version<11e4)return setTimeout(function(){e.set("is_row_trigger",!1)},10),!0;var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("is_row_trigger");return!(!l.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!l.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("is_row_trigger",!0)},10),!0)}},{id:"is_constraint_trigger",label:a("Constraint trigger?"),type:"switch",mode:["create","edit","properties"],group:a("Definition"),disabled:function(e){return l.has(e,"node_info")&&l.has(e.node_info,"table")&&l.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned||-1!=l.indexOf(Object.keys(e.node_info),"view")?(setTimeout(function(){e.set("is_constraint_trigger",!1)},10),!0):e.inSchemaWithModelCheck.apply(this,[e])}},{id:"tgdeferrable",label:a("Deferrable?"),type:"switch",group:a("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){var t=e.get("is_constraint_trigger");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!l.isUndefined(t)&&!0===t)&&(e.get("tgdeferrable")&&setTimeout(function(){e.set("tgdeferrable",!1)},10),!0)}},{id:"tginitdeferred",label:a("Deferred?"),type:"switch",group:a("Definition"),mode:["create","edit","properties"],deps:["tgdeferrable","is_constraint_trigger"],disabled:function(e){var t=e.get("tgdeferrable");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!l.isUndefined(t)&&t)&&(e.get("tginitdeferred")&&setTimeout(function(){e.set("tginitdeferred",!1)},10),!e.get("is_constraint_trigger"))}},{id:"tfunction",label:a("Trigger function"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:a("Definition"),control:"node-ajax-options",url:"get_triggerfunctions",cache_node:"trigger_function"},{id:"tgargs",label:a("Arguments"),cell:"string",group:a("Definition"),type:"text",mode:["create","edit","properties"],deps:["tfunction"],disabled:function(e){var t=e.get("tfunction"),i=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||"ppas"===i&&!l.isUndefined(t)&&"Inline EDB-SPL"===t&&(e.set("tgargs",void 0),!0)}},{id:"fires",label:a("Fires"),deps:["is_constraint_trigger"],mode:["create","edit","properties"],group:a("Events"),options:function(e){return-1!=l.indexOf(Object.keys(e.model.node_info),"table")?[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"}]:[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"},{label:"INSTEAD OF",value:"INSTEAD OF"}]},control:"select2",select2:{allowClear:!1,width:"100%"},disabled:function(e){var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("fires");return!(!l.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!l.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("fires","AFTER")},10),!0)}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:a("Events"),group:a("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:a("INSERT"),type:"switch",mode:["create","edit","properties"],group:a("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_insert");return!(!l.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_update",label:a("UPDATE"),type:"switch",mode:["create","edit","properties"],group:a("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_update");return!(!l.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_delete",label:a("DELETE"),type:"switch",mode:["create","edit","properties"],group:a("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_delete");return!(!l.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_truncate",label:a("TRUNCATE"),type:"switch",group:a("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("is_constraint_trigger"),i=e.get("is_row_trigger"),n=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||!("ppas"===n&&!l.isUndefined(t)&&!l.isUndefined(i)&&!1===t&&!1===i)}}]},{id:"whenclause",label:a("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:a("Events")},{id:"columns",label:a("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:a("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("evnt_update");return!(!l.isUndefined(t)&&t)}},{id:"tgoldtable",label:a("Old table"),type:"text",group:a("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"tgnewtable",label:a("New table"),type:"text",group:a("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"prosrc",label:a("Code"),group:a("Code"),type:"text",mode:["create","edit"],deps:["tfunction"],tabPanelCodeClass:"sql-code-control",control:i.SqlCodeControl,visible:!0,disabled:function(e){var t=e.get("tfunction");return!("ppas"===e.node_info.server.server_type&&!l.isUndefined(t)&&"Inline EDB-SPL"===t)}},{id:"is_sys_trigger",label:a("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(e){var t;return this.errorModel.clear(),e&&0==e.length?null:l.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=a("Name cannot be empty."),this.errorModel.set("name",t),t):l.isUndefined(this.get("tfunction"))||""==String(this.get("tfunction")).replace(/^\s+|\s+$/g,"")?(t=a("Trigger function cannot be empty."),this.errorModel.set("tfunction",t),t):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?l.isUndefined(this.get("tfunction"))||"Inline EDB-SPL"!==this.get("tfunction")||!l.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?null:(t=a("Trigger code cannot be empty."),this.errorModel.set("prosrc",t),t):(t=a("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",t),t)},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!l.isUndefined(e.get("attnum"))&&1<=e.get("attnum"))},disableTransition:function(e){var t=!0,i=null,n=this.name,o=0;return-1==l.indexOf(Object.keys(e.node_info),"table")||e.node_info.server.version<1e5||("tgoldtable"==n?i="evnt_delete":"tgnewtable"==n&&(i="evnt_insert"),e.get("evnt_insert")&&o++,e.get("evnt_update")&&o++,e.get("evnt_delete")&&o++,e.get("is_constraint_trigger")||"AFTER"!=e.get("fires")||!e.get("evnt_update")&&!e.get(i)||1!=o||(t=!!(e.get("evnt_update")&&1<=l.size(e.get("columns"))&&""!=e.get("columns")[0])),t&&setTimeout(function(){e.get(n)&&e.set(n,null)},10),t)}}),canCreate:n.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-trigger-bad"===e.icon&&this.canCreate.apply(this,[e,t,i]))},canCreate_with_trigger_disable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-trigger"===e.icon&&this.canCreate.apply(this,[e,t,i]))}})),s.Nodes.trigger}.apply(t,n))||(e.exports=o)},305:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(9),i(20)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-catalog_object_column"]||(n.Browser.Nodes["coll-catalog_object_column"]=n.Browser.Collection.extend({node:"catalog_object_column",label:e("catalog_object_column"),type:"coll-catalog_object_column",columns:["attname","attnum","cltype","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog_object_column||(n.Browser.Nodes.catalog_object_column=n.Browser.Node.extend({parent_type:"catalog_object",type:"catalog_object_column",label:e("catalog_object_column"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:n.Browser.Node.Model.extend({defaults:{attname:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0},schema:[{id:"attname",label:e("Column"),cell:"string",type:"text",disabled:!0},{id:"attowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:!0},{id:"cltype",label:e("Data type"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"collspcname",label:e("Collation"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"attacl",label:e("Privileges"),cell:"string",group:e("Security"),type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),o.Nodes.catalog_object_column}.apply(t,n))||(e.exports=o)},306:function(e,t,i){"use strict";var n,o;i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(51),i(38),i(54),i(213)],void 0===(o=function(o,e,t,l,i,a,n,r,s){return a.Nodes["coll-view"]||(a.Nodes["coll-view"]=a.Collection.extend({node:"view",label:o("Views"),type:"coll-view",columns:["name","owner"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),a.Nodes.view||(a.Nodes.view=r.SchemaChildNode.extend({type:"view",sqlAlterHelp:"sql-alterview.html",sqlCreateHelp:"sql-createview.html",dialogHelp:e("help.static",{filename:"view_dialog.html"}),label:o("View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert"],collection_type:"coll-view",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_view_on_coll",node:"coll-view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:o("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:o("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:17,label:o("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===l.size(e)){var i=t.node_info.schema._label||"public",n=a.serverInfo[t.node_info.server._id].user;this.set({schema:i,owner:n.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",disabled:"notInSchema"},{id:"oid",label:o("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:o("Owner"),cell:"string",control:"node-list-by-name",node:"role",disabled:"notInSchema",select2:{allowClear:!1}},{id:"schema",label:o("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",disabled:"notInSchema",mode:["create","edit"],select2:{allowClear:!1},cache_node:"database"},{id:"system_view",label:o("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"acl",label:o("Privileges"),mode:["properties"],type:"text",group:o("Security")},{id:"comment",label:o("Comment"),cell:"string",type:"multiline",disabled:"notInSchema"},{id:"security_barrier",label:o("Security barrier?"),type:"switch",min_version:"90200",group:o("Definition"),disabled:"notInSchema"},{id:"check_option",label:o("Check options"),control:"select2",group:o("Definition"),type:"text",min_version:"90400",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"notInSchema",options:[{label:o("No"),value:"no"},{label:o("Local"),value:"local"},{label:o("Cascaded"),value:"cascaded"}]},{id:"definition",label:o("Code"),cell:"string",type:"text",mode:["create","edit"],group:o("Code"),tabPanelCodeClass:"sql-code-control",control:n.SqlCodeControl,disabled:"notInSchema"},a.SecurityGroupSchema,{id:"datacl",label:o("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"notInSchema"},{id:"seclabels",label:o("Security labels"),model:a.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,disabled:"notInSchema",control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var e,t={},i=this.get("name"),n=this.get("definition");return l.isUndefined(i)||l.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t.name=o("Please specify name."),e=e||t.name,this.errorModel.set("name",e),e):(this.errorModel.unset("name"),l.isUndefined(n)||l.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t.definition=o("Please enter view code."),e=e||t.definition,this.errorModel.set("definition",e),e):(this.errorModel.unset("definition"),null))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}})})),a.Nodes.view}.apply(t,n))||(e.exports=o)},307:function(e,t,i){"use strict";var n,o;i(16),i(11),i(4),i(8),n=[i(2),i(5),i(0),i(1),i(3),i(14),i(9),i(13),i(51),i(38),i(54)],void 0===(o=function(l,e,a,r,s,d,c,t,i,n){return c.Nodes["coll-mview"]||(c.Nodes["coll-mview"]=c.Collection.extend({node:"mview",label:l("Materialized Views"),type:"coll-mview",columns:["name","owner"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})),c.Nodes.mview||(c.Nodes.mview=i.SchemaChildNode.extend({type:"mview",sqlAlterHelp:"sql-altermaterializedview.html",sqlCreateHelp:"sql-creatematerializedview.html",dialogHelp:e("help.static",{filename:"materialized_view_dialog.html"}),label:l("Materialized View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select"],collection_type:"coll-mview",Init:function(){this.initialized||(this.initialized=!0,s.Browser.add_menu_category("refresh_mview",l("Refresh View"),18,""),c.add_menus([{name:"create_mview_on_coll",node:"coll-mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:l("Materialized View...")},{name:"create_mview",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:l("Materialized View...")},{name:"create_mview",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:18,icon:"wcTabIcon icon-mview",data:{action:"create",check:!1},enable:"canCreate",label:l("Materialized View...")},{name:"refresh_mview_data",node:"mview",module:this,priority:1,callback:"refresh_mview",category:"refresh_mview",applies:["object","context"],label:l("With data"),data:{concurrent:!1,with_data:!0},icon:"fa fa-recycle"},{name:"refresh_mview_nodata",node:"mview",callback:"refresh_mview",priority:2,module:this,category:"refresh_mview",applies:["object","context"],label:l("With no data"),data:{concurrent:!1,with_data:!1},icon:"fa fa-refresh"},{name:"refresh_mview_concurrent",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!0},priority:3,applies:["object","context"],callback:"refresh_mview",label:l("With data (concurrently)"),icon:"fa fa-recycle"},{name:"refresh_mview_concurrent_nodata",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!1},priority:4,applies:["object","context"],callback:"refresh_mview",label:l("With no data (concurrently)"),icon:"fa fa-refresh"}]))},model:c.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===r.size(e)){var i=t.node_info.schema._label||"public",n=c.serverInfo[t.node_info.server._id].user;this.set({schema:i,owner:n.name},{silent:!0})}c.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{spcname:void 0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,warn_text:void 0},schema:[{id:"name",label:l("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:l("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:l("Owner"),cell:"string",control:"node-list-by-name",select2:{allowClear:!1},node:"role",disabled:"inSchema"},{id:"schema",label:l("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",mode:["create","edit"],cache_node:"database",disabled:"inSchema",select2:{allowClear:!1}},{id:"system_view",label:l("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},c.SecurityGroupSchema,{id:"acl",label:l("Privileges"),mode:["properties"],type:"text",group:l("Security")},{id:"comment",label:l("Comment"),cell:"string",type:"multiline"},{id:"definition",label:l("Definition"),cell:"string",type:"text",mode:["create","edit"],group:l("Definition"),tabPanelCodeClass:"sql-code-control",control:t.SqlCodeControl.extend({onChange:function(){t.SqlCodeControl.prototype.onChange.apply(this,arguments),this.model&&this.model.changed&&this.model.origSessAttrs&&this.model.changed.definition!=this.model.origSessAttrs.definition?this.model.warn_text=l("Updating the definition will drop and re-create the materialized view. It may result in loss of information about its dependent objects. Do you want to continue?"):this.model.warn_text=void 0}})},{id:"with_data",label:l("With data?"),group:l("Storage"),mode:["edit","create"],type:"switch"},{id:"spcname",label:l("Tablespace"),cell:"string",type:"text",group:l("Storage"),first_empty:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"fillfactor",label:l("Fill factor"),group:l("Storage"),mode:["edit","create"],type:"int"},{type:"nested",control:"tab",id:"materialization",label:l("Parameter"),mode:["edit","create"],group:l("Parameter"),schema:t.VacuumSettingsSchema},{id:"datacl",label:l("Privileges"),type:"collection",model:c.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",canAdd:!0,canDelete:!0,mode:["edit","create"],control:"unique-col-collection"},{id:"seclabels",label:l("Security labels"),model:c.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(e){var t,i={},n=this.get("name"),o=this.get("definition");return-1!=r.indexOf(e,"autovacuum_enabled")||-1!=r.indexOf(e,"toast_autovacuum_enabled")?null:r.isUndefined(n)||r.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(i.name=l("Please specify name."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),r.isUndefined(o)||r.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i.definition=l("Please enter view definition."),t=t||i.definition,this.errorModel.set("definition",t),t):(this.errorModel.unset("definition"),null))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),refresh_mview:function(e){var t=e||{},i=c.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0;if(!o)return!1;a.ajax({url:this.generate_url(n,"refresh_data",o,!0),type:"PUT",data:{concurrent:e.concurrent,with_data:e.with_data},dataType:"json"}).done(function(e){1==e.success?d.success(l("View refreshed successfully")):d.alert(l("Error refreshing view"),e.data.result)}).fail(function(e,t,i){d.pgRespErrorNotify(e,i,l("Error refreshing view"))})},is_version_supported:function(e,t){var i=s.Browser.tree,n=t||i.selected(),o=e||(n&&1==n.length?i.itemData(n):void 0),l=this||o&&s.Browser.Nodes[o._type];return 90400<=l.getTreeNodeHierarchy.apply(l,[n]).server.version}})),c.Nodes.mview}.apply(t,n))||(e.exports=o)},308:function(e,t,i){"use strict";var n,o;i(36),i(53),i(23),i(40),i(117),i(18),i(11),i(37),i(4),i(62),i(8),i(6),n=[i(309),i(2),i(5),i(0),i(1),i(3),i(9),i(14),i(13),i(28),i(310),i(51),i(38),i(20),i(421),i(422),i(215)],void 0===(o=function(t,r,e,c,m,h,g,s,d,i,n,o,l){return g.Nodes["coll-table"]||(g.Nodes["coll-table"]=g.Collection.extend({node:"table",label:r("Tables"),type:"coll-table",columns:["name","relowner","is_partitioned","description"],hasStatistics:!0,statsPrettifyFields:[r("Size"),r("Indexes size"),r("Table size"),r("TOAST table size"),r("Tuple length"),r("Dead tuple length"),r("Free space")],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),g.Nodes.table||(g.Nodes.table=o.SchemaChildNode.extend({type:"table",label:r("Table"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[r("Size"),r("Indexes size"),r("Table size"),r("TOAST table size"),r("Tuple length"),r("Dead tuple length"),r("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:e("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create","select","insert","update","delete"],width:"650px",Init:function(){this.initialized||(this.initialized=!0,g.add_menus([{name:"create_table_on_coll",node:"coll-table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:r("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:r("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table__on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!1},enable:"canCreate"},{name:"truncate_table",node:"table",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:r("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"table",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:r("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:r("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:r("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"table",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:r("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"count_table_rows",node:"table",module:this,applies:["object","context"],callback:"count_table_rows",category:"Count",priority:2,label:r("Count Rows"),enable:!0}]),g.Events.on("pgadmin:browser:node:table:updated",this.onTableUpdated,this),g.Events.on("pgadmin:browser:node:type:cache_cleared",this.handle_cache,this),g.Events.on("pgadmin:browser:node:domain:cache_cleared",this.handle_cache,this))},callbacks:{enable_triggers_on_table:function(e){t.enableTriggers(g.treeMenu,s,this.generate_url.bind(this),e)},disable_triggers_on_table:function(e){t.disableTriggers(g.treeMenu,s,this.generate_url.bind(this),e)},truncate_table:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!1}])},truncate_table_cascade:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!0}])},truncate:function(e,i){var t=e||{},n=this,o=g.tree,l=t.item||o.selected(),a=l&&1==l.length?o.itemData(l):void 0;if(!a)return!1;s.confirm(r("Truncate Table"),r("Are you sure you want to truncate table %s?",a.label),function(e){if(e){var t=a;c.ajax({url:n.generate_url(l,"truncate",a,!0),type:"PUT",data:i,dataType:"json"}).done(function(e){1==e.success&&(s.success(e.info),o.removeIcon(l),t.icon=t.is_partitioned?"icon-partition":"icon-table",o.addIcon(l,{icon:t.icon}),o.unload(l),o.setInode(l),o.deselect(l),setTimeout(function(){o.select(l)},10))}).fail(function(e,t,i){s.pgRespErrorNotify(e,i),o.unload(l)})}},function(){})},reset_table_stats:function(e){var t=e||{},i=this,n=g.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;s.confirm(r("Reset statistics"),r('Are you sure you want to reset the statistics for table "%s"?',l._label),function(e){if(e){var t=l;c.ajax({url:i.generate_url(o,"reset",l,!0),type:"DELETE"}).done(function(e){1==e.success&&(s.success(e.info),n.removeIcon(o),t.icon=t.is_partitioned?"icon-partition":"icon-table",n.addIcon(o,{icon:t.icon}),n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){s.pgRespErrorNotify(e,i),n.unload(o)})}},function(){})},count_table_rows:function(e){var t=e||{},n=g.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;c.ajax({url:this.generate_url(o,"count_rows",i,!0),type:"GET"}).done(function(e){s.success(e.info),i.rows_cnt=e.data.total_rows,n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10)}).fail(function(e,t,i){s.pgRespErrorNotify(e,i),n.unload(o)})}},model:g.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1},initialize:function(e,t){if(0===m.size(e)){var i=g.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({relowner:i.name,schema:n._label},{silent:!0})}g.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:r("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:r("OID"),type:"text",mode:["properties"]},{id:"relowner",label:r("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:r("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:r("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))},deps:["is_partitioned"],disabled:function(e){return!!(this.node_info&&"catalog"in this.node_info)||!(m.isUndefined(e.node_info)||m.isUndefined(e.node_info.server)||m.isUndefined(e.node_info.server.version)||!(12e4<=e.node_info.server.version)||!e.get("is_partitioned"))&&(setTimeout(function(){e.set("spcname",void 0)},10),!0)}},{id:"partition",type:"group",label:r("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:r("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){return!e.isNew()}},{id:"description",label:r("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"coll_inherits",label:r("Inherited from table(s)"),url:"get_inherits",type:"array",group:r("Columns"),disabled:"checkInheritance",deps:["typname","is_partitioned"],mode:["create","edit"],first_empty:!1,select2:{multiple:!0,allowClear:!0,first_empty:!1,placeholder:r("Select to inherit from...")},transform:function(e,t){return(t||this).model.inherited_tables_list=e},control:d.MultiSelectAjaxControl.extend({onChange:function(){d.MultiSelectAjaxControl.prototype.onChange.apply(this,arguments);var e=this.model.get("coll_inherits")||[],t=this.model.previous("coll_inherits")||[];if(!m.isUndefined(e)){var i=void 0,n=void 0;1<e.length&&t.length<e.length?(i=m.difference(e,t),n=this.get_table_oid(i[0]),this.add_columns(n)):1==e.length&&(n=this.get_table_oid(e[0]),this.add_columns(n)),0<e.length&&e.length<t.length?(i=m.difference(t,e),this.remove_columns(i[0])):1===t.length&&e.length<1&&(i=t[0],this.remove_columns(i))}},add_columns:function(e){var t,i=(this.model.top||this.model).get("columns"),n={tid:e};t=this.model.fetch_columns_ajax.apply(this,[n]),i.set(t,{merge:!1,remove:!1})},remove_columns:function(e){var t=this.get_table_oid(e),i=this.model.get("columns");i.remove(i.where({inheritedid:t}))},get_table_oid:function(t){var i=void 0;return m.each(this.model.inherited_tables_list,function(e){e.label===t&&(i=e.tid)}),i}})},{id:"advanced",label:r("Advanced"),type:"group",visible:n.show_advanced_tab},{id:"coll_inherits",label:r("Inherited from table(s)"),type:"text",group:"advanced",mode:["properties"]},{id:"inherited_tables_cnt",label:r("Inherited tables count"),type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"columns",label:r("Columns"),type:"collection",group:r("Columns"),model:g.Nodes.column.model,subnode:g.Nodes.column.model,mode:["create","edit"],disabled:function(t){return t.isNew()&&t.get("is_partitioned")&&setTimeout(function(){var e=t.get("columns");e.remove(e.filter(function(e){return!m.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:d.UniqueColCollectionControl.extend({initialize:function(){d.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var r=this;r.model.get(r.field.get("name")).on("change:is_primary_key",function(e){var t,i,n=r.model.get("primary_key"),o=e.get("name");if(e.get("is_primary_key")){if(n.length<1?(t=new n.model({},{top:r.model,collection:n,handler:n}),n.add(t)):t=n.first(),m.isUndefined(t.get("oid"))){if(0==(i=t.get("columns")).where({column:o}).length){var l=new i.model({column:o},{silent:!0,top:r.model,collection:n,handler:n});i.add(l)}i.trigger("pgadmin:multicolumn:updated",i)}}else if(0<n.length){if(t=n.first(),!m.isUndefined(t.get("oid")))return;var a=(i=t.get("columns")).where({column:o});0<a.length&&(i.remove(a),m.each(a,function(e){e.destroy()}),0==i.length&&n.remove(n.first())),i.trigger("pgadmin:multicolumn:updated",i)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),d.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{type:"nested",control:"tab",group:r("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:"",model:g.Nodes.primary_key.model,subnode:g.Nodes.primary_key.model,editable:!1,type:"collection",group:r("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(t){return!(t.get("is_partitioned")&&!m.isUndefined(t.top.node_info)&&!m.isUndefined(t.top.node_info.server)&&!m.isUndefined(t.top.node_info.server.version)&&t.top.node_info.server.version<11e4)||(setTimeout(function(){var e=t.get("primary_key");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&m.some(t.pluck("name"))}},{id:"foreign_key",label:"",model:g.Nodes.foreign_key.model,subnode:g.Nodes.foreign_key.model,editable:!1,type:"collection",group:r("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(t){return!(t.get("is_partitioned")&&!m.isUndefined(t.top.node_info)&&!m.isUndefined(t.top.node_info.server)&&!m.isUndefined(t.top.node_info.server.version)&&t.top.node_info.server.version<11e4)||(setTimeout(function(){var e=t.get("foreign_key");e.remove(e.filter(function(){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return m.some(t.pluck("name"))}},{id:"check_constraint",label:"",model:g.Nodes.check_constraint.model,subnode:g.Nodes.check_constraint.model,editable:!1,type:"collection",group:r("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:"",model:g.Nodes.unique_constraint.model,subnode:g.Nodes.unique_constraint.model,editable:!1,type:"collection",group:r("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(t){return!(t.get("is_partitioned")&&!m.isUndefined(t.node_info)&&!m.isUndefined(t.node_info.server)&&!m.isUndefined(t.node_info.server.version)&&t.node_info.server.version<11e4)||(setTimeout(function(){var e=t.get("unique_constraint");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return m.some(t.pluck("name"))}},{id:"exclude_constraint",label:"",model:g.Nodes.exclusion_constraint.model,subnode:g.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:r("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(t){return!t.get("is_partitioned")||(setTimeout(function(){var e=t.get("exclude_constraint");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return m.some(t.pluck("name"))}}]},{id:"typname",label:r("Of type"),type:"text",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:r("advanced"),deps:["coll_inherits"],transform:function(e,t){return(t||this).model.of_types_tables=e},control:d.NodeAjaxOptionsControl.extend({onChange:function(){d.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this,t=e.model.get("typname"),i=void 0,n=void 0,o=e.model.get("columns");if(m.isUndefined(t)||m.isNull(t)||""===t||0===o.length)m.isUndefined(t)||""!==t||o.remove(o.filter(function(){return!0}));else{var l=r("Remove column definitions?"),a=r("Changing 'Of type' will remove column definitions.");s.confirm(l,a,function(){o.remove(o.filter(function(){return!0}))},function(){setTimeout(function(){e.model.set("typname",null)},10)})}m.isUndefined(t)||""===t||(n={tname:t},i=e.model.fetch_columns_ajax.apply(e,[n]),o.set(i,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:r("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:r("advanced")},{id:"relhasoids",label:r("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],group:r("advanced"),disabled:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&12e4<=e.node_info.server.version||e.inSchema()}},{id:"relpersistence",label:r("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:r("advanced")},{id:"conname",label:r("Primary key"),cell:"string",type:"text",mode:["properties"],group:r("advanced"),disabled:"inSchema"},{id:"reltuples",label:r("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:r("advanced"),disabled:"inSchema"},{id:"rows_cnt",label:r("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:r("advanced"),disabled:"inSchema",control:d.InputControl.extend({formatter:{fromRaw:function(e){var t=h.Browser.tree,i=t.selected(),n=i&&1==i.length?t.itemData(i):void 0;return n&&n.rows_cnt&&0<parseInt(n.rows_cnt,10)?n.rows_cnt:e},toRaw:function(e){return e}}})},{id:"relhassubclass",label:r("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:r("advanced"),disabled:"inSchema"},{id:"is_sys_table",label:r("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:r("Like"),group:r("advanced"),schema:[{id:"like_relation",label:r("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:r("Like")},{id:"like_default_value",label:r("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_constraints",label:r("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_indexes",label:r("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_storage",label:r("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_comments",label:r("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")}]},{id:"partition_type",label:r("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:function(){var e=[{label:r("Range"),value:"range"},{label:r("List"),value:"list"}];return!m.isUndefined(this.node_info)&&!m.isUndefined(this.node_info.server)&&!m.isUndefined(this.node_info.server.version)&&11e4<=this.node_info.server.version&&e.push({label:r("Hash"),value:"hash"}),e},mode:["create"],visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:r("Partition Keys"),model:d.PartitionKeyModel,subnode:d.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=e.get("typname"),n=!1,o=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(o=1),t.length<=0&&!m.isUndefined(i)&&!m.isNull(i)&&0<e.of_types_tables.length?m.each(e.of_types_tables,function(e){e.label==i&&0<e.oftype_columns.length&&(n=!0)}):0<t.length&&(n=m.some(t.pluck("name"))),e.get("partition_keys")&&e.get("partition_keys").length<o&&n},visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(t){t.get("partition_keys")&&0<t.get("partition_keys").models.length&&setTimeout(function(){var e=t.get("partition_keys");e.remove(e.filter(function(){return!0}))},10)}},{id:"partition_scheme",label:r("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partition_key_note",label:r("Partition Keys"),type:"note",group:"partition",mode:["create"],text:["<ul><li>",r("Partition table supports two types of keys:"),"</li><li>","<strong>",r("Column: "),"</strong>",r("User can select any column from the list of available columns."),"</li><li>","<strong>",r("Expression: "),"</strong>",r("User can specify expression to create partition key."),"</li><li>","<strong>",r("Example: "),"</strong>",r("Let's say, we want to create a partition table based per year for the column 'saledate', having datatype 'date/timestamp', then we need to specify the expression as 'extract(YEAR from saledate)' as partition key."),"</li></ul>"].join(""),visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version}},{id:"partitions",label:r("Partitions"),model:d.PartitionsModel,subnode:d.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,customDeleteTitle:r("Detach Partition"),customDeleteMsg:r("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","is_default","values_from","values_to","values_in","values_modulus","values_remainder"],control:d.SubNodeCollectionControl.extend({row:i.PartitionRow,initialize:function(){d.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var e=this.field.get("schema_node"),i=this.field.get("node_info");c.ajax({url:e.generate_url.apply(e,[null,"get_attach_tables",this.field.get("node_data"),!0,i]),type:"GET",async:!1}).done(function(e){1==e.success?t.model.table_options=e.data:s.alert(r("Error fetching tables to be attached"),e.data.result)}).fail(function(e,t,i){s.pgRespErrorNotify(e,i)})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(t){t.isNew()&&t.get("partitions")&&0<t.get("partitions").models.length&&setTimeout(function(){var e=t.get("partitions");e.remove(e.filter(function(){return!0}))},10)}},{id:"partition_note",label:r("Partitions"),type:"note",group:"partition",text:["<ul><li>","<strong>",r("Create a table: "),"</strong>",r("User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>","<strong>",r("Edit existing table: "),"</strong>",r("User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>","<strong>",r("Default: "),"</strong>",r("The default partition can store rows that do not fall into any existing partition’s range or list."),"</li><li>","<strong>",r("From/To/In input: "),"</strong>",r("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"</li><li>","<strong>",r("Example: From/To: "),"</strong>",r("Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li>","<strong>",r("In: "),"</strong>",r("Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li><li>","<strong>",r("Modulus/Remainder: "),"</strong>",r("Enabled for hash partition."),"</li></ul>"].join(""),visible:function(e){return!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version}},{type:"nested",control:"tab",group:r("Parameters"),mode:["edit","create"],deps:["is_partitioned"],schema:d.VacuumSettingsSchema},{id:"relacl_str",label:r("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:r("Security")},g.SecurityGroupSchema,{id:"relacl",label:r("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:g.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:r("Security labels"),canEdit:!1,model:g.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:r("Storage settings"),type:"multiline",group:"advanced",mode:["properties"]}],validate:function(){var e,t=this.get("name"),i=this.get("schema"),n=this.get("relowner"),o=this.get("is_partitioned"),l=this.get("partition_keys");return m.isUndefined(t)||m.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")?(e=r("Table name cannot be empty."),this.errorModel.set("name",e),e):(this.errorModel.unset("name"),m.isUndefined(i)||m.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=r("Table schema cannot be empty."),this.errorModel.set("schema",e),e):(this.errorModel.unset("schema"),m.isUndefined(n)||m.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=r("Table owner cannot be empty."),this.errorModel.set("relowner",e),e):(this.errorModel.unset("relowner"),o&&this.isNew()&&!m.isNull(l)&&l.length<=0?(e=r("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",e),e):(this.errorModel.unset("partition_keys"),null))))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!m.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!m.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(m.isUndefined(e.get("typname"))||m.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(m.isUndefined(e.get("typname"))||m.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||m.isUndefined(e.get("typname"))||m.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return m.isUndefined(e.get("inheritedfrom"))||m.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(m.isUndefined(e.get("coll_inherits"))||m.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,i="get_columns",n=t.model.top||t.model,o=void 0,l=this.field.get("schema_node"),a=this.field.get("node_info"),r=l.generate_url.apply(l,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,a]),s=this.field.get("cache_level")||l.type,d=this.field.get("cache_node");return d=d&&g.Nodes[d]||l,n.trigger("pgadmin:view:fetching",n,t.field),c.ajax({async:!1,url:r,data:e}).done(function(e){o=d.cache(i,a,s,e.data)}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)}),n.trigger("pgadmin:view:fetched",n,t.field),o=o&&o.data||[]}}),canCreate_with_trigger_enable:function(e,t,i){return 0<e.tigger_count&&this.canCreate.apply(this,[e,t,i])},canCreate_with_trigger_disable:function(e,t,i){return 0<e.tigger_count&&0<e.has_enable_triggers&&this.canCreate.apply(this,[e,t,i])},onTableUpdated:function(e,t,i){var n,o;if(i.is_partitioned&&"affected_partitions"in i){var l,a=i.affected_partitions,r=[],s=[];if("detached"in a&&0<a.detached.length){g.removeChildTreeNodesById(e,"coll-partition",m.map(a.detached,function(e){return parseInt(e.oid)})),l=g.findParentTreeNodeByType(e,"schema");var d=m.groupBy(a.detached,function(e){return parseInt(e.schema_id)});for(n in d)if(l=g.findSiblingTreeNode(l,n)){o=m.map(d[n],function(e){return parseInt(e.oid)});var c=g.findChildCollectionTreeNode(l,"coll-table");c&&s.push({parent:c,type:"table",treeHierarchy:h.Browser.Nodes.schema.getTreeNodeHierarchy(l),childrenIDs:m.clone(o)})}}if("attached"in a&&0<a.attached.length){l=g.findParentTreeNodeByType(e,"schema");var p=m.groupBy(a.attached,function(e){return parseInt(e.schema_id)});for(n in p)(l=g.findSiblingTreeNode(l,n))&&(o=m.map(p[n],function(e){return parseInt(e.oid)}),g.removeChildTreeNodesById(l,"coll-table",o)),r=r.concat(o)}if("created"in a&&0<a.created.length&&m.each(a.created,function(e){r.push(e.oid)}),r.length){var u=g.findChildCollectionTreeNode(e,"coll-partition");u&&s.push({parent:u,type:"partition",treeHierarchy:this.getTreeNodeHierarchy(e),childrenIDs:r})}!function e(){if(s.length){var t=s.pop();g.addChildTreeNodes(t.treeHierarchy,t.parent,t.type,t.childrenIDs,e)}}()}},handle_cache:function(){this.clear_cache.apply(this,null)}})),g.Nodes.table}.apply(t,n))||(e.exports=o)},311:function(e,t,i){"use strict";var n,o;i(53),i(16),i(117),i(11),i(4),i(62),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(14),i(13),i(28),i(38),i(25),i(20),i(215)],void 0===(o=function(r,e,c,s,t,p,d,l,i,n,a){return p.Nodes["coll-partition"]||(t.Browser.Nodes["coll-partition"]=t.Browser.Collection.extend({node:"partition",label:r("Partitions"),type:"coll-partition",columns:["name","schema","partition_value","is_partitioned","description"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})),p.Nodes.partition||(t.Browser.Nodes.partition=p.Node.extend({parent_type:"table",collection_type:"coll-partition",type:"partition",label:r("Partition"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[r("Size"),r("Indexes size"),r("Table size"),r("TOAST table size"),r("Tuple length"),r("Dead tuple length"),r("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:e("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create"],height:"95%",width:"85%",Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"truncate_table",node:"partition",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:r("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"partition",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:r("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:r("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:r("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"partition",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:r("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"detach_partition",node:"partition",module:this,applies:["object","context"],callback:"detach_partition",priority:2,label:r("Detach Partition"),icon:"fa fa-remove"}]))},generate_url:function(e,t,i,n,o){return-1==s.indexOf(["stats","statistics","dependency","dependent","reset","get_relations","get_oftype","get_attach_tables"],t)?p.Node.generate_url.apply(this,arguments):("statistics"==t&&(t="stats"),o=s.isUndefined(e)||s.isNull(e)?o||{}:this.getTreeNodeHierarchy(e),a.sprintf("table/%s/%s/%s/%s/%s/%s",encodeURIComponent(t),encodeURIComponent(o.server_group._id),encodeURIComponent(o.server._id),encodeURIComponent(o.database._id),encodeURIComponent(o.partition.schema_id),encodeURIComponent(o.partition._id)))},canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema,callbacks:{enable_triggers_on_table:function(e){this.callbacks.set_triggers.apply(this,[e,{enable:!0}])},disable_triggers_on_table:function(e){this.callbacks.set_triggers.apply(this,[e,{enable:!1}])},set_triggers:function(e,t){var i=e||{},n=p.tree,o=i.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;c.ajax({url:this.generate_url(o,"set_trigger",l,!0),type:"PUT",data:t,dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)})},truncate_table:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!1}])},truncate_table_cascade:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!0}])},truncate:function(e,i){var t=e||{},n=this,o=p.tree,l=t.item||o.selected(),a=l&&1==l.length?o.itemData(l):void 0;if(!a)return!1;d.confirm(r("Truncate Table"),r("Are you sure you want to truncate table %s?",a.label),function(e){if(e){var t=a;c.ajax({url:n.generate_url(l,"truncate",a,!0),type:"PUT",data:i,dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),o.removeIcon(l),t.icon="icon-partition",o.addIcon(l,{icon:t.icon}),o.unload(l),o.setInode(l),o.deselect(l),setTimeout(function(){o.select(l)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),o.unload(l)})}},function(){})},reset_table_stats:function(e){var t=e||{},i=this,n=p.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;d.confirm(r("Reset statistics"),r('Are you sure you want to reset the statistics for table "%s"?',l._label),function(e){if(e){var t=l;c.ajax({url:i.generate_url(o,"reset",l,!0),type:"DELETE"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),t.icon="icon-partition",n.addIcon(o,{icon:t.icon}),n.unload(o),n.setInode(o),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)})}},function(){})},detach_partition:function(e){var t=e||{},i=this,n=p.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;d.confirm(r("Detach Partition"),r("Are you sure you want to detach the partition %s?",l._label),function(e){e&&c.ajax({url:i.generate_url(o,"detach",l,!0),type:"PUT"}).done(function(e){if(1==e.success){d.success(e.info);var t=n.next(o);t&&t.length||(t=n.prev(o))&&t.length||(t=n.parent(o),n.setInode(t,!0)),n.remove(o),t.length&&n.select(t)}}).fail(function(e,t,i){d.pgRespErrorNotify(e,i)})},function(){})}},model:p.Node.Model.extend({defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1,partition_value:void 0},initialize:function(e,t){if(0===s.size(e)){var i=p.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({relowner:i.name,schema:n._label},{silent:!0})}p.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:r("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:r("OID"),type:"text",mode:["properties"]},{id:"relowner",label:r("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:r("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit","properties"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:r("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:r("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:r("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){return!e.isNew()}},{id:"description",label:r("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"partition_value",label:r("Partition Scheme"),type:"text",visible:!1},{id:"coll_inherits",label:r("Inherited from table(s)"),type:"text",group:r("Advanced"),mode:["properties"]},{id:"Columns",type:"group",label:r("Columns"),mode:["edit","create"],min_version:1e5,visible:function(){return!1}},{id:"columns",label:r("Columns"),type:"collection",group:r("Columns"),model:p.Nodes.column.model,subnode:p.Nodes.column.model,mode:["create","edit"],disabled:function(t){return t.isNew()&&t.get("is_partitioned")&&setTimeout(function(){var e=t.get("columns");e.remove(e.filter(function(e){return!s.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:l.UniqueColCollectionControl.extend({initialize:function(){l.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var r=this;r.model.get(r.field.get("name")).on("change:is_primary_key",function(e){var t,i,n=r.model.get("primary_key"),o=e.get("name");if(e.get("is_primary_key")){if(n.length<1?(t=new n.model({},{top:r.model,collection:n,handler:n}),n.add(t)):t=n.first(),s.isUndefined(t.get("oid"))){if(0==(i=t.get("columns")).where({column:o}).length){var l=new i.model({column:o},{silent:!0,top:r.model,collection:n,handler:n});i.add(l)}i.trigger("pgadmin:multicolumn:updated",i)}}else if(0<n.length){if(t=n.first(),!s.isUndefined(t.get("oid")))return;var a=(i=t.get("columns")).where({column:o});0<a.length&&(i.remove(a),s.each(a,function(e){e.destroy()}),0==i.length&&setTimeout(function(){n.remove(n.first())},10)),i.trigger("pgadmin:multicolumn:updated",i)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),l.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{id:"inherited_tables_cnt",label:r("Inherited tables count"),type:"text",mode:["properties"],group:r("Advanced"),disabled:"inSchema"},{type:"nested",control:"tab",group:r("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:r("Primary key"),model:p.Nodes.primary_key.model,subnode:p.Nodes.primary_key.model,editable:!1,type:"collection",group:r("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(t){return!t.get("is_partitioned")||(setTimeout(function(){var e=t.get("primary_key");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&s.some(t.pluck("name"))}},{id:"foreign_key",label:r("Foreign key"),model:p.Nodes.foreign_key.model,subnode:p.Nodes.foreign_key.model,editable:!1,type:"collection",group:r("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(t){return!t.get("is_partitioned")||(setTimeout(function(){var e=t.get("foreign_key");e.remove(e.filter(function(){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return s.some(t.pluck("name"))}},{id:"check_constraint",label:r("Check constraint"),model:p.Nodes.check_constraint.model,subnode:p.Nodes.check_constraint.model,editable:!1,type:"collection",group:r("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:r("Unique Constraint"),model:p.Nodes.unique_constraint.model,subnode:p.Nodes.unique_constraint.model,editable:!1,type:"collection",group:r("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(t){return!t.get("is_partitioned")||(setTimeout(function(){var e=t.get("unique_constraint");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return s.some(t.pluck("name"))}},{id:"exclude_constraint",label:r("Exclude constraint"),model:p.Nodes.exclusion_constraint.model,subnode:p.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:r("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(t){return!t.get("is_partitioned")||(setTimeout(function(){var e=t.get("exclude_constraint");e.remove(e.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return s.some(t.pluck("name"))}}]},{id:"typname",label:r("Of type"),type:"text",mode:["properties","create","edit"],group:r("Advanced"),disabled:"checkOfType",url:"get_oftype",deps:["coll_inherits","is_partitioned"],transform:function(e,t){return(t||this).model.of_types_tables=e},control:l.NodeAjaxOptionsControl.extend({onChange:function(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("typname"),t=void 0,i=void 0,n=this.model.get("columns");if(s.isUndefined(e)||""===e||0===n.length)s.isUndefined(e)||""!==e||n.reset();else{var o=r("Changing of table type will clear columns collection.");d.confirm(o,function(e){if(!e)return this;n.reset()})}s.isUndefined(e)||""===e||(i={tname:e},t=this.model.fetch_columns_ajax.apply(this,[i]),n.set(t,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:r("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:r("Advanced")},{id:"relhasoids",label:r("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:r("Advanced")},{id:"relpersistence",label:r("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:r("Advanced")},{id:"conname",label:r("Primary key"),cell:"string",type:"text",mode:["properties"],group:r("Advanced"),disabled:"inSchema"},{id:"reltuples",label:r("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:r("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:r("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:r("Advanced"),disabled:"inSchema"},{id:"relhassubclass",label:r("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:r("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:r("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:r("Like"),group:r("Advanced"),schema:[{id:"like_relation",label:r("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:r("Like")},{id:"like_default_value",label:r("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_constraints",label:r("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_indexes",label:r("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_storage",label:r("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")},{id:"like_comments",label:r("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:r("Like")}]},{id:"partition_type",label:r("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:[{label:r("Range"),value:"range"},{label:r("List"),value:"list"}],mode:["create"],visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:r("Partition Keys"),model:l.PartitionKeyModel,subnode:l.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(i=1),e.get("partition_keys")&&e.get("partition_keys").length<i&&s.some(t.pluck("name"))},visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(t){t.get("partition_keys")&&0<t.get("partition_keys").models.length&&setTimeout(function(){var e=t.get("partition_keys");e.remove(e.filter(function(){return!0}))},10)}},{id:"partition_scheme",label:r("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partitions",label:r("Partitions"),model:l.PartitionsModel,subnode:l.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,customDeleteTitle:r("Detach Partition"),customDeleteMsg:r("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in"],control:l.SubNodeCollectionControl.extend({row:i.PartitionRow,initialize:function(){l.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var e=this.field.get("schema_node"),i=this.field.get("node_info");c.ajax({url:e.generate_url.apply(e,[null,"get_attach_tables",this.field.get("node_data"),!0,i]),type:"GET",async:!1}).done(function(e){1==e.success?t.model.table_options=e.data:d.alert(r("Error fetching tables to be attached"),e.data.result)}).fail(function(e,t,i){d.pgRespErrorNotify(e,i,r("Error fetching tables to be attached"))})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version},disabled:function(t){t.isNew()&&t.get("partitions")&&0<t.get("partitions").models.length&&setTimeout(function(){var e=t.get("partitions");e.remove(e.filter(function(){return!0}))},10)}},{id:"partition_note",label:r("Partition"),type:"note",group:"partition",text:r("The control above is used to Create/Attach/Detach partitions.<br><ul><li>Create Mode: User will be able to create N number of partitions. Mode switch control is disabled in this scenario.</li><li>Edit Mode: User will be able to create/attach/detach N number of partitions. In attach mode there will be list of suitable tables to be attached.</li></ul>"),visible:function(e){return!s.isUndefined(e.node_info)&&!s.isUndefined(e.node_info.server)&&!s.isUndefined(e.node_info.server.version)&&1e5<=e.node_info.server.version}},{type:"nested",control:"tab",group:r("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:l.VacuumSettingsSchema},{id:"relacl_str",label:r("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:r("Security")},p.SecurityGroupSchema,{id:"relacl",label:r("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:p.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:r("Security labels"),canEdit:!1,model:p.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:r("Storage settings"),type:"multiline",group:r("Advanced"),mode:["properties"]}],validate:function(e){var t,i=this.get("name"),n=this.get("schema"),o=this.get("relowner"),l=this.get("is_partitioned"),a=this.get("partition_keys");return!e||0!=e.length&&-1==s.indexOf(e,"autovacuum_enabled")&&-1==s.indexOf(e,"toast_autovacuum_enabled")?(this.errorModel.clear(),s.isUndefined(i)||s.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=r("Table name cannot be empty."),this.errorModel.set("name",t),t):s.isUndefined(n)||s.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=r("Table schema cannot be empty."),this.errorModel.set("schema",t),t):s.isUndefined(o)||s.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=r("Table owner cannot be empty."),this.errorModel.set("relowner",t),t):l&&this.isNew()&&!s.isNull(a)&&a.length<=0?(t=r("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",t),t):null):null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!s.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!s.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(s.isUndefined(e.get("typname"))||s.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(s.isUndefined(e.get("typname"))||s.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||s.isUndefined(e.get("typname"))||s.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return s.isUndefined(e.get("inheritedfrom"))||s.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("typname",void 0)},10),!0):!(!e.inSchemaWithModelCheck.apply(this,[e])&&(s.isUndefined(e.get("coll_inherits"))||s.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,i="get_columns",n=t.model.top||t.model,o=void 0,l=this.field.get("schema_node"),a=this.field.get("node_info"),r=l.generate_url.apply(l,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,a]),s=this.field.get("cache_level")||l.type,d=this.field.get("cache_node");return d=d&&p.Nodes.cache_node||l,n.trigger("pgadmin:view:fetching",n,t.field),c.ajax({async:!1,url:r,data:e}).done(function(e){o=d.cache(i,a,s,e.data)}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)}),n.trigger("pgadmin:view:fetched",n,t.field),o=o&&o.data||[]}}),canCreate:n.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return 0<e.tigger_count},canCreate_with_trigger_disable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return 0<e.tigger_count&&0<e.has_enable_triggers}})),p.Nodes.partition}.apply(t,n))||(e.exports=o)},312:function(e,t,i){"use strict";var n,o;i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(14),i(38),i(20)],void 0===(o=function(a,e,r,i,t,s,n,d,o){return s.Nodes["coll-compound_trigger"]||(t.Browser.Nodes["coll-compound_trigger"]=t.Browser.Collection.extend({node:"compound_trigger",label:a("Compound Triggers"),type:"coll-compound_trigger",columns:["name","description"],canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:o.isTreeItemOfChildOfSchema})),s.Nodes.compound_trigger||(t.Browser.Nodes.compound_trigger=s.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"compound_trigger",label:a("Compound Trigger"),hasSQL:!0,hasDepends:!0,width:s.stdW.sm+"px",sqlAlterHelp:"sql-altertcompoundtrigger.html",sqlCreateHelp:"sql-createcompoundtrigger.html",dialogHelp:e("help.static",{filename:"compound_trigger_dialog.html"}),Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_compound_trigger_on_coll",node:"coll-compound_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"enable_compound_trigger",category:"connect",priority:3,label:a("Enable compound trigger"),icon:"fa fa-check",enable:"canCreate_with_compound_trigger_enable"},{name:"disable_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"disable_compound_trigger",category:"drop",priority:3,label:a("Disable compound trigger"),icon:"fa fa-times",enable:"canCreate_with_compound_trigger_disable"},{name:"create_compound_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_compound_trigger:function(e){var t=e||{},n=s.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;r.ajax({url:this.generate_url(o,"enable",i,!0),type:"PUT",data:{is_enable_trigger:"O"},dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),l.icon="icon-compound_trigger",n.addIcon(o,{icon:l.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)})},disable_compound_trigger:function(e){var t=e||{},n=s.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;r.ajax({url:this.generate_url(o,"enable",i,!0),type:"PUT",data:{is_enable_trigger:"D"},dataType:"json"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),l.icon="icon-compound_trigger-bad",n.addIcon(o,{icon:l.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout(function(){n.select(o)},10))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i,a("Disable compound trigger failed")),n.unload(o)})}},canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:o.isTreeItemOfChildOfSchema,model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0},schema:[{id:"name",label:a("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:a("OID"),cell:"string",type:"int",disabled:!0,mode:["properties"]},{id:"is_enable_trigger",label:a("Trigger enabled?"),mode:["edit","properties"],disabled:function(){return!(!this.node_info||!("catalog"in this.node_info||"view"in this.node_info))},options:[{label:"Enable",value:"O"},{label:"Enable Replica",value:"R"},{label:"Enable Always",value:"A"},{label:"Disable",value:"D"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:a("FOR Events"),group:a("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:a("INSERT"),type:"switch",mode:["create","edit","properties"],group:a("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_insert");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_update",label:a("UPDATE"),type:"switch",mode:["create","edit","properties"],group:a("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_update");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_delete",label:a("DELETE"),type:"switch",mode:["create","edit","properties"],group:a("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_delete");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_truncate",label:a("TRUNCATE"),type:"switch",mode:["create","edit","properties"],group:a("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_truncate");return"view"in e.node_info||!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}}]},{id:"whenclause",label:a("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:a("Events")},{id:"columns",label:a("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:a("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("evnt_update");return!(!i.isUndefined(t)&&t)}},{id:"prosrc",label:a("Code"),group:a("Code"),type:"text",mode:["create","edit"],tabPanelCodeClass:"sql-code-control",control:n.SqlCodeControl,disabled:function(e){if(e.isNew()){var t=e.getCodeTemplate();setTimeout(function(){e.set("prosrc",t)},10)}return!1}},{id:"is_sys_trigger",label:a("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(e){var t;return this.errorModel.clear(),e&&0==e.length?null:i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=a("Name cannot be empty."),this.errorModel.set("name",t),t):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?i.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?(t=a("Code cannot be empty."),this.errorModel.set("prosrc",t),t):null:(t=a("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",t),t)},getCodeTemplate:function(){return a("-- Enter any global declarations below:\n\n-- BEFORE STATEMENT block. Delete if not required.\nBEFORE STATEMENT IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- AFTER STATEMENT block. Delete if not required.\nAFTER STATEMENT IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- BEFORE EACH ROW block. Delete if not required.\nBEFORE EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- AFTER EACH ROW block. Delete if not required.\nAFTER EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- INSTEAD OF EACH ROW block. Delete if not required.\nINSTEAD OF EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;")},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!i.isUndefined(e.get("attnum"))&&1<=e.get("attnum"))}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||!("pg"===o.server_type||o.version<12e4))&&null==n.catalog},canCreate_with_compound_trigger_enable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-compound_trigger-bad"===e.icon&&this.canCreate.apply(this,[e,t,i]))},canCreate_with_compound_trigger_disable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-compound_trigger"===e.icon&&this.canCreate.apply(this,[e,t,i]))}})),s.Nodes.compound_trigger}.apply(t,n))||(e.exports=o)},38:function(e,t,i){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(21),i(26),i(27),i(19),i(7),i(32),i(12),i(24),i(49),i(22),Object.defineProperty(t,"__esModule",{value:!0}),t.childCreateMenuEnabled=function(e,t,i){if(i&&!1===i.check)return!0;var n=o.treeMenu.findNodeByDomElement(t);return!!n&&n.anyFamilyMember(function(e){return"schema"===e.getData()._type})},t.isTreeItemOfChildOfSchema=function(e,t){var i=o.treeMenu.findNodeByDomElement(t);return!!i&&n(i)},t.isTreeNodeOfSchemaChild=n;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=n?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(i,o,l):i[o]=e[o]}i.default=e,t&&t.set(e,i);return i}(i(9));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){return e.anyParent(function(e){return"schema"===e.getData()._type})}},421:function(e,t,i){"use strict";var n,o;i(16),i(11),i(37),i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(13),i(28),i(38),i(20)],void 0===(o=function(d,e,t,c,i,n,r,o,l,a){r.Nodes["coll-column"]||(r.Nodes["coll-column"]=r.Collection.extend({node:"column",label:d("Columns"),type:"coll-column",columns:["name","atttypid","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:!1}));var s=o.VariablesModel=r.Node.Model.extend({idAttribute:"name",defaults:{name:null,value:null},schema:[{id:"name",label:d("Name"),cell:"select2",type:"text",disabled:!1,node:"column",options:[["n_distinct","n_distinct"],["n_distinct_inherited","n_distinct_inherited"]],select2:{placeholder:"Select variable"},cellHeaderClasses:"width_percent_50"},{id:"value",label:d("Value"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"}],validate:function(){if(c.isUndefined(this.get("value"))||c.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var e=d("Please provide input for variable.");return this.errorModel.set("value",e),e}return this.errorModel.unset("value"),null}}),p=l.Extension.IntegerDepCell=l.IntegerCell.extend({initialize:function(){l.NumberCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(c.isFunction(i)?!!i.apply(t,[e]):!!i)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},render:function(){l.NumberCell.prototype.render.apply(this,arguments);var e=this.model,t=this.column,i=this.column.get("editable");return(c.isFunction(i)?!!i.apply(t,[e]):!!i)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this},remove:l.Extension.DependentCell.prototype.remove});return r.Nodes.column||(r.Nodes.column=r.Node.extend({parent_type:["table","view","mview"],collection_type:["coll-table","coll-view","coll-mview"],type:"column",label:d("Column"),hasSQL:!0,sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-altertable.html",dialogHelp:e("help.static",{filename:"column_dialog.html"}),canDrop:function(e,t){var i=r.treeMenu.findNodeByDomElement(t);return!!i&&i.anyParent(function(e){return"table"===e.getData()._type&&!e.anyParent(function(e){return"catalog"===e.getData()._type})})},hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_column_on_coll",node:"coll-column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column",node:"column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"attnum",defaults:{name:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0,parent_tbl:void 0,min_val_attlen:void 0,min_val_attprecision:void 0,max_val_attlen:void 0,max_val_attprecision:void 0,edit_types:void 0,is_primary_key:!1,inheritedfrom:void 0,attstattarget:void 0,attnotnull:!1,attlen:null,attprecision:null,attidentity:"a",seqincrement:void 0,seqstart:void 0,seqmin:void 0,seqmax:void 0,seqcache:void 0,seqcycle:void 0,colconstype:"n",genexpr:void 0},initialize:function(e){0!==c.size(e)&&this.set({old_attidentity:this.get("attidentity")},{silent:!0}),r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:d("Name"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_30",editable:"editable_check_for_table"},{id:"is_primary_key",label:d("Primary key?"),cell:l.Extension.TableChildSwitchCell,type:"switch",deps:["name"],cellHeaderClasses:"width_percent_5",options:{onText:d("Yes"),offText:d("No"),onColor:"success",offColor:"primary"},visible:function(e){return c.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)},disabled:function(e){if(e.top&&(!c.isUndefined(e.top.get("oid"))&&!c.isUndefined(e.top.get("primary_key"))&&0<e.top.get("primary_key").length&&!c.isUndefined(e.top.get("primary_key").first().get("oid"))||e.top.has("is_partitioned")&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3))return!0;var t=e.get("name");return!(e.inSchemaWithColumnCheck.apply(this,[e])||!c.isUndefined(t)&&!c.isNull(t)&&""!=t)},editable:function(e){return e instanceof i.Collection||!(e.top&&!c.isUndefined(e.top.get("oid"))&&!c.isUndefined(e.top.get("primary_key"))&&0<e.top.get("primary_key").length&&!c.isUndefined(e.top.get("primary_key").first().get("oid")))&&(e.top&&!c.isUndefined(e.top.get("is_partitioned"))&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3?(setTimeout(function(){e.set("is_primary_key",!1)},10),!1):!e.inSchemaWithColumnCheck.apply(this,[e]))}},{id:"attnum",label:d("Position"),cell:"string",type:"text",disabled:"notInSchema",mode:["properties"]},{id:"cltype",label:d("Data type"),cell:l.Extension.NodeAjaxOptionsCell,type:"text",disabled:"inSchemaWithColumnCheck",control:"node-ajax-options",url:"get_types",node:"table",cellHeaderClasses:"width_percent_30",first_empty:!0,select2:{allowClear:!1},group:d("Definition"),cache_node:"table",transform:function(e,t){var i=t||this,n=i.model;i.model.datatypes=e;var o=n.get("edit_types"),l=[];return c.isUndefined(n.top)||n.top.isNew()?n.isNew()?e:(c.each(e,function(e){-1!=c.indexOf(o,e.value)&&l.push(e)}),l):(c.each(e,function(e){-1!=c.indexOf(o,e.value)&&l.push(e)}),0<l.length?l:e)},editable:"editable_check_for_table"},{id:"inheritedfrom",label:d("Inherited from table"),type:"text",disabled:!0,editable:!1,cellHeaderClasses:"width_percent_10",visible:function(e){return c.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)}},{id:"attlen",label:d("Length/Precision"),cell:p,deps:["cltype"],type:"int",group:d("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(t){var i=t.get("cltype"),n=!0;return c.each(t.datatypes,function(e){i==e.value&&e.length&&(t.set("min_val_attlen",e.min_val,{silent:!0}),t.set("max_val_attlen",e.max_val,{silent:!0}),n=!1)}),n&&setTimeout(function(){t.get("attlen")&&t.set("attlen",null)},10),n},editable:function(t){if(!c.isUndefined(t.get("inheritedfrom")))return!1;if(!t.datatypes)return!0;var i=t.get("cltype"),n=!1;return c.each(t.datatypes,function(e){i==e.value&&e.length&&(t.set("min_val_attlen",e.min_val,{silent:!0}),t.set("max_val_attlen",e.max_val,{silent:!0}),n=!0)}),n||setTimeout(function(){t.get("attlen")&&t.set("attlen",null,{silent:!0})},10),n}},{id:"attprecision",label:d("Scale"),cell:p,deps:["cltype"],type:"int",group:d("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(t){var i=t.get("cltype"),n=!0;return c.each(t.datatypes,function(e){i==e.value&&e.precision&&(t.set("min_val_attprecision",0,{silent:!0}),t.set("max_val_attprecision",e.max_val,{silent:!0}),n=!1)}),n&&setTimeout(function(){t.get("attprecision")&&t.set("attprecision",null)},10),n},editable:function(t){if(!c.isUndefined(t.get("inheritedfrom")))return!1;if(!t.datatypes)return!0;var i=t.get("cltype"),n=!1;return c.each(t.datatypes,function(e){i==e.value&&e.precision&&(t.set("min_val_attprecision",0,{silent:!0}),t.set("max_val_attprecision",e.max_val,{silent:!0}),n=!0)}),n||setTimeout(function(){t.get("attprecision")&&t.set("attprecision",null)},10),n}},{id:"collspcname",label:d("Collation"),cell:"string",type:"text",control:"node-ajax-options",url:"get_collations",group:d("Definition"),node:"collation",deps:["cltype"],disabled:function(e){var t=e.get("cltype"),i=!0;return c.each(e.datatypes,function(e){t==e.value&&e.is_collatable&&(i=!1)}),i&&setTimeout(function(){e.get("collspcname")&&""!==e.get("collspcname")&&e.set("collspcname","")},10),i}},{id:"attstattarget",label:d("Statistics"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",mode:["properties","edit"],group:d("Definition")},{id:"attstorage",label:d("Storage"),group:d("Definition"),type:"text",mode:["properties","edit"],cell:"string",disabled:"inSchemaWithColumnCheck",first_empty:!0,control:"select2",select2:{placeholder:"Select storage",allowClear:!1,width:"100%"},options:[{label:"PLAIN",value:"p"},{label:"MAIN",value:"m"},{label:"EXTERNAL",value:"e"},{label:"EXTENDED",value:"x"}]},{id:"defval",label:d("Default"),cell:"string",type:"text",group:d("Constraints"),deps:["cltype","colconstype"],disabled:function(e){var t=!1;if(!e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("cltype");t="serial"==i||"bigserial"==i||"smallserial"==i}return(t=t||"n"!=e.get("colconstype"))&&e.isNew()&&setTimeout(function(){e.set("defval",void 0)},10),t}},{id:"attnotnull",label:d("Not NULL?"),cell:"switch",type:"switch",cellHeaderClasses:"width_percent_20",group:d("Constraints"),editable:"editable_check_for_table",options:{onText:d("Yes"),offText:d("No"),onColor:"success",offColor:"primary"},deps:["colconstype"],disabled:function(e){return"i"==e.get("colconstype")&&setTimeout(function(){e.set("attnotnull",!0)},10),e.inSchemaWithColumnCheck(e)}},{id:"colconstype",label:d("Type"),cell:"string",type:"radioModern",controlsClassName:"pgadmin-controls col-12 col-sm-9",controlLabelClassName:"control-label col-sm-3 col-12",group:d("Constraints"),options:function(e){var t=[{label:d("NONE"),value:"n"},{label:d("IDENTITY"),value:"i"}];return e.top.node_info&&e.top.node_info.server&&12e4<=e.top.node_info.server.version&&(e.isNew()?t.push({label:d("GENERATED"),value:"g"}):t.push({label:d("GENERATED"),value:"g",disabled:!0})),t},disabled:function(e){return!e.isNew()&&"g"==e.get("colconstype")},visible:function(e){return!!(e.top.node_info&&e.top.node_info.server&&1e5<=e.top.node_info.server.version)}},{id:"attidentity",label:d("Identity"),control:"select2",cell:"select2",select2:{placeholder:"Select identity",allowClear:!1,width:"100%"},min_version:1e5,group:d("Constraints"),options:[{label:d("ALWAYS"),value:"a"},{label:d("BY DEFAULT"),value:"d"}],deps:["colconstype"],visible:"isTypeIdentity",disabled:function(e){return e.isNew()||""==e.get("attidentity")&&"i"==e.get("colconstype")&&setTimeout(function(){e.set("attidentity",e.get("old_attidentity"))},10),!1}},{id:"seqincrement",label:d("Increment"),type:"int",mode:["properties","create","edit"],group:d("Constraints"),min:1,deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqstart",label:d("Start"),type:"int",mode:["properties","create"],group:d("Constraints"),disabled:function(e){if(!e.isNew())return!0;var t=e.get("attidentity");return!!(c.isUndefined(t)||c.isNull(t)||c.isEmpty(t))},deps:["attidentity","colconstype"],visible:"isTypeIdentity"},{id:"seqmin",label:d("Minimum"),type:"int",mode:["properties","create","edit"],group:d("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqmax",label:d("Maximum"),type:"int",mode:["properties","create","edit"],group:d("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqcache",label:d("Cache"),type:"int",mode:["properties","create","edit"],group:d("Constraints"),min:1,deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqcycle",label:d("Cycled"),type:"switch",mode:["properties","create","edit"],group:d("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"genexpr",label:d("Expression"),type:"text",mode:["properties","create","edit"],group:d("Constraints"),min_version:12e4,deps:["colconstype"],visible:"isTypeGenerated",disabled:function(e){return!e.isNew()}},{id:"is_pk",label:d("Primary key?"),type:"switch",disabled:!0,mode:["properties"],group:d("Definition")},{id:"is_fk",label:d("Foreign key?"),type:"switch",disabled:!0,mode:["properties"],group:d("Definition")},{id:"is_inherited",label:d("Inherited?"),type:"switch",disabled:!0,mode:["properties"],group:d("Definition")},{id:"tbls_inherited",label:d("Inherited from table(s)"),type:"text",disabled:!0,mode:["properties"],deps:["is_inherited"],group:d("Definition"),visible:function(e){return!(c.isUndefined(e.get("is_inherited"))||!e.get("is_inherited"))}},{id:"is_sys_column",label:d("System column?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"description",label:d("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"notInSchema"},{id:"attoptions",label:d("Variables"),type:"collection",group:d("Variables"),control:"unique-col-collection",model:s,uniqueCol:["name"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},r.SecurityGroupSchema,{id:"attacl",label:d("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),mode:["edit"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:d("Security labels"),canAdd:!0,model:r.SecLabelModel,group:"security",mode:["edit","create"],editable:!1,type:"collection",min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(e){var t=void 0;if(e&&0==e.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),c.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=d("Column name cannot be empty."),this.errorModel.set("name",t),t;if(c.isUndefined(this.get("cltype"))||""==String(this.get("cltype")).replace(/^\s+|\s+$/g,""))return t=d("Column type cannot be empty."),this.errorModel.set("cltype",t),t;if(!c.isUndefined(this.get("cltype"))&&!c.isUndefined(this.get("attlen"))&&!c.isNull(this.get("attlen"))&&""!==this.get("attlen")&&(this.get("attlen")<this.get("min_val_attlen")&&(t=d("Length/Precision should not be less than: ")+this.get("min_val_attlen")),this.get("attlen")>this.get("max_val_attlen")&&(t=d("Length/Precision should not be greater than: ")+this.get("max_val_attlen")),t))return this.errorModel.set("attlen",t),t;if(!c.isUndefined(this.get("cltype"))&&!c.isUndefined(this.get("attprecision"))&&!c.isNull(this.get("attprecision"))&&""!==this.get("attprecision")&&(this.get("attprecision")<this.get("min_val_attprecision")&&(t=d("Scale should not be less than: ")+this.get("min_val_attprecision")),this.get("attprecision")>this.get("max_val_attprecision")&&(t=d("Scale should not be greater than: ")+this.get("max_val_attprecision")),t))return this.errorModel.set("attprecision",t),t;var i=this.get("genexpr");if("g"==this.get("colconstype")&&(c.isUndefined(i)||c.isNull(i)||""==i))return t=d("Expression value cannot be empty."),this.errorModel.set("genexpr",t),t;this.errorModel.unset("genexpr");var n=this.get("seqmin"),o=this.get("seqmax"),l=this.get("seqstart");if(!(this.isNew()||"i"!=this.get("colconstype")||"a"!=this.get("old_attidentity")&&"d"!=this.get("old_attidentity")||"a"!=this.get("attidentity")&&"d"!=this.get("attidentity"))){if(c.isUndefined(this.get("seqincrement"))||""==String(this.get("seqincrement")).replace(/^\s+|\s+$/g,""))return t=d("Increment value cannot be empty."),this.errorModel.set("seqincrement",t),t;if(this.errorModel.unset("seqincrement"),c.isUndefined(this.get("seqmin"))||""==String(this.get("seqmin")).replace(/^\s+|\s+$/g,""))return t=d("Minimum value cannot be empty."),this.errorModel.set("seqmin",t),t;if(this.errorModel.unset("seqmin"),c.isUndefined(this.get("seqmax"))||""==String(this.get("seqmax")).replace(/^\s+|\s+$/g,""))return t=d("Maximum value cannot be empty."),this.errorModel.set("seqmax",t),t;if(this.errorModel.unset("seqmax"),c.isUndefined(this.get("seqcache"))||""==String(this.get("seqcache")).replace(/^\s+|\s+$/g,""))return t=d("Cache value cannot be empty."),this.errorModel.set("seqcache",t),t;this.errorModel.unset("seqcache")}var a=d("Minimum value must be less than maximum value."),r=d("Start value cannot be less than minimum value."),s=d("Start value cannot be greater than maximum value.");return c.isEmpty(n)||c.isEmpty(o)?null:0==n&&0==o||parseInt(n,10)>=parseInt(o,10)?(this.errorModel.set("seqmin",a),a):(this.errorModel.unset("seqmin"),l&&n&&parseInt(l)<parseInt(n)?(this.errorModel.set("seqstart",r),r):(this.errorModel.unset("seqstart"),l&&o&&parseInt(l)>parseInt(o)?(this.errorModel.set("seqstart",s),s):(this.errorModel.unset("seqstart"),null)))},isIdentityColumn:function(e){var t=e.get("attidentity");return!!(c.isUndefined(t)||c.isNull(t)||c.isEmpty(t))},isTypeIdentity:function(e){var t=e.get("colconstype");return!c.isUndefined(t)&&!c.isNull(t)&&"i"==t},isTypeGenerated:function(e){var t=e.get("colconstype");return!c.isUndefined(t)&&!c.isNull(t)&&"g"==t},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){var t=this.node_info||e.node_info||e.top.node_info;return!!(t&&("view"in t||"mview"in t)&&this&&c.has(this,"name")&&"defval"!=this.name)||(!(t&&"schema"in t)||(!c.isUndefined(e.get("inheritedfrom"))||!e.isNew()&&!(!c.isUndefined(e.get("attnum"))&&0<e.get("attnum"))))},editable_check_for_table:function(e){return e instanceof i.Collection?!e.model.prototype.inSchemaWithColumnCheck.apply(this,[e.top]):!e.inSchemaWithColumnCheck.apply(this,[e])}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e,a=[];o;){if(-1<c.indexOf(["schema"],l._type))return!0;if(-1<c.indexOf(["view","coll-view","mview","coll-mview"],l._type)){a.push(l._type);break}a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<c.indexOf(a,"catalog")||-1<c.indexOf(a,"coll-view")||-1<c.indexOf(a,"coll-mview")||-1<c.indexOf(a,"mview")||-1<c.indexOf(a,"view"))}})),r.Nodes.column}.apply(t,n))||(e.exports=o)},422:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(9),i(20),i(423),i(424),i(425),i(426),i(427)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-constraints"]||(n.Browser.Nodes["coll-constraints"]=n.Browser.Collection.extend({node:"constraints",label:e("Constraints"),type:"coll-constraints",columns:["name","comment"],canDrop:!1,canDropCascade:!1})),o.Nodes.constraints||(n.Browser.Nodes.constraints=o.Node.extend({type:"constraints",label:e("Constraints"),collection_type:"coll-constraints",parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,o.add_menus([]))},model:n.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,comment:void 0},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("Oid"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"]}]})})),o.Nodes.constraints}.apply(t,n))||(e.exports=o)},423:function(e,t,i){"use strict";var n,o;i(16),i(40),i(50),i(33),i(12),i(4),i(46),i(8),i(29),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(28),i(20)],void 0===(o=function(n,e,t,c,i,p,o,l){return p.Nodes.unique_constraint||(i.Browser.Nodes.unique_constraint=p.Node.extend({type:"unique_constraint",label:n("Unique constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"unique_constraint_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[n("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"create_unique_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Unique constraint"),icon:"wcTabIcon icon-unique_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=p.tree,o=t,l=e,a=[],r=!1,s=!1,d=this.getTreeNodeHierarchy(o).server.version;o;){if(r||"table"!=l._type&&"partition"!=l._type||(r=!0,"is_partitioned"in l&&l.is_partitioned&&d<11e4&&(s=!0)),-1<c.indexOf(["schema"],l._type))return!s;a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<c.indexOf(a,"catalog"))&&!s},model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:n("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:n("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:n("Columns"),type:"collection",group:n("Definition"),editable:!1,cell:l.StringCell.extend({initialize:function(){l.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(c.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var i=this,t=i.model.get("columns").where({column:e.get("name")});i.model.get("columns").remove(t),setTimeout(function(){i.render()},10);setTimeout(function(){var e=i.model.top.get("unique_constraint"),t=[];e.each(function(e){0==e.get("columns").length&&t.push(e)}),e.remove(t)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});0<i.length&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return l.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),l.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:o.MultiSelectAjaxControl.extend({defaults:c.extend({},o.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:n("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(c.isArray(i))return c.map(i,function(e){return e.column});t=t.split(".");for(var n=0;n<t.length;n++){if(c.isNull(i))return null;c.isEmpty(t[n])||c.isUndefined(i[t[n]])||(i=i[t[n]])}return c.isObject(i)&&!c.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(o.Select2Control.prototype.initialize.apply(this,arguments),c.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else o.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),i=[];0<e.length&&c.each(e.models,function(e){var t=e.get("name");c.isUndefined(t)||c.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)},onChange:function(){var i=this,e=this.model,t=this.field.get("name").split(".").shift(),n=this.getValueFromDOM(),o=e.get(t),l=[];this.stopListening(this.model,"change:"+t,this.render),o.each(function(e){var t=e.get("column"),i=c.indexOf(n,t);-1<i?n.splice(i,1):l.push(t)}),c.each(n,function(e){var t=new(i.field.get("model"))({column:e},{silent:!0,top:i.model.top,collection:o,handler:o});o.add(t)}),c.each(l,function(e){o.remove(o.where({column:e}))}),this.listenTo(this.model,"change:"+t,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),o.Select2Control.prototype.remove.apply(this,arguments)}else o.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:p.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&c.isArray(e)&&c.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(c.has(e,"top")&&!c.isUndefined(e.top)&&!e.top.isNew())return!c.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!c.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:n("Include columns"),type:"array",group:n("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!c.isUndefined(e.node_info)&&!c.isUndefined(e.node_info.server)&&!c.isUndefined(e.node_info.server.version)&&11e4<=e.node_info.server.version},control:o.MultiSelectAjaxControl.extend({defaults:c.extend({},o.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:n("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(o.Select2Control.prototype.initialize.apply(this,arguments),c.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else o.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),i=[];0<e.length&&c.each(e.models,function(e){var t=e.get("name");c.isUndefined(t)||c.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function(e){if(c.has(e,"top")&&!c.isUndefined(e.top)&&!e.top.isNew())return!c.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!c.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:n("Tablespace"),type:"text",group:n("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){var t=(e=e.top||e).get("index");return!c.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:n("Index"),type:"text",group:n("Definition"),control:o.NodeListByNameControl.extend({initialize:function(){c.isUndefined(this.model.top)?o.NodeListByNameControl.prototype.initialize.apply(this,arguments):o.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!c.has(e,"top")||c.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!c.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:n("Fill factor"),deps:["index"],type:"int",group:n("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!c.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:n("Deferrable?"),type:"switch",group:n("Definition"),deps:["index"],disabled:function(e){if(c.has(e,"top")&&!c.isUndefined(e.top)&&!e.top.isNew())return!c.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!c.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:n("Deferred?"),type:"switch",group:n("Definition"),deps:["condeferrable"],disabled:function(e){return!c.has(e,"top")||c.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!c.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),c.has(this,"top")&&this.top.errorModel.clear();var e=this.get("columns"),t=this.get("index");if(!c.isUndefined(t)&&""!=String(t).replace(/^\s+|\s+$/g,"")||!(c.isUndefined(e)||c.isNull(e)||e.length<1))return null;var i=n("Please specify columns for %s",n("Unique constraint"));return this.errorModel.set("columns",i),i}})})),p.Nodes.unique_constraint}.apply(t,n))||(e.exports=o)},424:function(e,t,i){"use strict";var n,o;i(16),i(4),i(8),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(14),i(38),i(20)],void 0===(o=function(i,e,a,r,t,s,d,n){return s.Nodes.check_constraint||(t.Browser.Nodes.check_constraint=s.Node.extend({type:"check_constraint",label:i("Check"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"check_dialog.html"}),hasSQL:!0,hasDepends:!0,parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_check_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:i("Check..."),icon:"wcTabIcon icon-check_constraint",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_check_constraint",node:"check_constraint",module:this,applies:["object","context"],callback:"validate_check_constraint",category:"validate",priority:4,label:i("Validate check constraint"),icon:"fa fa-link",enable:"is_not_valid",data:{action:"edit",check:!0}}]))},is_not_valid:function(e,t,i){return!!this.canCreate(e,t,i)&&(e&&!e.valid)},callbacks:{validate_check_constraint:function(e){var t=e||{},n=s.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;return a.ajax({url:this.generate_url(o,"validate",i,!0),type:"GET"}).done(function(e){1==e.success&&(d.success(e.info),n.removeIcon(o),l.valid=!0,l.icon="icon-check_constraint",n.addIcon(o,{icon:l.icon}),setTimeout(function(){n.deselect(o)},10),setTimeout(function(){n.select(o)},100))}).fail(function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)}),!1}},canDrop:n.isTreeItemOfChildOfSchema,model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:i("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:i("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"consrc",label:i("Check"),type:"multiline",cell:"string",group:i("Definition"),mode:["properties","create","edit"],disabled:function(e){return r.has(e,"handler")&&!r.isUndefined(e.handler)&&!r.isUndefined(e.get("oid"))||r.isFunction(e.isNew)&&!e.isNew()},editable:!1},{id:"connoinherit",label:i("No inherit?"),type:"switch",cell:"boolean",group:i("Definition"),mode:["properties","create","edit"],min_version:90200,disabled:function(e){return r.has(e,"top")&&!r.isUndefined(e.top)&&e.top.get("is_partitioned")||r.has(e,"node_info")&&r.has(e.node_info,"table")&&r.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned?(setTimeout(function(){e.set("connoinherit",!1)},10),!0):r.has(e,"handler")&&!r.isUndefined(e.handler)&&!r.isUndefined(e.get("oid"))||r.isFunction(e.isNew)&&!e.isNew()}},{id:"convalidated",label:i("Don't validate?"),type:"switch",cell:"boolean",group:i("Definition"),min_version:90200,disabled:function(e){return!!(r.isFunction(e.isNew)&&!e.isNew()||r.has(e,"handler")&&!r.isUndefined(e.handler)&&!r.isUndefined(e.get("oid")))&&!e.get("convalidated")},mode:["properties","create","edit"]}],validate:function(){var e,t={};return!r.isUndefined(this.get("consrc"))&&""!=String(this.get("consrc")).replace(/^\s+|\s+$/g,"")||(t.consrc=i("Check cannot be empty."),e=e||t.consrc),this.errorModel.clear().set(t),r.size(t)?(this.trigger("on-status",{msg:e}),e):null},isDisabled:function(e){if((r.has(e,"handler")&&!r.isUndefined(e.handler)&&!r.isUndefined(e.get("oid"))||r.isFunction(e.isNew)&&!e.isNew())&&(this.node_info||e.top.node_info).server.version<90200)return!0;return!1}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,o=t,l=e,a=[];o;){if(-1<r.indexOf(["schema"],l._type))return!0;a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<r.indexOf(a,"catalog"))}})),s.Nodes.check_constraint}.apply(t,n))||(e.exports=o)},425:function(e,t,i){"use strict";var n,o;i(36),i(10),i(16),i(23),i(30),i(18),i(11),i(4),i(8),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(14),i(13),i(28),i(20)],void 0===(o=function(a,e,d,c,r,t,p,s,u,m){function h(e){if(!e.id)return e.text;var t=d(e.element).data("image");return t?d('<span><span class="wcTabIcon '+t+'"/>'+e.text+"</span>"):e.text}var g=c.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >','    <%=select2.first_empty ? " <option></option>" : ""%>',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),i=p.Node.Model.extend({defaults:{local_column:void 0,references:void 0,referenced:void 0},schema:[{id:"local_column",label:a("Local"),type:"text",editable:!1,cellHeaderClasses:"width_percent_50",cell:"string",headerCell:m.Extension.CustomHeaderCell},{id:"referenced",label:a("Referenced"),type:"text",editable:!1,cell:"string",cellHeaderClasses:"width_percent_50",headerCell:m.Extension.CustomHeaderCell}]}),n=u.ForeignKeyColumnControl=u.UniqueColCollectionControl.extend({initialize:function(){u.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var n=this,e=[{id:"local_column",label:"",type:"text",node:"column",control:u.NodeListByNameControl.extend({initialize:function(){if(n.model.handler){if(u.Select2Control.prototype.initialize.apply(this,arguments),c.isUndefined(n.model.get("oid"))){var e=n.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else u.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},resetColOptions:function(e){var t=this;e.previous("name")==n.headerData.get("local_column")&&(n.headerData.set({local_column:e.get("name")}),n.headerDataChanged()),setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=n.model.top.get("columns"),i=[];0<e.length&&c.each(e.models,function(e){var t=e.get("name");c.isUndefined(t)||c.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)},template:g,remove:function(){if(n.model.handler){var e=n.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),u.Select2Control.prototype.remove.apply(this,arguments)}else u.NodeListByNameControl.prototype.remove.apply(this,arguments)}}),select2:{allowClear:!1,width:"style",placeholder:a("Select column"),first_empty:!c.isUndefined(n.model.get("oid"))},version_compatible:n.field.get("version_compatible"),disabled:function(){return!c.isUndefined(n.model.get("oid"))}},{id:"references",label:"",type:"text",cache_level:"server",select2:{allowClear:!1,width:"style",placeholder:"Select foreign table"},first_empty:!0,control:u.NodeListByNameControl.extend({formatter:u.ControlFormatter,template:g}),url:"all_tables",node:"table",version_compatible:n.field.get("version_compatible"),disabled:function(){return!c.isUndefined(n.model.get("oid"))},transform:function(e){var t=[];return c.each(e,function(e){t.push({value:e.value,image:"icon-table",label:e.label})}),t}},{id:"referenced",label:"",type:"text",cache_level:"server",transform:function(e){var t=[];return c.each(e,function(e){t.push({value:e.name,image:"icon-column",label:e.name})}),t},control:u.Select2Control.extend({formatter:u.ControlFormatter,template:g,render:function(){var e=this,t=e.field.get("url")||e.defaults.url,i=e.model,n=i.get("references");if(i.set(e.field.get("name"),null,{silent:!0}),!t||c.isUndefined(n)||c.isNull(n)||""==n)e.field.set("options",[]);else{var o=this.field.get("schema_node"),l=this.field.get("node_info"),a=o.generate_url.apply(o,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,l]),r=[];this.field.get("version_compatible")&&(i.trigger("pgadmin:view:fetching",i,e.field),d.ajax({async:!1,data:{tid:n},url:a}).done(function(e){r=e.data}).fail(function(){i.trigger("pgadmin:view:fetch:error",i,e.field)}),i.trigger("pgadmin:view:fetched",i,e.field));var s=this.field.get("transform")||e.defaults.transform;s&&c.isFunction(s)?e.field.set("options",s.bind(e,r)):e.field.set("options",r)}return u.Select2Control.prototype.render.apply(this,arguments),this}}),url:"get_columns",select2:{allowClear:!1,width:"style",placeholder:a("Select column"),templateResult:h,templateSelection:h},deps:["references"],node:"table",version_compatible:n.field.get("version_compatible"),disabled:function(){return!c.isUndefined(n.model.get("oid"))}}],t={local_column:null,references:null,referenced:null};if(!n.model.isNew()&&c.isUndefined(n.model.handler)||c.has(n.model,"handler")&&!c.isUndefined(n.model.handler)&&!c.isUndefined(n.model.get("oid"))){var i=n.collection.first();i&&(t.references=i.get("references"))}n.headerData=new(r.Model.extend({defaults:t,schema:e}))({});var o=u.generateViewSchema(n.field.get("node_info"),n.headerData,"create","foreign_key",n.field.get("node_data")),l=[];c.each(o,function(e){l=l.concat(e.fields)}),n.headerFields=new u.Fields(l),n.gridSchema=u.generateGridColumnsFromModel(n.field.get("node_info"),n.field.get("model"),"edit",["local_column","references","referenced"],n.field.get("schema_node")),n.controls=[],n.listenTo(n.headerData,"change",n.headerDataChanged),n.listenTo(n.headerData,"select2",n.headerDataChanged),n.listenTo(n.collection,"add",n.onAddorRemoveColumns),n.listenTo(n.collection,"remove",n.onAddorRemoveColumns)},generateHeader:function(e){var t=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-md-6" header="local_column"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-references_label%></label>',"   </div>",'   <div class="col-md-6" header="references"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-referenced_label%></label>',"   </div>",'   <div class="col-md-6" header="referenced"></div>',"  </div>"," </div>","</div>"].join("\n");c.extend(e,{column_label:a("Local column"),references_label:a("References"),referenced_label:a("Referencing")});var i=this,n=c.template(t),o=d(n(e)),l=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:i.headerData});o.find('div[header="'+e.get("name")+'"]').append(t.render().$el),l.push(t)}),"properties"==e.mode&&o.html(""),i.$header=o},events:c.extend({},u.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,i=c.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+c("Add new row")+'"></button>',"</div>"].join("\n")),n=d("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?i({label:e.label,canAdd:e.canAdd}):"");t.grid&&t.grid.remove(),n.append(t.generateHeader(e));var o=c.clone(this.gridSchema);0==e.disabled&&e.canDelete&&o.columns.unshift({name:"pg-backform-delete",label:"",cell:m.Extension.DeleteCell,editable:!1,cell_priority:-1});var l=t.grid=new m.Grid({columns:o.columns,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=l.render().$el,n.append(t.$grid),setTimeout(function(){t.headerData.set({local_column:t.$header.find('div[header="local_column"] select option:first').val(),referenced:t.$header.find('div[header="referenced"] select option:first').val(),references:t.$header.find('div[header="references"] select option:first').val()},{silent:!0})},10),"properties"===e.mode&&n.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=n},headerDataChanged:function(){var i,n=this.headerData.toJSON(),o=!1,e=["local_column","referenced"];this.$header&&(this.control_data.canAdd?this.collection.each(function(t){o||c.each(e,function(e){o||(i=t.get(e),o=(c.isUndefined(i)||c.isNull(i))&&(c.isUndefined(n[e])||c.isNull(n[e]))||i==n[e])})}):o=!0,this.$gridBody.find("button.add").prop("disabled",o))},addColumns:function(e){e.preventDefault();var t=this,i=t.headerData.get("local_column"),n=t.headerData.get("referenced");if(!i||""==i||!n||""==n)return!1;var o=new(t.field.get("model"))(t.headerData.toJSON()),l=t.model.get(t.field.get("name"));l.add(o);var a=l.indexOf(o);if(-1<a){t.$grid.find(".new").removeClass("new");var r=t.grid.body.rows[a].$el;r.addClass("new"),d(r).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){0<e.collection.length?e.$header.find('div[header="references"] select').prop("disabled",!0):e.$header.find('div[header="references"] select').prop("disabled",!1),e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged(),(!c.has(e.model,"handler")||c.has(e.model,"handler")&&c.isUndefined(e.model.handler)||c.has(e.model,"handler")&&!c.isUndefined(e.model.handler)&&!c.isUndefined(e.model.handler.get("oid")))&&e.getCoveringIndex()},10)},getCoveringIndex:function(){var e=this,t=e.model,i=[],n=null;if(e.collection.each(function(e){i.push(e.get("local_column"))}),0<i.length){var o=this.field.get("schema_node"),l=this.field.get("node_info"),a=o.generate_url.apply(o,[null,"get_coveringindex",this.field.get("node_data"),this.field.get("url_with_id")||!1,l]);this.field.get("version_compatible")&&(t.trigger("pgadmin:view:fetching",t,e.field),d.ajax({async:!1,data:{cols:JSON.stringify(i)},url:a}).done(function(e){n=e.data}).fail(function(){t.trigger("pgadmin:view:fetch:error",t,e.field)}),t.trigger("pgadmin:view:fetched",t,e.field))}n?(t.set("hasindex",!0),t.set("autoindex",!1),t.set("coveringindex",n)):(t.set("coveringindex",null),t.set("autoindex",!0),t.set("hasindex",!1))},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onRemoveVariable),c.each(this.controls,function(e){e.remove()}),n.__super__.remove.apply(this,arguments),delete this.headerData}});return p.Nodes.foreign_key||(t.Browser.Nodes.foreign_key=p.Node.extend({type:"foreign_key",label:a("Foreign key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"foreign_key_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"create_foreign_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Foreign key..."),icon:"wcTabIcon icon-foreign_key",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_foreign_key",node:"foreign_key",module:this,applies:["object","context"],callback:"validate_foreign_key",category:"validate",priority:4,label:a("Validate foreign key"),icon:"fa fa-link",enable:"is_not_valid"}]))},is_not_valid:function(e){return e&&!e.valid},callbacks:{validate_foreign_key:function(e){var t=e||{},n=p.tree,o=t.item||n.selected(),i=o&&1==o.length?n.itemData(o):void 0;if(!i)return!1;var l=i;return d.ajax({url:this.generate_url(o,"validate",i,!0),type:"GET"}).done(function(e){1==e.success&&(s.success(e.info),n.removeIcon(o),l.valid=!0,l.icon="icon-foreign_key",n.addIcon(o,{icon:l.icon}),setTimeout(function(){n.deselect(o)},10),setTimeout(function(){n.select(o)},100))}).fail(function(e,t,i){s.pgRespErrorNotify(e,i),n.unload(o)}),!1}},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,condeferrable:void 0,condeferred:void 0,confmatchtype:void 0,convalidated:void 0,columns:void 0,confupdtype:"a",confdeltype:"a",autoindex:!0,coveringindex:void 0,hasindex:void 0},toJSON:function(){var e=t.Browser.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.hasindex,e},schema:[{id:"name",label:a("Name"),type:"text",mode:["properties","create","edit"],editable:!0,headerCell:m.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50"},{id:"oid",label:a("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"condeferrable",label:a("Deferrable?"),type:"switch",group:a("Definition"),disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()}},{id:"condeferred",label:a("Deferred?"),type:"switch",group:a("Definition"),deps:["condeferrable"],disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"confmatchtype",label:a("Match type"),type:"switch",group:a("Definition"),options:{onText:"FULL",offText:"SIMPLE",width:"80"},disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()}},{id:"convalidated",label:a("Validated?"),type:"switch",group:a("Definition"),options:{onText:a("Yes"),offText:a("No")},disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!(c.isUndefined(e.get("oid"))||!e.get("convalidated")):!(e.isNew()||!e.get("convalidated"))}},{id:"autoindex",label:a("Auto FK index?"),type:"switch",group:a("Definition"),deps:["name","hasindex"],options:{onText:a("Yes"),offText:a("No")},disabled:function(n){function e(){var e=n.get("name"),t="fki_"+n.previous("name");if(n.get("hasindex"))return!0;if(!n.get("autoindex")||c.isUndefined(e)||c.isNull(e)||""==e||!c.isUndefined(o)&&!c.isNull(o)&&""!=o&&o!=t)return!1;var i="fki_"+e;return n.set("coveringindex",i),!1}var o=n.get("coveringindex"),t=n.get("autoindex");return c.has(n,"handler")&&!c.isUndefined(n.handler)?c.isUndefined(n.get("oid"))&&c.isUndefined(n.handler.get("oid"))?(setTimeout(function(){n.get("autoindex")&&n.set("autoindex",!1)},10),!0):e():!(n.isNew()||!t||c.isUndefined(o)||c.isNull(o)||""==o||!n.get("hasindex"))||e()}},{id:"coveringindex",label:a("Covering index"),type:"text",mode:["properties","create","edit"],group:a("Definition"),deps:["autoindex","hasindex"],disabled:function(i){function e(){return!!i.get("hasindex")||(i.get("autoindex")?(setTimeout(function(){var e=i.get("name"),t="fki_"+e;!i.get("autoindex")||c.isUndefined(e)||c.isNull(e)||""==e||i.set("coveringindex",t)}),!1):(setTimeout(function(){i.set("coveringindex",null)}),!0))}var t=i.get("coveringindex");return c.has(i,"handler")&&!c.isUndefined(i.handler)?!(!c.isUndefined(i.get("oid"))||!c.isUndefined(i.handler.get("oid")))||e():!(i.isNew()||!i.get("autoindex")||c.isUndefined(t)||!c.isNull(t)||""!=t)||e()}},{id:"columns",label:a("Columns"),type:"collection",group:a("Columns"),node:"foreign_key",editable:!1,headerCell:m.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50",cell:m.StringCell.extend({initialize:function(){m.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(c.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}e.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var i=this,t=i.model.get("columns").where({local_column:e.get("name")});i.model.get("columns").remove(t),setTimeout(function(){i.render()},10),setTimeout(function(){var e=i.model.top.get("foreign_key"),t=[];e.each(function(e){0==e.get("columns").length&&t.push(e)}),e.remove(t)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({local_column:e.previous("name")});0<i.length&&i[0].set({local_column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){var t=[],i=[];return 0<e.length?(e.each(function(e){t.push(e.get("local_column")),i.push(e.get("referenced"))}),"("+t.join(", ")+") -> ("+i.join(", ")+")"):""},toRaw:function(e){return e}},render:function(){return m.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns");this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),m.StringCell.prototype.remove.apply(this,arguments)}}),canAdd:function(e){return e.isNew()},canDelete:!0,control:n,model:i,disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()}},{id:"confupdtype",label:a("On update"),type:"select2",group:a("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()}},{id:"confdeltype",label:a("On delete"),type:"select2",group:a("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)?!c.isUndefined(e.get("oid")):!e.isNew()}}],validate:function(){var e,t=this.get("columns");if(this.errorModel.clear(),c.isUndefined(t)||c.isNull(t)||t.length<1)return e=a("Please specify columns for Foreign key."),this.errorModel.set("columns",e),e;var i=this.get("coveringindex");return this.get("autoindex")&&(c.isUndefined(i)||c.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))?(e=a("Please specify covering index name."),this.errorModel.set("coveringindex",e),e):null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=p.tree,o=t,l=e,a=[],r=!1,s=!1,d=this.getTreeNodeHierarchy(o).server.version;o;){if(r||"table"!=l._type&&"partition"!=l._type||(r=!0,"is_partitioned"in l&&l.is_partitioned&&d<11e4&&(s=!0)),-1<c.indexOf(["schema"],l._type))return!s;a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<c.indexOf(a,"catalog"))&&!s}})),p.Nodes.foreign_key}.apply(t,n))||(e.exports=o)},426:function(e,t,i){"use strict";var n,o;i(36),i(10),i(16),i(23),i(30),i(33),i(18),i(11),i(12),i(46),i(6),i(31),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(9),i(47),i(13),i(28),i(20)],void 0===(o=function(a,e,d,c,n,t,p,l,r,u){var i=p.Node.Model.extend({defaults:{column:void 0,oper_class:void 0,order:!1,nulls_order:!1,operator:void 0,col_type:void 0,is_sort_nulls_applicable:!0},toJSON:function(){var e=p.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.col_type,e},schema:[{id:"column",label:a("Column"),type:"text",editable:!1,cell:"string"},{id:"oper_class",label:a("Operator class"),type:"text",node:"table",url:"get_oper_class",first_empty:!0,editable:function(e){return e instanceof n.Collection||!(c.has(e.collection,"handler")&&!c.isUndefined(e.collection.handler)&&!c.isUndefined(e.collection.handler.get("oid")))&&!(c.has(e.collection,"handler")&&!c.isUndefined(e.collection.handler)&&!c.isUndefined(e.collection.handler.get("amname"))&&"btree"!=e.collection.handler.get("amname"))},select2:{allowClear:!0,width:"style",tags:!0,placeholder:a("Select the operator class")},cell:u.Extension.Select2Cell.extend({initialize:function(){u.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var t=this,e=t.column.get("url")||t.defaults.url,i=t.model,n=t.model.collection.handler.get("amname");if(e&&("btree"==n||c.isUndefined(n)||c.isNull(n)||""==n)){setTimeout(function(){i.set("order",!0),i.set("nulls_order",!0)},10);var o=this.column.get("schema_node"),l=i.top||i,a=this.column.get("node_info"),r=o.generate_url.apply(o,[null,e,this.column.get("node_data"),this.column.get("url_with_id")||!1,a]),s=[];n="btree",this.column.get("version_compatible")&&(l.trigger("pgadmin:view:fetching",i,t.column),d.ajax({async:!1,data:{indextype:n},url:r}).done(function(e){s=e.data,t.column.set("options",s)}).fail(function(){l.trigger("pgadmin:view:fetch:error",i,t.column)}),l.trigger("pgadmin:view:fetched",i,t.column))}else t.column.set("options",[])}})},{id:"order",label:a("DESC"),type:"switch",options:{onText:"ASC",offText:"DESC"},editable:function(e){return e instanceof n.Collection||!(c.has(e.collection,"handler")&&!c.isUndefined(e.collection.handler)&&!c.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"nulls_order",label:a("NULLs order"),type:"switch",options:{onText:"FIRST",offText:"LAST"},editable:function(e){return e instanceof n.Collection||!(c.has(e.collection,"handler")&&!c.isUndefined(e.collection.handler)&&!c.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"operator",label:a("Operator"),type:"text",node:"table",url:"get_operator",editable:function(e){return e instanceof n.Collection||!(c.has(e.collection,"handler")&&!c.isUndefined(e.collection.handler)&&!c.isUndefined(e.collection.handler.get("oid")))},select2:{allowClear:!1,width:"style"},cell:u.Extension.Select2Cell.extend({initialize:function(){u.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var t=this,e=t.column.get("url")||t.defaults.url,i=t.model,n=t.model.get("col_type");if(t.column.set("options",[]),e&&!c.isUndefined(n)&&!c.isNull(n)&&""!=n){var o=this.column.get("schema_node"),l=i.top||i,a=this.column.get("node_info"),r=o.generate_url.apply(o,[null,e,this.column.get("node_data"),this.column.get("url_with_id")||!1,a]),s=[];this.column.get("version_compatible")&&(l.trigger("pgadmin:view:fetching",i,t.column),d.ajax({async:!1,data:{col_type:n},url:r}).done(function(e){s=e.data,t.column.set("options",s)}).fail(function(){l.trigger("pgadmin:view:fetch:error",i,t.column)}),l.trigger("pgadmin:view:fetched",i,t.column))}}})}],validate:function(){this.errorModel.clear();var e=this.get("operator"),t=this.get("column");if(c.isUndefined(e)||c.isNull(e)){var i=a("Please specify operator for column: ")+t;return this.errorModel.set("operator",i),i}return null}}),o=r.ExclusionConstraintColumnControl=r.UniqueColCollectionControl.extend({initialize:function(){r.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var s=this,e=[{id:"column",label:"",type:"text",node:"column",control:r.NodeListByNameControl.extend({initialize:function(){if(s.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),c.isUndefined(s.model.get("oid"))){var e=s.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions),this.listenTo(e,"change:cltype",this.resetColOptions)}this.custom_options()}else r.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},resetColOptions:function(e){var t=this;e.previous("name")==s.headerData.get("column")&&(s.headerData.set({column:e.get("name")}),s.headerDataChanged()),setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=s.model.top.get("columns"),i=[],n=[];0<e.length&&c.each(e.models,function(e){var t=e.get("name");c.isUndefined(t)||c.isNull(t)||(i.push({label:t,value:t,image:"icon-column"}),n.push({name:t,type:e.get("cltype")}))}),this.field.set("options",i),s.field.set("col_types",n)},remove:function(){if(s.model.handler){var e=s.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),this.stopListening(e,"change:cltype",this.resetColOptions),r.Select2Control.prototype.remove.apply(this,arguments)}else r.NodeListByNameControl.prototype.remove.apply(this,arguments)},template:c.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"))}),transform:function(e){var n=this,o=n.field.get("schema_node"),l=[],a=[],r=n.field.get("filter")||function(){return!0};return r=r.bind(n),c.each(e,function(e){if(r(e)){var t=c.isFunction(o.node_label)?o.node_label.apply(o,[e,n.model,n]):e.label,i=c.isFunction(o.node_image)?o.node_image.apply(o,[e,n.model,n]):o.node_image||"icon-"+o.type;l.push({value:e.label,image:i,label:t}),a.push({name:e.label,type:e.datatype})}}),s.field.set("col_types",a),l},canAdd:function(e){return!(c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew())},select2:{allowClear:!1,width:"style",placeholder:"Select column"},first_empty:!s.model.isNew(),disabled:function(){return!c.isUndefined(s.model.get("oid"))}}];s.headerData=new(n.Model.extend({defaults:{column:null},schema:e}))({});var t=r.generateViewSchema(s.field.get("node_info"),s.headerData,"create","exclusion_constraint",s.field.get("node_data")),i=[];c.each(t,function(e){i=i.concat(e.fields)}),s.headerFields=new r.Fields(i),s.gridSchema=r.generateGridColumnsFromModel(s.field.get("node_info"),s.field.get("model"),"edit",["column","oper_class","order","nulls_order","operator"],s.field.get("schema_node")),s.controls=[],s.listenTo(s.headerData,"change",s.headerDataChanged),s.listenTo(s.headerData,"select2",s.headerDataChanged),s.listenTo(s.collection,"add",s.onAddorRemoveColumns),s.listenTo(s.collection,"remove",s.onAddorRemoveColumns)},generateHeader:function(e){var t=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-4" header="column"></div>',"  </div>"," </div>","</div>"].join("\n");c.extend(e,{column_label:a("Column")});var i=this,n=c.template(t),o=d(n(e)),l=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:i.headerData});o.find('div[header="'+e.get("name")+'"]').append(t.render().$el),l.push(t)}),"properties"==e.mode&&o.html(""),i.$header=o},events:c.extend({},r.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,i=c.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+c("Add new row")+'"></button>',"</div>"].join("\n")),n=d("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?i({label:e.label,canAdd:e.canAdd}):"");n.append(t.generateHeader(e));var o=c.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&o.unshift({name:"pg-backform-delete",label:"",cell:u.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var l=t.grid=new u.Grid({columns:o,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=l.render().$el,n.append(t.$grid),setTimeout(function(){t.headerData.set({column:t.$header.find('div[header="column"] select').val()},{silent:!0})},10),"properties"===e.mode&&n.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=n},headerDataChanged:function(){var i,n=this.headerData.toJSON(),o=!1,e=["column"];this.$header&&(this.control_data.canAdd?this.collection.each(function(t){o||c.each(e,function(e){o||(i=t.get(e),o=(c.isUndefined(i)||c.isNull(i))&&(c.isUndefined(n[e])||c.isNull(n[e]))||i==n[e])})}):o=!0,this.$gridBody.find("button.add").prop("disabled",o))},addColumns:function(e){e.preventDefault();var t=this.headerData.get("column");if(!t||""==t)return!1;for(var i=this.model.get(this.field.get("name")),n=new(this.field.get("model"))(this.headerData.toJSON(),{silent:!0,top:this.model.top,collection:i,handler:i}),o=this.field.get("col_types")||[],l=0;l<o.length;l++){var a=o[l];if(a.name==n.get("column")){n.set({col_type:a.type});break}}i.add(n);var r=i.indexOf(n);if(-1<r){this.$grid.find(".new").removeClass("new");var s=this.grid.body.rows[r].$el;s.addClass("new"),d(s).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveColumns),c.each(this.controls,function(e){e.remove()}),o.__super__.remove.apply(this,arguments),delete this.headerData}});return p.Nodes.exclusion_constraint||(t.Browser.Nodes.exclusion_constraint=p.Node.extend({type:"exclusion_constraint",label:a("Exclusion constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"exclusion_constraint_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[a("Index size")],Init:function(){this.initialized||(this.initialized=!0,p.add_menus([{name:"create_exclusion_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Exclusion constraint..."),icon:"wcTabIcon icon-exclusion_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},is_not_valid:function(e){return e&&!e.valid},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,amname:"gist",fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:a("Name"),type:"text",mode:["properties","create","edit"],editable:!0},{id:"oid",label:a("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"spcname",label:a("Tablespace"),type:"text",group:a("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"amname",label:a("Access method"),type:"text",group:a("Definition"),url:"get_access_methods",node:"table",control:r.NodeAjaxOptionsControl.extend({onChange:function(){r.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this,t=e.model.get("amname"),i=e.model.previous("amname"),n=e.model.get("columns");if(0<n.length&&t!=i){var o=a("Changing access method will clear columns collection");l.confirm(o,function(){n.each(function(e){n.remove(e)}),setTimeout(function(){n.trigger("pgadmin:columns:updated",n)},10)},function(){setTimeout(function(){e.model.set("amname",i)},10)})}}}),select2:{allowClear:!0},disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew()}},{id:"fillfactor",label:a("Fill factor"),type:"int",group:a("Definition"),allowNull:!0},{id:"condeferrable",label:a("Deferrable?"),type:"switch",group:a("Definition"),deps:["index"],disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew()}},{id:"condeferred",label:a("Deferred?"),type:"switch",group:a("Definition"),deps:["condeferrable"],disabled:function(e){return!!(c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew())||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"indconstraint",label:a("Constraint"),cell:"string",type:"multiline",mode:["create","edit","properties"],editable:!1,group:a("Definition"),disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew()}},{id:"columns",label:a("Columns"),type:"collection",group:a("Columns"),deps:["amname"],canDelete:!0,editable:!1,canAdd:function(e){return!(c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew())},control:o,model:i,disabled:function(e){return c.has(e,"handler")&&!c.isUndefined(e.handler)&&!c.isUndefined(e.get("oid"))||c.isFunction(e.isNew)&&!e.isNew()},cell:u.StringCell.extend({initialize:function(){u.StringCell.prototype.initialize.apply(this,arguments);var e=this;if(c.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.removeColumn),e.listenTo(t,"change:name",e.resetColOptions),e.listenTo(t,"change:cltype",e.removeColumnWithType)}this.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)})},removeColumnWithType:function(e){var i=this,t=i.model.get("columns"),n=t.where({col_type:e.previous("cltype")});t.remove(n),setTimeout(function(){i.render()},10),setTimeout(function(){var e=i.model.top.get("exclude_constraint"),t=[];e.each(function(e){0==e.get("columns").length&&t.push(e)}),e.remove(t)},100)},removeColumn:function(e){var i=this,t=i.model.get("columns").where({column:e.get("name")});i.model.get("columns").remove(t),setTimeout(function(){i.render()},10),setTimeout(function(){var e=i.model.top.get("exclude_constraint"),t=[];e.each(function(e){0==e.get("columns").length&&t.push(e)}),e.remove(t)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});0<i.length&&i[0].set({column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return u.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:columns:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),this.stopListening(e,"change:cltype",self.removeColumnWithType),u.StringCell.prototype.remove.apply(this,arguments)}})},{id:"include",label:a("Include columns"),type:"array",group:a("Columns"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!c.isUndefined(e.node_info)&&!c.isUndefined(e.node_info.server)&&!c.isUndefined(e.node_info.server.version)&&11e4<=e.node_info.server.version},control:r.MultiSelectAjaxControl.extend({defaults:c.extend({},r.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:a("Select the column(s)")}}),initialize:function(){if(this.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),c.isUndefined(this.model.get("oid"))){var e=this.model.top.get("columns");this.listenTo(e,"remove",this.resetColOptions),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else r.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),i=[];0<e.length&&c.each(e.models,function(e){var t=e.get("name");c.isUndefined(t)||c.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function(e){if(c.has(e,"top")&&!c.isUndefined(e.top)&&!e.top.isNew())return!c.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!c.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}}],validate:function(){this.errorModel.clear();var e,t=this.get("columns"),i=this.get("name");return c.isUndefined(i)||c.isNull(i)||i.length<1?(e=a("Please specify name for exclusion constraint."),this.errorModel.set("name",e),e):c.isUndefined(t)||c.isNull(t)||t.length<1?(e=a("Please specify columns for exclusion constraint."),this.errorModel.set("columns",e),e):null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=p.tree,o=t,l=e,a=[],r=!1,s=!1;o;){if(r||"table"!=l._type&&"partition"!=l._type||(r=!0,"is_partitioned"in l&&l.is_partitioned&&(s=!0)),-1<c.indexOf(["schema"],l._type))return!s;a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<c.indexOf(a,"catalog"))&&!s}})),p.Nodes.exclusion_constraint}.apply(t,n))||(e.exports=o)},427:function(e,t,i){"use strict";var n,o;i(16),i(40),i(50),i(33),i(12),i(4),i(46),i(8),i(29),i(6),n=[i(2),i(5),i(0),i(1),i(3),i(9),i(13),i(28),i(20)],void 0===(o=function(n,e,u,m,t,h,i,o){return h.Nodes.primary_key||(t.Browser.Nodes.primary_key=h.Node.extend({type:"primary_key",label:n("Primary key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"primary_key_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[n("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,h.add_menus([{name:"create_primary_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Primary key"),icon:"wcTabIcon icon-primary_key",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=h.tree,o=t,l=e,a=[],r=!1,s=!1,d=this.getTreeNodeHierarchy(o).server.version;o;){if(r||"table"!=l._type&&"partition"!=l._type||(r=!0,"is_partitioned"in l&&l.is_partitioned&&d<11e4&&(s=!0)),-1<m.indexOf(["schema"],l._type)){if(s)return!1;var c=n.children(t,!1),p=!1;return m.each(c,function(e){i=h.tree.itemData(u(e)),p||"primary_key"!=i._type||(p=!0)}),!p}a.push(l._type),l=(o=n.hasParent(o)?n.parent(o):null)?n.itemData(o):null}return!(-1<m.indexOf(a,"catalog"))&&!s},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:n("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:n("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:n("Columns"),type:"collection",group:n("Definition"),editable:!1,cell:o.StringCell.extend({initialize:function(){o.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(m.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var i=this,t=i.model.get("columns").where({column:e.get("name")});i.model.get("columns").remove(t),setTimeout(function(){i.render()},10);setTimeout(function(){var e=i.model.top.get("primary_key"),t=[];e.each(function(e){0==e.get("columns").length&&t.push(e)}),e.remove(t)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});0<i.length&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return o.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),o.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:i.MultiSelectAjaxControl.extend({defaults:m.extend({},i.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:n("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(m.isArray(i))return m.map(i,function(e){return e.column});t=t.split(".");for(var n=0;n<t.length;n++){if(m.isNull(i))return null;m.isEmpty(t[n])||m.isUndefined(i[t[n]])||(i=i[t[n]])}return m.isObject(i)&&!m.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(i.Select2Control.prototype.initialize.apply(this,arguments),m.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else i.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),i=[];0<e.length&&m.each(e.models,function(e){var t=e.get("name");m.isUndefined(t)||m.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)},onChange:function(){var i=this,e=this.model,t=this.field.get("name").split(".").shift(),n=this.getValueFromDOM(),o=e.get(t),l=[];this.stopListening(this.model,"change:"+t,this.render),o.each(function(e){var t=e.get("column"),i=m.indexOf(n,t);-1<i?n.splice(i,1):l.push(t)}),m.each(n,function(e){var t=new(i.field.get("model"))({column:e},{silent:!0,top:i.model.top,collection:o,handler:o});o.add(t)}),m.each(l,function(e){o.remove(o.where({column:e}))}),this.listenTo(this.model,"change:"+t,this.render)},remove:function(){if(this.model.handler){var e=this.model.top.get("columns");this.stopListening(e,"remove",this.resetColOptions),this.stopListening(e,"change:name",this.resetColOptions),this.model.get("columns").off("pgadmin:multicolumn:updated"),i.Select2Control.prototype.remove.apply(this,arguments)}else i.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:h.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&m.isArray(e)&&m.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(m.has(e,"top")&&!m.isUndefined(e.top)&&!e.top.isNew())return!m.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!m.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:n("Include columns"),type:"array",group:n("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!m.isUndefined(e.node_info)&&!m.isUndefined(e.node_info.server)&&!m.isUndefined(e.node_info.server.version)&&11e4<=e.node_info.server.version},control:i.MultiSelectAjaxControl.extend({defaults:m.extend({},i.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:n("Select the column(s)")}}),initialize:function(){if(this.model.handler){if(i.Select2Control.prototype.initialize.apply(this,arguments),m.isUndefined(this.model.get("oid"))){var e=this.model.top.get("columns");this.listenTo(e,"remove",this.resetColOptions),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else i.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),i=[];0<e.length&&m.each(e.models,function(e){var t=e.get("name");m.isUndefined(t)||m.isNull(t)||i.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function(e){if(m.has(e,"top")&&!m.isUndefined(e.top)&&!e.top.isNew())return!m.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!m.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:n("Tablespace"),type:"text",group:n("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){var t=(e=e.top||e).get("index");return!m.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:n("Index"),mode:["create"],type:"text",group:n("Definition"),control:i.NodeListByNameControl.extend({initialize:function(){i.NodeListByNameControl.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!m.has(e,"top")||m.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!m.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:n("Fill factor"),deps:["index"],type:"int",group:n("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!m.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:n("Deferrable?"),type:"switch",group:n("Definition"),deps:["index"],disabled:function(e){if(m.has(e,"top")&&!m.isUndefined(e.top)&&!e.top.isNew())return!m.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!m.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:n("Deferred?"),type:"switch",group:n("Definition"),deps:["condeferrable"],disabled:function(e){return!m.has(e,"top")||m.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!m.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),m.has(this,"top")&&this.top.errorModel.clear();var e=this.get("columns"),t=this.get("index");if(!m.isUndefined(t)&&""!=String(t).replace(/^\s+|\s+$/g,"")||!(m.isUndefined(e)||m.isNull(e)||e.length<1))return null;var i=n("Please specify columns for %s",n("Primary key"));return this.errorModel.set("columns",i),i}})})),h.Nodes.primary_key}.apply(t,n))||(e.exports=o)},51:function(e,t,i){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(21),i(26),i(27),i(19),i(7),i(32),i(12),i(24),i(49),i(22),Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaChildNode=void 0;var n=l(i(80)),o=l(i(38));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var l=n?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(i,o,l):i[o]=e[o]}return i.default=e,t&&t.set(e,i),i}var s=n.extend({parent_type:["schema","catalog"],canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:o.isTreeItemOfChildOfSchema,canCreate:o.childCreateMenuEnabled},!1);t.SchemaChildNode=s}}]);